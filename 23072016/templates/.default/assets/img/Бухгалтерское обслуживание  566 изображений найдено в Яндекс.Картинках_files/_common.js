!function(t){function e(t){var e=r(t);if(u)for(var i,n=0;i=p[n++];)t.hasOwnProperty(i)&&e.push(i);return e}function i(i,n,s){function o(e,s){var o=function(){var t=this.__base;this.__base=o.__base;var e=s.apply(this,arguments);return this.__base=t,e};return o.__base=i[e]?i[e]:"__constructor"===e?n.__self.__parent:t.noop,o}for(var r,a,c=e(s),u=0,l=c.length;l>u;)"__self"!==(r=c[u++])&&(a=s[r],n[r]=h(a)&&a.toString().indexOf(".__base")>-1?o(r,a):a)}function n(e,i){for(var n,s=1;n=e[s++];)i?h(n)?t.inheritSelf(i,n.prototype,n):t.inheritSelf(i,n):i=h(n)?t.inherit(e[0],n.prototype,n):t.inherit(e[0],n);return i||e[0]}var s=function(){},o=Object.create||function(t){var e=function(){};return e.prototype=t,new e},r=Object.keys,a=t.extend,c=Array.isArray,h=t.isFunction,u=!0,l={toString:""};for(var d in l)l.hasOwnProperty(d)&&(u=!1);var p=u?["toString","valueOf"]:null;t.inherit=function(){var t=arguments,e=c(t[0]),r=e||h(t[0]),u=r?e?n(t[0]):t[0]:s,l=t[r?1:0]||{},d=t[r?2:1],p=l.__constructor||r&&u.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:r?function(){return u.apply(this,arguments)}:function(){};if(!r)return p.prototype=l,p.prototype.__self=p.prototype.constructor=p,a(p,d);a(p,u),p.__parent=u;var f=u.prototype,m=p.prototype=o(f);return m.__self=m.constructor=p,l&&i(f,m,l),d&&i(u,p,d),p},t.inheritSelf=function(){var t=arguments,e=c(t[0]),s=e?n(t[0],t[0][0]):t[0],o=t[1],r=t[2],a=s.prototype;return o&&i(a,a,o),r&&i(s,s,r),s}}(jQuery),function(t){var e=0,i="__"+Number(new Date),n=function(){return"uniq"+ ++e};t.identify=function(t,e){if(!t)return n();var s="uniqueID"in t?"uniqueID":i;return e||s in t?t[s]:t[s]=n()}}(jQuery),function(t){var e="__"+Number(new Date)+"storage",i=function(e,i){return t.identify(e)+(i?t.identify(i):"")},n={buildEventName:function(t){return t},on:function(n,s,o,r,a){if("string"==typeof n){t.isFunction(s)&&(r=o,o=s,s=void 0);for(var c,h=i(o,r),u=this[e]||(this[e]={}),l=n.split(" "),d=0;n=l[d++];)if(n=this.buildEventName(n),c=u[n]||(u[n]={ids:{},list:{}}),!(h in c.ids)){var p=c.list,f={fn:o,data:s,ctx:r,special:a};p.last?(p.last.next=f,f.prev=p.last):p.first=f,c.ids[h]=p.last=f}}else{var m=this;t.each(n,function(t,e){m.on(t,e,s,a)})}return this},onFirst:function(t,e,i,n){return this.on(t,e,i,n,{one:!0})},un:function(n,s,o){if("string"==typeof n||"undefined"==typeof n){var r=this[e];if(r)if(n){for(var a,c=n.split(" "),h=0;n=c[h++];)if(n=this.buildEventName(n),a=r[n])if(s){var u=i(s,o),l=a.ids;if(u in l){var d=a.list,p=l[u],f=p.prev,m=p.next;f?f.next=m:p===d.first&&(d.first=m),m?m.prev=f:p===d.last&&(d.last=f),delete l[u]}}else delete this[e][n]}else delete this[e]}else{var _=this;t.each(n,function(t,e){_.un(t,e,o)})}return this},trigger:function(i,n){var s,o=this,r=o[e];if("string"==typeof i?i=t.Event(o.buildEventName(s=i)):i.type=o.buildEventName(s=i.type),i.target||(i.target=o),r&&(r=r[i.type]))for(var a,c=r.list.first;c;)i.data=c.data,a=c.fn.call(c.ctx||o,i,n),"undefined"!=typeof a&&(i.result=a,a===!1&&(i.preventDefault(),i.stopPropagation())),c.special&&c.special.one&&o.un(s,c.fn,c.ctx),c=c.next;return this}};t.observable=t.inherit(n,n)}(jQuery),function(){var t=Array.prototype.slice;Function.prototype.bind||(Function.prototype.bind=function(e){var i=this,n=t.call(arguments,1);return function(){return i.apply(e,n.concat(t.call(arguments)))}})}(),function(t,e){function i(t,e,i){return(t?"__elem_"+t:"")+"__mod"+(e?"_"+e:"")+(i?"_"+i:"")}function n(e,n,s){t.isFunction(e)?n[i(s,"*","*")]=e:t.each(e,function(e,o){t.isFunction(o)?n[i(s,e,"*")]=o:t.each(o,function(t,o){n[i(s,e,t)]=o})})}function s(t,e){return e?Array.isArray(e)?function(i){for(var n=0,s=e.length;s>n;)if(i.hasMod(t,e[n++]))return!0;return!1}:function(i){return i.hasMod(t,e)}:function(e){return e.hasMod(t)}}var o=[],r={},a={};this.BEM=t.inherit(t.observable,{__constructor:function(t,e,i){var n=this;n._modCache=t||{},n._processingMods={},n._params=e,n.params=null,i!==!1?n._init():n.afterCurrentEvent(function(){n._init()})},_init:function(){return this._initing||this.hasMod("js","inited")||(this._initing=!0,this.params||(this.params=t.extend(this.getDefaultParams(),this._params),delete this._params),this.setMod("js","inited"),delete this._initing,this.hasMod("js","inited")&&this.trigger("init")),this},changeThis:function(t,e){return t.bind(e||this)},afterCurrentEvent:function(t,e){this.__self.afterCurrentEvent(this.changeThis(t,e))},trigger:function(t,e){return this.__base(t=this.buildEvent(t),e).__self.trigger(t,e),this},buildEvent:function(e){return"string"==typeof e&&(e=t.Event(e)),e.block=this,e},hasMod:function(t,i,n){var s=arguments.length,o=!1;1==s?(n="",i=t,t=e,o=!0):2==s&&("string"==typeof t?(n=i,i=t,t=e):(n="",o=!0));var r=this.getMod(t,i)===n;return o?!r:r},getMod:function(t,e){var i=typeof t;if("string"===i||"undefined"===i){e=t||e;var n=this._modCache;return e in n?n[e]:n[e]=this._extractModVal(e)}return this._getElemMod(e,t)},_getElemMod:function(t,e,i){return this._extractModVal(t,e,i)},getMods:function(t){var i=t&&"string"!=typeof t,n=this,s=[].slice.call(arguments,i?1:0),o=n._extractMods(s,i?t:e);return i||(s.length?s.forEach(function(t){n._modCache[t]=o[t]}):n._modCache=o),o},setMod:function(i,n,s){"undefined"==typeof s&&(s=n,n=i,i=e);var o=this;if(!i||i[0]){var r=(i&&i[0]?t.identify(i[0]):"")+"_"+n;if(this._processingMods[r])return o;var a,c=i?o._getElemMod(n,i,a=o.__self._extractElemNameFrom(i)):o.getMod(n);if(c===s)return o;this._processingMods[r]=!0;var h=!0,u=[n,s,c];i&&u.unshift(i),[["*","*"],[n,"*"],[n,s]].forEach(function(t){h=o._callModFn(a,t[0],t[1],u)!==!1&&h}),!i&&h&&(o._modCache[n]=s),h&&o._afterSetMod(n,s,c,i,a),delete this._processingMods[r]}return o},_afterSetMod:function(){},toggleMod:function(t,i,n,s,o){"string"==typeof t&&(o=s,s=n,n=i,i=t,t=e),"undefined"==typeof s?s="":"boolean"==typeof s&&(o=s,s="");var r=this.getMod(t,i);return(r==n||r==s)&&this.setMod(t,i,"boolean"==typeof o?o?n:s:this.hasMod(t,i,n)?s:n),this},delMod:function(t,i){return i||(i=t,t=e),this.setMod(t,i,"")},_callModFn:function(t,n,s,o){var r=i(t,n,s);return this[r]?this[r].apply(this,o):e},_extractModVal:function(){return""},_extractMods:function(){return{}},channel:function(t,e){return this.__self.channel(t,e)},getDefaultParams:function(){return{}},del:function(t){var e=[].slice.call(arguments);return"string"==typeof t&&e.unshift(this),this.__self.del.apply(this.__self,e),this},destruct:function(){}},t.extend(this.BEM,{_name:"i-bem",blocks:r,decl:function(i,o,a){if("string"==typeof i?i={block:i}:i.name&&(i.block=i.name),i.baseBlock&&!r[i.baseBlock])throw'baseBlock "'+i.baseBlock+'" for "'+i.block+'" is undefined';o||(o={}),o.onSetMod&&(n(o.onSetMod,o),delete o.onSetMod),o.onElemSetMod&&(t.each(o.onElemSetMod,function(t,e){n(e,o,t)}),delete o.onElemSetMod);var c=r[i.baseBlock||i.block]||this;if(i.modName){var h=s(i.modName,i.modVal);t.each(o,function(i,n){t.isFunction(n)&&(o[i]=function(){var t;if(h(this))t=n;else{var s=c.prototype[i];s&&s!==o[i]&&(t=this.__base)}return t?t.apply(this,arguments):e})})}if(a&&"boolean"==typeof a.live){var u=a.live;a.live=function(){return u}}var l;return i.block==c._name?(l=t.inheritSelf(c,o,a))._processLive(!0):((l=r[i.block]=t.inherit(c,o,a))._name=i.block,delete l._liveInitable),l},_processLive:function(){return!1},create:function(t,e){return"string"==typeof t&&(t={block:t}),new r[t.block](t.mods,e)},getName:function(){return this._name},_extractElemNameFrom:function(){},afterCurrentEvent:function(t,e){1==o.push({fn:t,ctx:e})&&setTimeout(this._runAfterCurrentEventFns,0)},_runAfterCurrentEventFns:function(){var t=o.length;t&&o.splice(0,t).forEach(function(t){t.fn.call(t.ctx||this)},this)},changeThis:function(t,e){return t.bind(e||this)},del:function(t){var e="string"==typeof t,i=e?0:1,n=arguments.length;for(e&&(t=this);n>i;)delete t[arguments[i++]];return this},channel:function(i,n){return"boolean"==typeof i&&(n=i,i=e),i||(i="default"),n?void(a[i]&&(a[i].un(),delete a[i])):a[i]||(a[i]=new t.observable)}}))}(jQuery),function(t,e,i){function n(t,e,i){i.push(r,t,r,e)}function s(t,e,i,s){s.push(t),i&&n(e,i,s)}function o(t,e,o,r,c){s(t,i,i,c),c.push(a,e),r&&n(o,r,c)}var r="_",a="__",c="[a-zA-Z0-9-]+";t.INTERNAL={NAME_PATTERN:c,MOD_DELIM:r,ELEM_DELIM:a,buildModPostfix:function(t,e,i){var s=i||[];return n(t,e,s),i?s:s.join("")},buildClass:function(t,e,n,r,a){var c=typeof n;if("string"==c?"string"!=typeof r&&"number"!=typeof r&&(a=r,r=n,n=e,e=i):"undefined"!=c?(a=n,n=i):e&&"string"!=typeof e&&(a=e,e=i),!(e||n||a))return t;var h=a||[];return e?o(t,e,n,r,h):s(t,n,r,h),a?h:h.join("")},buildClasses:function(t,n,r,a){n&&"string"!=typeof n&&(a=r,r=n,n=i);var c=a||[];return n?o(t,n,i,i,c):s(t,i,i,c),r&&e.each(r,function(e,i){i&&(c.push(" "),n?o(t,n,e,i,c):s(t,e,i,c))}),a?c:c.join("")}}}(BEM,jQuery),function(t,e,i){function n(t,i){var n=t[0];e.each(a(n),function(r,a){o(a,n,r,i);var c=f[a.uniqId];c?c.domElem.index(n)<0&&(c.domElem=c.domElem.add(t),e.extend(c._params,a)):s(r,t,a)})}function s(t,n,s,r,c){"boolean"==typeof s&&(c=r,r=s,s=i);var h=n[0];s=o(s||a(h)[t],h,t);var u=s.uniqId;if(f[u])return f[u]._init();p[u]=p[u]?p[u].add(n):n;var l=h.parentNode;l&&11!==l.nodeType||e.unique(p[u]);var d=b[t]||S.decl(t,{},{live:!0});if(!(d._liveInitable=Boolean(d._processLive()))||r||s.live===!1){r&&n.addClass("i-bem");var m=new d(p[u],s,Boolean(r));return delete p[u],c&&c.apply(m,B.call(arguments,4)),m}}function o(t,i,n,s){(t||(t={})).uniqId||(t.uniqId=(t.id?n+"-id-"+t.id:e.identify())+(s||e.identify()));var o=e.identify(i),r=m[o]||(m[o]={});return r[n]||(r[n]=t),t}function r(t,e,i){var n=t.find(e);return i?n:n.add(t.filter(e))}function a(t){var i=e.identify(t);return m[i]||(m[i]=c(t))}function c(t){var i,n,s=t.getAttribute("data-bem");return s?JSON.parse(s):(i=t.onclick||t.ondblclick,i||"body"!=t.tagName.toLowerCase()||(n=e(t),s=n.attr("onclick")||n.attr("ondblclick"),s&&(i=new Function(s))),i?i():{})}function h(t){delete m[e.identify(t)]}function u(t,e){1===t.domElem.length?t.destruct(!0):t.domElem=t.domElem.not(e)}var l=e(window),d=e(document),p={},f={},m={},_={},g={},b=t.blocks,v=t.INTERNAL,y=v.NAME_PATTERN,k=v.MOD_DELIM,M=v.ELEM_DELIM,w=v.buildModPostfix,E=v.buildClass,B=Array.prototype.slice,x=Array.prototype.reverse;e.fn.bem=function(t,e){return s(t,this,e,!0)};var S=t.DOM=t.decl("i-bem__dom",{__constructor:function(t,i,n){var s=this;s.domElem=t,s._eventNameCache={},s._elemCache={},f[s._uniqId=i.uniqId||e.identify(s)]=s,s._needSpecialUnbind=!1,s.__base(null,i,n)},findBlocksInside:function(t,e){return this._findBlocks("find",t,e)},findBlockInside:function(t,e){return this._findBlocks("find",t,e,!0)},findBlocksOutside:function(t,e){return this._findBlocks("parents",t,e)},findBlockOutside:function(t,e){return this._findBlocks("closest",t,e)[0]||null},findBlocksOn:function(t,e){return this._findBlocks("",t,e)},findBlockOn:function(t,e){return this._findBlocks("",t,e,!0)},_findBlocks:function(t,n,o,r){if(!this.domElem)return[];o||(o=n,n=i);var a=n?"string"==typeof n?this.findElem(n):n:this.domElem,c="string"==typeof o,h=c?o:o.block||o.blockName,u="."+(c?E(h):E(h,o.modName,o.modVal))+(r?":first":""),l=a.filter(u);if(t&&(l=l.add(a[t](u))),r)return l[0]?s(h,l.eq(0),!0):null;var d=[],p={};return e.each(l,function(t,i){var n=s(h,e(i),!0);p[n._uniqId]||(p[n._uniqId]=!0,d.push(n))}),d},bindToDomElem:function(t,i,n){var s=this;return n?t.bind(s._buildEventName(i),function(t){return(t.data||(t.data={})).domElem=e(this),n.apply(s,arguments)}):e.each(i,function(e,i){s.bindToDomElem(t,e,i)}),s},bindToDoc:function(t,e){return this._needSpecialUnbind=!0,this.bindToDomElem(d,t,e)},bindToWin:function(t,e){var i,n,s=e;return"resize"===t&&(e=function(){var t=l.height(),e=l.width();(i!==t||n!==e)&&(i=t,n=e,s.apply(this,arguments))}),this._needSpecialUnbind=!0,this.bindToDomElem(l,t,e)},bindTo:function(t,i,n){return!i||e.isFunction(i)?(n=i,i=t,t=this.domElem):"string"==typeof t&&(t=this.elem(t)),this.bindToDomElem(t,i,n)},unbindFromDomElem:function(t,e){return t.unbind(this._buildEventName(e)),this},unbindFromDoc:function(t){return this.unbindFromDomElem(d,t)},unbindFromWin:function(t){return this.unbindFromDomElem(l,t)},unbindFrom:function(t,e){return e?"string"==typeof t&&(t=this.elem(t)):(e=t,t=this.domElem),this.unbindFromDomElem(t,e)},_buildEventName:function(t){var e=this;return t.indexOf(" ")>1?t.split(" ").map(function(t){return e._buildOneEventName(t)}).join(" "):e._buildOneEventName(t)},_buildOneEventName:function(t){var e=this._eventNameCache;if(t in e)return e[t];var i="."+this._uniqId;if(-1===t.indexOf("."))return e[t]=t+i,e[t];var n=".bem_"+this.__self._name;return e[t]=t.split(".").map(function(t,e){return 0===e?t+n:n+"_"+t}).join("")+i,e[t]},trigger:function(t,e){return this.__base(t=this.buildEvent(t),e).domElem&&this._ctxTrigger(t,e),this},_ctxTrigger:function(t,i){var n=this,s=_[n.__self._buildCtxEventName(t.type)],o={};s&&n.domElem.each(function(){for(var r=this,a=s.counter;r&&a;){var c=e.identify(r,!0);if(c){if(o[c])break;var h=s.ctxs[c];h&&(e.each(h,function(e,s){s.fn.call(s.ctx||n,t,i)}),a--),o[c]=!0}r=r.parentNode}})},setMod:function(t,i,n){if(t&&"undefined"!=typeof n&&t.length>1){var s=this;return t.each(function(){var o=e(this);o.__bemElemName=t.__bemElemName,s.setMod(o,i,n)}),s}return this.__base(t,i,n)},_extractModVal:function(t,e,i){var n,s=(e||this.domElem)[0];return s&&(n=s.className.match(this.__self._buildModValRE(t,i||e))),n?n[2]:""},_extractMods:function(t,e){var i={},n=!t.length,s=0;return((e||this.domElem)[0].className.match(this.__self._buildModValRE("("+(n?y:t.join("|"))+")",e,"g"))||[]).forEach(function(t){var e=(t=t.trim()).lastIndexOf(k),n=t.substr(0,e-1).lastIndexOf(k);i[t.substr(n+1,e-n-1)]=t.substr(e+1),++s}),s<t.length&&t.forEach(function(t){t in i||(i[t]="")}),i},_afterSetMod:function(t,i,n,s,o){if(!this._isDestructing){var r=this.__self,a=r._buildModClassPrefix(t,o),c=r._buildModValRE(t,o),h=""===i;(s||this.domElem).each(function(){var t=this.className;t.indexOf(a)>-1?this.className=t.replace(c,h?"":"$1"+a+i):h||e(this).addClass(a+i)}),o&&this.dropElemCache(o,t,n).dropElemCache(o,t,i)}},findElem:function(t,e,i,n){arguments.length%2?(n=i,i=e,e=t,t=this.domElem):"string"==typeof t&&(t=this.findElem(t)),e=e.split(" ");var s=this.__self.getName(),o=w(i,n),a=[],c=e.map(function(t){return a.push("."+E(s,t,i,n)),t+o}),h=1===c.length,u=r(t,a.join(","));return t===this.domElem&&a.forEach(function(t,i){(this._elemCache[c[i]]=h?u:u.filter(t)).__bemElemName=e[i]},this),u},_elem:function(t,e,i){return this._elemCache[t+w(e,i)]||this.findElem(t,e,i)},elem:function(t,i,n){if(i&&"string"!=typeof i)return i.__bemElemName=t,i;if(t.indexOf(" ")<0)return this._elem(t,i,n);var s=e([]);return t.split(" ").forEach(function(t){s=s.add(this._elem(t,i,n))},this),s},dropElemCache:function(t,e,i){if(t){var n=w(e,i);t.indexOf(" ")<0?delete this._elemCache[t+n]:t.split(" ").forEach(function(t){delete this._elemCache[t+n]},this)}else this._elemCache={};return this},elemParams:function(t){var e;return"string"==typeof t?(e=t,t=this.elem(t)):e=this.__self._extractElemNameFrom(t),c(t[0])[E(this.__self.getName(),e)]||{}},elemify:function(t,i){return(t=e(t)).__bemElemName=i,t},containsDomElem:function(t){var e=!1;return this.domElem.each(function(){return!(e=t.parents().andSelf().index(this)>-1)}),e},buildSelector:function(t,e,i){return this.__self.buildSelector(t,e,i)},destruct:function(t){var i=this,n=i.__self;i._isDestructing||(i._isDestructing=!0,i._needSpecialUnbind&&n.doc.add(n.win).unbind("."+i._uniqId),i.dropElemCache().domElem.each(function(t,i){var n=a(i);e.each(n,function(t,e){var n=f[e.uniqId];n?n._isDestructing||u(n,i):delete p[e.uniqId]}),h(i)}),t||i.domElem.remove(),delete f[i.un()._uniqId],delete i.domElem,delete i._elemCache,i.__base())}},{scope:null,doc:d,win:l,_processLive:function(t){var e=this._liveInitable;if("live"in this){var i="undefined"==typeof e;if(i^t){e=this.live()!==!1;var n=this.getName(),s=this.live;this.live=function(){return this.getName()===n?e:s.apply(this,arguments)}}}return e},init:function(t,i,s){!t||e.isFunction(t)?(s=i,i=t,t=d):"string"==typeof t&&(t=e(t));var o=e.identify();return r(t,".i-bem").each(function(){n(e(this),o)}),i&&this.afterCurrentEvent(function(){i.call(s||this,t)}),this._runAfterCurrentEventFns(),t},destruct:function(t,n,s){"boolean"!=typeof t&&(s=n,n=t,t=i),x.call(r(n,".i-bem",s)).each(function(t,i){var n=a(this);e.each(n,function(t,e){if(e.uniqId){var n=f[e.uniqId];n?u(n,i):delete p[e.uniqId]}}),h(this)}),t||(s?n.empty():n.remove())},update:function(t,e,i,n){return this.destruct(t,!0),this.init(t.html(e),i,n)},replace:function(t,i){return this.destruct(!0,t),this.init(e(i).replaceAll(t))},append:function(t,i){return this.init(e(i).appendTo(t))},prepend:function(t,i){return this.init(e(i).prependTo(t))},before:function(t,i){return this.init(e(i).insertBefore(t))},after:function(t,i){return this.init(e(i).insertAfter(t))},_buildCtxEventName:function(t){return this._name+":"+t},_liveClassBind:function(t,i,n,s){var o=this;if(i.indexOf(" ")>-1)i.split(" ").forEach(function(e){o._liveClassBind(t,e,n,s)});else{var r=g[i],a=e.identify(n);r||(r=g[i]={},d.bind(i,o.changeThis(o._liveClassTrigger,o))),r=r[t]||(r[t]={uniqIds:{},fns:[]}),a in r.uniqIds||(r.fns.push({uniqId:a,fn:o._buildLiveEventFn(n,s)}),r.uniqIds[a]=r.fns.length-1)}return this},_liveClassUnbind:function(t,i,n){var s=g[i];if(s)if(n){if(s=s[t]){var o=e.identify(n);if(o in s.uniqIds){var r=s.uniqIds[o],a=s.fns.length-1;for(s.fns.splice(r,1);a>r;)s.uniqIds[s.fns[r++].uniqId]=r-1;delete s.uniqIds[o]}}}else delete s[t];return this},_liveClassTrigger:function(t){var i=g[t.type];if(i){var n=t.target,s=Object.keys(i);do for(var o,r=" "+n.className+" ",a=0;o=s[a++];)if(-1!==r.indexOf(" "+o+" ")){var c=!1;if(i[o].fns.forEach(function(i){i.fn.call(e(n),t)===!1&&(c=!0)}),c&&t.preventDefault(),c||t.isPropagationStopped())return;s.splice(--a,1)}while(s.length&&(n=n.parentNode))}},_buildLiveEventFn:function(t,i){var n=this;return function(o){var r=[n._name,((o.data||(o.data={})).domElem=e(this)).closest(n.buildSelector()),!0],a=s.apply(null,i?r.concat([t,o]):r);return a&&!i&&t?t.apply(a,arguments):void 0}},liveInitOnEvent:function(t,e,i){return this.liveBindTo(t,e,i,!0)},liveBindTo:function(t,n,s,o){(!n||e.isFunction(n))&&(s=n,n=t,t=i),t&&"string"!=typeof t||(t={elem:t}),t.elemName&&(t.elem=t.elemName);var r=this;return t.elem&&t.elem.indexOf(" ")>0?(t.elem.split(" ").forEach(function(e){r._liveClassBind(E(r._name,e,t.modName,t.modVal),n,s,o)}),r):r._liveClassBind(E(r._name,t.elem,t.modName,t.modVal),n,s,o)},liveUnbindFrom:function(t,n,s){(!n||e.isFunction(n))&&(s=n,n=t,t=i);var o=this;return t&&t.indexOf(" ")>1?(t.split(" ").forEach(function(t){o._liveClassUnbind(E(o._name,t),n,s)}),o):o._liveClassUnbind(E(o._name,t),n,s)},_liveInitOnBlockEvent:function(t,e,i,n){var s=this._name;return b[e].on(t,function(t){if(t.block.domElem){var e=arguments,o=t.block[n](s);i&&o.forEach(function(t){i.apply(t,e)})}}),this},liveInitOnBlockEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOn")},liveInitOnBlockInsideEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOutside")},on:function(t,e,i,n,s){return t.jquery?this._liveCtxBind(t,e,i,n,s):this.__base(t,e,i,n)},un:function(t,e,i,n){return t.jquery?this._liveCtxUnbind(t,e,i,n):this.__base(t,e,i)},liveCtxBind:function(t,e,i,n,s){return this._liveCtxBind(t,e,i,n,s)},_liveCtxBind:function(t,n,s,o,r){var a=this;if("string"==typeof n)if(e.isFunction(s)&&(r=o,o=s,s=i),n.indexOf(" ")>-1)n.split(" ").forEach(function(e){a._liveCtxBind(t,e,s,o,r)});else{var c=a._buildCtxEventName(n),h=_[c]||(_[c]={counter:0,ctxs:{}});t.each(function(){var t=e.identify(this),i=h.ctxs[t];i||(i=h.ctxs[t]={},++h.counter),i[e.identify(o)+(r?e.identify(r):"")]={fn:o,data:s,ctx:r}})}else e.each(n,function(e,i){a._liveCtxBind(t,e,i,s)});return a},liveCtxUnbind:function(t,e,i,n){return this._liveCtxUnbind(t,e,i,n)},_liveCtxUnbind:function(t,i,n,s){var o=this,r=_[i=o._buildCtxEventName(i)];return r&&(t.each(function(){var t,i=e.identify(this,!0);i&&(t=r.ctxs[i])&&(n&&delete t[e.identify(n)+(s?e.identify(s):"")],(!n||e.isEmptyObject(t))&&(r.counter--,delete r.ctxs[i]))}),r.counter||delete _[i]),o},_extractElemNameFrom:function(t){if(t.__bemElemName)return t.__bemElemName;var e=t[0].className.match(this._buildElemNameRE());return e?e[1]:i},extractParams:c,_buildModClassPrefix:function(t,e){return E(this._name)+(e?M+("string"==typeof e?e:this._extractElemNameFrom(e)):"")+k+t+k},_buildModValRE:function(t,e,i){return new RegExp("(\\s|^)"+this._buildModClassPrefix(t,e)+"("+y+")(?=\\s|$)",i)},_buildElemNameRE:function(){return new RegExp(this._name+M+"("+y+")(?:\\s|$)")},buildSelector:function(t,e,i){return"."+E(this._name,t,e,i)},getBlockByUniqId:function(t){return f[t]},getWindowSize:function(){return{width:l.width(),height:l.height()}}});e(function(){t.DOM.scope=e("body")})}(BEM,jQuery),BEM.decl("i-bem__dom",{},{liveInitOnBlockInit:function(t,e){return this.liveInitOnBlockEvent("init",t,e)}}),$(function(){BEM.afterCurrentEvent(function(){BEM.DOM.init()})}),jQuery.cookie=function(t,e,i){if("undefined"==typeof e){var n=null;if(document.cookie&&""!=document.cookie)for(var s=document.cookie.split(";"),o=0;o<s.length;o++){var r=jQuery.trim(s[o]);if(r.substring(0,t.length+1)==t+"="){n=decodeURIComponent(r.substring(t.length+1));break}}return n}i=i||{},null===e&&(e="",i.expires=-1);var a="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var c;"number"==typeof i.expires?(c=new Date,c.setTime(c.getTime()+24*i.expires*60*60*1e3)):c=i.expires,a="; expires="+c.toUTCString()}var h=i.path?"; path="+i.path:"",u=i.domain?"; domain="+i.domain:"",l=i.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),a,h,u,l].join("")},function(t){function e(t){return t.replace(/%.{2}/g,function(t){return n[t]||t})}function i(t,i){var n="";try{n=t(i)}catch(s){try{n=t(e(i))}catch(o){n=i}}return n}var n={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};t.extend({decodeURI:function(t){return i(decodeURI,t)},decodeURIComponent:function(t){return i(decodeURIComponent,t)}})}(jQuery),function(t){function e(t){return t.replace(/%[0-9a-f]{2}/gi,function(t){return n[t]||t})}function i(t,i){var n=i;try{n=t(i)}catch(s){try{n=t(e(i))}catch(s){}}return n}var n={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};t.extend({decodeURI:function(t){return i(decodeURI,t)},decodeURIComponent:function(t){return i(decodeURIComponent,t)}})}(jQuery),function(){function t(t,e){if(t!==e){var i=null===t,n=t===ln,s=t===t,o=null===e,r=e===ln,a=e===e;if(t>e&&!o||!s||i&&!r&&a||n&&a)return 1;if(e>t&&!i||!a||o&&!n&&s||r&&s)return-1}return 0}function e(t,e,i){for(var n=t.length,s=i?n:-1;i?s--:++s<n;)if(e(t[s],s,t))return s;return-1}function i(t,e,i){if(e!==e)return h(t,i);for(var n=i-1,s=t.length;++n<s;)if(t[n]===e)return n;return-1}function n(t){return"function"==typeof t||!1}function s(t){return"string"==typeof t?t:null==t?"":t+""}function o(t,e){for(var i=-1,n=t.length;++i<n&&e.indexOf(t.charAt(i))>-1;);return i}function r(t,e){for(var i=t.length;i--&&e.indexOf(t.charAt(i))>-1;);return i}function a(e,i){return t(e.criteria,i.criteria)||e.index-i.index}function c(t){return gs[t]}function h(t,e,i){for(var n=t.length,s=e+(i?0:-1);i?s--:++s<n;){var o=t[s];if(o!==o)return s}return-1}function u(t){return!!t&&"object"==typeof t}function l(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function d(t,e){for(var i=-1,n=t.length,s=-1,o=[];++i<n;)t[i]===e&&(t[i]=Pn,o[++s]=i);return o}function p(t,e){for(var i,n=-1,s=t.length,o=-1,r=[];++n<s;){var a=t[n],c=e?e(a,n,t):a;n&&i===c||(i=c,r[++o]=a)}return r}function f(t){for(var e=-1,i=t.length;++e<i&&l(t.charCodeAt(e)););return e}function m(t){for(var e=t.length;e--&&l(t.charCodeAt(e)););return e}function _(t){return bs[t]}function g(t){if(u(t)&&!To(t)&&!(t instanceof y)){if(t instanceof v)return t;if(Os.call(t,"__chain__")&&Os.call(t,"__wrapped__"))return oi(t)}return new v(t)}function b(){}function v(t,e,i){this.__wrapped__=t,this.__actions__=i||[],this.__chain__=!!e}function y(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=io,this.__views__=null}function k(){var t=this.__actions__,e=this.__iteratees__,i=this.__views__,n=new y(this.__wrapped__);return n.__actions__=t?T(t):null,n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=e?T(e):null,n.__takeCount__=this.__takeCount__,n.__views__=i?T(i):null,n}function M(){if(this.__filtered__){var t=new y(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function w(){var t=this.__wrapped__.value();if(!To(t))return _e(t,this.__actions__);var e=this.__dir__,i=0>e,n=qe(0,t.length,this.__views__),s=n.start,o=n.end,r=o-s,a=i?o:s-1,c=Zs(r,this.__takeCount__),h=this.__iteratees__,u=h?h.length:0,l=0,d=[];t:for(;r--&&c>l;){a+=e;for(var p=-1,f=t[a];++p<u;){var m=h[p],_=m.iteratee,g=m.type;if(g==Bn){if(m.done&&(i?a>m.index:a<m.index)&&(m.count=0,m.done=!1),m.index=a,!m.done){var b=m.limit;if(!(m.done=b>-1?m.count++>=b:!_(f)))continue t}}else{var v=_(f);if(g==Sn)f=v;else if(!v){if(g==xn)continue t;break t}}}d[l++]=f}return d}function E(){this.__data__={}}function B(t){return this.has(t)&&delete this.__data__[t]}function x(t){return"__proto__"==t?ln:this.__data__[t]}function S(t){return"__proto__"!=t&&Os.call(this.__data__,t)}function I(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function P(t){var e=t?t.length:0;for(this.data={hash:Gs(null),set:new Hs};e--;)this.push(t[e])}function C(t,e){var i=t.data,n="string"==typeof e||Fi(e)?i.set.has(e):i.hash[e];return n?0:-1}function D(t){var e=this.data;"string"==typeof t||Fi(t)?e.set.add(t):e.hash[t]=!0}function T(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}function O(t,e){for(var i=-1,n=t.length;++i<n&&e(t[i],i,t)!==!1;);return t}function F(t,e){for(var i=-1,n=t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function A(t,e){for(var i=-1,n=t.length,s=-1,o=[];++i<n;){var r=t[i];e(r,i,t)&&(o[++s]=r)}return o}function N(t,e){for(var i=-1,n=t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}function R(t,e,i,n){var s=-1,o=t.length;for(n&&o&&(i=t[++s]);++s<o;)i=e(i,t[s],s,t);return i}function L(t,e){for(var i=-1,n=t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function j(t,e){return t===ln?e:t}function z(t,e,i){for(var n=-1,s=jo(e),o=s.length;++n<o;){var r=s[n],a=t[r],c=i(a,e[r],r,t,e);(c===c?c===a:a!==a)&&(a!==ln||r in t)||(t[r]=c)}return t}function q(t,e){return null==e?t:U(e,jo(e),t)}function U(t,e,i){i||(i={});for(var n=-1,s=e.length;++n<s;){var o=e[n];i[o]=t[o]}return i}function H(t,e,i){var n=typeof t;return"function"==n?e===ln?t:ve(t,e,i):null==t?sn:"object"==n?oe(t):e===ln?cn(t):re(t,e)}function $(t,e,i,n,s,o,r){var a;if(i&&(a=s?i(t,n,s):i(t)),a!==ln)return a;if(!Fi(t))return t;var c=To(t);if(c){if(a=Ue(t),!e)return T(t,a)}else{var h=Fs.call(t),u=h==An;if(h!=Ln&&h!=Cn&&(!u||s))return _s[h]?$e(t,h,e):s?t:{};if(Ss(t))return s?t:{};if(a=He(u?{}:t),!e)return q(a,t)}o||(o=[]),r||(r=[]);for(var l=o.length;l--;)if(o[l]==t)return r[l];return o.push(t),r.push(a),(c?O:X)(t,function(n,s){a[s]=$(n,e,i,s,t,o,r)}),a}function V(t,e){var n=t?t.length:0,s=[];if(!n)return s;var o=-1,r=Le(),a=r==i,c=a&&e.length>=200?yo(e):null,h=e.length;c&&(r=C,a=!1,e=c);t:for(;++o<n;){var u=t[o];if(a&&u===u){for(var l=h;l--;)if(e[l]===u)continue t;s.push(u)}else r(e,u,0)<0&&s.push(u)}return s}function W(t,e){var i=!0;return mo(t,function(t,n,s){return i=!!e(t,n,s)}),i}function K(t,e){var i=[];return mo(t,function(t,n,s){e(t,n,s)&&i.push(t)}),i}function G(t,e,i,n){var s;return i(t,function(t,i,o){return e(t,i,o)?(s=n?i:t,!1):void 0}),s}function Y(t,e,i){for(var n=-1,s=t.length,o=-1,r=[];++n<s;){var a=t[n];if(u(a)&&Ve(a)&&(i||To(a)||Ti(a))){e&&(a=Y(a,e,i));for(var c=-1,h=a.length;++c<h;)r[++o]=a[c]}else i||(r[++o]=a)}return r}function Q(t,e){return go(t,e,Vi)}function X(t,e){return go(t,e,jo)}function J(t,e){return bo(t,e,jo)}function Z(t,e){for(var i=-1,n=e.length,s=-1,o=[];++i<n;){var r=e[i];Oo(t[r])&&(o[++s]=r)}return o}function te(t,e,i){if(null!=t){t=ni(t),i!==ln&&i in t&&(e=[i]);for(var n=0,s=e.length;null!=t&&s>n;)t=ni(t)[e[n++]];return n&&n==s?t:ln}}function ee(t,e,i,n,s,o){return t===e?!0:null==t||null==e||!Fi(t)&&!u(e)?t!==t&&e!==e:ie(t,e,ee,i,n,s,o)}function ie(t,e,i,n,s,o,r){var a=To(t),c=To(e),h=Dn,u=Dn;a||(h=Fs.call(t),h==Cn?h=Ln:h!=Ln&&(a=ji(t))),c||(u=Fs.call(e),u==Cn?u=Ln:u!=Ln&&(c=ji(e)));var l=h==Ln&&!Ss(t),d=u==Ln&&!Ss(e),p=h==u;if(p&&!a&&!l)return Fe(t,e,h);if(!s){var f=l&&Os.call(t,"__wrapped__"),m=d&&Os.call(e,"__wrapped__");if(f||m)return i(f?t.value():t,m?e.value():e,n,s,o,r)}if(!p)return!1;o||(o=[]),r||(r=[]);for(var _=o.length;_--;)if(o[_]==t)return r[_]==e;o.push(t),r.push(e);var g=(a?Oe:Ae)(t,e,i,n,s,o,r);return o.pop(),r.pop(),g}function ne(t,e,i){var n=e.length,s=n,o=!i;if(null==t)return!s;for(t=ni(t);n--;){var r=e[n];if(o&&r[2]?r[1]!==t[r[0]]:!(r[0]in t))return!1}for(;++n<s;){r=e[n];var a=r[0],c=t[a],h=r[1];if(o&&r[2]){if(c===ln&&!(a in t))return!1}else{var u=i?i(c,h,a):ln;if(!(u===ln?ee(h,c,i,!0):u))return!1}}return!0}function se(t,e){var i=-1,n=Ve(t)?Array(t.length):[];return mo(t,function(t,s,o){n[++i]=e(t,s,o)}),n}function oe(t){var e=je(t);if(1==e.length&&e[0][2]){var i=e[0][0],n=e[0][1];return function(t){return null==t?!1:(t=ni(t),t[i]===n&&(n!==ln||i in t))}}return function(t){return ne(t,e)}}function re(t,e){var i=To(t),n=Ge(t)&&Xe(e),s=t+"";return t=si(t),function(o){if(null==o)return!1;var r=s;if(o=ni(o),!(!i&&n||r in o)){if(o=1==t.length?o:te(o,de(t,0,-1)),null==o)return!1;r=hi(t),o=ni(o)}return o[r]===e?e!==ln||r in o:ee(e,o[r],ln,!0)}}function ae(t,e,i,n,s){if(!Fi(t))return t;var o=Ve(e)&&(To(e)||ji(e)),r=o?null:jo(e);return O(r||e,function(a,c){if(r&&(c=a,a=e[c]),u(a))n||(n=[]),s||(s=[]),ce(t,e,c,ae,i,n,s);else{var h=t[c],l=i?i(h,a,c,t,e):ln,d=l===ln;d&&(l=a),l===ln&&(!o||c in t)||!d&&(l===l?l===h:h!==h)||(t[c]=l)}}),t}function ce(t,e,i,n,s,o,r){for(var a=o.length,c=e[i];a--;)if(o[a]==c)return void(t[i]=r[a]);
var h=t[i],u=s?s(h,c,i,t,e):ln,l=u===ln;l&&(u=c,Ve(c)&&(To(c)||ji(c))?u=To(h)?h:Ve(h)?T(h):[]:Fo(c)||Ti(c)?u=Ti(h)?qi(h):Fo(h)?h:{}:l=!1),o.push(c),r.push(u),l?t[i]=n(u,c,s,o,r):(u===u?u!==h:h===h)&&(t[i]=u)}function he(t){return function(e){return null==e?ln:ni(e)[t]}}function ue(t){var e=t+"";return t=si(t),function(i){return te(i,t,e)}}function le(t,e,i,n,s){return s(t,function(t,s,o){i=n?(n=!1,t):e(i,t,s,o)}),i}function de(t,e,i){var n=-1,s=t.length;e=null==e?0:+e||0,0>e&&(e=-e>s?0:s+e),i=i===ln||i>s?s:+i||0,0>i&&(i+=s),s=e>i?0:i-e>>>0,e>>>=0;for(var o=Array(s);++n<s;)o[n]=t[n+e];return o}function pe(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}function fe(t,e){var n=-1,s=Le(),o=t.length,r=s==i,a=r&&o>=200,c=a?yo():null,h=[];c?(s=C,r=!1):(a=!1,c=e?[]:h);t:for(;++n<o;){var u=t[n],l=e?e(u,n,t):u;if(r&&u===u){for(var d=c.length;d--;)if(c[d]===l)continue t;e&&c.push(l),h.push(u)}else s(c,l,0)<0&&((e||a)&&c.push(l),h.push(u))}return h}function me(t,e){for(var i=-1,n=e.length,s=Array(n);++i<n;)s[i]=t[e[i]];return s}function _e(t,e){var i=t;i instanceof y&&(i=i.value());for(var n=-1,s=e.length;++n<s;){var o=[i],r=e[n];qs.apply(o,r.args),i=r.func.apply(r.thisArg,o)}return i}function ge(t,e,i){var n=0,s=t?t.length:n;if("number"==typeof e&&e===e&&oo>=s){for(;s>n;){var o=n+s>>>1,r=t[o];(i?e>=r:e>r)&&null!==r?n=o+1:s=o}return s}return be(t,e,sn,i)}function be(t,e,i,n){e=i(e);for(var s=0,o=t?t.length:0,r=e!==e,a=null===e,c=e===ln;o>s;){var h=js((s+o)/2),u=i(t[h]),l=u!==ln,d=u===u;if(r)var p=d||n;else p=a?d&&l&&(n||null!=u):c?d&&(n||l):null==u?!1:n?e>=u:e>u;p?s=h+1:o=h}return Zs(o,so)}function ve(t,e,i){if("function"!=typeof t)return sn;if(e===ln)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,s){return t.call(e,i,n,s)};case 4:return function(i,n,s,o){return t.call(e,i,n,s,o)};case 5:return function(i,n,s,o,r){return t.call(e,i,n,s,o,r)}}return function(){return t.apply(e,arguments)}}function ye(t){return Rs.call(t,0)}function ke(t,e,i){for(var n=i.length,s=-1,o=Js(t.length-n,0),r=-1,a=e.length,c=Array(o+a);++r<a;)c[r]=e[r];for(;++s<n;)c[i[s]]=t[s];for(;o--;)c[r++]=t[s++];return c}function Me(t,e,i){for(var n=-1,s=i.length,o=-1,r=Js(t.length-s,0),a=-1,c=e.length,h=Array(r+c);++o<r;)h[o]=t[o];for(var u=o;++a<c;)h[u+a]=e[a];for(;++n<s;)h[u+i[n]]=t[o++];return h}function we(t){return Pi(function(e,i){var n=-1,s=null==e?0:i.length,o=s>2?i[s-2]:ln,r=s>2?i[2]:ln,a=s>1?i[s-1]:ln;for("function"==typeof o?(o=ve(o,a,5),s-=2):(o="function"==typeof a?a:ln,s-=o?1:0),r&&Ke(i[0],i[1],r)&&(o=3>s?ln:o,s=1);++n<s;){var c=i[n];c&&t(e,c,o)}return e})}function Ee(t,e){return function(i,n){var s=i?Mo(i):0;if(!Qe(s))return t(i,n);for(var o=e?s:-1,r=ni(i);(e?o--:++o<s)&&n(r[o],o,r)!==!1;);return i}}function Be(t){return function(e,i,n){for(var s=ni(e),o=n(e),r=o.length,a=t?r:-1;t?a--:++a<r;){var c=o[a];if(i(s[c],c,s)===!1)break}return e}}function xe(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4])}var i=fo(t.prototype),n=t.apply(i,e);return Fi(n)?n:i}}function Se(t,i){return function(n,s,o){if(s=Ne(s,o,3),To(n)){var r=e(n,s,i);return r>-1?n[r]:ln}return G(n,s,t)}}function Ie(t){return function(e,i,n){return i=Ne(i,n,3),G(e,i,t,!0)}}function Pe(t,e){return function(i,n,s){return"function"==typeof n&&s===ln&&To(i)?t(i,n):e(i,ve(n,s,3))}}function Ce(t){return function(e,i,n){return("function"!=typeof i||n!==ln)&&(i=ve(i,n,3)),t(e,i)}}function De(t,e){return function(i,n,s,o){var r=arguments.length<3;return"function"==typeof n&&o===ln&&To(i)?t(i,n,s,r):le(i,Ne(n,o,4),s,r,e)}}function Te(t,e,i,n,s,o,r,a,c,h){function u(){for(var v=arguments.length,y=v,k=Array(v);y--;)k[y]=arguments[y];if(n&&(k=ke(k,n,s)),o&&(k=Me(k,o,r)),m||g){var M=u.placeholder,w=d(k,M);if(v-=w.length,h>v){var E=a?T(a):null,B=Js(h-v,0),x=m?w:null,S=m?null:w,I=m?k:null,P=m?null:k;e|=m?bn:vn,e&=~(m?vn:bn),_||(e&=~(pn|fn));var C=[t,e,i,I,x,P,S,E,c,B],D=Te.apply(ln,C);return Ye(t)&&wo(D,C),D.placeholder=M,D}}var O=p?i:this,F=f?O[t]:t;return a&&(k=ti(k,a)),l&&c<k.length&&(k.length=c),this&&this!==xs&&this instanceof u&&(F=b||xe(t)),F.apply(O,k)}var l=e&yn,p=e&pn,f=e&fn,m=e&_n,_=e&mn,g=e&gn,b=f?null:xe(t);return u}function Oe(t,e,i,n,s,o,r){var a=-1,c=t.length,h=e.length;if(c!=h&&!(s&&h>c))return!1;for(;++a<c;){var u=t[a],l=e[a],d=n?n(s?l:u,s?u:l,a):ln;if(d!==ln){if(d)continue;return!1}if(s){if(!L(e,function(t){return u===t||i(u,t,n,s,o,r)}))return!1}else if(u!==l&&!i(u,l,n,s,o,r))return!1}return!0}function Fe(t,e,i){switch(i){case Tn:case On:return+t==+e;case Fn:return t.name==e.name&&t.message==e.message;case Rn:return t!=+t?e!=+e:t==+e;case jn:case qn:return t==e+""}return!1}function Ae(t,e,i,n,s,o,r){var a=jo(t),c=a.length,h=jo(e),u=h.length;if(c!=u&&!s)return!1;for(var l=c;l--;){var d=a[l];if(!(s?d in e:Os.call(e,d)))return!1}for(var p=s;++l<c;){d=a[l];var f=t[d],m=e[d],_=n?n(s?m:f,s?f:m,d):ln;if(!(_===ln?i(f,m,n,s,o,r):_))return!1;p||(p="constructor"==d)}if(!p){var g=t.constructor,b=e.constructor;if(g!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b))return!1}return!0}function Ne(t,e,i){var n=g.callback||en;return n=n===en?H:n,i?n(t,e,i):n}function Re(t){for(var e=t.name,i=ho[e],n=i?i.length:0;n--;){var s=i[n],o=s.func;if(null==o||o==t)return s.name}return e}function Le(t,e,n){var s=g.indexOf||ci;return s=s===ci?i:s,t?s(t,e,n):s}function je(t){for(var e=Wi(t),i=e.length;i--;)e[i][2]=Xe(e[i][1]);return e}function ze(t,e){var i=null==t?ln:t[e];return Ai(i)?i:ln}function qe(t,e,i){for(var n=-1,s=i?i.length:0;++n<s;){var o=i[n],r=o.size;switch(o.type){case"drop":t+=r;break;case"dropRight":e-=r;break;case"take":e=Zs(e,t+r);break;case"takeRight":t=Js(t,e-r)}}return{start:t,end:e}}function Ue(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&Os.call(t,"index")&&(i.index=t.index,i.input=t.input),i}function He(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Object),new e}function $e(t,e,i){var n=t.constructor;switch(e){case Hn:return ye(t);case Tn:case On:return new n(+t);case $n:case Vn:case Wn:case Kn:case Gn:case Yn:case Qn:case Xn:case Jn:n instanceof n&&(n=uo[e]);var s=t.buffer;return new n(i?ye(s):s,t.byteOffset,t.length);case Rn:case qn:return new n(t);case jn:var o=new n(t.source,hs.exec(t));o.lastIndex=t.lastIndex}return o}function Ve(t){return null!=t&&Qe(Mo(t))}function We(t,e){return t="number"==typeof t||ds.test(t)?+t:-1,e=null==e?ao:e,t>-1&&t%1==0&&e>t}function Ke(t,e,i){if(!Fi(i))return!1;var n=typeof e;if("number"==n?Ve(i)&&We(e,i.length):"string"==n&&e in i){var s=i[e];return t===t?t===s:s!==s}return!1}function Ge(t,e){var i=typeof t;if("string"==i&&ss.test(t)||"number"==i)return!0;if(To(t))return!1;var n=!ns.test(t);return n||null!=e&&t in ni(e)}function Ye(t){var e=Re(t);if(!(e in y.prototype))return!1;var i=g[e];if(t===i)return!0;var n=ko(i);return!!n&&t===n[0]}function Qe(t){return"number"==typeof t&&t>-1&&t%1==0&&ao>=t}function Xe(t){return t===t&&!Fi(t)}function Je(t,e){t=ni(t);for(var i=-1,n=e.length,s={};++i<n;){var o=e[i];o in t&&(s[o]=t[o])}return s}function Ze(t,e){var i={};return Q(t,function(t,n,s){e(t,n,s)&&(i[n]=t)}),i}function ti(t,e){for(var i=t.length,n=Zs(e.length,i),s=T(t);n--;){var o=e[n];t[n]=We(o,i)?s[o]:ln}return t}function ei(t){var e,i=g.support;if(!u(t)||Fs.call(t)!=Ln||Ss(t)||!Os.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e))||!i.argsTag&&Ti(t))return!1;var n;return i.ownLast?(Q(t,function(t,e,i){return n=Os.call(i,e),!1}),n!==!1):(Q(t,function(t,e){n=e}),n===ln||Os.call(t,n))}function ii(t){for(var e=Vi(t),i=e.length,n=i&&t.length,s=!!n&&Qe(n)&&(To(t)||Ti(t)||Li(t)),o=-1,r=[];++o<i;){var a=e[o];(s&&We(a,n)||Os.call(t,a))&&r.push(a)}return r}function ni(t){if(g.support.unindexedChars&&Li(t)){for(var e=-1,i=t.length,n=Object(t);++e<i;)n[e]=t.charAt(e);return n}return Fi(t)?t:Object(t)}function si(t){if(To(t))return t;var e=[];return s(t).replace(os,function(t,i,n,s){e.push(n?s.replace(cs,"$1"):i||t)}),e}function oi(t){return t instanceof y?t.clone():new v(t.__wrapped__,t.__chain__,T(t.__actions__))}function ri(t){for(var e=-1,i=t?t.length:0,n=-1,s=[];++e<i;){var o=t[e];o&&(s[++n]=o)}return s}function ai(t,e,i){var n=t?t.length:0;return i&&Ke(t,e,i)&&(e=!1),n?Y(t,e):[]}function ci(t,e,n){var s=t?t.length:0;if(!s)return-1;if("number"==typeof n)n=0>n?Js(s+n,0):n;else if(n){var o=ge(t,e),r=t[o];return(e===e?e===r:r!==r)?o:-1}return i(t,e,n||0)}function hi(t){var e=t?t.length:0;return e?t[e-1]:ln}function ui(t,e,i){var n=t?t.length:0;return n?((i?Ke(t,e,i):null==e)&&(e=1),de(t,0,0>e?0:e)):[]}function li(t,e,n,s){var o=t?t.length:0;if(!o)return[];null!=e&&"boolean"!=typeof e&&(s=n,n=Ke(t,e,s)?null:e,e=!1);var r=Ne();return(null!=n||r!==H)&&(n=r(n,s,3)),e&&Le()==i?p(t,n):fe(t,n)}function di(t){var e=g(t);return e.__chain__=!0,e}function pi(t,e,i){return e.call(i,t),t}function fi(t,e,i){return e.call(i,t)}function mi(){return di(this)}function _i(){return new v(this.value(),this.__chain__)}function gi(t){for(var e,i=this;i instanceof b;){var n=oi(i);e?s.__wrapped__=n:e=n;var s=n;i=i.__wrapped__}return s.__wrapped__=t,e}function bi(){var t=this.__wrapped__;return t instanceof y?(this.__actions__.length&&(t=new y(this)),new v(t.reverse(),this.__chain__)):this.thru(function(t){return t.reverse()})}function vi(){return this.value()+""}function yi(){return _e(this.__wrapped__,this.__actions__)}function ki(t,e,i){var n=To(t)?F:W;return i&&Ke(t,e,i)&&(e=null),("function"!=typeof e||i!==ln)&&(e=Ne(e,i,3)),n(t,e)}function Mi(t,e,i){var n=To(t)?A:K;return e=Ne(e,i,3),n(t,e)}function wi(t,e,i,n){var s=t?Mo(t):0;return Qe(s)||(t=Gi(t),s=t.length),s?(i="number"!=typeof i||n&&Ke(e,i,n)?0:0>i?Js(s+i,0):i||0,"string"==typeof t||!To(t)&&Li(t)?s>i&&t.indexOf(e,i)>-1:Le(t,e,i)>-1):!1}function Ei(t,e,i){var n=To(t)?N:se;return e=Ne(e,i,3),n(t,e)}function Bi(t,e){return Ei(t,cn(e))}function xi(t){var e=t?Mo(t):0;return Qe(e)?e:jo(t).length}function Si(t,e,i){if(null==t)return[];i&&Ke(t,e,i)&&(e=null);var n=-1;e=Ne(e,i,3);var s=se(t,function(t,i,s){return{criteria:e(t,i,s),index:++n,value:t}});return pe(s,a)}function Ii(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(In);var i=function(){var n=arguments,s=e?e.apply(this,n):n[0],o=i.cache;if(o.has(s))return o.get(s);var r=t.apply(this,n);return i.cache=o.set(s,r),r};return i.cache=new Ii.Cache,i}function Pi(t,e){if("function"!=typeof t)throw new TypeError(In);return e=Js(e===ln?t.length-1:+e||0,0),function(){for(var i=arguments,n=-1,s=Js(i.length-e,0),o=Array(s);++n<s;)o[n]=i[e+n];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,i[0],o);case 2:return t.call(this,i[0],i[1],o)}var r=Array(e+1);for(n=-1;++n<e;)r[n]=i[n];return r[e]=o,t.apply(this,r)}}function Ci(t,e,i,n){return e&&"boolean"!=typeof e&&Ke(t,e,i)?e=!1:"function"==typeof e&&(n=i,i=e,e=!1),"function"==typeof i?$(t,e,ve(i,n,1)):$(t,e)}function Di(t,e,i){return"function"==typeof e?$(t,!0,ve(e,i,1)):$(t,!0)}function Ti(t){return u(t)&&Ve(t)&&Fs.call(t)==Cn}function Oi(t){return null==t?!0:Ve(t)&&(To(t)||Li(t)||Ti(t)||u(t)&&Oo(t.splice))?!t.length:!jo(t).length}function Fi(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Ai(t){return null==t?!1:Fs.call(t)==An?As.test(Ts.call(t)):u(t)&&(Ss(t)?As:ls).test(t)}function Ni(t){return"number"==typeof t||u(t)&&Fs.call(t)==Rn}function Ri(t){return Fi(t)&&Fs.call(t)==jn}function Li(t){return"string"==typeof t||u(t)&&Fs.call(t)==qn}function ji(t){return u(t)&&Qe(t.length)&&!!ms[Fs.call(t)]}function zi(t){return t===ln}function qi(t){return U(t,Vi(t))}function Ui(t,e,i){var n=null==t?ln:te(t,si(e),e+"");return n===ln?i:n}function Hi(t,e){if(null==t)return!1;var i=Os.call(t,e);if(!i&&!Ge(e)){if(e=si(e),t=1==e.length?t:te(t,de(e,0,-1)),null==t)return!1;e=hi(e),i=Os.call(t,e)}return i||Qe(t.length)&&We(e,t.length)&&(To(t)||Ti(t)||Li(t))}function $i(t,e,i){i&&Ke(t,e,i)&&(e=null);for(var n=-1,s=jo(t),o=s.length,r={};++n<o;){var a=s[n],c=t[a];e?Os.call(r,c)?r[c].push(a):r[c]=[a]:r[c]=a}return r}function Vi(t){if(null==t)return[];Fi(t)||(t=Object(t));var e=t.length,i=g.support;e=e&&Qe(e)&&(To(t)||Ti(t)||Li(t))&&e||0;for(var n=t.constructor,s=-1,o=Oo(n)&&n.prototype||Cs,r=o===t,a=Array(e),c=e>0,h=i.enumErrorProps&&(t===Ps||t instanceof Error),u=i.enumPrototypes&&Oo(t);++s<e;)a[s]=s+"";for(var l in t)u&&"prototype"==l||h&&("message"==l||"name"==l)||c&&We(l,e)||"constructor"==l&&(r||!Os.call(t,l))||a.push(l);if(i.nonEnumShadows&&t!==Cs){var d=t===Ds?qn:t===Ps?Fn:Fs.call(t),p=lo[d]||lo[Ln];for(d==Ln&&(o=Cs),e=fs.length;e--;){l=fs[e];var f=p[l];r&&f||(f?!Os.call(t,l):t[l]===o[l])||a.push(l)}}return a}function Wi(t){t=ni(t);for(var e=-1,i=jo(t),n=i.length,s=Array(n);++e<n;){var o=i[e];s[e]=[o,t[o]]}return s}function Ki(t,e,i,n){var s=To(t)||ji(t);if(e=Ne(e,n,4),null==i)if(s||Fi(t)){var o=t.constructor;i=s?To(t)?new o:[]:fo(Oo(o)?o.prototype:null)}else i={};return(s?O:X)(t,function(t,n,s){return e(i,t,n,s)}),i}function Gi(t){return me(t,jo(t))}function Yi(t){return t=s(t),t&&is.test(t)?t.replace(ts,c):t}function Qi(t){return t=s(t),t&&as.test(t)?t.replace(rs,"\\$&"):t}function Xi(t,e,i){return i&&Ke(t,e,i)&&(e=0),eo(t,e)}function Ji(t,e,i){var n=t;return(t=s(t))?(i?Ke(n,e,i):null==e)?t.slice(f(t),m(t)+1):(e+="",t.slice(o(t,e),r(t,e)+1)):t}function Zi(t,e,i){i&&Ke(t,e,i)&&(e=null);var n=kn,o=Mn;if(null!=e)if(Fi(e)){var r="separator"in e?e.separator:r;n="length"in e?+e.length||0:n,o="omission"in e?s(e.omission):o}else n=+e||0;if(t=s(t),n>=t.length)return t;var a=n-o.length;if(1>a)return o;var c=t.slice(0,a);if(null==r)return c+o;if(Ri(r)){if(t.slice(a).search(r)){var h,u,l=t.slice(0,a);for(r.global||(r=RegExp(r.source,(hs.exec(r)||"")+"g")),r.lastIndex=0;h=r.exec(l);)u=h.index;c=c.slice(0,null==u?a:u)}}else if(t.indexOf(r,a)!=a){var d=c.lastIndexOf(r);d>-1&&(c=c.slice(0,d))}return c+o}function tn(t){return t=s(t),t&&es.test(t)?t.replace(Zn,_):t}function en(t,e,i){return i&&Ke(t,e,i)&&(e=null),u(t)?on(t):H(t,e)}function nn(t){return function(){return t}}function sn(t){return t}function on(t){return oe($(t,!0))}function rn(t,e,i){if(null==i){var n=Fi(e),s=n?jo(e):null,o=s&&s.length?Z(e,s):null;(o?o.length:n)||(o=!1,i=e,e=t,t=this)}o||(o=Z(e,jo(e)));var r=!0,a=-1,c=Oo(t),h=o.length;i===!1?r=!1:Fi(i)&&"chain"in i&&(r=i.chain);for(;++a<h;){var u=o[a],l=e[u];t[u]=l,c&&(t.prototype[u]=function(e){return function(){var i=this.__chain__;if(r||i){var n=t(this.__wrapped__),s=n.__actions__=T(this.__actions__);return s.push({func:e,args:arguments,thisArg:t}),n.__chain__=i,n}var o=[this.value()];return qs.apply(o,arguments),e.apply(t,o)}}(l))}return t}function an(){}function cn(t){return Ge(t)?he(t):ue(t)}function hn(t,e,i){i&&Ke(t,e,i)&&(e=i=null),t=+t||0,i=null==i?1:+i||0,null==e?(e=t,t=0):e=+e||0;for(var n=-1,s=Js(Ls((e-t)/(i||1)),0),o=Array(s);++n<s;)o[n]=t,t+=i;return o}function un(t,e,i){if(t=js(t),1>t||!Qs(t))return[];var n=-1,s=Array(Zs(t,no));for(e=ve(e,i,1);++n<t;)no>n?s[n]=e(n):e(n);return s}var ln,dn="3.9.3",pn=1,fn=2,mn=4,_n=8,gn=16,bn=32,vn=64,yn=128,kn=30,Mn="...",wn=150,En=16,Bn=0,xn=1,Sn=2,In="Expected a function",Pn="__lodash_placeholder__",Cn="[object Arguments]",Dn="[object Array]",Tn="[object Boolean]",On="[object Date]",Fn="[object Error]",An="[object Function]",Nn="[object Map]",Rn="[object Number]",Ln="[object Object]",jn="[object RegExp]",zn="[object Set]",qn="[object String]",Un="[object WeakMap]",Hn="[object ArrayBuffer]",$n="[object Float32Array]",Vn="[object Float64Array]",Wn="[object Int8Array]",Kn="[object Int16Array]",Gn="[object Int32Array]",Yn="[object Uint8Array]",Qn="[object Uint8ClampedArray]",Xn="[object Uint16Array]",Jn="[object Uint32Array]",Zn=/&(?:amp|lt|gt|quot|#39|#96);/g,ts=/[&<>"'`]/g,es=RegExp(Zn.source),is=RegExp(ts.source),ns=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,ss=/^\w*$/,os=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,rs=/[.*+?^${}()|[\]\/\\]/g,as=RegExp(rs.source),cs=/\\(\\)?/g,hs=/\w*$/,us=/^0[xX]/,ls=/^\[object .+?Constructor\]$/,ds=/^\d+$/,ps=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",fs=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ms={};ms[$n]=ms[Vn]=ms[Wn]=ms[Kn]=ms[Gn]=ms[Yn]=ms[Qn]=ms[Xn]=ms[Jn]=!0,ms[Cn]=ms[Dn]=ms[Hn]=ms[Tn]=ms[On]=ms[Fn]=ms[An]=ms[Nn]=ms[Rn]=ms[Ln]=ms[jn]=ms[zn]=ms[qn]=ms[Un]=!1;var _s={};_s[Cn]=_s[Dn]=_s[Hn]=_s[Tn]=_s[On]=_s[$n]=_s[Vn]=_s[Wn]=_s[Kn]=_s[Gn]=_s[Rn]=_s[Ln]=_s[jn]=_s[qn]=_s[Yn]=_s[Qn]=_s[Xn]=_s[Jn]=!0,_s[Fn]=_s[An]=_s[Nn]=_s[zn]=_s[Un]=!1;var gs={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},bs={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},vs={"function":!0,object:!0},ys=vs[typeof exports]&&exports&&!exports.nodeType&&exports,ks=vs[typeof module]&&module&&!module.nodeType&&module,Ms=ys&&ks&&"object"==typeof global&&global&&global.Object&&global,ws=vs[typeof self]&&self&&self.Object&&self,Es=vs[typeof window]&&window&&window.Object&&window,Bs=ks&&ks.exports===ys&&ys,xs=Ms||Es!==(this&&this.window)&&Es||ws||this,Ss=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}(),Is=Array.prototype,Ps=Error.prototype,Cs=Object.prototype,Ds=String.prototype,Ts=Function.prototype.toString,Os=Cs.hasOwnProperty,Fs=Cs.toString,As=RegExp("^"+Qi(Ts.call(Os)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ns=ze(xs,"ArrayBuffer"),Rs=ze(Ns&&new Ns(0),"slice"),Ls=Math.ceil,js=Math.floor,zs=ze(Object,"getPrototypeOf"),qs=Is.push,Us=Cs.propertyIsEnumerable,Hs=ze(xs,"Set"),$s=Is.splice,Vs=ze(xs,"Uint8Array"),Ws=ze(xs,"WeakMap"),Ks=function(){try{var t=ze(xs,"Float64Array"),e=new t(new Ns(10),0,1)&&t}catch(i){}return e||null}(),Gs=ze(Object,"create"),Ys=ze(Array,"isArray"),Qs=xs.isFinite,Xs=ze(Object,"keys"),Js=Math.max,Zs=Math.min,to=ze(Date,"now"),eo=xs.parseInt,io=Number.POSITIVE_INFINITY,no=4294967295,so=no-1,oo=no>>>1,ro=Ks?Ks.BYTES_PER_ELEMENT:0,ao=9007199254740991,co=Ws&&new Ws,ho={},uo={};uo[$n]=xs.Float32Array,uo[Vn]=xs.Float64Array,uo[Wn]=xs.Int8Array,uo[Kn]=xs.Int16Array,uo[Gn]=xs.Int32Array,uo[Yn]=xs.Uint8Array,uo[Qn]=xs.Uint8ClampedArray,uo[Xn]=xs.Uint16Array,uo[Jn]=xs.Uint32Array;var lo={};lo[Dn]=lo[On]=lo[Rn]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},lo[Tn]=lo[qn]={constructor:!0,toString:!0,valueOf:!0},lo[Fn]=lo[An]=lo[jn]={constructor:!0,toString:!0},lo[Ln]={constructor:!0},O(fs,function(t){for(var e in lo)if(Os.call(lo,e)){var i=lo[e];i[t]=Os.call(i,t)}});var po=g.support={};!function(t){var e=function(){this.x=t},i={0:t,length:t},n=[];e.prototype={valueOf:t,y:t};for(var s in new e)n.push(s);po.argsTag=Fs.call(arguments)==Cn,po.enumErrorProps=Us.call(Ps,"message")||Us.call(Ps,"name"),po.enumPrototypes=Us.call(e,"prototype"),po.nonEnumShadows=!/valueOf/.test(n),po.ownLast="x"!=n[0],po.spliceObjects=($s.call(i,0,1),!i[0]),po.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1,0);var fo=function(){function t(){}return function(e){if(Fi(e)){t.prototype=e;var i=new t;t.prototype=null}return i||{}}}(),mo=Ee(X),_o=Ee(J,!0),go=Be(),bo=Be(!0),vo=co?function(t,e){return co.set(t,e),t}:sn;Rs||(ye=Ns&&Vs?function(t){var e=t.byteLength,i=Ks?js(e/ro):0,n=i*ro,s=new Ns(e);if(i){var o=new Ks(s,0,i);o.set(new Ks(t,0,i))}return e!=n&&(o=new Vs(s,n),o.set(new Vs(t,n))),s}:nn(null));var yo=Gs&&Hs?function(t){return new P(t)}:nn(null),ko=co?function(t){return co.get(t)}:an,Mo=he("length"),wo=function(){var t=0,e=0;return function(i,n){var s=Do(),o=En-(s-e);if(e=s,o>0){if(++t>=wn)return i}else t=0;return vo(i,n)}}(),Eo=Pi(function(t,e){return Ve(t)?V(t,Y(e,!1,!0)):[]}),Bo=Pi(function(t){for(var e=t.length,n=e,s=Array(l),o=Le(),r=o==i,a=[];n--;){var c=t[n]=Ve(c=t[n])?c:[];s[n]=r&&c.length>=120?yo(n&&c):null}var h=t[0],u=-1,l=h?h.length:0,d=s[0];t:for(;++u<l;)if(c=h[u],(d?C(d,c):o(a,c,0))<0){for(var n=e;--n;){var p=s[n];if((p?C(p,c):o(t[n],c,0))<0)continue t}d&&d.push(c),a.push(c)}return a}),xo=Pi(function(t,e){return Ve(t)?V(t,e):[]}),So=Se(mo),Io=Se(_o,!0),Po=Pe(O,mo),Co=De(R,mo),Do=to||function(){return(new Date).getTime()};po.argsTag||(Ti=function(t){return u(t)&&Ve(t)&&Os.call(t,"callee")&&!Us.call(t,"callee")});var To=Ys||function(t){return u(t)&&Qe(t.length)&&Fs.call(t)==Dn},Oo=n(/x/)||Vs&&!n(Vs)?function(t){return Fs.call(t)==An}:n,Fo=zs?function(t){if(!t||Fs.call(t)!=Ln||!g.support.argsTag&&Ti(t))return!1;var e=ze(t,"valueOf"),i=e&&(i=zs(e))&&zs(i);return i?t==i||zs(t)==i:ei(t)}:ei,Ao=we(function(t,e,i){return i?z(t,e,i):q(t,e)}),No=Pi(function(t){var e=t[0];return null==e?e:(t.push(j),Ao.apply(ln,t))}),Ro=Ie(X),Lo=Ce(X),jo=Xs?function(t){var e=null==t?null:t.constructor;return"function"==typeof e&&e.prototype===t||("function"==typeof t?g.support.enumPrototypes:Ve(t))?ii(t):Fi(t)?Xs(t):[]}:ii,zo=we(ae),qo=Pi(function(t,e){return null==t?{}:"function"==typeof e[0]?Ze(t,ve(e[0],e[1],3)):Je(t,Y(e))});8!=eo(ps+"08")&&(Xi=function(t,e,i){return(i?Ke(t,e,i):null==e)?e=0:e&&(e=+e),t=Ji(t),eo(t,e||(us.test(t)?16:10))}),g.prototype=b.prototype,v.prototype=fo(b.prototype),v.prototype.constructor=v,y.prototype=fo(b.prototype),y.prototype.constructor=y,E.prototype["delete"]=B,E.prototype.get=x,E.prototype.has=S,E.prototype.set=I,P.prototype.push=D,Ii.Cache=E,g.assign=Ao,g.callback=en,g.chain=di,g.compact=ri,g.constant=nn,g.defaults=No,g.difference=Eo,g.filter=Mi,g.flatten=ai,g.forEach=Po,g.forOwn=Lo,g.intersection=Bo,g.invert=$i,g.keys=jo,g.keysIn=Vi,g.map=Ei,g.matches=on,g.memoize=Ii,g.merge=zo,g.mixin=rn,g.pairs=Wi,g.pick=qo,g.pluck=Bi,g.property=cn,g.range=hn,g.restParam=Pi,g.sortBy=Si,g.take=ui,g.tap=pi,g.thru=fi,g.times=un,g.toPlainObject=qi,g.transform=Ki,g.uniq=li,g.values=Gi,g.without=xo,g.collect=Ei,g.each=Po,g.extend=Ao,g.iteratee=en,g.select=Mi,g.unique=li,rn(g,g),g.clone=Ci,g.cloneDeep=Di,g.escape=Yi,g.escapeRegExp=Qi,g.every=ki,g.find=So,g.findKey=Ro,g.findLast=Io,g.get=Ui,g.has=Hi,g.identity=sn,g.includes=wi,g.indexOf=ci,g.isArguments=Ti,g.isArray=To,g.isEmpty=Oi,g.isFunction=Oo,g.isNative=Ai,g.isNumber=Ni,g.isObject=Fi,g.isPlainObject=Fo,g.isRegExp=Ri,g.isString=Li,g.isTypedArray=ji,g.isUndefined=zi,g.last=hi,g.noop=an,g.now=Do,g.parseInt=Xi,g.reduce=Co,g.size=xi,g.trim=Ji,g.trunc=Zi,g.unescape=tn,g.all=ki,g.contains=wi,g.detect=So,g.foldl=Co,g.include=wi,g.inject=Co,rn(g,function(){var t={};return X(g,function(e,i){g.prototype[i]||(t[i]=e)}),t}(),!1),g.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return sample(e,t)}):sample(this.value())},g.VERSION=dn,O(["dropWhile","filter","map","takeWhile"],function(t,e){var i=e!=Sn,n=e==Bn;y.prototype[t]=function(t,s){var o=this.__filtered__,r=o&&n?new y(this):this.clone(),a=r.__iteratees__||(r.__iteratees__=[]);return a.push({done:!1,count:0,index:0,iteratee:Ne(t,s,1),limit:-1,type:e}),r.__filtered__=o||i,r}}),O(["drop","take"],function(t,e){var i=t+"While";y.prototype[t]=function(i){var n=this.__filtered__,s=n&&!e?this.dropWhile():this.clone();if(i=null==i?1:Js(js(i)||0,0),n)e?s.__takeCount__=Zs(s.__takeCount__,i):hi(s.__iteratees__).limit=i;else{var o=s.__views__||(s.__views__=[]);o.push({size:i,type:t+(s.__dir__<0?"Right":"")})}return s},y.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()},y.prototype[t+"RightWhile"]=function(t,e){return this.reverse()[i](t,e).reverse()}}),O(["first","last"],function(t,e){var i="take"+(e?"Right":"");y.prototype[t]=function(){return this[i](1).value()[0]}}),O(["initial","rest"],function(t,e){var i="drop"+(e?"":"Right");y.prototype[t]=function(){return this[i](1)}}),O(["pluck","where"],function(t,e){var i=e?"filter":"map",n=e?oe:cn;y.prototype[t]=function(t){return this[i](n(t))}}),y.prototype.compact=function(){return this.filter(sn)},y.prototype.reject=function(t,e){return t=Ne(t,e,1),this.filter(function(e){return!t(e)})},y.prototype.slice=function(t,e){t=null==t?0:+t||0;var i=this;return 0>t?i=this.takeRight(-t):t&&(i=this.drop(t)),e!==ln&&(e=+e||0,i=0>e?i.dropRight(-e):i.take(e-t)),i},y.prototype.toArray=function(){return this.drop(0)},X(y.prototype,function(t,e){var i=g[e];if(i){var n=/^(?:filter|map|reject)|While$/.test(e),s=/^(?:first|last)$/.test(e);g.prototype[e]=function(){var e=arguments,o=this.__chain__,r=this.__wrapped__,a=!!this.__actions__.length,c=r instanceof y,h=e[0],u=c||To(r);u&&n&&"function"==typeof h&&1!=h.length&&(c=u=!1);var l=c&&!a;if(s&&!o)return l?t.call(r):i.call(g,this.value());var d=function(t){var n=[t];return qs.apply(n,e),i.apply(g,n)};if(u){var p=l?r:new y(this),f=t.apply(p,e);if(!s&&(a||f.__actions__)){var m=f.__actions__||(f.__actions__=[]);m.push({func:fi,args:[d],thisArg:g})}return new v(f,o)}return this.thru(d)}}}),O(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var e=(/^(?:replace|split)$/.test(t)?Ds:Is)[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=!po.spliceObjects&&/^(?:pop|shift|splice)$/.test(t),s=/^(?:join|pop|replace|shift)$/.test(t),o=n?function(){var t=e.apply(this,arguments);return 0===this.length&&delete this[0],t}:e;g.prototype[t]=function(){var t=arguments;return s&&!this.__chain__?o.apply(this.value(),t):this[i](function(e){return o.apply(e,t)})}}),X(y.prototype,function(t,e){var i=g[e];if(i){var n=i.name,s=ho[n]||(ho[n]=[]);s.push({name:e,func:i})}}),ho[Te(null,fn).name]=[{name:"wrapper",func:null}],y.prototype.clone=k,y.prototype.reverse=M,y.prototype.value=w,g.prototype.chain=mi,g.prototype.commit=_i,g.prototype.plant=gi,g.prototype.reverse=bi,g.prototype.toString=vi,g.prototype.run=g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=yi,g.prototype.collect=g.prototype.map,g.prototype.head=g.prototype.first,g.prototype.select=g.prototype.filter,g.prototype.tail=g.prototype.rest,"function"==typeof define&&"object"==typeof define.amd&&define.amd?(xs._=g,define(function(){return g})):ys&&ks?Bs?(ks.exports=g)._=g:ys._=g:xs._=g}.call(this),BEM.DOM.decl("i-global",{onSetMod:{js:{inited:function(){this.del(this.__self._params=$.extend({},this.params),"uniqId","name");var t=this.__self._params;t["passport-msg"]||(t["passport-msg"]=t.id),void 0===t["show-counters"]&&(t["show-counters"]=Math.round(100*Math.random())<=t["show-counters-percent"]),t.locale=t.lang}}},getDefaultParams:function(){return{id:"",login:Lego.isSessionValid()?$.cookie("yandex_login")||"":"",yandexuid:$.cookie("yandexuid"),lang:"ru",tld:"ru",retpath:encodeURI($.decodeURI(location.href)),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100}}},{param:function(t,e){return"undefined"==typeof e?(this._params||{})[t]:void(this._params&&(this._params[t]=e))}}),BEM.DOM.decl("i-global",{},{setParams:function(t){this._params=this._params||{},$.extend(!0,this._params,t)},getBlockParams:function(t,e){var i=$(t).data("bem");return i?i[e]:!1}}),function(t){t||(t=window.Lego={}),t.getCookie=function(t){var e=document.cookie;if(e.length<1)return!1;var i=e.indexOf(t+"=");if(-1===i)return!1;i+=t.length+1;var n=e.indexOf(";",i);return decodeURIComponent(-1===n?e.substring(i):e.substring(i,n))}}(window.Lego),function(t,e){e||(e=window.Lego={}),e.init||(e.init=function(i){return(i=e.params=t.extend({id:"",login:e.isSessionValid()?e.getCookie("yandex_login")||"":"",yandexuid:e.getCookie("yandexuid"),locale:"ru",retpath:window.location.toString(),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","passport-msg":i.id,"social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100},i,e.params))["show-counters"]=Math.round(100*Math.random())<=i["show-counters-percent"],BEM.blocks["i-global"]._params||t.extend(BEM.blocks["i-global"]._params={},i),i}),e.block||(e.block={}),e.blockInit||(e.blockInit=function(i,n){i=i||document,n=n||".g-js",t(i).find(n).each(function(){var i=t(this),n=this.onclick?this.onclick():{},s=n.name||"",o=e.block[s];o&&!i.data(s)&&(o.call(i,n),i.data(s,!0).addClass(s+"_js_inited"))})}),e.blockInitBinded||(e.blockInitBinded=Boolean(t(document).ready(function(){e.blockInit()})))}(jQuery,window.Lego),function(t){t||(t=window.Lego={}),t.isSessionValid=function(){return Boolean(t.getCookie("yandex_login"))}}(window.Lego),BEM.decl("i-global__utils",{},{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",base64Encode:function(t,e){e=e||1e6;var i,n,s,o,r,a,c,h="",u=0;for(t=this._utf8_encode(t,3*e/4|0);u<t.length;)i=t.charCodeAt(u++),n=t.charCodeAt(u++),s=t.charCodeAt(u++),o=i>>2,r=(3&i)<<4|n>>4,a=(15&n)<<2|s>>6,c=63&s,isNaN(n)?a=c=64:isNaN(s)&&(c=64),h=h+this._keyStr.charAt(o)+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(c);return h},_utf8_encode:function(t,e){t=t.replace(/\r\n/g,"\n");for(var i,n="",s=0;s<t.length;s++){var o=t.charCodeAt(s);if(128>o?i=String.fromCharCode(o):o>127&&2048>o?(i=String.fromCharCode(o>>6|192),i+=String.fromCharCode(63&o|128)):(i=String.fromCharCode(o>>12|224),i+=String.fromCharCode(o>>6&63|128),i+=String.fromCharCode(63&o|128)),n.length+i.length>e)break;n+=i}return n},beginPromise:function(t){var e=$.Deferred(),i=e.resolve.bind(e);return i(t||null)}}),BEM.DOM.decl("i-global",{},{getFlag:function(t){var e=this.param("expFlags");return e||(e=this.getBlockParams(this.buildSelector(),this.getName()).expFlags||{},this.setParams({expFlags:e})),e[t]}}),BEM.blocks.utils=function(){throw new Error("This is static block")},BEM.blocks.utils.getRnd=function(t){return(new Date).getTime()+Math.floor(Math.random()*Math.pow(10,t))},function(t,e){var i=1,n=!1;if("deviceXDPI"in screen&&"logicalXDPI"in screen?i=screen.deviceXDPI/screen.logicalXDPI:"devicePixelRatio"in t&&(i=t.devicePixelRatio),"function"==typeof t.matchMedia){var s="only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 124dpi)";n=t.matchMedia(s).matches}else n=i>=1.3;var o={};/msie|trident/i.test(e)?o.ie=parseInt(e.split(/msie|rv:/i)[1],10):t.opera&&(o.opera=parseInt(t.opera.version(),10));var r,a={},c={};(r=e.match(/Windows\sPhone[^\d]*\s([\d.]+)/))?a.wp=r[1]:(r=e.match(/Android\s+([\d.]+)/))?a.android=r[1]:e.match(/\sHTC[\s_].*AppleWebKit/)?a.android="2.3":(r=e.match(/iPhone\sOS\s([\d_]+)/))?(a.ios=r[1].replace(/_/g,"."),c.iphone=!0):(r=e.match(/iPad.*OS\s([\d_]+)/))?(a.ios=r[1].replace(/_/g,"."),c.ipad=!0):(r=e.match(/Bada\/([\d.]+)/))?a.bada=r[1]:(r=e.match(/MSIE\s9/))?a.wp="7.5":a.other=!0,BEM.DOM.decl("i-ua",{onSetMod:{js:{inited:function(){var t=this.__self,e="other";["ios","android","bada","wp","opera"].some(function(i){return t[i]&&(e=i)}),this.setMod("platform",e),t.hiDpi&&this.setMod("hi-dpi","yes")}}}},{ios:a.ios,iphone:c.iphone,ipad:c.ipad,android:a.android,bada:a.bada,wp:a.wp,other:a.other,dpr:i,hiDpi:n,ua:e,ie:o.ie,opera:o.opera})}(window,navigator.userAgent),function(){var t,e;BEM.decl("i-ua",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.__self.wp&&this.afterCurrentEvent(function(){var t=document.querySelector("html"),e=t.getAttribute("class").replace("i-ua_inlinesvg_no","i-ua_inlinesvg_yes");t.setAttribute("class",e)})}}},{canUseCSSAnimation:function(){var t=document.createElement("div"),e="Webkit Moz O ms Khtml".split(" ");if(void 0!==t.style.animationName)return!0;for(var i=0;i<e.length;i++)if(void 0!==t.style[e[i]+"AnimationName"])return!0;return!1},hasHistoryAPI:Boolean(window.history&&history.pushState),canUseAjax:function(){return"undefined"==typeof t&&(t="function"==typeof(window.History||window.history||{}).replaceState&&this.isCookieEnabled()),t},isCookieEnabled:function(){if("undefined"==typeof e){var t=Math.random().toString(16).slice(2);document.cookie=t+"=1",e=document.cookie.indexOf(t)>=0,document.cookie=t+"=;expires="+new Date(0).toGMTString()
}return e},getTransitionEndEvent:_.memoize(function(){var t="transitionend",e={webkitTransition:"webkitTransitionEnd",OTransition:"otransitionend",mozTransition:t,transition:t};for(var i in e)if(e.hasOwnProperty(i)&&void 0!==document.body.style[i])return e[i];return t}),isPointerEventsAvailable:_.memoize(function(){return void 0!==document.body.style.pointerEvents}),getConnectionType:function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return t?t.type:""},isYandexAppIos:function(){return/YaApp_iOS/.test(navigator.userAgent)}})}(),function(t,e){var i,n={},s={},o={},r={},a=t.innerWidth>t.innerHeight;e.match(/Android\s+([\d.]+)/)?(i=e.match(/Android\s+([\d.]+)/),n.android=i[1]):e.match(/\sHTC[\s_].*AppleWebKit/)?n.android="2.3":e.match(/iPhone\sOS\s([\d_]+)/)?(i=e.match(/iPhone\sOS\s([\d_]+)/),n.ios=i[1].replace(/_/g,"."),o.iphone=!0):e.match(/iPad.*OS\s([\d_]+)/)?(i=e.match(/iPad.*OS\s([\d_]+)/),n.ios=i[1].replace(/_/g,"."),o.ipad=!0):e.match(/Bada\/([\d.]+)/)?(i=e.match(/Bada\/([\d.]+)/),n.bada=i[1]):e.match(/Windows\sPhone[^\d]*\s([\d.]+)/)?(i=e.match(/Windows\sPhone[^\d]*\s([\d.]+)/),n.wp=i[1]):e.match(/MSIE\s9/)?n.wp="7.5":n.other=!0,e.match(/\s(CrMo|Chrome)\/([\d.]+)/)&&(i=e.match(/\s(CrMo|Chrome)\/([\d.]+)/),s.chrome=i[2]),BEM.decl("i-ua",{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=this.__self;this.setMod("platform",t.ios?"ios":t.android?"android":t.bada?"bada":t.wp?"wp":t.opera?"opera":"other").setMod("ios",t.ios?t.ios.charAt(0):"").setMod("android",t.android?t.android.charAt(0):"")}}},{_hasFlexBox:!1,canUseCSSCalc:function(){var t=document.createElement("div");return t.style.cssText="width: calc(10px);",Boolean(t.style.length)},hasFlexbox:function(){if(0===BEM.blocks["i-global"].getFlag("images_flexbox"))return!1;if(this._hasFlexbox)return this._hasFlexbox;var t,e,i=["","webkit-","-moz-","ms-","o-"],n="flex-wrap",s=document.body.style;for(t=0,e=i.length;e>t;t++){var o=$.camelCase(i[t]+n);if(s.hasOwnProperty&&s.hasOwnProperty(o)||void 0!==s[o])return this._hasFlexBox=!0,this._hasFlexBox}return this._hasFlexBox},ua:e,ios:n.ios,iphone:o.iphone,ipad:o.ipad,android:n.android,bada:n.bada,wp:n.wp,other:n.other,chrome:s.chrome,screenSize:screen.width>320?"large":screen.width<320?"small":"normal",connection:r.connection,flash:r.flash,video:r.video,svg:r.svg,width:t.innerWidth,height:t.innerHeight,landscape:a})}(window,navigator.userAgent),BEM.DOM.decl("b-page",{updateTitle:function(t){document.title=_.unescape(t)},_getFilterParams:$.noop}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){this.findBlocks().bindEvents(),BEM.blocks["i-global"].setParams({hasHistoryAPI:Boolean(window.history&&history.pushState)}),BEM.blocks["i-global"].param("isPumpkin")&&BEM.blocks.header.getSearch().fill(BEM.blocks.uri.getParamValue("text"))}},findBlocks:function(){return this._pane=this.findBlockInside("pane"),this._header=this.findBlockInside("header"),this._headerHeight=0,this._header&&(this._headerHeight=this._header.getHeight()),this._htmlBody=$("html,body"),this},bindEvents:function(){return this.bindToWin("resize",$.throttle(this._onResize,200,this)),this.bindToWin("scroll",$.throttle(this._onDomScroll,200,this)),BEM.blocks["i-global"].param("mobile")&&this.bindToWin("touchmove",$.throttle(this._onTouchMove,200,this)),this},_onResize:function(){this.trigger("resize")},_onTouchMove:function(){this.trigger("touchmove")},_onDomScroll:function(){var t=this;window.requestAnimationFrame(function(){t.trigger("scroll")})}}),BEM.DOM.decl("b-page",{_getFilterParams:function(){var t=this.__base.apply(this,arguments)||[];return t.concat("img_url","pos","rpt")},findBlocks:function(){return this.__base.apply(this,arguments),this.cbirIntent=this.findBlockInside("cbir-intent"),this}}),BEM.decl("i-url-controller",{},{passedParams:["ncrnd","nojs","numdoc","rdrnd","i-m-a-hacker","l10n","family","no-tests","nocache","test-id","test-tag","yandex_login","yandexuid","waitall","exp_flags","time","sbh","dbgwzr","noredirect","category","metahost","promo","popular_category","srcrwr","suggest-uri","disable","exp_confs","rearr","pron","counterDebug","snip","qa-project","qa-field","qa-functionality","qa-element","qa-test-id","qa-run-id","videoapp","patch","cache_whitelist","login"],rejectedParams:["uinfo","viewport","suggest_reqid","json_dump"],setCurrent:function(t){return this._current=t,this},setNext:function(t){return this._next=t,this},build:function(){return this.fillNextParams().fillCurrentParams().buildURL()},fillNextParams:function(){var t=this._next,e=t.url||location.href,i=this.rejectedParams;return t.path=t.path||BEM.blocks.uri.getPath(BEM.blocks.uri.clearHashSymbol(e)),t.params=$.extend({},BEM.blocks.uri.parseParams(e),t.params),t.params=_.transform(t.params,function(t,e,n){_.includes(i,n)||null===e||(t[n]=e)}),this},fillCurrentParams:function(){var t,e=this._next.params,i=this._current.params;return this.passedParams.forEach(function(n){e[n]||(t=i[n],t&&(e[n]=t))}),this},buildURL:function(){var t=this._next;return t.url=BEM.blocks.uri.buildRelativeUrl(t.path,t.params),this},mergePassedUrlParams:function(){var t=[].splice.call(arguments,0),e=_.pick(BEM.blocks.location.getInstance().getState().params,this.passedParams);return _.assign.apply(_,[e].concat(t)),_.forEach(e,function(t,i){_.isArray(t)&&(e[i]=t.join(";"))}),e}}),BEM.decl("location",{onSetMod:{js:function(){this._history=BEM.blocks.history.getInstance(),this._syncState(),this._history.on("statechange",this.changeThis(this._onStateChange))}},_onStateChange:function(){this._syncState(),this._state.referer!==BEM.blocks.uri.normalize(window.location.href)&&this._state.trigger!==!1&&(this.trigger("change",this._state),this._state.block&&this.channel(this._state.block).trigger("change"))},_syncState:function(){var t=this._history.state,e=BEM.blocks.uri.parse(t.url);return this._state=$.extend({},t.data,{referer:this._state&&this._state.url,url:e.build(),hostname:e.host(),path:e.path(),params:e.queryParams}),this},change:function(t){var e=BEM.blocks.uri.parse(t.url);if(t.url&&delete t.params,t.url=e.build(),t.params){var i=BEM.blocks.uri.parse(),n=t.forceParams?t.params:$.extend({},this._state.params,t.params);Object.keys(n).forEach(function(t){i.addParam(t,n[t])}),t.url=i.build()}t.trigger===!1||(t.trigger=!0);try{this._history.changeState(t.history===!1?"replace":"push",{data:t,url:t.url})}catch(s){window.location.assign(t.url)}},getState:function(){return $.extend(!0,{},this._state)},getUri:function(){return BEM.blocks.uri.parse(this._state.url)},getReferer:function(){return this._state.referer}},{_instance:null,getInstance:function(){return this._instance||(this._instance=BEM.create("location"))}}),BEM.decl("location",{CHANGE_DEBOUNCE:600,onSetMod:{js:function(){this.__base.apply(this,arguments),this.changeDebounced=$.debounce(this.change,this.CHANGE_DEBOUNCE,this),this.fillBlock(this.getOriginalState())}},_onStateChange:function(){this.__base.apply(this,arguments),this._state.trigger!==!1&&this._state.block&&this.trigger(this._state.block,this._state)},_syncState:function(){this.__base.apply(this,arguments),this.fillBlock(this.getOriginalState())},getOriginalState:function(){return this._state},change:function(t,e){if(e&&e.preventDefault&&e.preventDefault(),this.fillURL(t),t.reload)return void window.location.assign(t.url);var i=BEM.blocks.uri.parse(t.url);if(t.url&&delete t.params,t.url=i.build(),t.params){var n=BEM.blocks.uri.parse(),s=t.forceParams?t.params:$.extend({},this._state.params,t.params);Object.keys(s).forEach(function(t){n.addParam(t,s[t])}),t.url=n.build()}t.trigger===!1||(t.trigger=!0);try{this._history.changeState(t.history===!1?"replace":"push",{data:t,url:t.url})}catch(o){if("SecurityError"===o.name)throw o;"undefined"!=typeof console&&console.error&&console.error("location.assign fallback",o),window.location.assign(t.url)}},fillURL:function(t){BEM.blocks["i-url-controller"].setCurrent(this.getState()).setNext(t).build()},fillBlock:function(t){return t.block||(t.block=this.detectBlock(t)),this},getParamValue:function(t){var e=this._state.params[t];return e&&e[0]},hasParam:function(t,e){var i=this._state.params[t];return i?e?-1!==i.indexOf(e):Boolean(i[0]):!1}}),BEM.decl("location",{detectBlock:function(t){var e,i=t.path;return!t.params.rpt||"imageinfo"!==t.params.rpt[0]&&"imageview"!==t.params.rpt[0]?t.params.rpt&&"imagelike"===t.params.rpt[0]||t.params.like?e="b-page_type_similar":-1!==i.indexOf("search")?e="b-page_type_search":("/"===i||i===BEM.blocks["i-global"].param("router").index)&&(e="b-page_type_index"):e="b-page_type_search-by-image",e}}),BEM.decl("history",{onSetMod:{js:function(){if(!this.hasMod("provider"))throw new Error("Use BEM.blocks['history'].getInstance() instead of BEM.create('history')");this._resetUrl().bindEvents().syncState()}},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},pushState:function(t,e,i){return this.changeState("push",this.normalizeState(t,e,i))},replaceState:function(t,e,i){return this.changeState("replace",this.normalizeState(t,e,i))},bindEvents:function(){return this},_resetUrl:function(){return this},_removeHashbang:function(t){var e=BEM.blocks.uri,i=e.parse(t);if(""===i.anchor())return t;var n=e.parse(i.anchor().replace(/^!/,""));return i.anchor(""),i.query(n.query()),i.build()},unbindEvents:function(){return this},syncState:function(){return this.state=this.normalizeState(void 0,document.title,window.location.href),this},normalizeState:function(t,e,i){return{data:null===t?void 0:t,title:e,url:i}},changeState:function(t,e){try{window.location.assign(e.url)}catch(i){}}},{hasNativeAPI:function(){return window.history&&"pushState"in window.history},_instance:null,getInstance:function(){return this._instance||(this._instance=BEM.create({block:"history",mods:{provider:this.hasNativeAPI()?"history-api":"hashchange"}}))}}),BEM.decl("uri",{onSetMod:{js:function(){var t=this;["protocol","host","port","path","anchor"].forEach(function(e){t[e]=function(t){return"undefined"!=typeof t?(this.uriParts[e]=t,this):this.uriParts[e]}})}},encode:function(t){return encodeURIComponent(t)},decode:function(t){try{t=decodeURIComponent(t)}catch(e){try{t=decodeURIComponent(this.convert(t))}catch(i){}}return t},convert:function(t){var e={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};return t=t.replace(/%.{2}/g,function(t){return e[t]||t})},normalize:function(t){return(t||"").replace(/\+/g,"%20")},parseUri:function(t){var e=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],n=e.exec(t||""),s={};return i.forEach(function(t,e){s[t]=n[e]||""}),s},parseQuery:function(t){var e,i,n,s,o,r={};if("string"!=typeof t||""===t)return r;for(i=t.replace("?","").split("&"),e=0;e<i.length;e++)n=i[e].split("="),n=[n.shift(),void 0!==n[0]?n.join("="):null],s=this.decode(n[0]),o=n[1]||""===n[1]?this.decode(n[1]):null,r[s]?(o||""===o)&&r[s].push(o):r[s]=null===o?[]:[o];return r},query:function(t){var e="";"undefined"!=typeof t&&(this.queryParams=this.parseQuery(t));var i=this.queryParams,n=Object.keys(i),s=this;return n.forEach(function(t,n){n>0&&(e+="&"),"object"!=typeof i[t]||i[t].length?i[t].forEach(function(i,n){n>0&&(e+="&"),e+=s.encode(t)+"="+s.encode(i)}):e+=t}),e.length>0?"?"+e:e},getParam:function(t){return this.queryParams[t]},deleteParam:function(t,e){var i=[];return"undefined"!=typeof e&&((this.queryParams[t]||[]).forEach(function(t){t!==e&&i.push(t)}),this.queryParams[t]=i),("undefined"==typeof e||0===i.length)&&delete this.queryParams[t],this},addParam:function(t,e){return this.queryParams[t]=(this.queryParams[t]||[]).concat(e),this},replaceParam:function(t,e,i){return this.deleteParam(t,i).addParam(t,e)},scheme:function(){var t="";return this.protocol()?(t+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(t+=":"),t+="//"):this.host()&&(t+="//"),t},origin:function(){var t=this.scheme();return this.host()&&(t+=this.host(),this.port()&&(t+=":"+this.port())),t},getRoot:function(){var t=this.origin();return this.path()&&(t+=this.path().replace(/\/[^\/]*$/,"")),t},pathParts:function(){return this.path().split("/")},toString:function(){var t=this.origin();return this.path()?t+=0!==this.path().indexOf("/")&&"/"!==t[t.length-1]?"/"+this.path():this.path():this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(0!==this.query().toString().indexOf("?")&&(t+="?"),t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},build:function(){var t="";return t+=this.protocol()?this.protocol():window.location.protocol,t+=t.indexOf(":")!==t.length-1?"://":"//",t+=this.host()?this.host():window.location.hostname,this.port()?t+=":"+this.port():!this.host()&&window.location.hostname&&(t+=":"+window.location.port),t+=this.path()?this.path():this.host()?"/":window.location.pathname,this.query()&&(0!==this.query().indexOf("?")&&(t+="?"),t+=this.query()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t}},{parse:function(t){var e=BEM.create({block:"uri"});return e.uriParts=e.parseUri(e.normalize(t)),e.queryParams=e.parseQuery(e.uriParts.query),e},normalize:function(t){return this.parse(t).toString()}}),BEM.decl("uri",{},{_validUrlRegEx:new RegExp("^(?:(?:https?|ftp)://)(?:(?:(?:xn--)?(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:xn--)?(:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:xn--)?(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/[^\\s]*)?"),_acceptableUrlRegEx:/\S+\.\S{2,}/,setParam:function(t,e,i){_.isUndefined(i)&&(i=e,e=t,t=BEM.blocks.location.getInstance().getState().url);var n=this.parse(t);return _.isEmpty(i)?n.deleteParam(e).toString():n.queryParams[e]?n.replaceParam(e,i).toString():n.addParam(e,i).toString()},setParams:function(t,e){_.isObject(t)&&(e=t,t=BEM.blocks.location.getInstance().getState().url);var i=this.parse(t);return _.each(e,function(t,e){_.isUndefined(t)?i.deleteParam(e):i.queryParams[e]?i.replaceParam(e,t):i.addParam(e,t)}),i.toString()},delParams:function(t,e){_.isUndefined(e)&&_.isArray(t)&&(e=t,t=BEM.blocks.location.getInstance().getState().url);var i=this.parse(t);return _.isString(e)&&i.deleteParam(e),_.isArray(e)&&_.each(e,function(t){i.deleteParam(t)}),i.toString()},getFlatParams:function(t){var e=_.extend({},this.parse(t).queryParams);return $.each(e,function(t,i){i&&(e[t]=i.join(";"))}),e},buildRelativeUrl:function(t,e){return _.isUndefined(e)&&_.isObject(t)&&(e=t,t=BEM.blocks.location.getInstance().getState().url),!e||_.isEmpty(e)?t:(e=_.isArray(e)?[].concat(e):_.extend({},e),e=$.param(e,!0),BEM.blocks.uri.normalize(t+"?"+e))},parseParams:function(t){_.isUndefined(t)&&(t=BEM.blocks.location.getInstance().getState().url);var e=this.parse(this.clearHashSymbol(t));return e.queryParams},clearHashSymbol:function(t){return _.isUndefined(t)&&(t=BEM.blocks.location.getInstance().getState().url),t.replace(/[^\/]*\/?#!\//,"")},getPath:function(t){return this.parse(t).path()},isValid:function(t){return this._validUrlRegEx.test(t)},isAcceptable:function(t){return this._acceptableUrlRegEx.test(t)},getParamValue:function(t,e){_.isUndefined(e)&&(e=t,t=BEM.blocks.location.getInstance().getState().url);var i=this.parse(t).getParam(e);return _.isString(i)?i:_.isArray(i)?i[0]:void 0}}),BEM.decl({block:"history",modName:"provider",modVal:"history-api"},{_onPopState:function(t){var e=t.originalEvent.state;null!==e&&(this.state=this.normalizeState(e,document.title,window.location.href),this.state.data&&delete this.state.data.trigger,this.trigger("statechange",this.state))},bindEvents:function(){return this.__base.apply(this,arguments),BEM.DOM.win.on("popstate",this.changeThis(this._onPopState)),this},unbindEvents:function(){return this.__base.apply(this,arguments),BEM.DOM.win.off("popstate",this._onPopState),this},_resetUrl:function(){var t=BEM.blocks.uri.parse(window.location.href);return t.anchor()&&window.history.replaceState(null,document.title,this._removeHashbang(window.location.href)),this},syncState:function(){return null===window.history.state&&window.history.replaceState(void 0,document.title,window.location.href),(null===this.state||void 0===this.state)&&(this.state=this.normalizeState(void 0,document.title,window.location.href)),this},changeState:function(t,e){return window.history[t+"State"](e.data,e.title||document.title,e.url),this.state=e,this.trigger("statechange",{state:e,nativeApi:!0}),this}}),BEM.decl({block:"history",modName:"provider",modVal:"history-api"},{syncState:function(){return-1===navigator.userAgent.indexOf("Trident")&&null===window.history.state&&window.history.replaceState(void 0,document.title,window.location.href),(null===this.state||void 0===this.state)&&(this.state=this.normalizeState(void 0,document.title,window.location.href)),this}}),BEM.DOM.decl({block:"b-page",modName:"ajax",modVal:"yes"},{bindEvents:function(){this.__base.apply(this,arguments),this.on("contentLoad",this._onContentLoad).on("change",this._onChange)},_onContentLoad:function(t,e){this.__base.apply(this,arguments),BEM.DOM.update(this.findElem("content"),e.html),this.trigger("contentLoaded",e)},_onChange:function(){},buildCacheKey:function(){var t=this._location.getState();return[t.block?t.block:"",t.type?t.type:"",BEM.blocks.uri.delParams(t.url,this._getFilterParams())].join("_")},decodeEntities:function(t){return t.replace(/&(lt|gt|quot|apos|amp);/g,function(t,e){return{lt:"<",gt:">",quot:'"',apos:"'",amp:"&"}[e]})},updateGlobalParams:function(t){BEM.blocks["i-global"].setParams(t.params),this.updateSeoInformation(t.params.seo)}}),BEM.DOM.decl({block:"b-page",modName:"ajax",modVal:"yes"},{onSetMod:{js:function(){this.findBlockOn("i-global"),this._location=BEM.blocks.location.getInstance(),this.__base.apply(this,arguments),this._cacheKey=this.buildCacheKey()},type:function(t,e){this.__base.apply(this,arguments),this.findBlockInside("page-layout").setMod("page",e)}},checkCacheKey:function(){var t=this.buildCacheKey();return this._cacheKey===t?!1:(this._cacheKey=t,!0)},load:function(t){var e=BEM.create("i-request_type_bem",{url:t.url,cache:t.cache,ctx:this}),i=[{name:"i-global__params:ajax",callback:this.updateGlobalParams},{name:"cookies_ajax",callback:this.updateCookies}],n=this.getMod("tabs-navigation"),s=BEM.blocks["i-global"],o=s.param("id");return _.isArray(t.blocks)&&(i=i.concat(t.blocks)),("grey"===n||"black"===n||"white"===n&&"images"===o)&&i.push({name:"tabs-navigation__content",callback:function(t){BEM.DOM.update($(".tabs-navigation"),t.html)}}),"images"===o&&s.getFlag("images_no_left_nav")||"video"===o&&s.getFlag("video_no_left_nav")||i.push({name:"navigation",callback:function(t){BEM.DOM.update($(".page-layout__column_type_navigation"),t.html)}}),i.push({name:"content_type_"+t.type,callback:function(e){e.page=t.type,this.trigger("contentLoad",e)}},{name:"serp-controller",callback:this.updateSerpParams}),i.forEach(function(t){e.block(t.name,t.callback)}),e.on("beforeCallback",function(){this.setMod("type",t.type)},this),this.getFade().setMod("progress","yes"),e.get(this.prepareParams(t.params),this._requestCallback.bind(this,t.type)),this},_requestCallback:function(t){this.trigger("change",{type:t}),this.getFade().delMod("progress")},prepareParams:function(t){var e=$.extend({},t);return $.each(e,function(t,i){i&&(e[t]=i.join(";"))}),e},updateSeoInformation:function(t){this.updateTitle(t.title),$("meta[name=keywords]").attr("content",t.keywords),$("meta[name=description]").attr("content",t.description),this.params.seo.shareTitle=t.shareTitle},updateCookies:function(t){BEM.blocks.cookies.save(t.params.cookies)},updateSerpParams:function(t){var e,i=BEM.blocks["serp-controller"].get(),n=t.params.mods;_.extend(i.params,t.params);for(e in n)n.hasOwnProperty(e)&&i.setMod(e,n[e])},getFade:function(){return this._fade||(this._fade=this.findBlockInside({block:"fade",modName:"region",modVal:"main"})),this._fade}}),BEM.DOM.decl({block:"b-page",modName:"ajax",modVal:"yes"},{prepareParams:function(){var t=this.__base.apply(this,arguments);return t.uinfo=BEM.blocks["i-userinfo"].get().getUserInfo(),t}}),BEM.DOM.decl({block:"b-page",modName:"ajax",modVal:"yes"},{findBlocks:function(){return this.headFilter=this.findBlockInside("head-filter"),this.__base.apply(this,arguments)},bindEvents:function(){return this.headFilter&&this.headFilter.on("saved",this._onHeadFilterSaved,this),BEM.blocks["i-cbir-controller"].on("fade",this.showFade,this).on("unfade",this.hideFade,this),BEM.blocks["b-501px"].on("updateUrl",function(){this._cacheKey=this.buildCacheKey()},this),this.__base.apply(this,arguments)},unbindEvents:function(){return this.headFilter&&this.headFilter.un("saved",this._onHeadFilterSaved,this),BEM.blocks["i-cbir-controller"].un("fade",this.showFade,this).un("unfade",this.hideFade,this),BEM.blocks["b-501px"].un("updateUrl"),this.__base.apply(this,arguments)},_onHeadFilterSaved:function(){this.getFade().setMod("progress","yes")},updateGlobalParams:function(t){this.__base.apply(this,arguments),this.trigger("warning",t.params)},_delayMethod:function(t,e){var i=BEM.blocks["i-global"].param("lags"),n=i&&i.delay;n?setTimeout(function(){t.apply(this,e)}.bind(this),n):t.apply(this,e)},_onContentLoad:function(){this._delayMethod(this.__base,arguments)},_requestCallback:function(){this._delayMethod(this.__base,arguments)},_onChange:function(t,e){this.__base.apply(this,arguments);var i="index"===e.type&&BEM.blocks["i-global"].param("is500pxAvailable");this.setMod("501px",i?"yes":"")},showFade:function(){this.getFade().setMod("progress","yes")},hideFade:function(){this.getFade().delMod("progress")},loadPage:function(t,e){this.load({type:e,url:BEM.blocks["i-global"].param("router").search,params:t.params,blocks:[{name:"cbir-intent__image-link",callback:function(t){this.trigger("cbir-intent:loaded",t)}}]})}}),function(t,e,i){function n(t,e){var i={},n=t.originalEvent||{};e||(e={});for(var s,o=0;c>o;o++)s=r[o],i[s]=e[s]||t[s]||n[s]||a[o];return i.x=i.clientX,i.y=i.clientY,i.pressure=i.pressure||(i.buttons?.5:0),i.buttons||h||(i.buttons=u[i.which]||0),i.originalEvent=t.originalEvent||null,i.preventDefault=e.preventDefault?function(){e.preventDefault(),t.preventDefault()}:function(){t.preventDefault()},i}function s(t,e){var n=i.Event(t),s=e.preventDefault,o=n.preventDefault.bind(n);return jQuery.extend(n,e),n.preventDefault=function(){s(),o()},n}var o={bubbles:!1,cancelable:!1,view:null,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null,buttons:0,pointerId:0,width:0,height:0,pressure:0,tiltX:0,tiltY:0,pointerType:"",hwTimestamp:0,isPrimary:!1,target:null,currentTarget:null,which:0,pageX:0,pageY:0,timeStamp:0},r=Object.keys(o),a=r.map(function(t){return o[t]}),c=r.length,h=!1,u=[0,1,4,2];try{h=1===new MouseEvent("test",{buttons:1}).buttons}catch(l){}var d=t.Map&&t.Map.prototype.forEach,p=d?new t.Map:{array:[],size:0,set:function(t,e){return void 0===e?this["delete"](t):(this.has(t)||this.size++,void(this.array[t]=e))},has:function(t){return void 0!==this.array[t]},"delete":function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach(function(i,n){t.call(e,i,n,this)},this)}},f={eventMap:{},captureInfo:{},eventSourceList:[],registerSource:function(t,e){var i=e.events;i&&(i.forEach(function(t){e[t]&&(this.eventMap[t]=e[t].bind(e))},this),this.eventSourceList.push(e))},register:function(t){for(var e,i=this.eventSourceList.length,n=0;i>n&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,n=0;i>n&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){return t.contains(e)},getCommonAncestor:function(t,i){for(;t&&t!==e.documentElement;){if(t.contains(i))return t;t=t.parentNode}return null},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.pop(),this.fireEvent("pointerenter",t)},leave:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.shift(),this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.contains(t.target,t.relatedTarget)||this.leave(t)},enterOver:function(t){this.over(t),this.contains(t.target,t.relatedTarget)||this.enter(t)},listen:function(t,e){e.forEach(function(e){this.addEvent(t,e)},this)},unlisten:function(t,e){e.forEach(function(e){this.removeEvent(t,e)},this)},addEvent:function(t,e){i(t).on(e,this.boundHandler)},removeEvent:function(t,e){i(t).off(e,this.boundHandler)},eventHandler:function(t){var e=this.eventMap[t.type];e&&e(t,t.originalEvent)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var i=s(t,e);return i._target=i._target||e.target,i},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},getTarget:function(t){return this.captureInfo[t.pointerId]||t._target},setCapture:function(t,n){this.captureInfo[t]&&this.releaseCapture(t),this.captureInfo[t]=n,this.implicitRelease=this.releaseCapture.bind(this,t),i(e).on("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("gotpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n}))},releaseCapture:function(t){var n=this.captureInfo[t];n&&(this.captureInfo[t]=void 0,i(e).off("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("lostpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n})))},dispatchEvent:function(t){var e=this.getTarget(t);return e?i.event.trigger(t,null,e,!t.bubbles):void 0},asyncDispatchEvent:function(e){(t.requestAnimationFrame||setTimeout)(this.dispatchEvent.bind(this,e))}};f.boundHandler=f.eventHandler.bind(f);var m,_,g={POINTER_ID:1,POINTER_TYPE:"mouse",DEDUP_DIST:25,events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){f.listen(t,this.events)},unregister:function(t){f.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,n=t.clientX,s=t.clientY,o=0,r=i.length;r>o&&(e=i[o]);o++){var a=Math.abs(n-e.x),c=Math.abs(s-e.y);if(a<=this.DEDUP_DIST&&c<=this.DEDUP_DIST)return!0}},prepareEvent:function(t){return n(t,{pointerId:this.POINTER_ID,isPrimary:!0,pointerType:this.POINTER_TYPE})},mousedown:function(t){this.isEventSimulatedFromTouch(t)||(p.has(this.POINTER_ID)&&this.cancel(t),p.set(this.POINTER_ID,t),f.down(this.prepareEvent(t)))},mousemove:function(t){this.isEventSimulatedFromTouch(t)||f.move(this.prepareEvent(t))},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=p.get(this.POINTER_ID);e&&e.button===t.button&&(f.up(this.prepareEvent(t)),this.cleanupMouse())}},mouseover:function(t){this.isEventSimulatedFromTouch(t)||f.enterOver(this.prepareEvent(t))},mouseout:function(t){this.isEventSimulatedFromTouch(t)||f.leaveOut(this.prepareEvent(t))},cancel:function(t){f.cancel(this.prepareEvent(t)),this.cleanupMouse()},cleanupMouse:function(){p["delete"](this.POINTER_ID)}},b={POINTER_TYPE:"touch",DEDUP_TIMEOUT:2500,CLICK_COUNT_TIMEOUT:200,events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){f.listen(t,this.events)},unregister:function(t){f.unlisten(t,this.events)},firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===p.size||1===p.size&&p.has(1))&&(this.firstTouch=t.identifier,this.scrolling=!1,this.shouldScroll=!0,this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var t=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(t,this.CLICK_COUNT_TIMEOUT)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){return"touchstart"===t||"touchmove"===t?1:0},findTarget:function(t){return e.elementFromPoint(t.clientX,t.clientY)},touchToPointer:function(t){var e=this,s=this.currentTouchEvent,o=t.identifier+2;return n(s,i.extend({},t,{pointerId:o,target:f.captureInfo[o]||this.findTarget(t),bubbles:!0,cancelable:!0,detail:this.clickCount,button:0,buttons:this.typeToButtons(s.type),width:t.webkitRadiusX||t.radiusX||0,height:t.webkitRadiusY||t.radiusY||0,pressure:t.webkitForce||t.force||.5,isPrimary:this.isPrimaryTouch(t),pointerType:this.POINTER_TYPE,preventDefault:function(){e.scrolling=!1,e.shouldScroll=!1}}))},processTouches:function(t,e){var i=t.originalEvent.changedTouches;this.currentTouchEvent=t;for(var n,s=0;s<i.length;s++)n=i[s],e.call(this,this.touchToPointer(n))},findTouch:function(t,e){for(var i,n=0,s=t.length;s>n&&(i=t[n]);n++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.originalEvent.touches;if(p.size>=e.length){var i=[];p.forEach(function(t,n){if(1!==n&&!this.findTouch(e,n-2)){var s=t.out;i.push(s)}},this),i.forEach(this.cancelOut,this)}},touchstart:function(t){var e=t.originalEvent.changedTouches[0];this.vacuumTouches(t),this.setPrimaryTouch(e),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))},overDown:function(t){p.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),f.over(t),f.enter(t),f.down(t)},touchmove:function(t){this.scrolling||(this.shouldScroll?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=p.get(t.pointerId);if(e){var i=e.out,n=e.outTarget;f.move(t),i&&n!==t.target&&(i.relatedTarget=t.target,t.relatedTarget=n,i.target=n,t.target?(f.leaveOut(i),f.enterOver(t)):(t.target=n,t.relatedTarget=null,this.cancelOut(t))),e.out=t,e.outTarget=t.target}},touchend:function(t){this.dedupSynthMouse(t.originalEvent.changedTouches[0]),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(f.up(t),f.out(t),f.leave(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){f.cancel(t),f.out(t),f.leave(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){p["delete"](t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=g.lastTouches;if(this.isPrimaryTouch(t)){var i={x:t.clientX,y:t.clientY};e.push(i);var n=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,i);
setTimeout(n,this.DEDUP_TIMEOUT)}}},v={POINTER_TYPES:["","unavailable","touch","pen","mouse"],HAS_BITMAP_TYPE:t.MSPointerEvent&&"number"==typeof t.MSPointerEvent.MSPOINTER_TYPE_MOUSE,events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){f.listen(t,this.events)},unregister:function(t){f.unlisten(t,this.events)},prepareEvent:function(t){var e=n(t);return this.HAS_BITMAP_TYPE&&(e.pointerType=this.POINTER_TYPES[e.pointerType]),e},cleanup:function(t){p["delete"](t)},MSPointerDown:function(t){p.set(t.originalEvent.pointerId,t),f.down(this.prepareEvent(t))},MSPointerMove:function(t){f.move(this.prepareEvent(t))},MSPointerUp:function(t){f.up(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSPointerOut:function(t){f.leaveOut(this.prepareEvent(t))},MSPointerOver:function(t){f.enterOver(this.prepareEvent(t))},MSPointerCancel:function(t){f.cancel(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSGotPointerCapture:function(t){f.fireEvent("gotpointercapture",this.prepareEvent(t))},MSLostPointerCapture:function(t){f.fireEvent("lostpointercapture",this.prepareEvent(t))}},y=function(t){if(!p.has(t))throw new Error("InvalidPointerId")};t.Element&&Element.prototype.setPointerCapture?(m=function(t,e){t.setPointerCapture(e)},_=function(t,e){t.releasePointerCapture(e)}):t.navigator.msPointerEnabled?(m=function(t,e){y(e),t.msSetPointerCapture(e)},_=function(t,e){y(e),t.msReleasePointerCapture(e)}):(m=function(t,e){y(e),f.setCapture(e,t)},_=function(t,e){y(e),f.releaseCapture(e,t)}),i.fn.extend({setPointerCapture:function(t){m(this[0],t)},releasePointerCapture:function(t){_(this[0],t)}}),t.PointerEvent?["move","down","up","over","out","enter","leave","cancel"].forEach(function(t){var e=jQuery.event.fixHooks,i="pointer"+t;e[i]||(e[i]={}),e[i].props=r.concat(e[i].props||[])}):(delete i.event.special.pointerenter,delete i.event.special.pointerleave,t.navigator.msPointerEnabled?f.registerSource("ms",v):(f.registerSource("mouse",g),void 0!==t.ontouchstart&&f.registerSource("touch",b)),f.register(document))}(window,document,jQuery),$.each({pointerpress:"pointerdown",pointerrelease:"pointerup pointercancel"},function(t,e){function i(e){var i,n=e.type;return("mouse"!==e.pointerType||1===e.which)&&(e.type=t,i=$.event.dispatch.apply(this,arguments),e.type=n),i}$.event.special[t]={setup:function(){$(this).on(e,i)},teardown:function(){$(this).off(e,i)}}}),$.extend({util:{}}),function(){function t(t){return"[object Object]"===n.call(t)}function e(i,n,s){var o,r;i=Object(i),n=Object(n);for(o in n)r=s&&s(i[o],n[o],o),i[o]=void 0!==r?r:t(i[o])&&t(n[o])?e(i[o],n[o],s):n[o];return i}function i(t,i){return e(t,i,function(t,e,i){return"mix"===i?[].concat(t,e):void 0})}var n=Object.prototype.toString;$.extend($.util,{merge:e,mergeBemjson:i})}(),BEM.DOM.decl("control",{onSetMod:{focused:{yes:function(){return this.hasMod("disabled")?!1:void(this._focused||this._focus())},"":function(){this._focused&&this._blur()}},disabled:{"*":function(t,e){var i=this._getControl(),n=Boolean(e);i.prop("disabled",n).attr("aria-disabled",n),i.attr("tabindex",n?null:this.params._tabindex)},yes:function(){this.delMod("focused")}}},_focus:function(){this._getControl().focus()},_blur:function(){this._getControl().blur()},_getControl:function(){var t=this.elem("control");return t.length>0?t:this.domElem},_onFocusin:function(){this._focused=!0,this.setMod("focused","yes").bindTo("focusout",this._onFocusout)},_onFocusout:function(){this._focused=!1,this.delMod("focused").unbindFrom("focusout")}},{live:function(){this.liveBindTo("focusin",this.prototype._onFocusin),BEM.blocks["i-ua"].ios>=8&&this.liveBindTo("control","focusin",function(t){t.preventDefault()})}}),BEM.DOM.decl({block:"link",baseBlock:"control"},{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},disabled:{"":function(){this.__base.apply(this,arguments),this.domElem.attr("href",this._url)},yes:function(){this.__base.apply(this,arguments),this._url=this.domElem.attr("href"),this.domElem.removeAttr("href"),this.delMod("hovered").delMod("pressed")}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onPointerpress:function(){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}),this.__base()}}),function(){function t(){i.hasClass("pointerfocus")&&(s=!0,setTimeout(function(){s=!1}))}var e=$(window),i=$(document.documentElement),n=0,s=!1;document.documentMode<=9?i.on("focusin",function(e){var i=e.originalEvent;!i||i.fromElement||i.relatedTarget||t()}):e.on("blur",function(){e.one("focus",t)}),i.addClass("utilityfocus").on({focusin:function(){i.toggleClass("pointerfocus",s).toggleClass("utilityfocus",!s)},keydown:function(){clearTimeout(n),s=!1},"pointerdown pointerup click":function(){s=!0,clearTimeout(n),n=setTimeout(function(){s=!1},600)}})}(),BEM.DOM.decl({block:"link",modName:"ajax",modVal:"yes"},{_onClick:function(t){this.__base.apply(this,arguments);var e=this.domElem.attr("href");this.isMouseDownTriggered||this.domElem.trigger("onmousedown"),BEM.blocks.location.getInstance().change($.extend({url:e},this.params),t)},_onMouseDown:function(){this.isMouseDownTriggered=!0}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo({block:"link",modName:"ajax",modVal:"yes"},"pointerclick",function(t){this._onClick(t)}),this.liveBindTo({block:"link",modName:"ajax",modVal:"yes"},"mousedown",function(){this._onMouseDown()})}}),function(){var t={};BEM.decl("i-request",{onSetMod:{js:{inited:function(){this._preventCache=!1}}},get:function(t,e,i,n){return $.isFunction(i)||(n=i,i=this.params.onError),this._get(t,e,i,$.extend({},this.params,n)),this},_get:function(e,i,n,s){var o=this._buildCacheKey(e,s),r=t[s.cacheGroup];s.cache&&r&&o in r.data?this.afterCurrentEvent(function(){i.call(this.params.callbackCtx,r.data[o])},this):this._do(e,i,n,s)},_do:function(){},_onSuccess:function(t,e,i,n){n.cache&&!this._preventCache&&this.putToCache(n,t,i),this._preventCache=!1},_buildCacheKey:function(t){return"string"==typeof t?t:$.param(t)},putToCache:function(e,i,n){var s=t[e.cacheGroup]||(t[e.cacheGroup]={keys:[],data:{}});s.keys.length>=e.cacheSize&&delete s.data[s.keys.shift()];var o=this._buildCacheKey(i,e);return s.data[o]=n,s.keys.push(o),this},dropCache:function(){return delete t[this.params.cacheGroup],this},getDefaultParams:function(){return{cache:!1,cacheGroup:"default",cacheSize:100,callbackCtx:this}}},{_cache:t})}(),BEM.decl("i-request_type_bem",{onSetMod:{js:function(){this.blocks=[],BEM.blocks["i-global"].param("isYandexNet")&&this.blocks.push({decl:"i-console",error:$.noop,success:function(t){$("body").append(t.html)},params:{isAjax:!0}}),this._req=BEM.create("i-request_type_ajax",{dataType:this.params.dataType,url:this.params.url,cache:this.params.cache,callbackCtx:this})}},block:function(t,e,i,n){var s=Array.isArray(t)?t:"string"==typeof t?t.split(" "):[t];if(arguments.length<2)throw new Error("success callback is required");for(var o=0,r=s.length;r>o;o++)this.blocks.push({decl:s[o],success:e,error:"function"===$.type(i)?i:$.noop,params:n||"object"===$.type(i)?i:{},ctx:this.params.ctx});return this},get:function(t,e,i){var n=this.params;return"function"===$.type(t)?(n.success=t,n.error=e||$.noop,t=void 0):(n.success=e||$.noop,n.error=i||$.noop),this.afterCurrentEvent(function(){this.trigger("beforeRequest"),this._req.get($.extend({},this._getArgs(),t),this._onSuccess,this._onError)}),this},abort:function(){return this._req.abort(),this.blocks.length=0,this},_onSuccess:function(t){return t&&"captcha"===t.type?(c.hit({dtype:"stred",pid:40,cid:72952,path:BEM.blocks["i-global"].param("project").replace("/",".")}),void window.location.assign(t.captcha["captcha-page"])):void this._callback("success",t)},_onError:function(t){this._callback("error",t)},_callback:function(t,e){var i={};this.trigger("beforeCallback"),this.blocks.forEach(function(n,s){var o="string"==typeof n.decl?n.decl:n.decl.block;n[t].call(n.ctx,"success"===t?e.blocks?e.blocks[s]:e[n.decl]:e,n.decl),"success"===t&&("string"==typeof n.decl?i[o]=e.blocks[s]:(Array.isArray(i[o])||(i[o]=[]),i[o].push(e.blocks[s])))}),this.params[t].call(this.params.ctx,"success"===t?i:e)},_getRequestString:function(){return JSON.stringify(this.blocks.map(function(t){return{block:t.decl,params:t.params,version:2}}))},_getArgs:function(){return $.extend({format:"json",request:this._getRequestString()},"jsonp"===this.params.dataType?{yu:BEM.blocks["i-global"].param("yandexuid")}:{})},getDefaultParams:function(){return{url:"/",dataType:"jsonp",ctx:this}}}),BEM.decl("i-request_type_bem",{_onSuccess:function(){var t=BEM.blocks["i-global"].param("lags"),e=t&&t.load,i=this.__base,n=arguments;e?setTimeout(function(){i.apply(this,n)}.bind(this),e):i.apply(this,n)}}),function(t){t.decl({block:"i-request_type_ajax",baseBlock:"i-request"},{onSetMod:{js:{inited:function(){this.__base(),this._requestNumber=this._number=this._preventNumber=this._retryCount=0}}},_get:function(t,e,i,n){this._number++,this._requestNumber++,this._retryCount=n.retryCount,this.__base.apply(this,arguments)},_do:function(t,e,i,n){var s=this;if(s._number>s._preventNumber){var o=arguments,r={data:n.data?$.extend({},n.data,t):t},a=s._wrapCallback(function(i,o,r){s._onSuccess(s._buildCacheKey(t,n),t,i[0],n),s._allowCallback(o,r)&&e.apply(n.callbackCtx,i)}),c=s._wrapCallback(function(t,e,r){s._allowCallback(e,r)&&(s._retryCount-->0?setTimeout(function(){s._do.apply(s,o)},n.retryInterval):i&&i.apply(n.callbackCtx,t))});$.each(["url","dataType","timeout","type","jsonp","jsonpCallback","xhrFields"].concat(n.paramsToSettings||[]),function(t,e){r[e]=n[e]}),$.ajax(r).done(a).fail(c)}},_wrapCallback:function(t){var e=this._requestNumber,i=this._number;return function(n){null!==n&&t(arguments,e,i)}},_allowCallback:function(t,e){return e>this._preventNumber&&this._requestNumber===t},_buildCacheKey:function(t,e){return"string"==typeof t?t:this.__base(t)+e.url},abort:function(){this._preventNumber=++this._number},getDefaultParams:function(){return $.extend(this.__base(),{cache:!0,type:"GET",dataType:"jsonp",timeout:2e4,retryCount:0,retryInterval:2e3})}})}(BEM),BEM.decl("i-request_type_ajax",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.cacheIrrelevantParams=["yu","uinfo","viewport","rpt","_","pos"]}},getDefaultParams:function(){return _.extend(this.__base.apply(this,arguments),{timeout:3e5})},_get:function(t,e,i,n){if(this.params.timeout){var s,o=this._buildCacheKey(t,n),r=this.__self._cache,a=r[n.cacheGroup];n.cache&&a&&o in a.data&&(s=a.timestamps[o],(new Date).getTime()-s>this.params.timeout&&(delete a.timestamps[o],delete a.data[o],a.keys.splice(a.keys.indexOf(o),1)))}this.__base.apply(this,arguments)},_buildCacheKey:function(t,e){if("string"==typeof t)return t;for(var i=$.extend(!0,{},t),n=this.cacheIrrelevantParams,s=0,o=n.length;o>s;s++)n[s]in i&&delete i[n[s]];return void 0===i.p&&(i.p=1),$.param(i)+e.url},putToCache:function(t,e){var i=this._buildCacheKey(e,t),n=this.__self._cache,s=n[t.cacheGroup]||(n[t.cacheGroup]={keys:[],data:{},timestamps:{}});this.__base.apply(this,arguments),s.keys.length>=t.cacheSize&&delete s.timestamps[s.keys[0]],s.timestamps[i]=(new Date).getTime()}}),BEM.DOM.decl("b-page",{_onUserScroll:function(){this._htmlBody.stop(),this.stopScrollTracking()},startScrollTracking:function(){this.isScrolling=!0,this.bindToWin("DOMMouseScroll mousewheel",$.throttle(this._onUserScroll.bind(this),100))},stopScrollTracking:function(){this.isScrolling=!1,this.unbindFromWin("DOMMouseScroll mousewheel",$.throttle(this._onUserScroll.bind(this),100))},scrollTo:function(t,e,i){i||(i=0);var n=t instanceof jQuery?t.offset().top-this._headerHeight-i-20:t;return e?this.isScrolling||(this.startScrollTracking(),this._htmlBody.animate({scrollTop:n},e,this.stopScrollTracking.bind(this))):window.scrollTo(0,n),this},enableScroll:function(){this.delMod("scroll-disabled"),this.loadScroll()},disableScroll:function(){this.saveScroll(),this.setMod("scroll-disabled","yes")},loadScroll:function(){window.scrollTo(this._savedScroll.x,this._savedScroll.y)},saveScroll:function(){this._savedScroll={x:window.scrollX,y:window.scrollY}}}),BEM.DOM.decl("b-page",{bindEvents:function(){return this.__base.apply(this,arguments),this._location.on("b-page_type_index",this._onPageIndex,this),this},_onPageIndex:function(t,e){this.checkCacheKey()&&this.loadIndex(e)},loadIndex:function(t){return this.load({type:"index",url:BEM.blocks["i-global"].param("router").index,params:t.params}),this}}),BEM.DOM.decl("b-page",{_onPageIndex:function(){this.__self.preventFocus=!0,this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this.__self.preventFocus=!1}),this.cbirIntent&&this.cbirIntent.prepareInputForIndex()}}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){this.params.shouldUpdateFilters=!BEM.blocks["i-global"].param("hasHistoryAPI"),this.__base.apply(this,arguments)}},bindEvents:function(){return this.__base.apply(this,arguments),this._location.on("b-page_type_search",this._onPageSearch,this),this},_onPageSearch:function(t,e){this.checkCacheKey()&&this.loadSearch(e)},getBlocks:function(){var t=BEM.blocks["i-global"].getFlag("video_mega_header")?"search2":"search",e=[{name:t+":ajax",callback:function(t){this.trigger("search:input:update",t)}}];return this.params.shouldUpdateFilters&&e.push({name:"advanced-search__filters",callback:this._onAdvancedSearchData}),e},loadSearch:function(t){return this.load({type:"search",url:t.path||BEM.blocks["i-global"].param("router").search,params:t.params,blocks:this.getBlocks()}),this},_onAdvancedSearchData:function(t){this.trigger("filters:update",t)}}),BEM.DOM.decl({block:"b-page",modName:"type",modVal:"search"},{preview:function(t){this._pane.load(t)}}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.shouldUpdateFilters=!0}},getBlocks:function(){var t=this.__base.apply(this,arguments);return t.push({name:"preview__isWallpaper",callback:function(t){this.trigger("preview:update",t.params.isWallpaper)}}),t.push({name:"related2",callback:function(t){this.trigger("related2:update",t)}}),t},_onAdvancedSearchData:function(t){_.isEmpty(t.params.filters)||this._advancedSearch||(this._advancedSearch=this.findBlockInside("advanced-search")),this.__base.apply(this,arguments)},_onPageSearch:function(){this.__base.apply(this,arguments),this.cbirIntent&&this.cbirIntent.prepareInputForSearch()}}),function(t,e){function i(t){t.isPrimary&&(h.push({x:t.clientX,y:t.clientY,target:t.target}),setTimeout(Array.prototype.shift.bind(h),c))}function n(t){var e=t.clientX,i=t.clientY;return h.some(function(n){return Math.abs(e-n.x)>a||Math.abs(i-n.y)>a?!1:n.target!==t.target&&document.elementFromPoint(n.x,n.y)===n.target?!1:!0})}function s(t){var i,n=t.type;return t.button||(t.type="pointerclick",i=e.event.dispatch.apply(this,arguments),t.type=n),i}var o,r=void 0!==t.ontouchstart||navigator.msMaxTouchPoints>0,a=25,c=2500,h=[],u=!1,l=!1;o=r?{click:function(t){return n(t)?void 0:s.apply(this,arguments)},"pointerdown pointerleave pointercancel pointerup":function(t){if("mouse"!==t.pointerType)if("pointerdown"===t.type)i(t),u=!0;else if("pointerleave"===t.type||"pointercancel"===t.type)u=!1;else if("pointerup"===t.type&&(i(t),u))return l||(l=setTimeout(function(){l=u=!1})),s.apply(this,arguments)}}:{click:function(){return s.apply(this,arguments)}},e.event.special.pointerclick={setup:function(){e(this).on(o)},teardown:function(){e(this).off(o)}}}(window,jQuery),BEM.DOM.decl("popup",{getDefaultParams:function(){var t={left:15,right:15,top:15,bottom:15};return{directions:[{to:"bottom",axis:"center",tail:{axis:"center"}},{to:"top",axis:"center",tail:{axis:"center"}},{to:"right",axis:"middle",tail:{axis:"middle"}},{to:"left",axis:"middle",tail:{axis:"middle"}}],tail:{width:24.04,height:12.02,offset:t},duration:150}},onSetMod:{js:{inited:function(){this._cache={},this._viewport=BEM.DOM.win,this._scope=BEM.DOM.scope,this._channel=BEM.channel("popups"),this._inContainer=!1,this._isParentFixed=!1,this._owner=null,this._userPosition=null,this._parent=null,this._childs=[],this._isShown=!1,this._isHiding=!1,this._positions={},this._currPos={},this._visibilityFactor=null,this._direction=!1,this._directions={};var t=this.getDefaultParams(),e=this.params,i=this._repackDirParams(t.directions),n=e.generateDirections?this._generateDirections:e.directions,s=this._repackDirParams(n);e.tail&&(this.params.tail=this._mergeParams(t.tail,e.tail)),this._order=s.keys.map(function(t){var e=s.directions[t],n=i.directions[t];return n||(n=i.directions[e.to]),this._directions[t]=this._mergeParams(n,e,{tail:this._tailParamsHook}),t},this)}},visibility:{visible:function(){this._onShown()},"":function(){this._onHidden()}}},show:function(t){var e;if(t instanceof BEM)e=t.domElem.eq(0);else if(t instanceof $)e=t;else if(!t)return;if(e){this._owner&&e[0]!==this._owner[0]&&this.delMod("visibility"),this._owner=e;var i=this._findParent(e);i&&this.setParent(i)}else this._userPosition=t;return this.setMod("visibility","outside").repaint()},hide:function(){if(this._isHiding)return this;if(this._isShown&&(this._isHiding=!0,this._childs.forEach(function(t){t.hide()}),this.hasMod("animate","yes")&&!this.hasMod("fade-out","no"))){var t=this;return this.beforeHide(function(){t.domElem&&t.delMod("visibility")}),this}return this.delMod("visibility")},toggle:function(t){return this._isShown&&!this._isHiding?this.hide():this.show(t||this._owner)},repaint:function(){this._moveToContainer();var t=this._pickDirection();return this.setMod("to",t.to)._show(this._positions[t.key],this._tailPos&&this._tailPos[t.key]),this},getCurrPos:function(){return this._currPos},getCurrDirection:function(){return this._direction},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this._resetDefault(),this._isShown&&this.repaint(),this},isShown:function(){return this._isShown},setParent:function(t){return this._parent=t,this._isParentFixed=t.hasMod("position","fixed"),t.addChild(this),this},addChild:function(t){for(var e=this._childs,i=e.length,n=0;i>n;n++)if(e[n]._uniqId===t._uniqId)return;t.on("hide",function(){this.removeChild(t)},this),e.push(t)},removeChild:function(t){for(var e=this._childs,i=e.length,n=0;i>n;n++)if(e[n]._uniqId===t._uniqId)return void e.splice(n,1)},setSize:function(t){return t&&(this._resetDefault(),this.domElem.css(t),this._isShown&&!this._isHiding&&this.repaint()),this},_show:function(t,e){return this._currPos=t,e&&this.elem("tail").removeAttr("style").css(e),this.domElem.css(t),(!this._isShown||this._isHiding)&&this.hasMod("animate","yes")&&!this.hasMod("fade-in","no")&&this.afterShow(),this._isHiding=!1,this.setMod("visibility","visible"),this},_onShown:function(){this.bindToDoc("keydown",function(t){t.which===BEM.blocks.keycodes.ESC&&0===this._childs.length&&this.hide()}),this._attachRepaintOnResize(),this._bindFocusEvents(),this._attachUnder(),this._isShown=!0,this.hasMod("autoclosable","yes")&&this.afterCurrentEvent(function(){this._enableAutoclosable()}),this.hasMod("adaptive","yes")&&this._enableAdaptive(),this._channel.on("hide",this.hide,this),this.trigger("show")},_onHidden:function(){this.unbindFromDoc("keydown"),this._detachRepaintOnResize(),this._unbindFocusEvents(),this.hasMod("autoclosable","yes")&&this._disableAutoclosable(),this.hasMod("adaptive","yes")&&this._disableAdaptive(),this._detachUnder(),this._cache={},this._isShown=!1,this._isHiding=!1,this._channel.un("hide"),this._returnFocus(),this.trigger("hide")},_attachRepaintOnResize:function(){window.attachEvent&&this.domElem[0].attachEvent("onresize",this.__self._enforcePageRepaint)},_detachRepaintOnResize:function(){window.detachEvent&&this.domElem[0].detachEvent("onresize",this.__self._enforcePageRepaint)},_bindFocusEvents:function(){this._lastFocused=$($.dom.getActiveElement()[0]||this._scope);var t=this.__self._getFocusable(this.elem("content"));return this._firstFocusable=t.first(),this._lastFocusable=t.last(),this._skipReturnFocus=!1,0===this._firstFocusable.length?void(this._skipReturnFocus=!0):void this.bindTo(this._lastFocused,"keydown",this._onLastFocusedKeyDown).bindTo(this._firstFocusable,"keydown",this._onFirstFocusableKeyDown).bindTo(this._lastFocusable,"keydown",this._onLastFocusableKeyDown)},_unbindFocusEvents:function(){this.unbindFrom(this._firstFocusable,"keydown"),this.unbindFrom(this._lastFocusable,"keydown"),this.unbindFrom(this._lastFocused,"keydown")},_onLastFocusedKeyDown:function(t){(!this._lastFocused.is(this._scope)||this._lastFocused.is(t.target))&&(t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this[t.shiftKey?"_lastFocusable":"_firstFocusable"].focus()))},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_returnFocus:function(){var t=(this._parent||{})._skipReturnFocus||this._skipReturnFocus;t||this._lastFocused.focus()},_mergeParams:function(t,e,i){var n={},s=Object.prototype.hasOwnProperty;return i||(i={}),t&&"object"==typeof t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(o){var r=s.call(i,o)?i[o].call(this,t[o],e[o]):e[o];n[o]=!r||"object"!=typeof r||Array.isArray(r)?r:t[o]?this._mergeParams(t[o],r,i):r},this),n},_tailParamsHook:function(t,e){return e.offset||(e.offset=this.params.tail.offset),"number"==typeof e.offset?{offset:{left:e.offset,top:e.offset}}:e},_generateDirections:function(){if(this.__self._generateDirectionsCache)return this.__self._generateDirectionsCache;for(var t=[["bottom","top"],["left","right"]],e=[["center","left","right"],["middle","top","bottom"]],i=e,n=t.length,s=[],o=0;n>o;o++)for(var r=t[o],a=r.length,c=0;a>c;c++)for(var h=e[o],u=h.length,l=0;u>l;l++)for(var d=i[o],p=d.length,f=0;p>f;f++)s.push({direction:r[c],axis:h[l],tail:{axis:d[f]}});return this.__self._generateDirectionsCache=s,s},_repackDirParams:function(t){var e={},i=[];return("string"==typeof t||$.isPlainObject(t))&&(t=[t]),i=t.map(function(t){if("string"==typeof t){var i=t.split("-");t={to:i[0],tail:{}},i[1]&&(t.axis=i[1]),i[2]&&(t.tail.axis=i[2])}var n=t.to;return e[n]||(e[n]=t),t.axis&&(n+="-"+t.axis),t.key=n,e[n]=t,n},this),{directions:e,keys:i}},setViewport:function(t){return this._viewport=t,this},_pickDirection:function(){var t,e=this._order,i=this.hasMod("adaptive","yes")?e.length:1;for(this._visibilityFactor=0,t=0;i>t;t++){var n=e[t],s=this._directions[n];this._resetPos(n)._pushPos(n,this._calcPos(s))._pushPos(n,this._calcOffsets(s)),this._hasTail()&&this._resetTailPos(n)._pushTailPos(n,this._calcTailPos(s))._pushTailPos(n,this._calcTailOffset(s))._pushPos(n,this._calcOffsetByTail(s)),this._pushPos(n,this._getParentOffset());var o=this._calcVisibilityFactor(s);if((o>this._visibilityFactor||!this._direction)&&(this._visibilityFactor=o,this._direction=this._directions[n],this.size=this.getPlacingSize(),100===o))break}return this._direction},_getParentOffset:function(){var t=this.domElem.offsetParent().offset();return t.left*=-1,t.top*=-1,t},_calcPos:function(t){this._calcPlacingSize(t);var e=this.getOwnerPos(),i=this.getOwnerSize(),n=this.getPlacingSize(),s=t.axis,o=this.params.position||{},r={},a=Object.prototype.hasOwnProperty;switch(t.to){case"bottom":r={top:a.call(o,"top")?o.top:e.top+i.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"top":r={top:a.call(o,"top")?o.top:e.top-n.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"left":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left-n.width};break;case"right":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left+i.width}}return r},_calcTop:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"top"===t?e+=n.top:"middle"===t?e+=n.top+s.height/2-i.height/2:"bottom"===t&&(e+=n.top+s.height-i.height),e},_calcLeft:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"left"===t?e+=n.left:"center"===t?e+=n.left+s.width/2-i.width/2:"right"===t&&(e+=n.left+s.width-i.width),e},getPlacingSize:function(){return this.getPopupSize()},_calcOffsets:function(t){var e,i=this._cache.offset||(this._cache.offset={}),n=t.key,s=t.offset;if(i[n])return i[n];if(!s)return!1;if(e={left:0,top:0},"number"==typeof s)switch(n){case"left":e.left+=s;break;case"right":e.left-=s;break;case"top":e.top+=s;break;case"bottom":e.top-=s}else s.left&&(e.left+=s.left),s.right&&(e.left-=s.right),s.top&&(e.top+=s.top),s.bottom&&(e.top-=s.bottom);return i[n]=e,e},_hasTail:function(){return 0!==this.elem("tail").length},_moveToContainer:function(t){if(t)this._inContainer=!1;else{if(this._isShown)return;t=this._parent?this._parent.domElem:this._scope}this.domElem.appendTo(t),this._inContainer=!0},_resetPos:function(t){return t?this._positions[t]=null:this._positions={},this},_pushPosTo:function(t,e,i){i!==!1&&("string"==typeof e?this._sum(t[e]||(t[e]={}),i):(i=e,Object.keys(t).forEach(function(e){this._sum(t[e],i)},this)))},_pushPos:function(t,e){return this._pushPosTo(this._positions,t,e),this},_sum:function(t,e){Object.keys(e).forEach(function(i){t[i]=(t[i]||0)+e[i]})},_getSizeOf:function(t){return{height:t.outerHeight(),width:t.outerWidth()}},getOwnerSize:function(){return this._owner?this._cache.ownerSize||(this._cache.ownerSize=this._getSizeOf(this._owner)):{height:0,width:0}},getPopupSize:function(){return this._getSizeOf(this.domElem)},_getPosOf:function(t){return t.offset()||{left:0,top:0}},getOwnerPos:function(){var t;return this._owner&&(t=this._getPosOf(this._owner),"pageYOffset"in window&&(t.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),t.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft))),t||this._userPosition},_calcVisibilityFactor:function(t){var e,i,n=this._viewport,s=this._getSizeOf(n),o=this.getPopupSize(),r=this._positions[t.key],a=this._parent&&this._isParentFixed?this._parent.domElem.offset():{top:0,left:0},c=this.hasMod("position","fixed")?{top:0,left:0}:{top:n.scrollTop(),left:n.scrollLeft()},h=r.top+a.top-c.top,u=r.left+a.left-c.left,l=u+o.width-s.width,d=h+o.height-s.height,p={height:o.height,width:o.width},f=100;return d>0&&(p.height-=d),0>h&&(p.height+=h),0>u&&(p.width+=u),l>0&&(p.width-=l),p.height<0||p.width<0?f=0:(i=Math.abs(p.height*p.width),e=o.height*o.width,e!==i&&(f=i/e*100)),f},_findParent:function(t){return this.findBlockOutside(t,"popup")},destruct:function(){return this._childs.forEach(function(t){BEM.DOM.destruct(t.domElem)}),this.setMod("fade-out","no"),this.hide(),this.__base.apply(this,arguments)},_resetDefault:function(){},_calcPlacingSize:function(){}},{live:function(){this.liveBindTo("close","pointerclick",function(){this.hide()})},_getFocusable:function(t){var e=$.data(t,"popup-getFocusable-id");e||(e=$.identify(),$.data(t,"popup-getFocusable-id",e)),e='*[data-popup-getFocusable-id="'+e+'"]';var i="a[href], link, ";return BEM.blocks["i-ua"].opera<13&&(i=""),t.find(i+'*[tabindex], button, input:not([type="hidden"]), textarea, select, menuitem').filter(function(){var t=$(this),i=!0;return parseInt(t.prop("tabindex"),10)<0||"hidden"===t.css("visibility")?!1:($(this).parentsUntil(e).each(function(){var t=$(this);return"none"===t.css("display")?i=!1:void 0}),i)})},_enforcePageRepaint:function(){document.body.className+=""},_generateDirectionsCache:null}),BEM.DOM.decl("popup",{_onHidden:function(){return this.hasMod(this._under,"type","paranja")&&this.unbindFrom(this._under,"pointerclick pointerdown"),this.__base.apply(this,arguments)}}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.findBlockOn("share-dropdown")&&(this._isParentFixed=!0)}}}}),BEM.DOM.decl("popup",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["i-global"].param("mobile")&&this.setMod("fade-out","no")},visibility:{visible:function(){this.__base.apply(this,arguments),BEM.blocks["i-keyrouter"].on("esc",this._onEsc,this),BEM.blocks["b-page"].on("touchmove",this._onTouchMove,this)},"":function(){this.__base.apply(this,arguments),BEM.blocks["i-keyrouter"].un("esc",this._onEsc,this),BEM.blocks["b-page"].un("touchmove",this._onTouchMove,this)}}},_onEsc:function(){this.hide()},_onTouchMove:function(t){$(t.target).closest(".popup").length||this.hide()},_pushPos:function(t,e){var i=e.top,n=e.left;return i&&"string"!=typeof i&&(e.top=Math.floor(i)),n&&(e.left=Math.floor(n)),this.__base.apply(this,arguments)}}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.findBlockOn("sizes-popup")&&(this._isParentFixed=!0)}},visibility:{visible:function(){this.__base.apply(this,arguments),this.bindToDoc("dragover",this.hide)},"":function(){this.__base.apply(this,arguments),this.unbindFromDoc("dragover",this.hide)}}}}),BEM.decl("keycodes",{},{BACKSPACE:8,TAB:9,ENTER:13,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,is:function(t,e){return(Array.isArray(e)?e:Array.prototype.slice.call(arguments,1)).some(function(e){return this[e]===t},this)}}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base.call(this);var t=this.findElem("under").first();this._underClassAttr=t.attr("class"),this.isDivEnough()?this._under=t:(t.remove(),this._under=null),this._underInPool=!1}}},isDivEnough:function(){return!0},_createUnder:function(){return $('<iframe frameBorder="0" tabindex="-1" src="about:blank"/>')},_getUnder:function(){if(this._under)return this._under;var t=this.__self._underPool.pop();return t&&(this._underInPool=!1),this._under=t||this._createUnder()},_attachUnder:function(){var t=this._under=this._getUnder();t.attr("class",this._underClassAttr),this.hasMod(t,"type","paranja")?t.detach().insertBefore(this.domElem):t.prependTo(this.domElem)},_detachUnder:function(){var t=this._under;this.__self._underPool.push(t.detach()),this._under=null,this._underInPool=!0},destruct:function(){var t=this.__base.apply(this,arguments);return this._underInPool&&this.__self._underPool.pop(),this._under&&this._under.remove(),t}},{_underPool:[]}),BEM.DOM.decl("popup",{isDivEnough:function(){return BEM.blocks["i-global"].param("mobile")}}),BEM.DOM.decl("popup",{onSetMod:{autoclosable:{yes:function(){this._enableAutoclosable()},"":function(){this._disableAutoclosable()}}},_enableAutoclosable:function(){if(this.domElem){var t=this._under;this.hasMod(t,"type","paranja")&&(t.is("iframe")&&(t=$([t[0].contentWindow,t[0].contentWindow.document])),this.bindTo(t,"pointerclick",function(t){t.stopPropagation(),this.hide()}),this.bindTo(t,"pointerdown",function(){this._skipReturnFocus=!0})),this.bindToDoc("pointerclick",function(t){if(!this._isRelatedNode($(t.target))){var e=$.Event("outside-click");this.trigger(e,t),e.isDefaultPrevented()||this.hide()}}),this.bindToDoc("pointerdown",function(){this._skipReturnFocus=!0})}},_disableAutoclosable:function(){this.hasMod(this._under,"type","paranja")&&this.unbindFrom(this._under,"pointerclick pointerdown"),this.unbindFromDoc("pointerclick pointerdown")},_isRelatedNode:function(t){var e=this.containsDomElem(t);if(e||(e=Boolean(this._owner)&&this.containsDomElem.call({domElem:this._owner},t)),e)return!0;
var i,n=this._childs.length;for(i=0;n>i;i++)if(this.containsDomElem.call({domElem:this._childs[i].domElem},t))return!0;return!1}}),BEM.DOM.decl({block:"popup",modName:"adaptive",modVal:"yes"},{onSetMod:{adaptive:{yes:function(){this._enableAdaptive()},no:function(){this._disableAdaptive()}},"watch-scroll":{yes:function(){this._watchScroll()},no:function(){this._unwatchScroll()}}},_enableAdaptive:function(){this.afterCurrentEvent(function(){this.domElem&&this.bindToWin("resize",this.onResize)}),this._watchScroll()},_disableAdaptive:function(){this.unbindFromWin("resize")._unwatchScroll()},getScrollEvents:function(){return["scroll"]},_watchScroll:function(){this._owner&&!this.hasMod("watch-scroll","no")&&this.bindTo(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "),this.onScroll,this)},_unwatchScroll:function(){this._owner&&this.unbindFromDomElem(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "))},onResize:function(){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},onScroll:function(){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},destruct:function(){this._disableAdaptive(),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"popup",modName:"animate",modVal:"yes"},{afterShow:function(){var t=this.getCurrDirection();if(t){var e=t.to,i=this.getCurrPos(),n={opacity:1,top:i.top,left:i.left},s={opacity:0,top:i.top,left:i.left};"bottom"===e?s.top+=10:"top"===e?s.top-=10:"left"===e?s.left-=10:"right"===e&&(s.left+=10),this.domElem.stop(!0).css(s).animate(n,this.params.duration)}},beforeHide:function(t){var e=this.getCurrDirection();if(!e)return t();var i=e.to,n=this.getCurrPos(),s=this.domElem,o={top:n.top,left:n.left,opacity:0};return"bottom"===i?o.top+=10:"top"===i?o.top-=10:"left"===i?o.left-=10:"right"===i&&(o.left+=10),s.stop(!0,!0).animate(o,this.params.duration,function(){t(),s.css("opacity","")})}}),function(t){t.dom={getActiveElement:function(){try{return t(document.activeElement)}catch(e){return t()}}},t.fn.isFocused=function(){return this.is(t.dom.getActiveElement())}}(jQuery),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{addChild:function(t){this.__base.apply(this,arguments),t.setMod("watch-scroll","no")},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocusable.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._firstFocusable.focus())}}),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{getOwnerPos:function(){var t=this.__base.apply(this,arguments);if(this._owner){var e=this._viewport;t.top-=e.scrollTop(),t.left-=e.scrollLeft()}return t}}),BEM.DOM.decl("nps",{getDefaultParams:function(){return{timeout:{show:1e4,hide:5e3}}},onSetMod:{js:function(){var t,e=this.params;this.cookie=BEM.blocks["i-cookie"].get(),this.isEqual=this.hasMod("equal","yes"),e.save&&this.cookie.yp(this.hasMod("cbir","yes")?"cnps":"nps",[e.rand,e.status].join(":"),e.expires),this.isClosed()||(this.findBlocks().bindEvents(),t=this.page.getMod("type"),this.hasMod("cbir","yes")?this.isCbirPages("b-page_type_"+t)&&this.show():"search"===t?this.show():this.location.on("b-page_type_search",this.show,this))},hidden:{yes:function(){this.isClosed()||this.afterCurrentEvent(function(){this.popup.hide()})},"":function(){this.isClosed()||this.hasMod("search","yes")&&this._disable||this.hasMod("cbir","yes")&&this._disable||(this.hasMod("cbir","yes")&&this.isEqual&&this.searchPopup&&(this.searchPopup._disable=!0),this.hasMod("search","yes")&&this.isEqual&&this.cbirPopup&&(this.cbirPopup._disable=!0),this.afterCurrentEvent(function(){this.popup.show(this.popupAnchor)}))}},layout:{view:function(){this.hide()},"":function(){this.show()}}},findBlocks:function(){return this.popupAnchor=this.findBlockOutside("b-page").elem("content"),this.location=BEM.blocks.location.getInstance(),this.popup=this.findBlockOn("popup"),this.list=this.findBlockInside("radio-button"),this.button=this.findBlockInside("button"),this.question=this.elem("text"),this.page=this.findBlockOutside("b-page"),this.cbirPopup=this.page.findBlockInside({block:"nps",modName:"cbir",modVal:"yes"}),this.searchPopup=this.page.findBlockInside({block:"nps",modName:"search",modVal:"yes"}),this},bindEvents:function(){return this.button.on("click",this._onSendClick,this),this.popup.on("hide",this._onPopupHidden,this),this.list.on("change",this._onRadioChange,this),this.location.on("change",this._onPageChange,this),this},destruct:function(){this.__base.apply(this,arguments),this.button.un("click",this._onSendClick,this),this.popup.un("hide",this._onPopupHidden,this),this.list.un("change",this._onRadioChange,this),this.location.un("change",this._onPageChange,this)},_onPageChange:function(t,e){"b-page_type_search"===e.block?this.show():this.hide()},_onRadioChange:function(t,e){this.enableButton(),this.value=e},_onPopupHidden:function(){if(this.hasMod("hidden","yes"))return!1;this.hide();var t=this.getMod("type");return this.hasMod("minimized","yes")?(this.saveStatus("close"),this.hasMod("thanks","yes")||w(null,["/image/new",this.hasMod("cbir","yes")?"cbir":"serp",t,"close"].join("/"))):(this.minimizeNPS(),w(null,["/image/new",this.hasMod("cbir","yes")?"cbir":"serp",t,"small"].join("/")),this.show()),!1},_onSendClick:function(){var t=this.getMod("type");this.hasMod("minimized","yes")?(this.maximizeNPS(),this._isShown&&this.popup.repaint(),w(null,["/image/new",this.hasMod("cbir","yes")?"cbir":"serp",t,"normal"].join("/"))):(w(null,["/image/new",this.hasMod("cbir","yes")?"cbir":"serp",t,"result","p"+this.value].join("/")),this.showThanks())},hide:function(){return this.setMod("hidden","yes")},show:function(){return this.isClosed()?void 0:(this._isShown?this.delMod("hidden"):this.startPopupTimer(),this)},disableButton:function(){return this.button.delMod("focused").setMod("theme","normal").setMod("disabled","yes"),this},enableButton:function(){return this.button.setMod("theme","action").delMod("disabled"),this},initPopup:function(){var t=this.page.getMod("type");return this.hasMod("search","yes")&&"search"!==t?"":this.hasMod("cbir","yes")&&!this.isCbirPages("b-page_type_"+t)?"":(this._isShown=!0,this.hasMod("layout","view")||this.show().countShow(),void(this.hasMod("minimized","yes")?this.minimizeNPS():this.maximizeNPS()))},startPopupTimer:function(){this.location.un("b-page_type_search",this.show,this),setTimeout(this.changeThis(function(){this.initPopup(),this.popup.domElem.css({bottom:-this.domElem.height()+"px"}).animate({bottom:0})}),this.params.timeout.show)},countShow:function(){return this.params.save&&w(null,["/image/new",this.hasMod("cbir","yes")?"cbir":"serp",this.getMod("type"),"show"].join("/")),this},minimizeNPS:function(){var t=this.params.i18n;return this.setMod("minimized","yes").setButtonText(t.answer).setQuestion(t.invite).enableButton().saveStatus("min")},maximizeNPS:function(){var t=this.params.i18n;return this.setMod("minimized","no").setButtonText(t.send).setQuestion(t.question).saveStatus("max"),this.value||this.disableButton(),this},showThanks:function(){var t=this.params;this.popup.hide().setMod("animate","yes"),this.setMod(this.elem("button"),"hidden","yes").setMod("minimized","yes").setMod("thanks","yes").saveStatus("close").setQuestion(t.i18n.thankyou).show(),setTimeout(this.changeThis(this.hide),t.timeout.hide)},setQuestion:function(t){return this.question.text(t),this},setButtonText:function(t){return this.button.elem("text").text(t),this},isClosed:function(){return"close"===this.params.status},saveStatus:function(t){return this.cookie.yp(this.hasMod("cbir","yes")?"cnps":"nps",[this.params.rand,t].join(":")),this.params.status=t,this}}),BEM.DOM.decl({block:"nps",modName:"cbir",modVal:"yes"},{isCbirPages:function(t){var e=["b-page_type_search-by-image","b-page_type_similar"];return _.contains(e,t)},_onPageChange:function(t,e){this.isCbirPages(e.block)?this.show():this.hide()}}),function(){var t;BEM.decl("i-cookie",{defaultExpire:new Date+604800,getDefaultParams:function(){return{yp:{expires:new Date("Tue Jan 1 00:00:00 2038"),domain:".yandex."+BEM.blocks["i-global"].param("tld"),path:"/"}}},ypRead:function(){for(var t,e=$.cookie("yp"),i=e?e.split("#"):[],n=new Date/1e3,s={},o=0,r=i.length;r>o;o++)t=i[o].split("."),t[0]>n&&(s[t[1]]={value:t[2],expires:t[0]});return s},ypWrite:function(t){for(var e=[],i=0,n=Object.keys(t),s=n.length;s>i;i++)e.push([t[n[i]].expires,n[i],t[n[i]].value].join("."));$.cookie("yp",e.join("#"),this.params.yp)},yp:function(t,e,i){var n=this.ypRead(),s=n[t];return 1===arguments.length?s&&s.value:(s||(s={}),s.value=e,s.expires=i||s.expires||this.defaultExpires,n[t]=s,this.ypWrite(n))}},{get:function(){return t||(t=BEM.create("i-cookie"))}})}(),BEM.DOM.decl("button",{onSetMod:{js:{inited:function(){var t=this.isDisabled(),e=this.domElem;(this._href=e.attr("href"))&&t&&e.removeAttr("href")}},disabled:function(t,e){var i="yes"===e,n=this.domElem;i&&this.delMod("hovered"),this._href&&(i?n.removeAttr("href"):n.attr("href",this._href)),this.afterCurrentEvent(function(){n.attr("disabled",i)})},pressed:function(t,e){return this.isDisabled()?!1:void this.trigger("yes"===e?"press":"release")}},isDisabled:function(){return this.hasMod("disabled","yes")},url:function(t){return"undefined"==typeof t?this._href:(this._href=t,this.isDisabled()||this.domElem.attr("href",t),this)},getUrl:function(){return this.url()},setUrl:function(t){return this.url(t)},_onPointerpress:function(){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){this.isDisabled()?t.preventDefault():this.afterCurrentEvent(function(){this.trigger("click")})}},{live:function(){this.liveBindTo("pointerclick",function(t){this._onClick(t)}).liveBindTo("click",function(t){var e=this.hasMod("pseudo","yes")&&this._href;(this.isDisabled()||e)&&t.preventDefault()}).liveBindTo("pointerpress",function(t){this.isDisabled()||this._onPointerpress(t)})}}),BEM.DOM.decl("button",{onSetMod:{focused:{yes:function(){return this.isDisabled()?!1:(this.bindToWin("unload",function(){this.delMod("focused")}).bindTo("keydown",this._onKeyDown),this._isControlFocused()||this._getControl().focus(),void this.trigger("focus"))},"":function(){var t=BEM.blocks["i-ua"].opera<13;this.unbindFromWin("unload").unbindFrom("keydown"),(t||document.hasFocus())&&this._isControlFocused()&&this._getControl().blur(),this.trigger("blur")}},disabled:function(t,e){this.__base.apply(this,arguments),"yes"===e&&this.domElem.keyup()},hovered:function(t,e){return this.isDisabled()?!1:void(""===e&&this.delMod("pressed"))},pressed:function(){return this.isDisabled()||this.setMod("focused","yes"),this.__base.apply(this,arguments)}},_getControl:function(){return this.elem("control").length&&this.elem("control")||this.domElem},_isControlFocused:function(){return this.containsDomElem($.dom.getActiveElement())},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode;!this._keyDowned&&e.is(i,"ENTER","SPACE")&&(this._keyDowned=!0,this.setMod("pressed","yes").bindTo("keyup",function(){this.delMod("pressed").unbindFrom("keyup"),delete this._keyDowned,i===e.SPACE&&this.domElem.attr("href")&&(document.location=this.domElem.attr("href"))}))},destruct:function(){this.delMod("focused"),this.__base.apply(this,arguments)}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||this.toggleMod("hovered","yes","pointerover"===t.type)}).liveBindTo("focusin focusout",function(t){this.toggleMod("focused","yes","focusin"===t.type)}),8===BEM.blocks["i-ua"].ie&&this.liveBindTo("mouseup mouseout",function(){this.domElem.height()}),this.__base()}}),BEM.DOM.decl("button",{_keyDowned:!0}),BEM.DOM.decl("radiobox",{onSetMod:{js:{inited:function(){this._val=this.findElem(this.elem("radio","checked","yes"),"control").val(),this.elem("control").each(function(t,e){var i=$(e),n=this.__self._getRadioByElem(i);i.isFocused()&&this.setMod(n,"focused","yes"),i.prop("checked")&&this.setMod(n,"checked","yes")}.bind(this))}},disabled:{yes:function(){this.setMod(this.elem("radio"),"disabled","yes")},"":function(){this.delMod(this.elem("radio"),"disabled")}}},onElemSetMod:{radio:{focused:{yes:function(t){this.delMod(this.elem("radio","focused","yes"),"focused");var e=this.findElem(t,"control");e.isFocused()||e.focus(),this.afterCurrentEvent(function(){this.trigger("focus",{current:t})})},"":function(t){this.afterCurrentEvent(function(){this.trigger("blur",{prev:t})})}},checked:{yes:function(t){var e=this.elem("radio","checked","yes"),i=this.findElem(t,"control"),n=this._val;this._willSwitch=!0,this.delMod(e,"checked"),this._willSwitch=!1,i.prop("checked",!0),this._val=i.val(),this.trigger("change",{current:t,currentVal:this._val,prev:e,prevVal:n})},"":function(t){var e=this.findElem(t,"control"),i=this._val;e.prop("checked",!1),this._val=void 0,this._willSwitch||this.trigger("change",{current:$(),currentVal:void 0,prev:t,prevVal:i})}},hovered:function(t){return!this.isDisabled(t)},pressed:function(t){return!this.isDisabled(t)},disabled:function(t,e,i){t.find(this.buildSelector("control")).prop("disabled","yes"===i),"yes"===i&&this.delMod(t,"hovered").delMod(t,"pressed")}}},isDisabled:function(t){return this.hasMod(t,"disabled","yes")},val:function(t){if("undefined"==typeof t)return this._val;var e=this;return this.elem("control").each(function(i,n){return n.value===t?(e.setMod(e.__self._getRadioByElem($(n)),"checked","yes"),!1):void 0}),e},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getCurrent:function(){return this.findElem("radio","checked","yes")},uncheckAll:function(){return this.delMod(this.elem("radio","checked","yes"),"checked"),this},_onRadioEnter:function(t){this.setMod(t.data.domElem,"hovered","yes")},_onRadioLeave:function(t){this.delMod(t.data.domElem,"hovered")},_onRadioClick:function(t){this.isDisabled(t)||this.setMod(t,"focused","yes")},_onChange:function(t){this.setMod(this.__self._getRadioByElem(t.data.domElem),"checked","yes")},_onPointerpress:function(t){var e=t.data.domElem;this.setMod(e,"pressed","yes").bindToDoc("pointerrelease",function(){this.delMod(e,"pressed").unbindFromDoc("pointerrelease")})}},{live:function(){this.liveBindTo("radio","pointerclick",function(t){this._onRadioClick(t.data.domElem,t)}).liveBindTo("control","change",function(t){this._onChange(t)}).liveBindTo("radio","pointerover pointerout",function(t){t.data.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onRadioEnter(t):this._onRadioLeave(t))}).liveBindTo("control","focusin focusout",function(t){var e=this.__self._getRadioByElem(t.data.domElem);this.setMod(e,"focused","focusin"===t.type?"yes":""),BEM.blocks["i-ua"].ios>=8&&t.preventDefault()}).liveBindTo("radio","pointerpress",function(t){this.hasMod(t.data.domElem,"disabled")||this._onPointerpress(t)})},_getRadioByElem:function(t){return t.closest(this.buildSelector("radio"))}}),BEM.DOM.decl("radiobox",{_onRadioClick:function(t,e){this.__base.apply(this,arguments),this._onChange(e),e.preventDefault()}}),BEM.DOM.decl({block:"radio-button",baseBlock:"radiobox"},{onElemSetMod:{radio:{pressed:{yes:function(){this.delMod(this.elem("radio","pressed","yes"),"pressed")}}}},_onPointerPress:function(t){this._pressedRadio=t.data.domElem,this.isDisabled(this._pressedRadio)||(this.setMod(this._pressedRadio,"pressed","yes"),this.bindToDoc("pointerrelease",this._onPointerRelease))},_onPointerRelease:function(t){var e=this._pressedRadio;delete this._pressedRadio,this.delMod(e,"pressed"),this.afterCurrentEvent(function(){var i=this.findElem(e,"control");i.prop("checked")||!e.is(t.target)&&!e.find(t.target).length||i.trigger("change").focus()}),this.unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("radio","pointerpress",function(t){this._onPointerPress(t)}),this.__base()}}),BEM.DOM.decl({block:"radio-button",modName:"breadcrumbs",modVal:"yes"},{_onMouseEvent:function(t){var e=t.type,i=t.data.domElem,n=this.extractElemIndex(i),s=this.elem("radio").length;switch(e){case"mouseover":this.setElemsMod(s,"active","").setElemsMod(s,"checked","").setElemsMod(n,"hovered","yes").setMod(i,"checked","yes").setHint(this.extractHint(i)||this.params.hint);break;case"mouseout":this.selectedIndex||this.setActive(this.selectedIndex),this.setElemsMod(n,"hovered","").setElemsMod(s,"active","").setElemsMod(s,"checked","").setElemsMod(this.selectedIndex,"active","yes").setMod(this.selectedElem,"checked","yes").setHint(this.selectedElem&&this.extractHint(this.selectedElem)||this.params.hint);break;case"click":this.selectedIndex=n,this.selectedElem=i,this.setActive(n).setElemsMod(n,"hovered","").setMod(i,"checked","yes").setHint(this.extractHint(i)||this.params.hint),this.trigger("change",n)}},onElemSetMod:{radio:{checked:{yes:function(){this.delMod(this.elem("radio","checked","yes"),"checked")}}}},extractElemIndex:function(t){return this.elem("radio").index(t)+1},setElemsMod:function(t,e,i){return t&&this.setMod(this.elem("radio").slice(0,t),e,i),this},setActive:function(t){return this.setElemsMod(t,"active","yes")},setHint:function(t){return this.elem("hint").text(t||""),this},extractHint:function(t){return this.elemParams(t).hint}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("radio","click mouseover mouseout",function(t){this._onMouseEvent(t)})}}),BEM.DOM.decl("timing",{onSetMod:{js:function(){this.data={},this.visibilityState={visible:1,hidden:2,prerender:3}[this.getVisibilityState()],this.send()}},send:function(){this.getData().then(this.changeThis(function(t){this._send(this.buildCounterParams(this.normalizeMetrics(this.buildMetrics(t))))}))},_send:function(t){t&&(document.createElement("IMG").src=[this.getClickUrl(),this._serializeParams(t),"*"].join("/"))},getData:function(){var t=this._timing=(window.performance||{}).timing;if(!t||!t.navigationStart||t.navigationStart<+new Date-18e5)return $.Deferred().reject().promise();var e=this.data;return $.when.apply($,this.getDataList()).pipe(function(){return e})},buildMetrics:function(){var t=this._timing,e={1036:[t.domainLookupStart,t.navigationStart],1037:[t.domainLookupEnd,t.domainLookupStart],1038:[t.connectEnd,t.connectStart],1039:[t.responseStart,t.connectEnd],1040:[t.responseEnd,t.responseStart],1040.906:[t.responseEnd,t.domainLookupStart],1310.1309:[t.domContentLoadedEventEnd,t.domContentLoadedEventStart],1310.1007:[t.domContentLoadedEventStart,t.responseStart]},i=this.data.firstPaintTime;i&&i>0&&(e[1041]=[i,t.responseStart],e[1041.906]=[i,t.domainLookupStart]);var n=t.secureConnectionStart;n&&n>0&&(e[1383]=[t.requestStart,n]);var s=window.performance.navigation;return s&&(s.redirectCount&&(e[1384.1385]=s.redirectCount),(1==s.type||2==s.type)&&(e[770.76]=s.type)),this.visibilityState&&(e[1484]=this.visibilityState),e},normalizeMetrics:function(t){var e=this._timing.navigationStart;return $.each(t,function(i,n){if($.isArray(n)){if(n[0]<n[1]||n[1]<e)return t=!1;t[i]=n=n[0]-n[1]}return 0>n?t=!1:void 0}),t},buildCounterParams:function(t){if(t){var e=this.getCounterParams();return e.vars=$.extend(t,this.params.vars),e.vars[1042]=encodeURIComponent(navigator.userAgent),e}},getDataList:function(){if(2==this.visibilityState||3==this.visibilityState)return[];var t,e;this._timing.msFirstPaint&&(t=this._timing,e="msFirstPaint"),this.withLoadTimes(function(i){t=i,e="firstPaintTime"});var i=this,n=[];return t&&n.push(this.promiseProperty(t,e).then(function(t){"firstPaintTime"===e&&(t*=1e3),i.data.firstPaintTime=Math.floor(t)})),n},promiseProperty:function(t,e,i){var n=this.channel("sys"),s=$.Deferred(),o=function(){var n=$.isFunction(t)?t():t;return n&&n[e]?void((i?i(n[e]):n[e]>0)&&s.resolve(n[e],n)):s.reject("Property does not exist")};return n.on("tick",o),s.always(function(){n.un("tick",o)}),s.promise()},withLoadTimes:function(t){var e=(window.chrome||{}).loadTimes;return $.isFunction(e)&&t&&t.call(this,e),this},getCounterParams:function(){return{dtype:"stred",pid:1,cid:72202,path:"690.1033"}},getVisibilityState:function(){return document.visibilityState||document.webkitVisibilityState||document.msVisibilityState},getClickUrl:function(){var t=this.params.clckHost;if(!t){var e=location.hostname.match(/^(?:[-\w]+\.)*(yandex(?:.[a-z]+)+)$/i);t=(e?e[1]:"yandex.ru")+"/clck"}return"//"+t+"/click"},_flatten:function(t,e){var i=[];return e=e||"=",$.each(t,function(t,n){i.push(t+e+n)}),i},_serializeParams:function(t){var e=this;return $.each(t,function(i,n){$.isPlainObject(n)&&(t[i]=e._flatten(n).join(","))}),this._flatten(t).join("/")}}),BEM.DOM.decl("timing",{speedParams:{1036:"Время ожидания начала DNS lookup (wait)",1037:"DNS lookup (dns)",1038:"TCP handshake (tcp)",1383:"Время установки HTTPS подключения (ssl)",1039:"Время до получения первого байта (ttfb)",1040:"Время скачивания HTML (html)",1040.906:"Время от DNS Lookup до окончания скачивания HTML (html-total)",1310.1007:"Время скачивания и парсинга html (dom-loaded)",1310.1309:"Время подготовки DOM (применение стилей) DOMContentLoaded (dom-init)",1041:"Время от начала скачивания HTML до первой отрисовки (ttfp)",1041.906:"Время от DNS Lookup до первой отрисовки (ttfp-total)",628.1309:"Время инициализации блоков i-bem (js-init)","184.2046.85":"Время от начала загрузки сайта до отрисовки первого тамба (thumb-render-p0)","184.2046.93":"Время от начала загрузки сайта до отрисовки восьмого тамба (thumb-render-p8)",628.1007:"Время от navigationStart до конца инициализации JS"},restParams:{1384.1385:"Происходил ли redirect (redirect-count)",770.76:"Способ перехода на страницу (nav-type)",143:"Страница (page)",1042:"User-agent (ua)"},buildCounterParams:function(){var t=this.__base.apply(this,arguments),e=encodeURIComponent(BEM.blocks["i-global"].param("serpid")),i=encodeURIComponent(this.params.reqid);if(t)return t.reqid=i,t.serpid=e,t},getDataList:function(){var t=this.__base.apply(this,arguments);if(this._isBemProfilerEnabled()){var e=$.Deferred();setTimeout(function(){e.resolve(BEM.profiler("__total").time)},4e3),e.then(function(t){this.data.ibemInitTime=t}.bind(this)),t.push(e)}if(BEM.blocks["i-global"].getFlag("images_touch_thumb_render_speed")&&!(window.Ya.Images.thumbsRenderTimeLoaded&&window.Ya.Images.thumbsRenderTimeLoaded[7]&&window.Ya.Images.thumbsRenderTimeLoaded[0])){var i=$.Deferred();t.push(i),this.__self.win.load(i.resolve)}if(BEM.blocks["i-global"].getFlag("images_touch_count_js_load")){var n=$.Deferred();window.inNextFrame(function(){this.data.jsLoadTime=Date.now()-window.performance.timing.navigationStart,n.resolve()}.bind(this)),t.push(n)}return t},buildMetrics:function(t){var e=this.__base.apply(this,arguments);return this._isBemProfilerEnabled()&&(e[628.1309]=t.ibemInitTime),BEM.blocks["i-global"].getFlag("images_touch_thumb_render_speed")&&window.performance&&window.performance.timing&&window.Ya.Images.thumbsRenderTimeLoaded&&(e["184.2046.85"]=Math.max(window.Ya.Images.thumbsRenderTimeLoaded[0]-window.performance.timing.navigationStart,window.Ya.Images.thumbsRenderTimeInlineJs[0]-window.performance.timing.navigationStart),e["184.2046.93"]=Math.max(window.Ya.Images.thumbsRenderTimeLoaded[7]-window.performance.timing.navigationStart,window.Ya.Images.thumbsRenderTimeInlineJs[7]-window.performance.timing.navigationStart)),BEM.blocks["i-global"].getFlag("images_touch_count_js_load")&&(e[628.1007]=t.jsLoadTime),e},_isBemProfilerEnabled:function(){return _.isFunction(BEM.profiler)},_send:function(t){if(BEM.blocks["i-global"].param("counterDebug")){var e=_.cloneDeep(t).vars;console.info("RUM speed:"),console.table(_.map(e,function(t,e){return this.speedParams[e]?{Blockstat:e,"Характеристика":this.speedParams[e],"Значение, мс":t}:void 0},this)),console.info("RUM etc.:"),console.table(_.map(e,function(t,e){return this.restParams[e]?{Blockstat:e,"Характеристика":this.restParams[e],"Значение":t}:void 0},this))}this.__base.apply(this,arguments)}}),BEM.DOM.decl("ajax-perf",{errors:{UNKNOWN_ERROR:-1,SERVER_TIMEOUT:1,CLIENT_TIMEOUT:2,ABORT:3,PARSE_ERROR:4,JS_ERROR:5,HTTP_ERROR:6,HANDLED_ERROR:7},onSetMod:{js:function(){this._requests={},this._stateChange=0,this._bindEvents()}},_bindEvents:function(){var t=this;BEM.blocks.history.getInstance().on("statechange",function(){t._stateChange=+new Date}),BEM.channel("main").on("updateStart",function(){t._render=+new Date}).on("updateStop",function(){t._render&&(t._render=+new Date-t._render)}),this.bindToDoc({ajaxSend:this._onSend,ajaxError:this._onError,ajaxSuccess:this._onSuccess,ajaxComplete:this._onComplete})},_getRequestData:function(t){return this._requests[$.identify(t)]},_onSend:function(t,e,i){this.filterRequest(i)&&(this._requests[$.identify(e)]={ajaxSend:+new Date,stateChange:this._stateChange})},_onSuccess:function(t,e,i,n){if(n&&n.error){var s=this._getRequestData(e);s&&(s.ajaxError=+new Date,s.ajaxErrorType=this.errors.HANDLED_ERROR)}},_onError:function(t,e,i,n){var s=this._getRequestData(e);s&&(s.ajaxError=+new Date,s.ajaxErrorType=this._getErrorType(e,n))},_onComplete:function(t,e,i){var n=this._getRequestData(e);if(n){n.ajaxComplete=+new Date;var s=this._buildMetrics(n),o=i.url;this._hasResourceTiming()&&!n.ajaxError?this.afterCurrentEvent(function(){s=$.extend(s,this._buildMetricsForUrl(o)),this._send(s,o)}):this._send(s,o),delete this._requests[$.identify(e)]}},_getErrorType:function(t,e){var i=this.errors;if(0===t.status&&"timeout"===t.statusText)return i.SERVER_TIMEOUT;switch(e){case"timeout":return i.CLIENT_TIMEOUT;case"canceled":case"abort":return i.ABORT;case"parsererror":return i.PARSE_ERROR;default:if(e instanceof Error)return i.JS_ERROR}return 200!==t.status&&304!==t.status?i.HTTP_ERROR:i.UNKNOWN_ERROR},filterRequest:function(t){var e=BEM.blocks.uri.parse(t.url),i=e.queryParams;return 0===e.path().indexOf("/yandsearch")&&i.callback&&!(i.rpt||i.filter)},_hasResourceTiming:function(){return!window.externalHost&&window.performance&&$.isFunction(window.performance.getEntriesByName)},_buildMetrics:function(t){var e={1201.906:(t.ajaxError||t.ajaxComplete)-t.ajaxSend};return t.ajaxError&&(e["1201.1030"]=t.ajaxErrorType),t.stateChange&&(e[1201.789]=t.ajaxSend-t.stateChange),this._render&&(e["1201.1310"]=this._render,this._render=0),e},_buildMetricsForUrl:function(t){t=this._getFullUrl(t);var e,i={},n=performance.getEntriesByName(t);return n.length&&(n=n[0],e=n.domainLookupStart-n.fetchStart,n.connectEnd===n.fetchStart&&(e=n.requestStart-n.connectEnd),i={1036:e,1037:n.domainLookupEnd-n.domainLookupStart,1038:n.connectEnd-n.connectStart,1039:n.responseStart-n.connectEnd,1040:n.responseEnd-n.responseStart,1040.906:n.responseEnd-n.domainLookupStart}),i},_getFullUrl:function(t){return t.indexOf("//")<0&&(t=location.protocol+"//"+location.host+location.pathname+t),t},getClickUrl:function(){var t=this.params.clckHost;if(!t){var e=location.hostname.match(/^(?:[-\w]+\.)*(yandex(?:.[a-z]+)+)$/i);t=(e?e[1]:"yandex.ru")+"/clck"}return"//"+t+"/click"},getCounterParams:function(){return{reqid:encodeURIComponent(BEM.blocks["i-global"].param("reqid")),dtype:"stred",pid:1,cid:72202,path:"690.1201"}},buildCounterParams:function(t){var e=this.getCounterParams();return e.vars=$.extend(t,this.params.vars),e.vars[1042]=encodeURIComponent(navigator.userAgent),e},_send:function(t,e){if(t=this._normalizeMetrics(t)){t=this.buildCounterParams(t);var i=[this.getClickUrl(),this._serializeParams(t),"*"].join("/");t.vars["1201.1030"]&&(i+=encodeURIComponent(e)),document.createElement("IMG").src=i}},_normalizeMetrics:function(t){return $.each(t,function(e,i){return isNaN(i)||0>i?t=!1:void(t&&(t[e]=parseInt(i,10)))}),t},_flatten:function(t,e,i){return e=e||"=",$.map(t,function(t,i){return i+e+t}).join(i||",")},_serializeParams:function(t){t=$.extend({},t);var e=this;return $.each(t,function(i,n){$.isPlainObject(n)&&(t[i]=e._flatten(n))}),this._flatten(t,"=","/")}}),BEM.DOM.decl("ajax-perf",{_getFullUrl:function(t){return t.indexOf("//")<0&&(t=location.protocol+"//"+location.host+t),t},filterRequest:function(t){var e=t&&t.url,i=BEM.blocks.location.getInstance(),n=BEM.blocks.uri,s={url:e,path:n.getPath(n.clearHashSymbol(e)),params:n.parseParams(e)};return"b-page_type_search"===i.detectBlock(s)&&e.indexOf("serp-list_infinite_yes")>-1},buildCounterParams:function(){var t=this.__base.apply(this,arguments);return t.reqid=encodeURIComponent(this.__self._reqid),t.serpid=encodeURIComponent(BEM.blocks["i-global"].param("serpid")),t},_send:function(t){BEM.blocks.counter.debug("ajax-perf",this._normalizeMetrics(t)),this.__base.apply(this,arguments)}},{setReqid:function(t){this._reqid=t}}),BEM.DOM.decl("more",{onSetMod:{js:function(){this.__base.apply(this,arguments),this._spin=this.findBlockInside("spin2"),this._button=this.findBlockInside("button2"),this.bindEvents()},loading:{yes:function(){this.hideButton(),this._spin.setMod("progress","yes")},"":function(){this._spin.delMod("progress")}},disabled:{yes:function(){this.hideButton()}}},bindEvents:function(){return this.on("pointerclick",this._onClick),this},_onButtonClick:function(t){t.preventDefault(),this.trigger("click")},_onClick:function(){this.setMod("loading","yes")},startProgress:function(){return this.setMod("loading","yes"),this},stopProgress:function(){return this.delMod("loading"),this},show:function(){return this.delMod("hidden")},hide:function(){return this.setMod("hidden","yes")},showButton:function(){return this._spin.hasMod("progress")&&this._spin.delMod("progress"),this.delMod(this.elem("button"),"hidden"),this},hideButton:function(){return this.setMod(this.elem("button"),"hidden","yes"),this},url:function(t){return"undefined"!=typeof t?(this.elem("button").attr("href",t),this.params.url=t,this):this.elem("button").attr("href")}}),BEM.DOM.decl("more",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["serp-controller"].on("listOut",this._onListOut,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["serp-controller"].un("listOut",this._onListOut,this)},_onListOut:function(t,e){var i=this.hasMod("direction","next");"left"!==e&&"up"!==e||i||this.trigger("click"),"right"!==e&&"down"!==e||!i||this.trigger("click")},bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo("button","pointerclick",this._onButtonClick),this}}),BEM.DOM.decl("more",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["pane2-controller"].on("listOut",this._onListOut,this)}},destruct:function(){BEM.blocks["pane2-controller"].un("listOut",this._onListOut,this),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"more",modName:"direction",modVal:"next"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["i-keyrouter"].on("special:right pagedown space",this._onLoadNextPage,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["i-keyrouter"].un("special:right, pagedown space",this._onLoadNextPage,this)},_onLoadNextPage:function(){this._isEndOfPage()&&this.trigger("click")},_isEndOfPage:function(){return window.pageYOffset+window.innerHeight>=this.__self.doc.height()}}),BEM.DOM.decl({block:"more",modName:"direction",modVal:"next"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].on("scroll",this._onScroll,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("scroll",this._onScroll,this)},_onScroll:function(){if(this.hasMod("loading","yes")){var t,e=window.pageYOffset+window.innerHeight,i=this.__self.doc.height(),n=this._spin.hasMod("position","fixed"),s=160;e>i||(t=this.domElem.offset().top,e-t>=s?n||this.setSpinPosition("fixed"):n&&this.setSpinPosition(""))}},_onClick:function(){this.hasMod("last","yes")&&this.setSpinPosition(""),this.__base.apply(this,arguments)},setSpinPosition:function(t){var e="";
"fixed"===t&&(e=this.domElem.offset().left+this.domElem.width()/2),this._spin.domElem.css("left",e),this._spin.setMod("position",t)}}),BEM.DOM.decl({block:"button2",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)}},pressed:{yes:function(){return!this.hasMod("disabled","yes")}},checked:{yes:function(){this.trigger("check").domElem.attr("aria-pressed","true")},"":function(){this.trigger("uncheck").domElem.attr("aria-pressed","false")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("pressed")}},focused:{"":function(){this.__base.apply(this,arguments),this.delMod("pressed")}}},getText:function(){return this.elem("text").text()},setText:function(t){return this.elem("text").text(t),this},_onFocusin:function(){this.__base.apply(this,arguments),this.bindTo("keydown",this._onKeydown).bindTo("keyup",this._onKeyup)},_onFocusout:function(){this.__base.apply(this,arguments),this.unbindFrom("keydown keyup")},_onClick:function(t){this.trigger("click",{domEvent:t})},_onPointerpress:function(){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onKeydown:function(t){BEM.blocks.keycodes.is(t.keyCode,this.params.pressKeys)&&this.setMod("pressed","yes")},_onKeyup:function(t){BEM.blocks.keycodes.is(t.keyCode,this.params.pressKeys)&&this.delMod("pressed")},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["SPACE","ENTER"]})}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}),this.__base()}}),BEM.DOM.decl("button2",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered")}}},_onPointerenter:function(){this.setMod("hovered","yes").bindTo("pointerleave",this._onPointerleave)},_onPointerleave:function(){this.delMod("hovered").unbindFrom("pointerleave")}},{live:function(){return 8===BEM.blocks["i-ua"].ie&&this.liveBindTo("dblclick",function(t){this.hasMod("disabled")||this._onClick(t)}),this.liveBindTo("pointerover",function(t){var e=this.domElem.is(t.relatedTarget)||$.contains(this.domElem[0],t.relatedTarget);this.hasMod("disabled")||e||this._onPointerenter(t)}),this.__base()}}),BEM.DOM.decl({block:"button2",modName:"type",modVal:"link"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._url=this.params._url}},disabled:{"":function(){this.__base.apply(this,arguments),this.domElem.attr("href",this._url)},yes:function(){this.__base.apply(this,arguments),this.domElem.removeAttr("href")}}},getUrl:function(){return this._url},setUrl:function(t){return this._url=t,this.hasMod("disabled")||this.domElem.attr("href",t),this},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["ENTER"]})}}),BEM.DOM.decl({block:"button2",modName:"type",modVal:"link"},{},{live:function(){return this.liveBindTo("dragend",function(){this.hasMod("type","link")&&!this.hasMod("disabled")&&this.delMod("pressed")}),this.__base()}}),BEM.DOM.decl("serp-controller",{_viewParams:[],onSetMod:{js:function(){this.__self.instance=this,this.findBlocks()._setPageMod().syncState()},infinite:{"":function(){this.disableInfiniteLoad()}}},destruct:function(){this.__self.instance=null,this.unbindEvents(),this.__base.apply(this,arguments)},findBlocks:function(){return this.page=this.findBlockOutside("b-page"),this.header=this.page.findBlockInside("header"),this.layout=this.page.findBlockInside("page-layout"),this.footer=this.page.findBlockInside("footer"),this.location=BEM.blocks.location.getInstance(),this},bindEvents:function(){return BEM.blocks.more.on("click",this._onMoreClick,this),BEM.blocks["b-page"].on("change",this._onPageChanged,this).on("resize",this._onPageResized,this).on("contentLoaded",this._onContentLoaded,this),BEM.blocks["serp-item"].on(this.domElem,"clicked",this._onItemClicked,this),this},unbindEvents:function(){return BEM.blocks.more.un("click",this._onMoreClick,this),BEM.blocks["b-page"].un("change",this._onPageChanged).un("resize",this._onPageResized).un("contentLoaded",this._onContentLoaded),BEM.blocks["serp-item"].un(this.domElem,"clicked",this._onItemClicked,this),this},_onPageChanged:function(){this._setPageMod().syncState(),c&&BEM.blocks["ajax-perf"].setReqid(c.getReqId()),this.__base.apply(this,arguments)},_setPageMod:function(){return this.setMod("page",this.page.getMod("type")),this},_onPageResized:function(){},_onMoreClick:function(t){var e=t.block.getMod("direction");this.hasMod("loading","yes")||(this.load(e),"prev"===e&&this.location.change({url:t.block.params.url,history:!1,trigger:!1}))},syncState:function(){this.unbindEvents().bindEvents(),this.competitors=this.page.findBlockInside("competitors"),this.loadInitialItem(),this.__base.apply(this,arguments)},showFooter:function(){return this.footer&&this.footer.show(),this.toggleCompetitors(),this},toggleCompetitors:function(){return BEM.blocks["i-global"].param("isPumpkin")?this:(this.competitors&&this.competitors.domElem&&this.competitors.setMod("visibility",BEM.blocks["i-global"].param("query")?"":"hidden"),this)},hideFooter:function(t){return this.footer&&(t?this.footer.transparent():this.footer.hide()),this.competitors&&this.competitors.setMod("visibility",t?"transparent":"hidden"),this},findMore:function(t){var e="_more"+t,i=this[e];return i&&i.domElem||(this[e]=this.page.findBlockInside({block:"more",modName:"direction",modVal:t})),this[e]},checkListOut:function(t){var e=t.params.pos,i=this.changeThis(this.getStraightItem||this.getNearItem),n=i(t,1),s=Boolean(this.getItemByPos(Number(e)+5).length);return n&&s||this.trigger("listOut","right"),this},addReqId:function(t){return t&&(t.params.reqid=c.getReqId(t.domElem)||!1),this},delViewParams:function(t){return this.location.change({url:BEM.blocks.uri.delParams(location.href,t||this._viewParams),trigger:!1,history:!1}),this}},{get:function(){return this.instance}}),BEM.DOM.decl("serp-controller",{onSetMod:{loading:{yes:function(){this.trigger("loading")}},js:function(){this.__base.apply(this,arguments),this.params.cacheMore&&this.setMod("cached-more","yes"),this._setPageMod()}},syncState:function(){return this.hasMod("page","search")&&(this.relatedBottom=this.findBlockInside({block:"related",modName:"position",modVal:"bottom"})),this.__base.apply(this,arguments)},_setPageMod:function(){var t="similar"===this.page.getMod("type"),e=this._viewParams.indexOf("rpt");return t?(e>-1&&this._viewParams.splice(e,1),this.setMod("page","search")):(-1===e&&this._viewParams.push("rpt"),this.setMod("page",this.page.getMod("type")))},showFooter:function(){return this.hasMod("page","search")&&this.relatedBottom&&this.relatedBottom.show(),this.__base.apply(this,arguments)},hideFooter:function(){return this.hasMod("page","search")&&this.relatedBottom&&this.relatedBottom.hide(),this.__base.apply(this,arguments)},_getSerpList:function(){return this._serpList||(this._serpList=this.findBlockInside("serp-list"))},_getPane2Api:function(){return this._pane2api||(this._pane2api=this.findBlockInside("pane2-api"))},getScrollPagesCount:function(){return this.params.count}}),BEM.DOM.decl("serp-controller",{_req:{},destruct:function(){this._clearRequestStack(),this.__base.apply(this,arguments)},_clearRequestStack:function(){return _.forOwn(this._req,function(t){t.abort()}),this._req={},this},syncState:function(){this._clearRequestStack(),this.delMod("loading"),this.__base.apply(this,arguments)},getRequest:function(t,e){var i={url:BEM.blocks.uri.getPath(t),ctx:this,cache:!0};return _.assign(i,e),BEM.create("i-request_type_bem",i)},load:function(t,e){this._loadPage(t,e)&&this._setLoading(t)},_setLoading:function(t){return this.setMod("loading","yes").findMore(t).setMod("loading","yes")},_loadPage:function(t,e){var i=this.params[t+"PageUrl"],n=BEM.blocks.uri.getFlatParams(i);return i?(e=_.assign(e||{},{direction:t}),_.assign(n,this.__self.getUrlRequestParams()),this._sendRequest(n,e),!0):!1},_sendRequest:function(t,e){var i=this.getRequest(this.params[e.direction+"PageUrl"],e);this._req[t.p]=i,this.setRequestBlocks(i,e),i.get(t,this._onAjaxSuccess)},_onAjaxSuccess:$.noop,setRequestBlocks:function(t,e){var i=this,n=e.direction;return t.block("serp-controller",function(t){i._onSerpControllerLoaded(t,n)}).block("serp-list_infinite_yes",function(t){i._onListLoaded(t,n)}).block("more_direction_"+n,this._onMoreDataLoaded),this},_onSerpControllerLoaded:function(t,e){this.params[e+"PageUrl"]=t.params[e+"PageUrl"]},_onContentLoaded:function(){var t=this.findMore("next"),e=t&&t.params.visible;e||this.afterCurrentEvent(this.showFooter)},_onListLoaded:$.noop,_onMoreDataLoaded:function(t){var e=t.params.direction,i=this.findMore(e),n=t.params.visible;i&&(this.delMod("loading"),i.url(t.params.url).delMod("loading").setMod("disabled",n?"":"yes").setMod("hidden",n?"":"yes"),this["_onMoreDataLoaded"+e](t,i))},_onMoreDataLoadednext:function(t,e){var i=t.params.visible,n=this.getListCount()%this.params.count===0;e.setMod("last",n?"yes":"no"),this.hideFooter(),n&&i&&(this.trigger("infiniteLoadStop"),e.showButton(),this.showFooter()),i||this.showFooter()},_onMoreDataLoadedprev:function(t,e){t.params.visible&&e.showButton()}},{getUrlRequestParams:function(){return{serpid:BEM.blocks["i-global"].param("serpid")}}}),BEM.DOM.decl("serp-controller",{setRequestBlocks:function(t){return this.__base.apply(this,arguments),t.block("gallery__items:ajax",this._onGalleryLoaded),this},_onListLoaded:function(t,e){this.__base.apply(this,arguments),this._getSerpList()&&this._getSerpList().addSerpItems(t,e)},_onGalleryLoaded:function(t){window.inNextFrame(function(){this.trigger("galleryLoaded",t)},this)},_onContentLoaded:function(){this.__base.apply(this,arguments),this._serpList=void 0,this.setMod("height",this._isFullHeightAllowed()?"full":"")},_isFullHeightAllowed:function(){var t=this.hasMod("page","search"),e=this.findMore("next"),i=e&&e.params.visible;return!BEM.blocks["i-global"].param("showRelevance")&&!BEM.blocks["i-global"].param("mobile")&&t&&i}},{getUrlRequestParams:function(){var t=this.__base.apply(this,arguments);return _.assign(t,{uinfo:BEM.blocks["i-userinfo"].get().getUserInfo()})}}),BEM.DOM.decl("serp-controller",{deviation:5,itemSelector:".serp-item",getBlockByDirection:function(t){var e,i=this.getCurrentItem(),n=i&&i.params.pos;if(i)return n>=0&&"left"===t?e=this.getNearItem(i,-1):"right"===t&&(e=this.getNearItem(i,1)),e&&e.length?e.bem("serp-item"):void 0},getNearItem:function(t,e){return this.getNearItemBySibling(t,e)||this.getNearItemByIdx(t,e)||this.getNearItemByPos(t,e)},getNearItemBySibling:function(t,e){var i=t.domElem[e>0?"next":"prev"](this.itemSelector);return i.length&&i},getNearItemByPos:function(t,e){for(var i=[],n=t.params.pos,s=n;0===i.length&&Math.abs(n-s)<this.deviation;)s+=e,i=this.getItemByPos(s);return i.length&&i},getNearItemByIdx:function(t,e){var i=t.domElem.index(this.itemSelector)+e,n=i>=0?$(this.itemSelector).eq(i):$([]);return n.length&&n},getStraightItem:function(t,e){var i,n,s,o,r,a,c,h,u=t.domElem,l=u.offset(),d=0,p=0;for(0===l.left&&(u=this.getVisibleNearItem(u,-1),l=u.offset()),n=Math.floor(l.left+u.width()/2),s=l.top,o=this.getVisibleNearItem(u,e),r=o&&o.offset();o&&30>=d&&(d++,!(r.top!==s&&(s=r.top,p++,p>2)));){if(a=n-r.left,c=r.left+o.width()-n,h=Math.min(Math.abs(a),Math.abs(c)),a>=0&&c>=0||7>h){i=o;break}o=this.getVisibleNearItem(o,e),r=o&&o.offset()}return i},getVisibleNearItem:function(t,e){for(var i=this.getNearItem(t.bem("serp-item"),e);i&&i.hasClass("serp-item_extra_yes");)i=this.getNearItem(i.bem("serp-item"),e);return i},getItemByPos:function(t){return $(".serp-item_pos_"+t+":eq(0)")},getItemById:function(t){var e=$("#"+t);return e.length?e.bem("serp-item"):void 0},selectItem:function(t){return t.setMod("selected","yes"),this},getCurrentItem:function(){return BEM.blocks["serp-item"].getCurrent()},getPrevItem:function(){return BEM.blocks["serp-item"].getPrev()},selectCurrentItem:function(){var t=this.getCurrentItem();return t&&this.selectItem(t),this},unselectCurrentItem:function(){return BEM.blocks["serp-item"].delSelected(),this}}),BEM.DOM.decl("serp-controller",{getDefaultParams:function(){var t=this.__base.apply(this,arguments);return t.blinkTime=1e3,t},loadInitialItem:function(){},blinkCurrentItem:function(){var t=this.getCurrentItem(),e=this.params.isDarkParanja;return t&&(t.setMod("blink",e?"dark":"light"),setTimeout(function(){t&&t.domElem&&t.delMod("blink")},this.params.blinkTime)),this}}),BEM.DOM.decl({block:"serp-controller",modName:"infinite",modVal:"yes"},{offset:{"default":700,serp:700,view:2e3},syncState:function(){return this.__base.apply(this,arguments),this.updateInfiniteLoadState(!0),this},unbindEvents:function(){return this.__base.apply(this,arguments),this.disableInfiniteLoad(),this},enableInfiniteLoad:function(){var t=this.findMore("next");t&&t.setMod("disabled","yes"),BEM.blocks["b-page"].on("scroll resize",this.tryLoad,this)},disableInfiniteLoad:function(){var t=this.findMore("next");t&&t.delMod("disabled"),BEM.blocks["b-page"].un("scroll resize",this.tryLoad,this)},updateInfiniteLoadState:function(){this.needMore()?(new window.rafQueue).add(this.enableInfiniteLoad,this).add(this.tryLoad,this).run():(new window.rafQueue).add(this.disableInfiniteLoad,this).add(this.toggleCompetitors,this).run()},getListCount:function(){return this.findElem("list").length},_onMoreDataLoaded:function(t){this.__base.apply(this,arguments),"next"===t.params.direction&&this.updateInfiniteLoadState()},tryLoad:function(){(new window.rafQueue).add(function(){!this.hasMod("loading","yes")&&this._isEndOfPage()&&(this.disableInfiniteLoad(),this.load("next"))}.bind(this)).run()},_isEndOfPage:function(){var t,e,i=window.pageYOffset+window.innerHeight,n=this.findMore("next");return n?(t=n.domElem.offset().top,e=this.offset[this.layout.getMod("layout")||"default"],i+e>=t):!1},needMore:function(){return this.getListCount()%this.params.count!==0}}),BEM.DOM.decl({block:"serp-controller",modName:"infinite",modVal:"yes"},{getListCount:function(){var t=this._getSerpList();return t?t.getPagesCount():0},_isEndOfPage:function(){return this.page.hasMod("fullscreen","yes")?!1:this.__base.apply(this,arguments)},needMore:function(){return this.page.hasMod("fullscreen","yes")?!0:this.hasMod("page","index")?!1:this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"serp-controller",modName:"page",modVal:"index"},{syncState:function(){return this.showFooter(),this.__base.apply(this,arguments)},_onItemClicked:function(t,e){this.location.change({block:"b-page_type_search",url:e.params.detail_url},t)}}),BEM.DOM.decl({block:"serp-controller",modName:"page",modVal:"search"},{syncState:function(){return this.__self._removedThumbs&&this.__self._removedThumbs.empty(),this.__self._removedGalleryThumbs&&this.__self._removedGalleryThumbs.empty(),this.__base.apply(this,arguments)},getLastPage:function(){return this._getSerpList().getLastPageNumber()}}),BEM.DOM.decl("navigation-controller",{onSetMod:{js:function(){this.__self.instance=this,this.serp=this.findBlockOn("serp-controller"),this.page=this.findBlockOutside("b-page"),this.bindEvents()}},bindEvents:function(){},goTo:function(t,e,i){var n=this.serp.getBlockByDirection(t);return n?(n.click(i||"keyboard",t),e&&this.hasMod("scrollable","yes")&&this.scroll(t),!0):(this.serp.trigger("listOut",t),!1)}},{get:function(){return this.instance}}),BEM.DOM.decl("navigation-controller",{ROW_HEIGHT:BEM.blocks["i-global"].getFlag("thumb_size")||190,scroll:function(t){return"left"===t||"up"===t?this.tryScrollTop():("right"===t||"down"===t)&&this.tryScrollBottom(),this},tryScrollBottom:function(){var t=this.__self.win,e=t.height(),i=t.scrollTop()+e,n=this.getOffset(),s=n+this.ROW_HEIGHT,o=i-s;(o<this.ROW_HEIGHT||o>e)&&this.page.scrollTo(s+this.ROW_HEIGHT-e,200)},tryScrollTop:function(){var t=this.__self.win,e=this.getOffset(),i=this.page._headerHeight+9,n=e-t.scrollTop();(n<this.ROW_HEIGHT||n>t.height())&&this.page.scrollTo(e-this.ROW_HEIGHT-i,200)},getOffset:function(){var t=BEM.blocks["serp-item"].getCurrent();return t?t.domElem.offset().top:0}}),function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=+new Date,n=Math.max(0,16-(i-t)),s=setTimeout(function(){e(i+n)},n);return t=i+n,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.rafQueue=function(){var t=[];this.add=function(e,i){return _.isArray(e)||(e=[e]),e.forEach(function(e){var n;_.isPlainObject(e)&&(e=e.fn,n=e.ctx),t.push({fn:e,ctx:n||i})}.bind(this)),this},this.run=function(){var e,i=window.requestAnimationFrame,n=function(){0!==t.length&&(e=t.shift(),e.ctx?e.fn.call(e.ctx):e.fn(),i(n))};i(function(){i(n)})}},window.inNextFrame=function(t,e){window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){e?t.call(e):t()})})}}(),BEM.DOM.decl({block:"serp-controller",modName:"navigation",modVal:"yes"},{extraScroll:0,isInitialScrollDone:!1,findBlocks:function(){return this.navigation=this.findBlockOn("navigation-controller"),this.__base.apply(this,arguments)},bindEvents:function(){return this.params.item&&this.params.item.selected&&this.bindToWin("load scroll",this.initialScroll),this.__base.apply(this,arguments)},initialScroll:function(){this.isInitialScrollDone||this.initialScrollToSelected(),this.unbindFromWin("load scroll",this.initialScroll),this.location.un("b-page_type_search",this.initialScroll,this),this.isInitialScrollDone=!0},needScrollTo:function(t){return _.isFunction(this.isViewLayout)&&this.isViewLayout()||t.offset().top>.7*this.__self.win.height()},initialScrollToSelected:function(){var t,e,i=this.getCurrentItem();i&&(t=i.domElem,e=this.needScrollTo(t)?t:this.__self.win.scrollTop(),this.page.scrollTo(e,950,this.extraScroll))}}),BEM.DOM.decl({block:"serp-controller",modName:"navigation",modVal:"yes"},{extraScroll:150,initialScroll:function(){"wiz"===BEM.blocks.uri.getParamValue("source")&&(this.isInitialScrollDone=!0),this._getPane2Api().isOpened&&(this.isInitialScrollDone=!0),this.__base.apply(this,arguments)},needMore:function(){return this.hasMod("page","search-by-image")?!0:this.__base.apply(this,arguments)}}),BEM.DOM.decl("serp-controller",{bindEvents:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].on("scroll",this._onScroll,this),this._enablePointerEventsDebounced=$.debounce(this._enablePointerEvents,300,this)},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("scroll",this._onScroll,this)},_needPointerEventsSwitching:function(){return!BEM.blocks["i-global"].param("mobile")&&BEM.blocks["i-ua"].isPointerEventsAvailable()},_onScroll:function(){this._needPointerEventsSwitching()&&(this.hasMod(this._getContent(),"pointer-events","none")||this._disablePointerEvents(),this._enablePointerEventsDebounced())},_disablePointerEvents:function(){this.setMod(this._getContent(),"pointer-events","none")},_enablePointerEvents:function(){this.delMod(this._getContent(),"pointer-events")},_getContent:function(){return this._content||(this._content=this.findElem("content"))},_onPageChanged:function(){this.__base.apply(this,arguments),this._content=void 0}}),BEM.DOM.decl("serp-controller",{delayRemoveUinfo:3e3,onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.uri.parseParams().uinfo&&(BEM.blocks["i-ua"].ie>=10?setTimeout(this.removeParams.bind(this),this.delayRemoveUinfo):this.removeParams())}},removeParams:function(){this.delViewParams("uinfo")}}),BEM.DOM.decl("serp-controller",{syncState:function(){return this.params.hoverTime>0&&(clearInterval(this._sendHoverInterval),this._sendHoverInterval=setInterval(this.sendHoverStats.bind(this),this.params.hoverTime)),this.__base.apply(this,arguments)},sendHoverStats:function(){_.isEmpty(BEM.blocks["serp-item"].hovered)||(c.hit({dtype:"iweb",path:"/image/new/serp/hover",serpid:BEM.blocks["i-global"].param("serpid"),vars:"858,-info="+JSON.stringify(BEM.blocks["serp-item"].hovered)}),BEM.blocks["serp-item"].hovered={})}}),BEM.DOM.decl("serp-controller",{bindEvents:function(){return BEM.blocks["pane2-api"].on("pane:close",this._onPane2Close,this),this.__base.apply(this,arguments)},unbindEvents:function(){return BEM.blocks["pane2-api"].un("pane:close",this._onPane2Close,this),this.__base.apply(this,arguments)},_onPane2Close:function(){this.unselectCurrentItem(),this.blinkCurrentItem()}}),BEM.DOM.decl({block:"serp-controller",modName:"page",modVal:"search-by-image"},{_nextDupsUrlChanged:!1,_onMoreClick:function(){this.load()},_onOtherSitesLoaded:function(t){this.findBlockInside("other-sites").loadSites(t),"undefined"==typeof this._pagesCount&&(this._pagesCount=0),this._pagesCount++},_onMoreDataLoaded:function(t){var e=!(t.params.visible&&this.params.nextPageUrl||this._nextDupsUrlChanged);e&&this.params.nextPageUrlCBIR&&(t.params.visible=!0,this._nextDupsUrlChanged=!0,this.params.nextPageUrl=this.params.nextPageUrlCBIR),this.__base.apply(this,arguments)},needMore:function(){return 2!==this._pagesCount?this.__base.apply(this,arguments):!1},syncState:function(){this._pagesCount=0,this.__base.apply(this,arguments);var t=this.findBlockInside("navigation");"search-by-image"===this.getMod("page")&&t&&t.reflow(),this._nextDupsUrlChanged=!1,this.delMod("loading")},load:function(){var t,e=this.params.nextPageUrl;return e||this._nextDupsUrlChanged||(this._nextDupsUrlChanged=!0,e=this.params.nextPageUrl=this.params.nextPageUrlCBIR),e?(this._setLoading("next"),t=this.getRequest(e).block("other-sites__items",this._onOtherSitesLoaded).block("serp-controller",function(t){this.params.nextPageUrl=t.params.nextPageUrl}).block("more_direction_next",this._onMoreDataLoaded),t.get(BEM.blocks["i-url-controller"].mergePassedUrlParams(BEM.blocks["serp-controller"].getUrlRequestParams(),BEM.blocks.uri.getFlatParams(e))),this):void 0}}),BEM.DOM.decl({block:"serp-controller",modName:"prefetch",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),"search"===BEM.blocks["i-global"].param("page")&&this._loadPage("next",{cacheRequest:!0})}},_clearRequestStack:function(){return _.forOwn(this._req,function(t){t.reject()}),this._req={},this},setRequestBlocks:function(t,e){return e.cacheRequest?(t.block("serp-controller",$.noop).block("serp-list_infinite_yes",$.noop).block("more_direction_"+e.direction,$.noop).block("gallery__items:ajax",$.noop),this):this.__base.apply(this,arguments)},_onSerpControllerLoaded:function(t,e){this.__base.apply(this,[t,e]),this._loadPage(e,{cacheRequest:!0})},_loadPage:function(t,e){var i=this.params[t+"PageUrl"],n=BEM.blocks.uri.getFlatParams(i),s=n.p;if(!i)return!1;if(e=_.assign(e||{},{direction:t}),_.assign(n,this.__self.getUrlRequestParams(e.direction)),this._req[s]&&e&&e.cacheRequest)return!0;if(this._req[s]){var o=this;return this._req[s].done(function(){return o._sendRequest(n,e)}),!0}return this._sendRequest(n,e),!0},_sendRequest:function(t,e){var i=$.Deferred(),n=this.getRequest(this.params[e.direction+"PageUrl"],e);this._req[t.p]=i,this.setRequestBlocks(n,e),n.get(t,this._onAjaxSuccess.bind(this,i))},_onAjaxSuccess:function(t){t.resolve&&t.resolve()}}),BEM.DOM.decl({block:"serp-controller",modName:"height",modVal:"full"},{onSetMod:{height:{"":function(){this._removeEmptySpace()}}},_emptySpaceAdded:!1,_addSpace:function(){var t=this._getSerpList();if(t){var e=t.domElem.height()/t.getPagesCount(),i=t.getCurrentPageNumber(),n=t.getLastPageNumber()-i,s=Math.min(n,this.params.count);0!==i&&s--,this.layout.setHeight(this.layout.getHeight()+e*s)}},enableInfiniteLoad:function(){this.__base.apply(this,arguments),!this._emptySpaceAdded&&this._isFullHeightAllowed()&&(window.inNextFrame(this._addSpace,this),this._emptySpaceAdded=!0)},disableInfiniteLoad:function(){this.__base.apply(this,arguments),this.needMore()&&this._getSerpList()&&!this._getSerpList().isCurrentPageLast()||this._removeEmptySpace()},_removeEmptySpace:function(){this.layout.setDefaultHeight(),this._emptySpaceAdded=!1}}),BEM.DOM.decl("serp-list",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["ajax-perf"].setReqid(this.params.reqid)}}}),BEM.DOM.decl("serp-list",{onSetMod:{js:function(){this.totalPages=1,this.thumbRows=[],this.justifier=BEM.blocks.justifier,window.Ya.Images.thumbRows&&!this.isCurrentPageLast()?this.setThumbRows(window.Ya.Images.thumbRows):this.fitAllItems(),window.Ya.Images.thumbRows&&delete window.Ya.Images.thumbRows,this._removeDuplicates(this.domElem),this._countLoadedRows(),BEM.blocks["b-page"].on("resize",this._onPageResize,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("resize",this._onPageResize,this)},addSerpItems:function(t,e){this.params.pageNum=t.params.pageNum,this.params.lastPage=t.params.lastPage;var i=$(t.html),n=this.getLastRowItems();return this.thumbRows.pop(),this._removeDuplicates(i),"next"===e?(this.fitAddedItems(i.prepend(n)),BEM.DOM.append(this.domElem,i.contents())):(BEM.DOM.prepend(this.domElem,i.contents()),this.fitAllItems()),this.onPageAfterAlign(),this},appendIncutElem:function(t){return this.domElem.append(t),this},prependIncutElem:function(t){return this.domElem.prepend(t),this}},{getUrls:function(){return _($(".serp-item_type_search")).map(function(t){return BEM.blocks["serp-item"].getUrls($(t))}).flatten().value()}}),BEM.DOM.decl("serp-item",{onSetMod:{selected:{yes:function(){this.delMod("hovered"),this.__self.delSelected()}}},saveCurrent:function(){return this.__self.prev=this.__self.getCurrent(),this.__self.setCurrent(this),this}},{getCurrent:function(){return this.current&&!this.current._isDestructing?this.current:void 0},getPrev:function(){return this.prev&&!this.prev._isDestructing?this.prev:void 0},setCurrent:function(t){this.current=t},clearCurrent:function(){this.setCurrent(null)},delSelected:function(){return this.getCurrent()&&this.getCurrent().delMod("selected"),this},current:null,prev:null}),BEM.DOM.decl("serp-item",{onSetMod:{js:function(){BEM.blocks["i-ua"].ie<=8&&window.focus(),BEM.blocks["i-global"].param("mobile")||this.bindTo("mousemove",this._onMouseMove).bindTo("mouseleave",this._onMouseLeave)},hovered:{yes:function(){return this.canHover()}}},canHover:function(){return!this.hasMod("selected","yes")},_onClick:function(t){BEM.blocks["i-global"].param("isPumpkin")&&"index"===BEM.blocks["i-global"].param("page")||(this.click("mouse"),t.preventDefault())},_onMouseMove:function(){this.setMod("hovered","yes")},_onMouseLeave:function(){this.delMod("hovered")},click:function(t,e){return this.eventSource=t,this.eventParams=e,this.setMod("selected","yes").saveCurrent().trigger("clicked",this),this}},{live:function(){this.__base.apply(this,arguments),this.liveInitOnEvent("mousemove")},getParams:function(t){var e=$("#"+t).data("bem");return e?e["serp-item"]:void 0}}),BEM.DOM.decl("serp-item",{_hoverTimer:null,_onMouseMove:function(){if(null===this.__self.hoverStartTime&&(this.__self.hoverStartTime=Date.now()),!this.hasMod("hovered","yes")&&!this._hoverTimer){var t=BEM.blocks["i-global"].param("lags"),e=t&&t.show,i=this.__base,n=arguments;e?this._hoverTimer=setTimeout(function(){i.apply(this,n)}.bind(this),e):i.apply(this,n)}},_onMouseLeave:function(){if(this.__base.apply(this,arguments),this.__self.hoverStartTime){var t=Number(this.getMod("pos"));this.__self.hovered[t]=(this.__self.hovered[t]||0)+Date.now()-this.__self.hoverStartTime,this.__self.hoverStartTime=null}clearTimeout(this._hoverTimer),this._hoverTimer=null},click:function(){var t=BEM.blocks["i-global"].param("lags"),e=t&&t.show,i=this.__base,n=arguments;e?setTimeout(function(){i.apply(this,n)}.bind(this),e):i.apply(this,n)},_onClick:function(){this.__base.apply(this,arguments),this.sendClickCounter()},sendClickCounter:function(){return c.hitDelayed({dtype:"iweb",path:"/image/new/serp/results/"+this.params.counterPath,pos:this.params.pos,reqid:this.params.reqid},{href:this.params.img_href}),this}},{hovered:{},hoverStartTime:null,getUrls:function(t){var e=t.params||t.data("bem")["serp-item"],i=[e.img_href,e.preview[0].url],n=_.clone(e.dups);return n.push.apply(n,e.preview),_(n).map(function(t){i.push(t.url)}),_.uniq(i)}}),BEM.DOM.decl("complain",{},{live:function(){this.liveInitOnEvent("click keypress"),this.liveBindTo("keypress",function(t){13===t.which&&this.trigger("click")},this),this.liveBindTo("pointerclick",function(){this.trigger("click")},this)}}),function(){var t=12,e=150;BEM.DOM.decl({block:"serp-item",modName:"type",modVal:"search"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.complain.on(this.domElem,"click",this._onComplainClick,this)},hovered:{yes:function(){if(this.__base.apply(this,arguments)===!1)return!1;var i=this.domElem,n=this.findElem("snippet"),s=Math.max(i.width(),e);n.css({paddingTop:i.height()+t,width:s}),0!==i.position().left&&n.css("margin-left",this._calculateMargin(s,i))}},blink:function(t,e){this.__self.canUseCSSAnimation||("light"===e?this.domElem.css("opacity","0.2"):this.domElem.animate({opacity:"1"},{duration:500}))},selected:{yes:function(){this.__base.apply(this,arguments),this.trigger("viewed")}}},destruct:function(){BEM.blocks.complain.un(this.domElem,"click",this._onComplainClick,this),this.__base.apply(this,arguments)},_onComplainClick:function(){BEM.blocks.feedback.showPopup(this)},_calculateMargin:function(e,i){return BEM.blocks["i-global"].getFlag("images_no_left_nav")&&this._isFirstImageInRow(i,i.prev())?-t:this._calculateMarginWithDivider(e,i,i.next())},_calculateMarginWithDivider:function(e,i,n){var s=i.width(),o=this._isLastImageInRow(e,i,n)?1:2;return-Math.floor(t+(e-s)/o)},canHover:function(){return this.__base.apply(this,arguments)&&!BEM.blocks["i-global"].getFlag("imgs_no_polaroid")},_isLastImageInRow:function(e,i,n){var s=i.offset(),o=!(n.length&&s.top===n.offset().top),r=s.left+e+t>this.__self.doc.width();return o&&r},_isFirstImageInRow:function(t,e){return!e.length||t.offset().top!==e.offset().top}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("link","pointerclick",function(t){return t.stopPropagation(),2===t.which||t.metaKey||t.ctrlKey?!0:void this._onClick(t)}),this.canUseCSSAnimation=BEM.blocks["i-ua"].canUseCSSAnimation()}})}(),BEM.DOM.decl("serp-mark",{onSetMod:{js:function(){this.findBlocks().bindEvents().setState(),this.parentItem.hasMod("selected","yes")&&this._onViewed(this.params.parentId)}},findBlocks:function(){return this.localStorage=BEM.blocks.localstorage.getInstance(),this.popup=this.findBlockInside("popup"),this.parentItem=this.findBlockOutside("serp-item"),this},bindEvents:function(){return this.parentItem.on("viewed",this._onViewed,this),this.afterCurrentEvent(function(){this.bindTo("mouseover mouseout",this._onMouseMove,this)}),this},destruct:function(){this.__base.apply(this,arguments),this.parentItem.un("viewed",this._onViewed,this)},_onViewed:function(){var t=this.localStorage.get("_viewedImages")||{},e=_.size(t);this.setContent(BEM.I18N("serp-mark","Просмотрено только что")).show(),e>=2e3&&(t=this.truncateViewList(t,1900)),t[this.params.parentId]=Number(new Date),this.localStorage.set("_viewedImages",t)},truncateViewList:function(t,e){var i=_.takeRight(_.sortBy(t),e);return _.transform(t,function(t,e,n){-1!==_.indexOf(i,e)&&(t[n]=e)})},_onMouseMove:function(t){"mouseover"===t.type?this.popup.show(this.domElem):this.popup.hide()},setState:function(){var t=this.localStorage.get("_viewedImages"),e=this.params.parentId;_.has(t,e)?this.pickMessage(t[e]):this.setContent(BEM.I18N("serp-mark","Просмотрено только что"))},pickMessage:function(t){var e,i=new Date,n=this.calculateAge(t,i),s={0:BEM.I18N("serp-mark","Просмотрено сегодня"),1:BEM.I18N("serp-mark","Просмотрено вчера"),2:BEM.I18N("serp-mark","Просмотрено позавчера"),7:BEM.I18N("serp-mark","Просмотрено неделю назад"),14:BEM.I18N("serp-mark","Просмотрено 2 недели назад")},o={1:BEM.I18N("serp-mark","Просмотрено в понедельник"),2:BEM.I18N("serp-mark","Просмотрено во вторник"),3:BEM.I18N("serp-mark","Просмотрено в среду"),4:BEM.I18N("serp-mark","Просмотрено в четверг"),5:BEM.I18N("serp-mark","Просмотрено в пятницу"),6:BEM.I18N("serp-mark","Просмотрено в субботу"),7:BEM.I18N("serp-mark","Просмотрено в воскресенье")};
s[n]&&(e=(i-t)/1e3>600?s[n]:BEM.I18N("serp-mark","Просмотрено только что")),n>2&&7>n&&(e=o[this.getWeekDay(n,i)]),n>7&&14>n?e=BEM.I18N("serp-mark","Просмотрено больше недели назад"):n>14&&21>n?e=BEM.I18N("serp-mark","Просмотрено больше 2 недель назад"):n>=21&&29>n?e=BEM.I18N("serp-mark","Просмотрено больше 3 недель назад"):n>=29&&40>n&&(e=BEM.I18N("serp-mark","Просмотрено месяц назад")),n>=40&&(e=BEM.I18N("serp-mark","Просмотрено давно")),this.setContent(e).show()},calculateAge:function(t,e){var i=(e-t)/1e3,n=Math.floor(i/86400),s=Math.floor(i%86400),o=3600*e.getHours()+60*e.getMinutes()+e.getSeconds();return s>o&&n++,n},getWeekDay:function(t,e){var i=e.getDay()-t;return 1>i?7+i:i},setContent:function(t){return this.popup.elem("content").text(t),this},show:function(){this.setMod("visible","yes")}}),BEM.decl("localstorage",{onSetMod:{js:{inited:function(){this._service=BEM.blocks["i-global"].param("id"),this._enabled=!1;try{if("localStorage"in window){var t="test"+Number(new Date);localStorage.setItem(t,t),localStorage.removeItem(t),this._enabled=!0,this._convertDeprecatedData()}}catch(e){}}}},_convertDeprecatedData:function(){var t=JSON.parse(localStorage.getItem(this._service));t&&(_.forOwn(t,function(t,e){this.set(e,t)},this),localStorage.removeItem(this._service))},get:function(t,e){var i;try{if(this._enabled)return i=localStorage.getItem(this._getItemName(t)),null!==i||"undefined"==typeof e?JSON.parse(i):e}catch(n){}return e||null},set:function(t,e){try{if(this._enabled)return localStorage.setItem(this._getItemName(t),JSON.stringify(e)),!0}catch(i){}return!1},del:function(t){try{this._enabled&&localStorage.removeItem(this._getItemName(t))}catch(e){}},_getItemName:function(t){return this._service+"."+t}},{getInstance:function(){return this.instance||(this.instance=BEM.create("localstorage"))}}),BEM.DOM.decl({block:"serp-list",modName:"rum",modVal:"yes"},{_loadedThumbs:{},_serpItemImgSelector:".serp-item__thumb",_rumThumbCounterPath:void 0,onSetMod:{js:function(){this.MAX_RESULTS=450,this.__base.apply(this,arguments),this._isResourceTimingAPIAvaliable()&&this.setupSpeedTest()}},_isResourceTimingAPIAvaliable:function(){return window.performance&&(window.performance.getEntries||window.performance.webkitGetEntries)},setupSpeedTest:function(){var t=window.performance,e=t.setResourceTimingBufferSize?"setResourceTimingBufferSize":"webkitSetResourceTimingBufferSize";return t[e]&&t[e](this.MAX_RESULTS),this},bindToImages:function(t){var e=t.length,i=function(){--e||this.allImagesLoadedHandler(t)}.bind(this);return t.each(function(){return this.complete?void i():void $(this).bind("load",i)}),this},getEntriesName:function(){return window.performance.getEntries?"getEntries":"webkitGetEntries"},getImagesTimings:function(t){for(var e,i,n,s,o,r,a,c=this.getEntriesName(),h=window.performance[c](),u=BEM.blocks["i-ua"].getConnectionType(),l=[],d=0,p=h.length;p>d;d++)r=h[d],a=r.name,t[a]&&!this._loadedThumbs[a]&&(s=-1!==a.indexOf("http://")?"http":"https",n=a.replace(".yandex.net","").replace(s+"://","").split("/"),o=r.startTime,i=r.responseStart||o,e=[Math.floor(o),Math.floor(r.redirectEnd-r.redirectStart),Math.floor(r.domainLookupEnd-r.domainLookupStart),Math.max(Math.floor(r.domainLookupStart-r.fetchStart),0),Math.floor(r.connectEnd-(r.secureConnectionStart||r.connectStart)),Math.floor(r.responseStart-r.requestStart),Math.floor(r.responseEnd-i),Math.floor(r.duration),s,encodeURIComponent(n[0]),encodeURIComponent(n[1])],u&&e.push(u),l.push(e.join(";")),this._loadedThumbs[a]=e);return l},allImagesLoadedHandler:function(t){var e,i,n={};t.each(function(){i=this.src,/^https?\:/.test(i)||(i=window.location.protocol+i),n[this.src]=1}),e=this.getImagesTimings(n),e.length&&this.sendStats(e)},sendStats:function(t){var e=window.location.protocol+"//yandex.ru/clck/click/dtype=iweb/path="+this._rumThumbCounterPath+"/serpid="+BEM.blocks["i-global"].param("serpid")+"/vars=1045,-info="+t.join("!")+"/*"+encodeURIComponent(location.href);(new Image).src=e,BEM.blocks.counter.debug("thumbs load timings",e)}}),BEM.DOM.decl({block:"serp-list",modName:"rum",modVal:"yes"},{_rumThumbCounterPath:"8.228.1045",onPageAfterAlign:function(){this.__base.apply(this,arguments),this.bindToImages(this.domElem.find(this._serpItemImgSelector))}}),BEM.DOM.decl({block:"serp-list",modName:"unique",modVal:"yes"},{_removeDuplicates:function(t){this._uniqIds||(this._uniqIds={});var e=this._uniqIds;_.forEach(t.find(".serp-item"),function(t){e[t.id]?$(t).remove():e[t.id]=!0})}}),BEM.DOM.decl("serp-list",{_isLastPageHasBeenLoaded:!1,_onPageResize:function(){this._resetContainerWidth().fitAllItems()},fitAllItems:function(){return this.hasMod("justifier","yes")&&this.setThumbRows(this.justifier.fitImages({container:this.domElem[0],containerWidth:this._getContainerWidth(),showDangling:this.isLastPageHasBeenLoaded()})),this},fitAddedItems:function(t){return this.addThumbRows(this.justifier.fitImages({container:t.get(0),containerWidth:this._getContainerWidth(),showDangling:this.isCurrentPageLast()})),this},onPageAfterAlign:function(){this.totalPages++,this.trigger("loaded",{serpList:this,totalPages:this.totalPages}),this.__base.apply(this,arguments)},_countLoadedRows:function(){var t="-info="+_.pluck(this.thumbRows,"length").join("-"),e=BEM.blocks["i-userinfo"].get().getWindowSize(),i="-viewport-size="+e.width+";"+e.height;c.cpHitDelayed({pid:40,cid:72687,path:"image.new.serp.list.loaded",vars:"1341,"+t+","+i})},setThumbRows:function(t){this.thumbRows=t},addThumbRows:function(t){this.thumbRows=this.thumbRows.concat(t)},_getContainerWidth:function(){return this._containerWidth||(this._containerWidth=this.domElem.parent().width()),this._containerWidth},_resetContainerWidth:function(){return delete this._containerWidth,this},getLastThumbOfRow:function(t){return $(document.getElementById(_.last(this.thumbRows[t])))},getPenultRowNum:function(){var t=this.isRowVisible(this.thumbRows.length-1);return t?this.thumbRows.length-2:this.thumbRows.length-3},isRowVisible:function(t){return"inline-block"===this.getLastThumbOfRow(t).css("display")},getLastRowItems:function(){return _.map(_.last(this.thumbRows),function(t){return document.getElementById(t)})},getThumbRow:function(t){for(var e,i=0,n=0;n<this.thumbRows.length;n++)for(e=0;e<this.thumbRows[n].length;e++)if(i++,i===t)return n},getPagesCount:function(){return this.totalPages},getCurrentPageNumber:function(){return this.params.pageNum},getLastPageNumber:function(){return this.params.lastPage},getIds:function(){return _.flatten(this.thumbRows)},isLastPageHasBeenLoaded:function(){return this.isCurrentPageLast()&&(this._isLastPageHasBeenLoaded=!0),this._isLastPageHasBeenLoaded},isCurrentPageLast:function(){return this.params.pageNum===this.params.lastPage}}),BEM.DOM.decl("fluider",{rowsThumbsCount:[],onSetMod:{js:function(){this.__self._instances.push(this),BEM.blocks["b-page"].on("resize",this._onPageResize,this),BEM.blocks["serp-controller"].on("align",this._onPageAlign,this),this.hasMod("similar","yes")||this.setMargin(),this.afterCurrentEvent(this.align)}},getDefaultParams:function(){return{minItemWidth:75,maxLineWidth:750,forceRowTruncate:!1}},destruct:function(){BEM.blocks["b-page"].un("resize",this._onPageResize,this),BEM.blocks["serp-controller"].un("align",this._onPageAlign,this),this.__base.apply(this,arguments)},_onPageResize:function(){this._aligned=!1,!this._progress&&this.isEnabled()&&(this._progress=!0,this.align(),this._progress=!1)},_onPageAlign:function(){this._aligned||this._onPageResize()},setMargin:function(){this.params.margin||(this.params.margin=8)},getCurrentItem:function(){return this.items.eq(this.currentItem)},getItems:function(){return this.items||(this.items=this.elem("item")),this},align:function(){return this.trigger("align"),this.isEnabled()?(this.getItems().processAlign(),this._aligned=!0,this.trigger("aligned"),this):this},processAlign:function(){return this.getMaxWidth().buildMatrix(),this},getMaxWidth:function(){return this.maxWidth=this.domElem.width()||this.params.maxLineWidth,this},buildMatrix:function(){var t=[];for(this.listLength=this.items.length,this.currentItem=0;this.currentItem<this.listLength;)t.push(this.buildRow());return this.rowsThumbsCount=_.map(t,function(t){return t.items.length}),this},buildRow:function(){var t=this.createRow();return this.tryTruncateRow(t),t},getRowsThumbsCount:function(t){return this.rowsThumbsCount.slice(0,t).join("-")},createRow:function(){for(var t={items:[],width:0};!this.isEnoughItems(t);)this.pushCurrentItem(t);return t.width+=this.params.margin,t},isEnoughItems:function(t){return this.currentItem>=this.listLength||t.width>=this.maxWidth},pushCurrentItem:function(t){var e=this.getCurrentItem();this.currentItem++,e.hasClass("serp-item_extra_yes")||(t.width+=this.params.margin,t.width+=Math.max(this.getThumbWidth(e),this.params.minItemWidth),t.items.push(e))},tryTruncateRow:function(t){var e=t.width-this.maxWidth;(t.items.length&&e>0||this.params.forceRowTruncate)&&this.truncateRow(t.items,this.getRowOverage(t,e))},truncateRow:function(t,e){for(var i=0,n=t.length;n>i;i++)this.truncateAndCenterItem(t[i],e[i]>0?e[i]:0)},truncateAndCenterItem:function(t,e){this.truncateItem(t,e).centerThumb(t,e)},getRowOverage:function(t,e){var i=this.getOverage(t,e),n=i.overage,s=i.width,o=i.cut;return this.getExtraOverage(o,e,s,n)},getOverage:function(t,e){var i,n=[],s=[],o=0,r=t.items.length;for(i=0;r>i;i++)s[i]=this.getThumbWidth(t.items[i]),n[i]=Math.floor(s[i]/t.width*e),s[i]-n[i]<this.params.minItemWidth&&(n[i]=Math.max(s[i]-this.params.minItemWidth,0)),o+=n[i];return{overage:n,width:s,cut:o}},getExtraOverage:function(t,e,i,n){for(var s=e-t,o=n.length;s>0&&!this.isThumbsSmall(i,n);)for(var r=0;o>r&&(i[r]-n[r]>this.params.minItemWidth&&(s--,n[r]+=1),!(0>=s||this.isThumbsSmall(i,n)));r++);return n},isEnabled:function(){return this.__self.enabled},getItemIndex:function(t){return this.items.index(t)},getItemThumb:function(t){var e=this.getItemIndex(t);return this.thumbs||(this.thumbs=[]),this.thumbs[e]||(this.thumbs[e]=t.find("img:first"))},getThumbWidth:function(t){var e=this.getItemIndex(t);return this.thumbsWidths||(this.thumbsWidths=[]),this.thumbsWidths[e]||(this.thumbsWidths[e]=this.getItemThumb(t).width())},getItemWidth:function(t){return t.width()},truncateItem:function(t,e){return t.width(this.getThumbWidth(t,!0)-e),this},centerThumb:function(t,e){return e||(e=this.getThumbWidth(t,!0)-this.getItemWidth(t)),this.getItemThumb(t).css("margin-left",-Math.floor(e/2)),this},isThumbsSmall:function(t,e){return _.all(t,function(i,n){return t[n]-e[n]<=this.params.minItemWidth},this)}},{enabled:!0,_instances:[],align:function(){this._instances.forEach(function(t){t.align()})}}),BEM.decl("justifier",{},{fitImages:function(t){return window.Ya.Images.fitImages(t)}}),BEM.DOM.decl("b-501px",{getDefaultParams:function(){return{preloadCount:3,imagesCount:7,popupTimeout:300,_lineHeight:17}},onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlocks().bindEvents().fillData().countImageShow()._onResize(),this.params.hasNext||this.setDownloadText().setDownloadURL();var t=Date.now()+String(Math.random()).slice(-6);(new Image).src="https://awaps.yandex.ru/0/c2/TLZuSw11mBxNobY4Vjb5LcE0T4kGYqIsttovhSxae8EoDKjCBVYg17NOpG4CcvHLOYxhnrIWUFwbKFFscHA=.gif?random="+t}},findBlocks:function(){return this.page=this.findBlockOutside("b-page"),this._indexPage=BEM.blocks["i-global"].param("router").index,this.slider=this.findBlockInside("b-501px-slider"),this._description=this.elem("description"),this},bindEvents:function(){return BEM.blocks.button.on(this.elem("download"),"click",this._onDownloadClick,this).on(this.elem("adv"),"click",this._onAdvButtonClick,this),BEM.blocks["b-page"].on("resize",this._onResize,this),this.bindTo("back","pointerclick",this._onBackClick),this.bindTo("info-button","pointerclick",this._countCaptionAuthorOpen),this.on("download",this._onDownload).bindTo("download","mousedown",this._onDownloadMousedown).bindTo("download-me","mousedown",this._onDownloadMousedown).bindTo("download-me","touchstart",function(){this._tapTimer=setTimeout(this._onLongTap.bind(this),400)}).bindTo("download-me","touchend",function(){clearTimeout(this._tapTimer)}),this},destruct:function(){BEM.blocks.button.un(this.elem("download"),"click",this._onDownloadClick,this).un(this.elem("adv"),"click",this._onAdvButtonClick,this),BEM.blocks["b-page"].un("resize",this._onResize,this),this.__base.apply(this,arguments)},getDownloadButton:function(){return this._downloadButton||(this._downloadButton=this.findBlockInside("right","button"))},_onDownload:function(){this._hasDownloadSRC||this.setDownloadSRC()},_onDownloadMousedown:function(t){2===t.button&&this.trigger("download")},_onBackClick:function(){this.moveToToday()},_onLongTap:function(){this.trigger("download")},getAppropriateSize:function(){var t=BEM.blocks["i-userinfo"].get(),e=_.map(this._today.sizes,function(e){return e.ratio=t.getRatio(e),e});return t.findAppropriateResolution(t.extendedScreenSize(),e)},makeDownloadUrl:function(){var t=BEM.blocks["i-global"].param("router").todayImageProxy,e=BEM.blocks.uri.buildRelativeUrl(t,this.getDownloadParams()),i=BEM.blocks.uri.parse(e);return i.host(location.hostname),i.build()},getDownloadParams:function(){var t=this.getAppropriateSize(),e=this.__self.getTimeParam(),i={size:t.width+"x"+t.height};return e&&(i.time=e),i},setDownloadSRC:function(){this.elem("download-me").attr("src",this.makeDownloadUrl()),this._hasDownloadSRC=!0},setDownloadURL:function(){return this.getDownloadButton().url(this.makeDownloadUrl()),this},setDownloadText:function(){var t=this.getAppropriateSize();return this.elem("download-resolution").text(t.width+"x"+t.height),this},setSearchURL:function(){return this.getSearchButton().url(this.getCurrentSlide().snippet.link),this},fillData:function(){var t=this.params;return this._today=t.today,this._previous=t.previous,this},getCurrentSlide:function(){return this._currentSlide>=0?this._previous[this._currentSlide]:this._today},isControlsHidden:function(){return this.hasMod("hidden-controls","yes")},updateFooter:function(t){var e=t.snippet,i=t.author,n=this.hasMod("today","yes"),s=this._isDescriptionFitNeeded();return this.elem("description").text(e.description),this.elem("name").text(e.title),this.elem("info-button").attr("href",i.link),this.elem("caption-author").html(i.linkText),this.setSearchURL(),!n&&s?this._fitDescription(e.description):n&&this._isDescriptionFitted&&this._unFitDescription(),this},_isDescriptionFitNeeded:function(){return this.__self.win.innerHeight()<790&&!this.__self.isPortraitOrientation()},_getMaxDescriptionHeight:_.memoize(function(){var t=Math.floor(this.elem("center-wrapper")[0].getBoundingClientRect().bottom-this.elem("slider-main")[0].getBoundingClientRect().bottom-40);return this.__self.win.innerHeight()<=600&&(t-=this.params._lineHeight),t-t%this.params._lineHeight}),_fitDescription:function(t){var e=this._description.get(0).scrollHeight,i=this._getMaxDescriptionHeight();if(e>i&&!this._isDescriptionFitted&&(this._description.height(i),this._isDescriptionFitted=!0,this.setMod(this.elem("center"),"mode","cutted")),i>=e&&(this._description.height(""),this._isDescriptionFitted=!1,this.delMod(this.elem("center"),"mode")),this._isDescriptionFitted){var n=60*(i/this.params._lineHeight);t.length>n&&this._description.text(this.__self.cutText(t,n))}return this},_unFitDescription:function(){return this._isDescriptionFitted=!1,this.delMod(this.elem("center"),"mode")._description.height(""),this},_onResize:function(){window.Ya.fit501pxImage(),this.trigger("resize")},hideControls:function(){return this.setMod("hidden-controls","yes")},showControls:function(){return this.delMod("hidden-controls")}}),function(t){t.decl("i-userinfo",{resolutions:[{width:240,height:320,ratio:{width:3,height:4}},{width:320,height:480,ratio:{width:2,height:3}},{width:480,height:800,ratio:{width:3,height:5}},{width:640,height:960,ratio:{width:2,height:3}},{width:600,height:1024,ratio:{width:3,height:5}},{width:768,height:1024,ratio:{width:3,height:4}},{width:1920,height:1080,ratio:{width:16,height:9}},{width:1680,height:1050,ratio:{width:16,height:10}},{width:1600,height:900,ratio:{width:16,height:9}},{width:1440,height:900,ratio:{width:16,height:10}},{width:1280,height:1024,ratio:{width:5,height:4}},{width:1366,height:768,ratio:{width:16,height:9}},{width:1280,height:800,ratio:{width:16,height:10}},{width:1152,height:864,ratio:{width:4,height:3}},{width:1024,height:768,ratio:{width:4,height:3}},{width:1200,height:800,ratio:{width:3,height:2}},{width:1280,height:720,ratio:{width:16,height:9}},{width:1280,height:768,ratio:{width:5,height:3}},{width:1280,height:960,ratio:{width:4,height:3}},{width:1366,height:768,ratio:{width:16,height:9}},{width:1400,height:1050,ratio:{width:4,height:3}},{width:1600,height:1200,ratio:{width:4,height:3}},{width:1680,height:945,ratio:{width:16,height:9}},{width:1920,height:1200,ratio:{width:16,height:10}},{width:2048,height:1152,ratio:{width:16,height:9}},{width:2048,height:1536,ratio:{width:4,height:3}},{width:2560,height:1440,ratio:{width:16,height:9}},{width:2560,height:1600,ratio:{width:16,height:10}}],getScreenSize:function(t){var e=this.getDefaultResolution(this.getDeviceInfo(t));if(!t)return e;var i=t.userInfo||{},n={width:i.sw||e.width,height:i.sh||e.height};return _.extend(n,{ratio:this.getRatio(n)})},getWindowSize:function(t){var e,i=this.getDefaultResolution(this.getDeviceInfo(t));return t?(e=t.userInfo||{},{width:e.ww||i.width,height:e.wh||i.height}):i},getScreenResolution:function(t){var e=this.getScreenSize(t),i=this.getPixelDensity(t);return{width:Math.floor(e.width*i),height:Math.floor(e.height*i)}},getDeviceInfo:function(t){return{isTablet:t.isTablet,isMobile:t.isMobile,iOS7:t.iOS7,iOS:t.iOS,wp:t.isWindowsPhone}},getDefaultResolution:function(t){var e={width:1366,height:768};return t?(t.isTablet?e={width:1024,height:768}:t.isMobile&&(e={width:640,height:960}),e):e},getRatio:function(t){return{1.25:{width:5,height:4},1.33:{width:4,height:3},1.56:{width:3,height:2},1.6:{width:16,height:10},1.66:{width:5,height:3},1.77:{width:16,height:9},1:{width:1,height:1},.6:{width:3,height:5},.66:{width:2,height:3},.67:{width:2,height:3},.75:{width:3,height:4},.58:{width:3,height:5},.56:{width:9,height:16}}[this.calcRatio(t)]||{width:16,height:9}},getPixelDensity:function(t){return Number(t.userInfo||{}).pd||1},isRetinaDisplay:function(t){return this.getPixelDensity(t)>1.5},parseResolution:function(t){var e=t.split("x");return{width:parseInt(e[0],10),height:parseInt(e[1],10)}},extendedScreenSize:function(t){var e=this.getDeviceInfo(t),i=this.getScreenResolution(t),n=i.width,s=i.height,o=e.isTablet,r=e.isMobile,a=e.iOS7,c=e.iOS,h=e.wp;return o&&a?n=s=2448:r&&a?(n=1040,s=1536):r&&!c&&!h||o?n=s=Math.max(n,s):c&&!a&&(n=640,s=1136),{width:n,height:s}},findAppropriateResolution:function(t,e,i){var n;return e||(e=this.resolutions),n=_.map(e,function(e){return this.calcResolutionDelta(e,t)},this),n.sort(this.compare),i?_.pluck(n,"resolution").slice(0,i):n[0].resolution},compare:function(t,e){var i=Math.abs(t.square),n=Math.abs(e.square);return t.ratio===e.ratio?t.square>=0&&e.square>=0?t.square<=e.square?-1:1:Math.min(i,n)<1e5?n>i?-1:1:t.square>e.square?-1:1:i*t.ratio<n*e.ratio?-1:1},calcResolutionDelta:function(t,e){var i=t.ratio||t;return{ratio:Math.abs(this.calcRatio(i)-this.calcRatio(e)),square:this.calcSquare(t)-this.calcSquare(e),resolution:t}},calcRatio:function(t){return Math.floor((t.width||t.w)/(t.height||t.h)*100)/100},calcSquare:function(t){return(t.width||t.w)*(t.height||t.h)}})}("undefined"!=typeof BEMPRIV?BEMPRIV:BEM),BEM.decl("i-userinfo",{getDefaultParams:function(){return{separator:"-"}},getScreenSize:function(){var t,e=this.getDeviceInfo(),i=window.screen,n={width:i.width,height:i.height,ratio:this.getRatio(i)};return e&&e.isTablet&&n.width<n.height&&(t=n.width,n.width=n.height,n.height=t),n},getDeviceInfo:function(){var t,e,i=BEM.blocks["i-global"],n=BEM.blocks["i-ua"];return n.ios&&(t=n.ios.match(/([0-9]+)/g),e=t&&t[0]),{isTablet:i.param("tablet"),isMobile:i.param("mobile"),iOS:n.ios,iOS7:parseInt(n.ios,10)>=7,wp:n.wp}},getUserInfo:function(){var t=this.params.separator,e=this.getScreenSize(),i=this.getWindowSize();return[["sw",e.width].join(t),["sh",e.height].join(t),["ww",i.width].join(t),["wh",i.height].join(t),["pd",this.getPixelDensity()].join(t),["wp",this.getWP()].join(t)].join(t)},getWindowSize:function(){return{width:window.innerWidth,height:window.innerHeight}},getPixelDensity:function(){return BEM.DOM.win[0].devicePixelRatio||1},getWP:function(){var t=this.getScreenInfo();return t.ratio.width+"x"+t.ratio.height+"_"+t.width+"x"+t.height},getScreenInfo:function(){if(this._screen)return this._screen;var t=this.getScreenResolution(),e=this.findAppropriateResolution(t);return this._screen={width:e.width,height:e.height,ratio:e.ratio},this._screen}},{_instance:null,get:function(){return this._instance||(this._instance=BEM.create("i-userinfo"))}}),BEM.DOM.decl("b-501px",{},{isPortraitOrientation:function(){return window.innerHeight>window.innerWidth},humanDownloadDate:function(t){var e=new Date(this.getTimestamp(t)),i=new Date(this.getTime());return 1===Math.floor((i-e)/864e5)?BEM.I18N("b-501px_spok_yes","Эту картинку можно было скачать вчера"):BEM.I18N("b-501px_spok_yes","Эту картинку можно было скачать {date}",{context:"Эту картинку можно было скачать <20 мая>",date:BEM.blocks.date.getHumanDate(e,i)})},getTimestamp:function(t){var e=t.split("-");return Number(new Date(e[0],e[1]-1,e[2]))},getTime:function(){var t=this.getTimeParam();return BEM.blocks["i-global"].param("isYandexNet")&&t?this.getTimestamp(t.replace(/([0-9]{4})([0-9]{2})([0-9]{2})/,"$1-$2-$3")):Date.now()},getTimeParam:_.memoize(function(){var t=BEM.blocks.uri.parse(location.href).getParam("time");return t&&t.toString()}),formatDate:function(t){var e=new Date(t),i=e.getDate(),n=e.getMonth()+1;return[e.getFullYear(),(10>n?"0":"")+n,(10>i?"0":"")+i].join("-")},cutText:function(t,e){var i,n=t.lastIndexOf(" ",e),s=t.lastIndexOf(".",e)+1;return i=25>n-s?t.slice(0,s):t.slice(0,n)+this._getMoreSymbol()},_getMoreSymbol:_.memoize(function(){return/com/.test(BEM.blocks["i-global"].param("tld"))?' "…"':" «…»"})}),BEM.DOM.decl({block:"b-501px",modName:"counter",modVal:"yes"},{_onDownloadClick:function(){this.__base.apply(this,arguments),cp({pid:40,cid:72623,path:"px500.download.click"},{href:this.makeDownloadUrl()}),this.countMetrikaGoal()},_onAdvButtonClick:function(){cp({pid:40,cid:72623,path:"px500.adv.footer.click"})},_onDownload:function(){this.__base.apply(this,arguments),cp({pid:40,cid:72623,path:"px500.download.imgclickright"},{href:this.makeDownloadUrl()}),this.countMetrikaGoal()},countMetrikaGoal:function(){_.includes(["ru","ua","com.tr"],BEM.blocks["i-global"].param("tld"))&&BEM.blocks["b-statcounter"].goal({goal:"download",params:{query:{morda:"download"}}})},_countCaptionAuthorOpen:function(){return cp({pid:40,cid:72623,path:"px500.title.click"}),this},_onBackClick:function(){this.__base.apply(this,arguments),cp({pid:40,cid:72623,path:"px500.back.click"})},countImageShow:function(){var t,e=this.getCurrentImage().date;return e&&(t="355,-info="+e.replace(/-/g,"")),cp(this.hasMod("today","yes")?{pid:40,cid:72623,path:"px500.main.show",vars:t}:{pid:40,cid:72623,path:"px500.previous.show",vars:t}),this}}),BEM.DOM.decl({block:"b-501px",modName:"preload",modVal:"yes"},{getPreloader:function(){return this._preloader||(this._preloader=BEM.create({block:"i-preloader",mods:{batch:"yes","reload-on-error":"yes"}}))},batchPreload:function(){return this.getPreloader().setImages(this.getPreloadImages()).batchLoad(),this},getPreloadImages:function(){for(var t,e=this._currentSlide,i=this.params.preloadCount,n=this.params.previousSizes,s=e-i,o=this._previous.slice(0>s?0:s,e+i),r=this._today.slide||{},a=[],c=0,h=o.length;h>c;c++)t=o[c],t.slide.preview&&a.push([{width:n.preview.width,height:n.preview.height,url:t.slide.preview}]),t.slide.back&&a.push([{width:n.back.width,height:n.back.height,url:t.slide.back}]);return 0>s&&r.appropriate&&a.push([r.appropriate]),a}}),BEM.DOM.decl({block:"b-501px",modName:"popup",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._popups={}}},findBlocks:function(){return this.__base.apply(this,arguments)},bindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks["b-501px-popup"].on("closed",this._onPopupClose,this),BEM.blocks.button.on(this.elem("caption-icon"),"click",this._onInfoButtonClick,this),this},destruct:function(){BEM.blocks["b-501px-popup"].un("closed",this._onPopupClose,this),BEM.blocks.button.un(this.elem("caption-icon"),"click",this._onInfoButtonClick,this),this.__base.apply(this,arguments)},_onPopupClose:function(){this.showControls()},_onInfoButtonClick:function(){this._openPopup("info").hideControls(),cp({pid:40,cid:72623,path:"px500.info.click"})},_openPopup:function(t){return this._getPopup(t).open(),this},_getPopup:function(t){return this._popups[t]||(this._popups[t]=this.findBlockInside({block:"b-501px-popup",modName:"type",modVal:t}))}}),BEM.DOM.decl({block:"b-501px",modName:"initialize",modVal:"yes"},{_blinkArrowDelay:300,_showControlsDelay:200,_animationTimeout:500,onSetMod:{js:function(){this.__base.apply(this,arguments),this.initSliderData().initSlider()}},destruct:function(){this.dfdCanceled(!0),this.__base.apply(this,arguments)},initSliderData:function(){return this._currentSlide=-1,this.params.hasNext&&(this._previous.unshift(this._today),this._currentSlide++),this},initSlider:function(){return this.dfdCanceled(!1),this.params.hasNext?this.initPreviousPicture():this.initDailyPicture(),this},dfdCanceled:function(t){return"undefined"!=typeof t&&(this._dfdCanceled=t),this._dfdCanceled},initDailyPicture:function(){return this._loadBluredBackground().then(this._loadBackground.bind(this)).then(this._hideParanja.bind(this)).then(this._enableSlider.bind(this)).then(this._blinkPrevArrow.bind(this)).done(this._initDone.bind(this)),this},initPreviousPicture:function(){return this._loadBluredBackground().then(this._loadPreview.bind(this)).then(this._loadNextSlides.bind(this)).then(this._loadPrevImage.bind(this)).then(this._loadNextImage.bind(this)).then(this._enableSlider.bind(this)).done(this._initDone.bind(this)),this},_loadBackground:function(){return this.preloadSingleImage(this._today.slide.appropriate).then(this._setBackground.bind(this))},_setBackground:function(t){this.dfdCanceled()||this.changeSliderBackground(t.url,t.focus)},_hideParanja:function(){var t=$.Deferred(),e=this;return this.dfdCanceled()?t.reject():(this.slider.hideParanja(),setTimeout(function(){e.dfdCanceled()?t.reject():t.resolve()},this._animationTimeout),t.promise())},_showControls:function(){var t=$.Deferred(),e=this;return this.slider.updateLayoutSize().updatePreviewSizes().updatePreviews(),setTimeout(function(){return e.dfdCanceled()?void t.reject():(e.showControls().checkForLastSlide(),void t.resolve())},this._showControlsDelay),t.promise()},_blinkPrevArrow:function(){var t=$.Deferred(),e=this;return setTimeout(function(){return e.dfdCanceled()?void t.reject():(e.slider.blinkPrevArrow(),void t.resolve())},this._blinkArrowDelay),t.promise()},_enableSlider:function(){return this.dfdCanceled()||this.enableSlider(),this._showControls()},_loadBluredBackground:function(){return this.preloadSingleImage(this.getBackgroundImage(this._today.slide.back)).then(this._setBackground.bind(this))},_setBluredBackground:function(){var t=$.Deferred();return this.dfdCanceled()?t.reject():(this.changeSliderBackground(this._today.slide.back),t.resolve())},_loadPreview:function(){return this.preloadSingleImage(this.getPreviewImage(this.getSlide(this._currentSlide).preview)).then(this._setCurrentPreview.bind(this))},_setCurrentPreview:function(){this.dfdCanceled()||this.changePreview("current",this.getSlide(this._currentSlide))},_loadNextSlides:function(){var t=$.Deferred(),e=this;return this.dfdCanceled()?t.reject():(this.load(this.getNextSlidesDate(),this.getFirstImageDate()).done(function(i){return e.dfdCanceled()?void t.reject():(e._addLoadedImages(i),void t.resolve())}),t.promise())},_loadPrevImage:function(){var t=this.getSlide(this._currentSlide+1)||{};return this.preloadSingleImage(this.getPreviewImage(t.preview)).then(this._setPrevSlide.bind(this))},_setPrevSlide:function(){this.dfdCanceled()||this.changePreview("prev",this.getSlide(this._currentSlide+1))},_loadNextImage:function(){var t=this.getSlide(this._currentSlide-1);return this.preloadSingleImage(this.getPreviewImage(t.preview)).then(this._setNextSlide.bind(this))},_setNextSlide:function(){this.dfdCanceled()||this.changePreview("next",this.getSlide(this._currentSlide-1))},_initDone:function(){this.delMod("initialize")},enableSlider:function(){this.slider.enableMove().hideSpinner(),this.updateSlider()},preloadSingleImage:function(t){var e=$.Deferred(),i=function n(){this.getPreloader().un("success error",n,this),this.dfdCanceled()?e.reject():e.resolve(t)};return this.dfdCanceled()?e.reject():t&&t.url?(this.getPreloader().on("success error",i,this).setImages([[t]]).batchLoad(),e.promise()):e.resolve()}}),BEM.DOM.decl({block:"b-501px",modName:"slider",modVal:"yes"},{findBlocks:function(){return this.__base.apply(this,arguments),this.uinfo=BEM.blocks["i-userinfo"].get(),this.location=BEM.blocks.location.getInstance(),this},bindEvents:function(){return this.__base.apply(this,arguments),this.slider.on("preview-disabled",this._onSliderToday,this).on("start",this._onSliderStart,this).on("next",this._onSliderNext,this).on("prev",this._onSliderPrev,this),BEM.blocks["i-keyrouter"].on("left up",this._onKeyPrev,this).on("right down",this._onKeyNext,this),this},destruct:function(){this.slider.un("preview-disabled",this._onSliderToday,this).un("start",this._onSliderStart,this).un("next",this._onSliderNext,this).un("prev",this._onSliderPrev,this),BEM.blocks["i-keyrouter"].un("left up",this._onKeyPrev,this).un("right down",this._onKeyNext,this),this.__base.apply(this,arguments)},_onKeyPrev:function(){this.isControlsHidden()||(this.slider.slide("prev"),cp({pid:40,cid:72623,path:"px500.previous.prev.click"}))},_onKeyNext:function(){this.isControlsHidden()||(this.slider.slide("next"),cp({pid:40,cid:72623,path:"px500.previous.next.click"}))},_onSliderNext:function(){this.updateURL().updateSlider("next").countImageShow()},_onSliderPrev:function(){this.updateURL().updateSlider("prev").countImageShow()},_onSliderToday:function(t,e){this.setMod("today",e),"yes"===e&&this.setDownloadText().setDownloadURL()},moveToToday:function(){var t=this.__self.formatDate(Date.now());this.load(t).done(this.onLoadToday.bind(this))},onLoadToday:function(t){this.updateState(t),this._currentSlide=0,this.slider.slide("next"),this._previous=t.params.images},_onSliderStart:function(t,e){"next"===e?this._currentSlide--:this._currentSlide++,this.isPreviousImage()?this.slider.enablePreview():this.slider.disablePreview()},_onDataLoaded:function(t){this.updateState(t)},updateState:function(t){this._addLoadedImages(t),this.slider.setImages(this.getState()).enableMove(),this.checkForLastSlide()},_addLoadedImages:function(t){var e=t.params,i=e.today,n=e.images;return this.params.hasPrev=e.hasPrev,this.params.hasNext&&(this.params.hasNext=e.hasNext),i?(this._today=i,this.addImages(n,this._today)):this.addImages(n,this._previous[0]),this},updateSlider:function(t){return this.isPreviousImage()||this.slider.disablePreview(),this.updateSliderImages().updateMods().updatePage().checkData(t).batchPreload()},updateSliderImages:function(){return this.slider.setImages(this.getState()),this},updateMods:function(){var t=this.getState().current;return this.toggleMod("adv","yes","",t.isAdvImage),this},checkData:function(t){var e=this._currentSlide,i=this.params.preloadCount;return"next"===t?this._previous[e-i]||this.tryLoad(!0):this._previous[e+i]||this.tryLoad(),this},changeSliderBackground:function(t,e){return this.slider.setBackground("next",t,e).moveBackground("next"),this
},changePreview:function(t,e){return e&&this.slider.setPreview(t,e).showPreview(t),this},getPreviewImage:function(t){var e=this.params.previousSizes.preview;return{width:e.width,height:e.height,url:t}},getBackgroundImage:function(t){var e=this.params.previousSizes.back;return{width:e.width,height:e.height,url:t}},getCurrentImage:function(){var t=this._currentSlide;return t>=0?this._previous[t]:this._today},isPreviousImage:function(){return this._currentSlide>=0},updatePage:function(){return this.checkForLastSlide().updateFooter(this.getCurrentSlide()),this},checkForLastSlide:function(){return this._currentSlide===this._previous.length-1?this.slider.disableArrow("prev"):this.slider.enableArrow("prev"),this},updateURL:function(){var t=this.getCurrentSlide();return this.location.change({url:BEM.blocks.uri.buildRelativeUrl(this._indexPage,{d:t.hash_date}),trigger:!1,history:!1}),this.trigger("updateUrl"),this},isNextImages:function(t,e){return this.__self.getTimestamp(t[0].date)>=this.__self.getTimestamp(e.date)},getNextSlidesDate:function(){var t=this.__self.getTimestamp(this._previous[0].date),e=this.__self.getTime(),i=t+864e5*(this.params.imagesCount+1);return i>e&&(i=e),this.__self.formatDate(i)},getPrevSlidesDate:function(){var t=this._previous;return t[t.length-1].date},hasMore:function(t){return this.params.hasNext&&t||this.params.hasPrev&&!t},tryLoad:function(t){if(!this.hasMore(t))return this;var e,i;return t?(i=this.getNextSlidesDate(),e=this.getFirstImageDate()):i=this.getPrevSlidesDate(),this.load(i,e).done(this._onDataLoaded),this},getFirstImageDate:function(){return this._previous[0].date},load:function(t,e){var i=$.Deferred();return BEM.create("i-request_type_bem",{url:this._indexPage,ctx:this}).block("b-501px__data",i.resolve,{date:e}).get({date:t,uinfo:this.uinfo.getUserInfo(),time:this.__self.getTimeParam()}),i.promise()},addImages:function(t,e){return _.isEmpty(t)?this:(this.isNextImages(t,e)?(this._previous=t.concat(this._previous),this._currentSlide+=t.length):this._previous=this._previous.concat(t),this)},getState:function(){var t=this._currentSlide;return{prevprev:this.getSlide(t+2),prev:this.getSlide(t+1),current:this.getSlide(t),next:this.getSlide(t-1),nextnext:this.getSlide(t-2)}},getSlide:function(t){var e=-1===t,i=e?this._today:this._previous[t],n=i&&i.slide,s=n&&n.appropriate;return n?{back:s?s.url:n.back,preview:n.preview,focus:s?s.focus:void 0,alt:[i.snippet.title,i.author.name].join(", "),isAdvImage:e&&this._isAdvParner(i.partner)}:{}},_isAdvParner:function(t){return"adv"===t.toLowerCase()}}),BEM.DOM.decl({block:"b-501px",modName:"wizard",modVal:"yes"},{bindEvents:function(){if(this.__base.apply(this,arguments),this.bindTo("search","pointerclick",this._onWizardClick),this.bindTo("search","click",function(t){t.preventDefault()}),BEM.blocks["b-501px-wizard"].on("click",this._onWizardClick,this),BEM.blocks.location.on("change",this.hidePopup,this),!this.page.hasMod("mobile","yes")){var t=this._getWizard();BEM.blocks.button.on(this.elem("search"),"hovered",this._onSearchHovered,this),this._getWizardPopup().on("hovered",this._onPopupHovered,this).on("hide",t.hide,t)}return this},destruct:function(){if(BEM.blocks.location.un("change",this.hidePopup,this),!this.page.hasMod("mobile","yes")){var t=this._getWizard();BEM.blocks.button.un(this.elem("search"),"hovered",this._onSearchHovered,this),this._getWizardPopup().un("hovered",this._onPopupHovered,this).un("hide",t.hide,t)}BEM.blocks["b-501px-wizard"].un("click",this._onWizardClick,this),this.clearPopupTimer(),this.__base.apply(this,arguments)},_onWizardClick:function(t){this.countWizardClick().hidePopup(),t.preventDefault()},_onSearchHovered:function(t,e){this.togglePopup(e)},_onPopupHovered:function(t,e){this.togglePopup(e)},_getWizard:function(){return this._wizard||(this._wizard=this.findBlockInside("b-501px-wizard"))},_getWizardPopup:function(){return this._wizardPopup||(this._wizardPopup=this.findBlockInside({block:"popup",modName:"wizard",modVal:"yes"}))},getSearchButton:function(){return this._searchButton||(this._searchButton=this.findBlockInside("search","button"))},countWizardClick:function(){return cp(this.hasMod("today","yes")?{pid:40,cid:72623,path:"px500.main.wizard.click"}:{pid:40,cid:72623,path:"px500.previous.wizard.click"}),BEM.blocks["b-statcounter"].hit({params:{query:{morda:"daily"}}}),_.includes(["ru","ua","com.tr"],BEM.blocks["i-global"].param("tld"))&&BEM.blocks["b-statcounter"].goal({goal:"wizard",params:{query:{morda:"daily"}}}),this},togglePopup:function(t){return"yes"===t?this.showPopup():this.hidePopup(),this},showPopup:function(){var t=this._getWizard();this.clearPopupTimer(),t.isVisible()||(this.checkWizard(),this._getWizardPopup().show(this.elem("search")),t.show())},hidePopup:function(){return this.popupTimer=setTimeout(function(){this._getWizardPopup().hide()}.bind(this),this.params.popupTimeout),this},clearPopupTimer:function(){this.popupTimer&&clearTimeout(this.popupTimer)},updateWizard:function(){return this._getWizard().updateLink(this.getCurrentWizardLink()).load(),this},getCurrentWizardLink:function(){return this.getCurrentSlide().snippet.link},checkWizard:function(){return this._getWizard().isLoaded()||this.updateWizard(),this},updateSlider:function(){return this._getWizard().updateLink(this.getCurrentWizardLink()),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"button",modName:"triggerable",modVal:"yes"},{onSetMod:{hovered:function(t,e){this.__base.apply(this,arguments),this.trigger("hovered",e)}}}),BEM.DOM.decl({block:"popup",modName:"hoverable",modVal:"yes"},{onSetMod:{hovered:function(t,e){this.__base.apply(this,arguments),this.trigger("hovered",e)}}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("mouseover mouseout",function(t){this.setMod("hovered","mouseover"===t.type?"yes":"")})}}),BEM.DOM.decl("b-501px-info",{onSetMod:{js:function(){this.actualizeImages()}},actualizeImages:function(){this.addSourceToImages(BEM.blocks["i-userinfo"].get().isRetinaDisplay()?this.getRetinaImages():this.getBasicImages())},addSourceToImages:function(t){var e=this.params.path;this.elem("image").each(function(i){$(this).attr("src",e+t[i])})},getBasicImages:function(){return this._basicImages||(this._basicImages=this.getImages("basic"))},getRetinaImages:function(){return this._retinaImages||(this._retinaImages=this.getImages("retina"))},getImages:function(t){return _.map(this.params.images,function(e){return e[t]})}},{live:!0}),BEM.DOM.decl("b-501px-info",{},{live:function(){this.liveInitOnBlockEvent("opened","b-501px-popup")}}),BEM.DOM.decl("b-501px-popup",{_popupWrapperMarginBottom:58,onSetMod:{js:function(){this.bindEvents()}},bindEvents:function(){return this.__self.on("close",this.close,this),this.bindTo("pointerclick",this.close).bindTo("close","pointerclick",this._onCloseClick).bindTo("content","pointerclick",this._onContentClick),this.hasMod("scrollable","yes")&&(this.bindTo("touchstart",this._onTouchStart).bindTo("touchmove",this._onTouchMove),this.hasMod("centering","yes")&&BEM.blocks["b-page"].on("resize",this._setPopupPosition,this)),BEM.blocks["i-keyrouter"].on("esc",this.close,this),this},destruct:function(){this.__self.un("close",this.close,this),BEM.blocks["i-keyrouter"].un("esc",this.close,this),this.hasMod("centering","yes")&&BEM.blocks["b-page"].un("resize",this._setPopupPosition,this),this.__base.apply(this,arguments)},_onContentClick:function(t){t.stopPropagation()},_onTouchStart:function(t){this._scrollStartPos=this.domElem.scrollTop()+t.originalEvent.touches[0].pageY},_onTouchMove:function(t){this.domElem.scrollTop(this._scrollStartPos-t.originalEvent.touches[0].pageY),t.preventDefault()},_onCloseClick:function(){this.close().trigger("closed-by-cross")},_setPopupPosition:function(){return this.elem("content").css({transform:"translateY("+this._calcPopupTop()+"px)"}),this},_calcPopupTop:function(){var t=this._getContentHeight(),e=this._getPopupHeight();return t>e?Math.floor((t-e)/2):0},_getContentHeight:function(){return this.domElem.height()-this._popupWrapperMarginBottom},_getPopupHeight:function(){return this._popupHeight||(this._popupHeight=this.elem("content").height())},open:function(){return this.hasMod("centering","yes")&&this._setPopupPosition(),this.setMod("visibility","visible").trigger("opened")},close:function(){return this.isVisible()&&(this.setMod("visibility","hidden"),BEM.blocks["i-ua"].ie<=9?this._close():this.domElem.one(BEM.blocks["i-ua"].getTransitionEndEvent(),this._close.bind(this))),this},isVisible:function(){return this.hasMod("visibility","visible")},setPosition:function(t){return this.setMod("position",t)},clearPosition:function(){return this.delMod("position")},_close:function(){return this.delMod("visibility").trigger("closed")}},{live:!0}),BEM.DOM.decl("b-501px-slider",{_animationTime:600,onSetMod:{js:function(){this.bindEvents()},"preview-disabled":{yes:function(t,e){this.disableArrow("next").hideParanja().trigger(t,e)},"":function(t,e){this.enableArrow("next").showParanja().trigger(t,e)}}},setImages:function(t){return _.forOwn(t,this.setImage,this),this},setImage:function(t,e){return t?(this.setPreview(e,t).showPreview(e),void("prevprev"!==e&&"nextnext"!==e&&t.back&&this.setBackground(e,t.back,t.focus))):void this.hidePreview(e)},isMoveDisabled:function(t){return this.hasMod("animation","yes")||this.hasMod("disable-move","yes")||this.hasMod(this.elem("arrow","dir",t),"hidden","yes")},slide:function(t){return this.isMoveDisabled(t)?this:(this.setMod("animation","yes").trigger("start",t).slidePreviews(t).moveBackground(t).trigger(t),setTimeout(this.onAnimationEnd.bind(this),this._animationTime),this)},onAnimationEnd:function(){this.delMod("animation").delMod(this.elem("preview","animation","no"),"animation")},showParanja:function(){return this.setMod(this.elem("paranja"),"visible","yes")},hideParanja:function(){return this.delMod(this.elem("paranja"),"visible")},hideSpinner:function(){return this.findBlockInside("spinner").delMod("progress"),this}}),BEM.DOM.decl("b-501px-slider",{setBackground:function(t,e,i){var n=this.elem("background","pos",t),s="url("+e+")";return n.css("background-image")===s?this:(n.css({"background-image":s,"background-position":i?i.left+"% "+i.top+"%":""}),this)},moveBackground:function(t){var e="next"===t,i=this.elem("background","pos","current"),n=this.elem("background","pos","next"),s=this.elem("background","pos","prev");return this.setMod(i,"pos",e?"prev":"next").setMod(n,"pos",e?"current":"prev").setMod(s,"pos",e?"next":"current")}}),BEM.DOM.decl("b-501px-slider",{_positions:["prevprev","prev","current","next","nextnext"],_minArrowHeight:100,_maxArrowHeight:300,_prevNextOffset:50,onSetMod:{js:function(){this.__base.apply(this,arguments),this.findPreviews().updateLayoutSize().updatePreviewSizes()}},bindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks["b-501px"].on("resize",this._onPageResize,this),this},destruct:function(){BEM.blocks["b-501px"].un("resize",this._onPageResize,this),this.__base.apply(this,arguments)},_onPageResize:function(){this.updateLayoutSize().updatePreviewSizes().updatePreviews()},updatePreviewSizes:function(){return this._previewSizes={current:this.calcPreviewSize("current"),other:this.calcPreviewSize()},this},updateLayoutSize:function(){return this._layoutSize={width:this.getLayoutWidth(),height:this.getLayoutHeight()},this},findPreviews:function(){var t=this.elem("preview");return this._previewsState=[{preview:t.eq(0)},{preview:t.eq(1)},{preview:t.eq(2)},{preview:t.eq(3)},{preview:t.eq(4)}],this},disablePreview:function(){return this.setMod("preview-disabled","yes")},enablePreview:function(){return this.delMod("preview-disabled")},isPreviewDisabled:function(){return this.hasMod("preview-disabled","yes")},setPreview:function(t,e){var i=this.getThumb(t);return i.attr("src")!==e.preview&&i.attr({src:e.preview||"",alt:e.alt||""}),this},getThumb:function(t){return this.findElem(this.getPreview(t),"thumb")},updatePreviews:function(){this.fillBaseTransform(),this.setArrowsHeight(this.getPreviewSize().height);for(var t=0,e=this._previewsState.length;e>t;t++)this.updateTransform(this.getPreviewPos(t));return this.changePreviewsMods()},setNewState:function(t,e){var i=this.getPreviewIndex(t);return this._previewsState[i].transform=e,this},getPreviewIndex:function(t){return this._positions.indexOf(t)},getPreviewPos:function(t){return this._positions[t]},getPreview:function(t){return this.getState(t).preview},getState:function(t){return this._previewsState[this.getPreviewIndex(t)]},moveLastPreview:function(t){var e=t+t,i="next"===t?"prevprev":"nextnext",n=this.getTransform(i);return n.translate.x=this.getTransform(e).translate.x-this.getXInc(t),this.disableAnimation(e).setNewState(i,n).updateTransform(i),this},getPreviewHeight:function(t){var e=this.getLayoutHeight(),i="current"===t?this.params.maxSize.height:this._maxArrowHeight;return Math.max(this._minArrowHeight,Math.min(e,i))},getPreviewWidth:function(t){var e=this.getLayoutWidth()-150,i=this.params.maxSize,n=i.width;return"current"===t?Math.min(e,n):this._maxArrowHeight/i.height*n},getPreviewSize:function(t){return"current"!==t||this.isPreviewDisabled()?this._previewSizes.other:this._previewSizes.current},getLayoutHeight:function(){return this.elem("main").height()},getLayoutWidth:function(){return this.elem("main").width()},getLayoutSize:function(){return this._layoutSize},slidePreviews:function(t){return"next"===t?this.rotateStateNext():this.rotateStatePrev(),this.moveLastPreview(t).slideList(t).updatePreviews()},changePreviewsMods:function(){return this.clearPositionMod().setPositionMod("current").setPositionMod("next").setPositionMod("prev")},clearPositionMod:function(){return this.delMod(this.elem("preview"),"pos")},setPositionMod:function(t){return this.setMod(this.getPreview(t),"pos",t)},disableAnimation:function(t){return this.setMod(this.getPreview(t),"animation","no")},hidePreview:function(t){return this.setMod(this.getPreview(t),"hidden","yes")},showPreview:function(t){return this.delMod(this.getPreview(t),"hidden")},rotateStateNext:function(){var t=this._previewsState;return t.push(t.shift()),this},rotateStatePrev:function(){var t=this._previewsState;return t.unshift(t.pop()),this}}),BEM.DOM.decl("b-501px-slider",{onSetMod:{"disable-move":{"":function(){this.updatePreviews()}}},bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo("arrow","pointerclick",this._onArrowClick),this.bindTo("arrow","keypress",this._onArrowKeyboard),this},destruct:function(){clearTimeout(this._blinkTimer),this.__base.apply(this,arguments)},_arrowPress:function(t){var e=this._extractElem(t),i=this.getMod(e,"dir");this.slide(i),cp({pid:40,cid:72623,path:"px500.previous."+i+".click"}),BEM.blocks["b-501px-popup"].trigger("close")},_onArrowClick:function(t){this._arrowPress(t)},_onArrowKeyboard:function(t){(13===t.which||32===t.which)&&(t.preventDefault(),this._arrowPress(t))},_extractElem:function(t){return t.data.domElem},enableMove:function(){return this.delMod("disable-move")},disableArrow:function(t){return this.setMod(this.elem("arrow","dir",t),"hidden","yes")},enableArrow:function(t){return this.delMod(this.elem("arrow","dir",t),"hidden")},blinkPrevArrow:function(){return this._blinkTimer=setTimeout(this.unblinkPrevArrow.bind(this),2500),this.setMod(this.elem("arrow","dir","prev"),"blinking","yes")},unblinkPrevArrow:function(){this.delMod(this.elem("arrow","dir","prev"),"blinking")},setArrowsHeight:function(t){return this.elem("arrow").css({height:t,"margin-top":-Math.floor(t/2)}),this}}),BEM.DOM.decl("b-501px-slider",{_listOffsetX:0,slideList:function(t){return this._listOffsetX+=this.getXInc(t),this.setTransform(this.elem("list"),{x:this._listOffsetX})}}),BEM.DOM.decl({block:"b-501px-slider",modName:"transform",modVal:"yes"},{getXInc:function(t){var e=(this.getLayoutWidth()+this.calcPreviewSize().width)/2-this._prevNextOffset;return("next"===t?-1:1)*e},getTransform:function(t){return this.getState(t).transform},calcPreviewSize:function(t){var e=this.getPreviewHeight(t),i=this.getPreviewWidth(t),n=this.params.maxSize,s=this.calcPreviewScale(i,e);return{width:Math.round(n.width*s),height:Math.round(n.height*s),scale:s}},calcPreviewScale:function(t,e){var i=this.params.maxSize;return Math.min(e/i.height,t/i.width).toFixed(2)},fillBaseTransform:function(){for(var t,e=this.getLayoutSize(),i=0,n=this._previewsState.length;n>i;i++)t=this.getPreviewPos(i),this.setNewState(t,this.calcTransform(t,this.getPreviewSize(t),e));return this},calcTransformX:function(t,e,i){var n=-(1-e.scale)*this.params.maxSize.width/2,s=this.isPreviewDisabled(),o=this._prevNextOffset,r=i.width,a=e.width,c=n-this._listOffsetX;switch(t){case"prevprev":c+=-r/2-1.5*a+2*o;break;case"prev":c+=-a+(s?0:o);break;case"current":c+=s?r:(r-a)/2;break;case"next":c+=r-(s?0:o);break;case"nextnext":c+=1.5*r+a/2-2*o}return Math.round(c)},calcTransformY:function(t,e){var i=-(1-t.scale)*this.params.maxSize.height/2;return Math.round(i+(e.height-t.height)/2)},calcTransform:function(t,e,i){return{translate:{x:this.calcTransformX(t,e,i),y:this.calcTransformY(e,i)},scale:e.scale}},updateTransform:function(t){var e=this.getState(t),i=e.transform;return this.setTransform(e.preview,i.translate,i.scale)},setTransform:function(t,e,i){var n="translate("+[e.x+"px",(e.y||0)+"px"].join()+")";return i&&(n+="scale("+i+")"),t.css({transform:n}),this}}),BEM.DOM.decl("b-501px-wizard",{onSetMod:{js:function(){this.spin=this.findBlockInside("spinner")},loading:function(t,e){this.spin.setMod("progress","yes"===e?"yes":"")}},_onClick:function(){this.trigger("click")},_onLoad:function(t){this.update(t.html).setMod("loaded","yes").delMod("loading").findElem("images").attr("href",this._link)},load:function(){return this.setMod("loading","yes"),this._load(this._link)},updateLink:function(t){return this._link!==t&&this.setLink(t).clearContent().delMod("loaded").tryReload(),this},tryReload:function(){return this.isVisible()&&this.load(),this},setLink:function(t){return this._link=t,this},clearContent:function(){return BEM.DOM.destruct(this.elem("content"),!0),this},update:function(t){return BEM.DOM.update(this.elem("content"),t),this.bindTo("images","pointerclick",this._onClick),this.bindTo("images","click",function(t){t.preventDefault()}),this},isLoaded:function(){return this.hasMod("loaded","yes")},isVisible:function(){return this.hasMod("visibility","visible")},show:function(){return this.setMod("visibility","visible")},hide:function(){return this.setMod("visibility","hidden")},_load:function(t){var e=BEM.blocks.uri,i=e.getPath(t)+"?"+e.parse(t).uriParts.query;return BEM.create("i-request_type_bem",{url:i,ctx:this}).block("b-501px-wizard__images",this._onLoad).get({type:"search",params:{uinfo:BEM.blocks["i-userinfo"].get().getUserInfo()}}),this}}),BEM.decl("date",{},{shortHumanDate:function(t){var e=t.getDate();return[BEM.I18N("date","{day} января",{day:e}),BEM.I18N("date","{day} февраля",{day:e}),BEM.I18N("date","{day} марта",{day:e}),BEM.I18N("date","{day} апреля",{day:e}),BEM.I18N("date","{day} мая",{day:e}),BEM.I18N("date","{day} июня",{day:e}),BEM.I18N("date","{day} июля",{day:e}),BEM.I18N("date","{day} августа",{day:e}),BEM.I18N("date","{day} сентября",{day:e}),BEM.I18N("date","{day} октября",{day:e}),BEM.I18N("date","{day} ноября",{day:e}),BEM.I18N("date","{day} декабря",{day:e})][t.getMonth()]},fullHumanDate:function(t){var e=t.getDate(),i=t.getFullYear();return[BEM.I18N("date","{day} января {year} г.",{day:e,year:i}),BEM.I18N("date","{day} февраля {year} г.",{day:e,year:i}),BEM.I18N("date","{day} марта {year} г.",{day:e,year:i}),BEM.I18N("date","{day} апреля {year} г.",{day:e,year:i}),BEM.I18N("date","{day} мая {year} г.",{day:e,year:i}),BEM.I18N("date","{day} июня {year} г.",{day:e,year:i}),BEM.I18N("date","{day} июля {year} г.",{day:e,year:i}),BEM.I18N("date","{day} августа {year} г.",{day:e,year:i}),BEM.I18N("date","{day} сентября {year} г.",{day:e,year:i}),BEM.I18N("date","{day} октября {year} г.",{day:e,year:i}),BEM.I18N("date","{day} ноября {year} г.",{day:e,year:i}),BEM.I18N("date","{day} декабря {year} г.",{day:e,year:i})][t.getMonth()]},getRelativeDate:function(t,e){switch(e||(e=new Date),Math.floor((e-t)/864e5)){case 0:return BEM.I18N("date","Сегодня");case 1:return BEM.I18N("date","Вчера");default:return this.getHumanDate(t,e)}},getHumanDate:function(t,e){return e||(e=new Date),e.getFullYear()===t.getFullYear()?this.shortHumanDate(t):this.fullHumanDate(t)}}),BEM.decl("i-preloader",{onSetMod:{js:function(){this.__self._history||(this.__self._history=$("<div />",{"class":"i-preloader__history"}).appendTo("body"))}},load:function(t){return t&&t.length?(this.stop(),this.duplicates=t.slice(0),this.preload(this.getNextDuplicate()),this):this},getSuccessfulDup:function(t){for(var e=0,i=t.length;i>e;e++)if("complete"===this.getState(t[e]))return t[e]},preload:function(t){switch(this.image=t,this.getState(t)){case"error":this._onError(t);break;case"complete":this._onSuccess(t);break;default:this.startLoad(t)}},startLoad:function(t){return this.loadImage(t)},loadImage:function(t){return this.setState(t,"loading"),this._loader=this.createLoader(t),this._loader&&this._loader.complete&&this._loader.width>0&&this._loader.height>0&&this._onLoad(this._loader,t),this},stop:function(){return this.destroyLoader()},createLoader:function(t){var e=new Image,i=this;return e.onload=function(){i._onLoad(this,t)},e.onerror=function(){i._onError(this,t)},e.src=t.url,e},destroyLoader:function(){return this._loader&&(this._loader.onload=this._loader.onerror=null,this._loader=null),this},_onLoad:function(t,e){t=this.toObject(t,e),e&&!this._isSizeMatch(t,this.toObject(e))?(this._onError(t,e),this.trigger("wrongsize",t.url)):this._onSuccess(t)},_onSuccess:function(t){this.stop(),"complete"!==this.getState(t)&&this.setState(t,"complete").saveImage(t),this.trigger("success",t)},_onError:function(t,e){t=this.toObject(t,e),"loading"===this.getState(t)&&(this.setState(t,"error"),this.stop(),this.trigger("notfound",t.url)),this.duplicates&&this.duplicates.length?this.preload(this.getNextDuplicate()):this.hasMod("batch","yes")||this.trigger("error",t)},_isSizeMatch:function(t,e){return t.width===e.width||t.height===e.height},setState:function(t,e){return this.__self._state[t.url]=e,this},getState:function(t){return this.__self._state[t.url]},saveImage:function(t){return this.__self._history.append('<img src="'+t.url+'" />'),this},getNextDuplicate:function(){return this.toObject(this.duplicates.shift())},toObject:function(t,e){return{url:t.url||t.src,origin:e&&e.url,width:+t.width,height:+t.height}}},{_state:{},_history:null}),BEM.decl("i-preloader",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.on("wrongsize",this._onWrongSize).on("notfound",this._onNotFound)}},_onWrongSize:function(t,e){errcnt({src:e},72681)},_onNotFound:function(t,e){errcnt({src:e},2055)}}),BEM.decl({block:"i-preloader",modName:"reload-on-error",modVal:"yes"},{getDefaultParams:function(){return _.extend(this.__base.apply(this,arguments),{triesCount:2,tryTimeout:100})},_onError:function(t,e){t=this.toObject(t,e);var i=t.origin||t.url,n=this.__self._errorsCount[i]||0;n<this.params.triesCount?setTimeout(this.preload.bind(this,t),this.params.tryTimeout):this.__base.apply(this,arguments),this.__self._errorsCount[i]=n+1}},{_errorsCount:{}}),BEM.DOM.decl("b-501px-metrika",{onSetMod:{js:function(){if(!(location.hash.indexOf("search")>=0)){var t=$.cookie("mfrom");t||(t=this.params.source,this._setCookie(t)),this._hitVisit(t)._removeUTM()}}},_hitVisit:function(t){var e=window.Ya&&Ya.Metrika,i=window.yandex_metrika_callbacks||(window.yandex_metrika_callbacks=[]),n=this.params.counter,s=function(){new Ya.Metrika({id:n,params:{from:t}})};return e?s():(BEM.blocks["b-statcounter__metrika"].loadMetrika(),i.push(s)),this},_removeUTM:function(){return BEM.blocks.location.getInstance().change({url:BEM.blocks.uri.delParams(["utm_source","utm_campaign"]),history:!1,trigger:!1}),this},_setCookie:function(t){return $.cookie("mfrom",t,{expires:3650,path:BEM.blocks["i-global"].param("router").index}),this}}),BEM.DOM.decl("direct",{update:function(t,e){window.Ya&&window.Ya.Direct&&this.__self._isLoaded||this._load(t,e),this._update(t,e)},_load:function(t,e){this.__self.load(this._onLoad.bind(this,t,e))},_onLoad:function(t,e){window.yandex_context_callbacks||(window.yandex_context_callbacks=[]),window.yandex_context_callbacks.push(this._update.bind(this,t,e))}},{LOADER_URL:"//an.yandex.ru/system/context.js",load:function(t){t(),$.getScript(this.LOADER_URL,function(){this._isLoaded=!0}.bind(this))}}),BEM.DOM.decl("direct",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.directCallback=this._onDirectLoaded.bind(this)}},_onDirectLoaded:function(){return BEM.blocks["i-global"].param("isPornoQuery")?void this.hide():void this.show()},_render:function(t,e,i){return this.ctx.Ya.Context&&(this.ctx.Ya.Context._asyncModeOn=!0,this.ctx.Ya.Context.AdvManager.render({blockId:i||this.params.directId,renderTo:e,async:!0,onRender:this._onDirectLoaded.bind(this),grab:BEM.blocks["i-global__utils"].base64Encode("t"+t)},this._onEmptyDirectLoaded.bind(this))),this},_getDirectId:function(){return this.params.moreDirectId&&this.__self.canShowMoreAds()?this.params.moreDirectId:this.params.directId},_onEmptyDirectLoaded:$.noop},{_status:"not exists",load:function(t){t(),"not exists"===this._status&&$.getScript(this.LOADER_URL).done(function(){this._isLoaded=!0,this._status="loaded"}.bind(this)).fail(function(){this._status="error"}.bind(this)),this._status="loading"},canShowMoreAds:function(){return window.innerWidth>1300}}),BEM.DOM.decl("direct",{transparent:function(){this.setMod("visibility","transparent")},hide:function(){return this.setMod("visibility","hidden")},show:function(){return this.delMod("visibility")}}),BEM.DOM.decl({block:"direct",modName:"type",modVal:"stripe"},{_getDirectId:function(){return this.params.directId}}),BEM.DOM.decl({block:"direct",modName:"type",modVal:"search"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.footer.on("show",this._onFooterShow,this),BEM.blocks.footer.on("hide",this._onFooterHide,this),BEM.blocks.footer.on("transparent",this._onFooterTransparent,this),BEM.blocks["serp-list"].on("loaded",this._onSerpListLoaded,this)}},destruct:function(){BEM.blocks.footer.un("show",this._onFooterShow,this),BEM.blocks.footer.un("hide",this._onFooterHide,this),BEM.blocks.footer.un("transparent",this._onFooterTransparent,this),BEM.blocks["serp-list"].un("loaded",this._onSerpListLoaded,this),this.__base.apply(this,arguments)},show:function(){return this.__base.apply(this,arguments),this.hasMod("target","iframe")&&this.updateFrameHeight(),this},_onFooterShow:function(){this.isExists()&&this.show()},_onFooterHide:function(){this.hide()},_onFooterTransparent:function(){this.transparent()},_onSerpListLoaded:function(t,e){e.totalPages%this.params.pagesCount===this.params.initAfterPage&&this.update()},_onDirectLoaded:$.noop}),BEM.DOM.decl({block:"direct",modName:"type",modVal:"between"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["serp-list"].on("loaded",this._onSerpListLoaded,this)}},destruct:function(){BEM.blocks["serp-list"].un("loaded",this._onSerpListLoaded,this),this.__base.apply(this,arguments)},_onSerpListLoaded:function(t,e){var i=this.params;e.totalPages%i.scrollPagesCount===i.insertAfterPage&&(e.serpList.appendIncutElem(this.domElem),this.hasMod("target","iframe")&&this.findContainers(),this.update())},_onDirectLoaded:function(){this.__base.apply(this,arguments),"hidden"!==this.hasMod("visibility")&&this.updateFrameHeight()}}),BEM.DOM.decl({block:"direct",modName:"type",modVal:"fridge"},{_update:function(t){return this._render(t,this._getDirectClass()),this},_onDirectLoaded:function(){this.domElem.height(this._frame.height()),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"direct",modName:"type",modVal:"stripe-over-gallery"},{_update:function(t){return this._render(t,this._getDirectClass()),this}}),BEM.DOM.decl({block:"direct",modName:"target",modVal:"iframe"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.domElem.on("load",this._onFrameLoaded.bind(this)),this.directNotExistsCounter=0}},destruct:function(){return clearTimeout(this._directLoader),this.__base.apply(this,arguments)},_onFrameLoaded:function(){this.findContainers()},findContainers:function(){return this.setContext().findFrame(),this},setSrc:function(){this.afterCurrentEvent(function(){this.domElem.attr("src",this.params.src),this._hasSrc=!0})},setContext:function(){return this.ctx=this.domElem[0].contentWindow,this},findFrame:function(){if(this.domElem)try{this._frame=this.domElem.contents().find("."+this._getDirectClass())}catch(t){}return this},update:function(t){if(t||(t=BEM.blocks["i-global"].param("query")),BEM.blocks["i-global"].param("isPornoQuery"))return void this.hide();if(this.domElem){this._hasSrc||this.setSrc();try{if(!_.get(this,"ctx.Ya.Context.AdvManager"))return void(this._directLoader=setTimeout(function(){this.update(t)}.bind(this),100));this._update(t)}catch(e){}}},_update:function(t){return this._addClassAndFindFrame(),this._render(t,this._getDirectClass(),this._getDirectId()),this},isExists:function(){var t;return this.directNotExistsCounter>10&&(this.findFrame(),this.directNotExistsCounter=0),t=Boolean(this._frame&&this._frame.length)&&!this._frame.is(":empty"),!t&&this.directNotExistsCounter++,t},updateFrameHeight:function(){if(this._frame&&this._frame.length){var t=this._frame.context.contentWindow.document.body.offsetHeight;this._frame.context.height=t,this.trigger("updateHeight",{height:t})}return this},_addClassAndFindFrame:function(){var t=this.ctx.document.querySelector("div"),e=this._getDirectClass();t.className||(t.className=e,t.id=e,this.findFrame())},_getDirectClass:function(){return"yandex_ad_"+this.getMod("type")+"_frame"}}),BEM.DOM.decl({block:"direct",modName:"target",modVal:"page"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.ctx=window}},_update:function(){if(!this.__self._isLoaded)return this;var t=BEM.blocks["i-global"].param("query");return this._render(t,this.domElem[0].id,this._getDirectId()),this},isExists:function(){return!this.domElem.is(":empty")}}),BEM.DOM.decl({block:"direct",modName:"update-on-init",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.update()}}}),BEM.DOM.decl("back",{onSetMod:{js:function(){this._isEnabled()&&(this.setMod("visibility","visible"),this.bindTo("pointerclick",this._onClick))}},_isEnabled:function(){return window.history&&window.history.length>1},_onClick:function(t){t.preventDefault(),window.history.back()}}),BEM.DOM.decl("related",{show:function(){return this.delMod("visibility")},hide:function(){return this.setMod("visibility","hidden")},_onItemClick:function(t){var e={};e[this.getMod("position")]="p"+this.getItemIndex(t.data.domElem),BEM.blocks["b-statcounter"].hit({params:{query:{related:e}}})},getItemIndex:function(t){return this.elem("item").index(t)}},{live:function(){this.liveBindTo("item","pointerclick",function(t){this._onItemClick(t)}),this.liveBindTo("preview","click",function(t){t.preventDefault()})}}),BEM.DOM.decl("related",{getDefaultParams:function(){return{pageWidth:this.__self.win.width()}},onSetMod:{js:function(){this.reduceLabelHeight().setCarouselHeight()}},reduceLabelHeight:function(){this.delMod("one-line-label");var t=parseInt(this.elem("label").css("line-height"),10),e=Math.floor(this.params.pageWidth/this._getCarousel().getStep()),i=_(this.elem("label")).pluck("offsetHeight").take(e).indexOf(2*t);return-1===i&&this.setMod("one-line-label","yes"),this},setCarouselSizes:function(){return this.setCarouselHeight(),this._getCarousel().setWidth(),this},setCarouselHeight:function(t){t||(t=this.elem("item").height());var e="top"!==this.getMod("position")&&this.getMod("heading"),i=20,n=23;return 0!==t&&this.elem("carousel").css("height",t+i+(e&&n)),this
},_getCarousel:function(){return this._carousel||(this._carousel=this.findBlockInside("carousel"))},setCarouselMod:function(){return this._getCarousel().setScrollMod(),this}},{live:function(){return this.__base(),!1}}),BEM.DOM.decl("carousel",{getDefaultParams:function(){return{animationTime:300,offset:null}},onSetMod:{js:function(){this.setScrollMod(),this.bindEvents()},scroll:{left:function(){var t=this.elem("control","side","right");this.hasMod(t,"hovered","yes")&&this.setMod(t,"disable","yes")},right:function(){var t=this.elem("control","side","left");this.hasMod(t,"hovered","yes")&&this.setMod(t,"disable","yes")}}},onElemSetMod:{control:{hovered:{"":function(){this.delMod(this.elem("control"),"disable")}}}},bindEvents:function(){return this.bindTo("item","pointerclick",this._onItemClick).bindTo("control","pointerclick",this._onControlClick).bindTo("control","dblclick",function(t){t.preventDefault()}).bindTo("wrap","scroll",$.throttle(this._onScroll,50,this)),BEM.blocks["i-global"].param("mobile")||this.bindTo("control","mousemove",this._onMouseMove).bindTo("control","mouseleave",this._onMouseLeave).bindTo("wrap","dragstart",this._onDragStart).bindTo("wrap","mousedown",this._onMouseDown).bindTo("wrap","mousemove",this._onItemMouseMove).bindTo("wrap","mouseup mouseleave",this._onMouseUp),BEM.blocks["b-page"].on("resize",this._onResize,this),this},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("resize",this._onResize,this)},_onResize:function(){this.setScrollMod()},_onItemClick:function(t){return this.preventClick?(this.preventClick=!1,t.stopImmediatePropagation(),!1):void 0},_onMouseMove:function(t){this.setMod(t.data.domElem,"hovered","yes")},_onMouseLeave:function(){this.delMod(this.elem("control"),"hovered")},_onMouseDown:function(t){this.clicked=!0,this.preventClick=!1,this.startPoint=t.clientX+this.elem("wrap").scrollLeft(),this._mouseDownX=t.clientX,this._mouseDownY=t.clientY},_onDragStart:function(t){t.preventDefault()},_onItemMouseMove:function(t){!this.clicked||t.clientX===this._mouseDownX&&t.clientY===this._mouseDownY||(this.setMod(this.elem("wrap"),"grabbing","yes"),this.elem("wrap").scrollLeft(this.startPoint-t.clientX),this.preventClick=!0)},_onMouseUp:function(){this.delMod(this.elem("wrap"),"grabbing"),this.clicked=!1},_onControlClick:function(t){if(!this.hasMod(this.elem("control"),"disable","yes")){var e=this.getMod(t.data.domElem,"side");this.canScrollTo(e)&&this.move(e)}},_onScroll:function(){this.setScrollMod().checkEndOfList()},setScrollMod:function(){var t,e=this.elem("wrap").scrollLeft(),i=this.elem("wrap")[0].scrollWidth,n=this.elem("wrap").width();return t=0>=i-n?"":0===e?"right":i>e+n?"both":"left",this.setMod("scroll",t)},checkEndOfList:function(){if(!this.params.offset)return this;var t=this.elem("wrap"),e=t.scrollLeft(),i=t[0].scrollWidth,n=t.width();return e<=this.params.offset&&this.trigger("listOut","left"),e+n>i-this.params.offset&&this.trigger("listOut","right"),this},canScrollTo:function(t){var e=this.getMod("scroll");return"both"===e||e===t},move:function(t){var e=this.elem("wrap").scrollLeft(),i=e+this.getOffset(t);this.elem("wrap").animate({scrollLeft:i},this.params.animationTime,this.setScrollMod.bind(this))},getOffset:function(t){return("left"===t?-1:1)*this.params.step},scrollToStart:function(){this.elem("wrap").scrollLeft(0)},setItemsInList:function(t){this.getList().html(t)},appendItemsInList:function(t){this.getList().append(t)},prependItemsInList:function(t){this.getList().prepend(t)},getList:function(){return this.list||(this.list=this.elem("list"))}}),BEM.DOM.decl("carousel",{getDefaultParams:function(){return _.extend(this.__base.apply(this,arguments),this.params,{animationTime:this.hasMod("full-scroll","yes")?400:300})},onSetMod:{js:function(){this.__base.apply(this,arguments),this.scrollToStart(),this.setWidth(),this.items=this.elem("item")}},setWidth:function(){return this.carouselWidth=this.domElem.width(),this},_onResize:function(){this.__base.apply(this,arguments),this.setWidth()},getFullOffset:function(t){var e,i,n,s=this.carouselWidth,o=this.elem("wrap").scrollLeft(),r=this.elem("control").width();return i=_.findLast(this.items,function(i){return e=$(i).position().left,"right"===t?o+s>e:"left"===t?o>e:void 0}),n="right"===t?e-r-o:s+o-e-$(i).outerWidth(!0)-r},getOffset:function(t){var e=this.hasMod("full-scroll","yes")?this.getFullOffset(t):this.params.step;return("left"===t?-1:1)*(this.shouldAddExtraScroll(e,t)?1.4*e:e)},shouldAddExtraScroll:function(t,e){var i=this.domElem.width(),n=this.elem("wrap").scrollLeft(),s=this.elem("wrap")[0].scrollWidth;return"right"===e&&.4*t>=s-i-n-t||"left"===e&&.4*t>=n-t?!0:!1},insertAfterThumb:function(t,e){this.getList().find("#gallery-"+e).after(t)},insertBeforeAllThumbs:function(t){this.getList().prepend(t)},getStep:function(){return this.params.step}}),BEM.DOM.decl("b-501px-popular-themes",{},{live:function(){this.liveBindTo("item","pointerclick",function(t){BEM.blocks["b-statcounter"].hit({params:{query:{morda:{popular:{click:"p"+this.getMod(t.data.domElem,"pos")}}}}})})}}),BEM.DOM.decl("categories-index",{onSetMod:{js:function(){BEM.blocks["b-page"].on("scroll",this._onPageScroll,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("scroll",this._onPageScroll,this)},_onItemClick:function(t){var e=this.elemParams(t.data.domElem);cp({pid:40,cid:72623,path:"px500.categories.theme."+e.theme+".item."+e.query})},_onButtonClick:function(t){cp({pid:40,cid:72623,path:"px500.categories.theme."+this.elemParams(t.data.domElem).query})},_onPageScroll:function(){var t=BEM.DOM.win,e=270;t.scrollTop()>=t.height()-e&&(cp({pid:40,cid:72623,path:"px500.categories.show"}),BEM.blocks["b-page"].un("scroll",this._onPageScroll,this))}},{live:function(){this.liveBindTo("item","pointerclick",function(t){this._onItemClick(t)}),this.liveBindTo("button","pointerclick",function(t){this._onButtonClick(t)})}}),BEM.DOM.decl("other-sites",{onSetMod:{js:function(){this._container=this.elem("container")}},loadSites:function(t){BEM.DOM.append(this._container,t.html)},_hitCounter:function(t){var e,i=t.target.className.match(/other-sites__(title-link|outer-link|thumb)/),n=i&&i[1],s=t.data.domElem.index();if(n){switch(n){case"thumb":e="/image/new/cbir/results/thumb";break;case"title-link":e="/image/new/cbir/results/site";break;case"outer-link":e="/image/new/cbir/results/duplicates/url"}c.hit({dtype:"iweb",path:e,pos:s,reqid:this.params.reqid})}},_onMiddleClick:function(t){1===t.button&&this._hitCounter(t)}},{live:function(){this.liveBindTo("item","pointerclick contextmenu",function(t){this._hitCounter(t)}).liveBindTo("item","click",function(t){this._onMiddleClick(t)})}}),BEM.DOM.decl("other-sizes",{_hitCounter:function(t){var e=this.getMod(t.parent(),"size"),i=t.index()+1;switch(e){case"large":e="big";break;case"medium":e="middle"}c.hit({dtype:"iweb",path:"/image/new/cbir/results/othersize/"+e+"/p"+i,reqid:this.params.reqid})},_onMiddleClick:function(t){1===t.button&&this._hitCounter(t.data.domElem)}},{live:function(){this.liveBindTo("column-item","pointerclick contextmenu",function(t){this._hitCounter(t.data.domElem)}).liveBindTo("column-item","click",function(t){this._onMiddleClick(t)})}}),BEM.DOM.decl("similar",{onSetMod:{js:function(){!BEM.blocks["i-ua"].hasFlexbox()||window.opera?(this.setMod("flexbox","no"),_.forEach(this.elem("thumb"),function(t){$(t).removeAttr("style").after(" ")}),this.justifyFallbackTimer=setTimeout(function(){this.initMoreLink()}.bind(this),1e3)):this.initMoreLink(),this.bindTo("thumb","pointerclick contextmenu",this._hitCounter),this.bindTo("thumb","click",this._onMiddleThumbClick)}},destruct:function(){this.__base.apply(this,arguments),clearTimeout(this.justifyFallbackTimer)},initMoreLink:function(){for(var t,e,i=this.hasMod("no-results","yes")?3:2,n=130,s=this.elem("thumb"),o=s.length,r=o-1;r>=0;r--)if(e=s[r].offsetTop,e>=n*(i-1)&&n*i>=e){t=s.eq(r),this.setMod(t,"last","yes"),this.findElem(t,"link").append(this.elem("more-link")).attr("href",this.params.moreLink),this.bindTo(t,"click",this._onSimilarThumbClick);break}},_onSimilarThumbClick:function(){BEM.blocks["b-statcounter"].hit({params:{query:{cbir:"similar"}}})},_onMiddleThumbClick:function(t){1===t.button&&this._hitCounter(t)},_hitCounter:function(t){var e=t.data.domElem,i="yes"===this.getMod(e,"last"),n=e.index()+1,s=i?"/image/new/cbir/results/similar/more":"/image/new/cbir/results/similar/thumb";c.hit({dtype:"iweb",path:s,pos:n,reqid:this.params.reqid})}}),BEM.DOM.decl("dist",{_onYesClick:function(){this.sendStredCounter(this.params.counters.click)},_onNoClick:function(){this.sendStredCounter(this.params.counters.close)},sendStredCounter:function(t){cp({pid:this.params.counters.pid,cid:this.params.counters.cid,path:t.path,vars:t.vars})}},{live:function(){return this.liveBindTo({elem:"button",modName:"action",modVal:"yes"},"click",function(){this._onYesClick()}).liveBindTo({elem:"button",modName:"action",modVal:"no"},"click",function(){this._onNoClick()}),!1}}),BEM.DOM.decl({block:"dist",modName:"modal",modVal:"yes"},{_onNoClick:function(){this.__base.apply(this,arguments),this.hidePopup()},showPopup:function(){var t=this._getPopup();t.show({bottom:-this.domElem.height()+"px",left:(document.documentElement.clientWidth-t.domElem.width())/2+"px"}),t.domElem.css({bottom:0})},hidePopup:function(){this._getPopup().hide()},_getPopup:function(){return this._popup||(this._popup=this.findBlockOn("popup"))}}),BEM.DOM.decl({block:"dist",modName:"kind",modVal:"popup"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.footer.on("distro",this._onDistroShow,this),setTimeout(this.showPopup.bind(this),this.params.timeout.show)}},getDefaultParams:function(){return{timeout:{show:1e4}}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks.footer.un("distro",this._onDistroShow,this)},showPopup:function(){return this.__base.apply(this,arguments),this.sendStredCounter(this.params.counters.show),this},_onDistroShow:function(t,e){"show"===e&&this.hidePopup()},hidePopup:function(){this.__base.apply(this,arguments),this.destruct()},_installationCancelled:function(){this.__base.apply(this,arguments),this.hidePopup()},_installed:function(){this.__base.apply(this,arguments),this.hidePopup()}}),BEM.DOM.decl({block:"dist",modName:"kind",modVal:"wizard"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.sendStredCounter(this.params.counters.show)}},_onNoClick:function(){this.__base.apply(this,arguments),this.setMod("visibility","hidden")},_installationCancelled:function(){this.__base.apply(this,arguments),this.setMod("visibility","hidden")},_installed:function(){this.__base.apply(this,arguments),this.setMod("visibility","hidden")}},{live:function(){return this.__base(),this.liveBindTo(BEM.blocks["i-ua"].getTransitionEndEvent(),function(){"hidden"===this.getMod("visibility")&&BEM.DOM.destruct(this.domElem)}),!1}}),BEM.DOM.decl({block:"dist",modName:"action",modVal:"extension"},{_onYesClick:function(){this.__base.apply(this,arguments),BEM.create("chrome-webstore-item",{url:this.params.extensionLink}).on({installed:this._installed.bind(this),installationCancelled:this._installationCancelled.bind(this),installationFailed:function(){}}).install()},_installed:function(){this.__base.apply(this,arguments);var t=this.params.counters.install;this.sendStredCounter({path:t.path,vars:t.vars})},_installationCancelled:function(){this.__base.apply(this,arguments);var t=this.params.counters.close;this.sendStredCounter({path:t.path,vars:t.vars})}}),$.extend({debounce:function(t,e,i,n){var s;return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),function(){var o=arguments;n=n||this,i&&!s&&t.apply(n,o),clearTimeout(s),s=setTimeout(function(){i||t.apply(n,o),s=null},e)}},throttle:function(t,e,i){var n,s,o;return function(){s=arguments,o=!0,i=i||this,n||function(){o?(t.apply(i,s),o=!1,n=setTimeout(arguments.callee,e)):n=null}()}}}),BEM.DOM.decl("header",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindToWin("resize",$.throttle(this._onResize,150)),this._collapseUserIfNeeded()}}},_onResize:function(){this._collapseUserIfNeeded()},_onUserUpdatesName:function(){this._collapseBreakpoint=null,this._collapseUserIfNeeded()},_collapseUserIfNeeded:function(){var t=this._getUser();t&&t.toggleCollapsed(this._getCollapseBreakpoint()>=this.elem("nav").width())},_getCollapseBreakpoint:function(){return this._collapseBreakpoint||(this._collapseBreakpoint=this._getNavItemsWidth()+this.__self.NAV_ITEMS_GAP),this._collapseBreakpoint},_getNavItemsWidth:function(){var t=0;return this.elem("nav").children().each(function(){t+=$(this).outerWidth(!0)}),t},_getUser:function(){return this._user?this._user._isDestructing&&(this._collapseBreakpoint=null,this._user=this.findBlockInside("user")):(this._user=this.findBlockInside("user"),this._user&&this._user.on("update-name",this._onUserUpdatesName,this)),this._user}},{NAV_ITEMS_GAP:10,live:!1}),BEM.DOM.decl("header",{},{live:function(){return this.liveBindTo("action","click",function(t){t.preventDefault()}),this.__base.apply(this,arguments)}}),BEM.DOM.decl("header",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.__self.instance=this,this.__self.searchBlock=this.findBlockInside("search")||this.findBlockInside("search2"),this._syncState().bindEvents()},type:function(){this.afterCurrentEvent(function(){this.trigger("resize")})}},bindEvents:function(){return this.bindTo(this.elem("action","type","adv"),"pressed",function(){this._getAdvanced(),this.setMod("type","advanced")}),this.bindTo(this.elem("action","type","adv"),"released",function(){this.delMod("type")}),"fixed"!==this.getMod("filters")&&this.params.filtersAutoopen&&this.afterCurrentEvent(function(){this.setMod(this.elem("action","type","adv"),"pressed","yes")}),this.bindTo(this.elem("action","type","srv"),"pressed",function(){this.findBlockInside("services-table").updateServicesLink()}),this},_syncState:function(){var t=this.getFiltersCount();return t>0&&this._isFiltersCountHidden()&&(this.params.filtersAutoopen=t),this},_getAdvanced:function(){return this._advancedSearch||(this._advancedSearch=this.findBlockInside("advanced-search"))},getHeight:function(){return this.domElem.height()}},{get:function(){return this.instance||(this.instance=$(this.buildSelector()).bem(this.getName()))},getSearch:function(){return this.searchBlock||(this.searchBlock=$(".search").length?$(".search").bem("search"):$(".search2").bem("search2"))}}),BEM.DOM.decl("header",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindTo(this.elem("action","type","adv"),"click",function(){w(this,"/image/new/filters/"+(this.hasMod("type","advanced")?"close":"open"))})}}}),BEM.DOM.decl("user",{redraw:function(){return this}},{getLogoutUrl:function(){var t=BEM.blocks["i-global"],e=t.param("retpath"),i=t.param("yandexuid");return[t.param("passport-host"),"/passport?mode=logout",i?"&yu="+i:"",e?"&retpath="+encodeURIComponent(e):""].join("")}}),BEM.DOM.decl("user",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._isRetina=BEM.blocks["i-ua"].hiDpi,this._isRetina&&this.updateIcon()}}},_getIconPath:function(t){var e=this.params.avatarHost,i=this._getIconSize(),n=(this._isRetina?"/islands-retina-":"/islands-")+i;return[e,"/get-yapic/",t,n,"?rnd=",Number(new Date)].join("")},_setIconBackground:function(t){var e=this.elem("icon");e&&e.css("background-image","url("+t+")")},updateIcon:function(){this.elem("icon").length&&this._setIconBackground(this._getIconPath(this.elemParams("icon").avatarId))},getDefaultParams:function(){return $.extend(this.__base(),{avatarHost:"//avatars.mds.yandex.net"})}}),BEM.DOM.decl("user",{_getIconSize:function(){return"middle"}}),BEM.decl("i-common__string",{},{cleverSubstring:function(){var t="…";return function(e,i,n){return e.length>i+n?e.substring(0,i-1)+t:e}}(),escapeHTML:function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"};return function(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return t[e]||e})}}(),escapeRegExp:function(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},highlight:function(t,e){if(!$.isArray(e))return t;var i,n=[],s=0,o=e.sort(function(t,e){return t[0]-e[0]}),r=[],a="?",c=~t.indexOf(a),h=function(){for(var e,i=/\&#\d+;/gi;e=i.exec(t);)r.push(e[0]),t=t.replace(e[0],a)},u=function(t){if(c)return t;for(;~t.indexOf(a)&&r.length;)t=t.replace(a,r[0]),r.shift();return t};return!c&&h(),o.forEach(function(e){i=s>e[0]?s:e[0],n.push({tag:"span",elem:"span",content:u(t.slice(s,i))}),n.push({tag:"em",elem:"em",content:u(t.slice(i,s=e[1]))})},this),n.push({tag:"span",elem:"span",content:u(t.slice(s))}),n}}),BEM.DOM.decl("user",{onSetMod:{js:{inited:function(){if(this.__base.apply(this,arguments),this.elem("name").length){var t=this,e=t.elemParams("name");e.isUglyUserName&&BEM.blocks["i-user-services"].get(function(i){var n=BEM.blocks["i-common__string"].cleverSubstring,s=BEM.blocks["i-common__string"].escapeHTML,o=Object(i.displayName).name||i.login,r=n(o,e.maxLength,e.maxLengthRelative);r=s(r),r='<span class="user__first-letter">'+r.charAt(0)+"</span>"+r.slice(1),t.elem("name").html(r),t.trigger("update-name")})}}}},toggleCollapsed:function(t){return this.toggleMod("hide-name","yes","",t)}}),BEM.DOM.decl("user",{_setUsernameVisibility:$.noop}),BEM.decl("i-user-services",{},{get:function(t){this._data?t(this._data):this._get(t)},getApiUrl:function(){return BEM.blocks["i-global"].param("pass-host")+"/services?callback=?"},_callbacks:[],_get:function(t){var e=this;e._callbacks.push(t),1===e._callbacks.length&&$.getJSON(e.getApiUrl(),{locale:BEM.blocks["i-global"].param("lang"),login:"yes","current-login":BEM.blocks["i-global"].param("login"),yu:$.cookie("yandexuid")},function(t){e._data=t,$.each(e._callbacks,function(){this(t)}),e._callbacks.length=0})}}),BEM.DOM.decl("user",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.findBlockOn("enter","button");if(null!==t){var e=this.domElem.prop("tabindex");this.domElem.attr({tabindex:-1,role:"group"}).removeAttr("aria-haspopup aria-expanded"),t.domElem.attr("tabindex",e),this._domik=BEM.create("domik_type_popup",{mods:this.params.domikMods,js:this.params.domikJs,hidden:this.findBlockInside({block:"domik",modName:"type",modVal:"hidden"})}),t.bindTo("pointerclick",function(t){t.preventDefault(),this._domik.open()}.bind(this))}}}},destruct:function(){this._domik&&this._domik.destruct(),this.__base.apply(this,arguments)}}),BEM.DOM.decl("user",{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=this.findBlockOn("enter","button");null!==t&&t.on("click",function(t){t.preventDefault(),this._domik.open()}.bind(this))}},destruct:function(){this._domik&&this._domik.destruct(),this.__base.apply(this,arguments)}}),BEM.DOM.decl({name:"button",modName:"pseudo",modVal:"yes"},{_onClick:function(t){this.__base.apply(this,arguments),this._href&&t.preventDefault()}}),BEM.decl("domik_type_popup",{destruct:function(){this._form&&this._form.destruct(),this._popup&&this._popup.destruct(),this.__base.apply(this,arguments)},create:function(){if(this._created)return this;var t,e,i=this.__self,n=i._buildTypePopup(this._uniqId,this.params.mods,this.params.js),s=$(BEMHTML.apply(n)),o=this.params.hidden;if(BEM.DOM.append(BEM.DOM.scope,s),e=this._popup=s.bem("popup"),t=this._form=this._popup.findBlockInside("auth"),o){var r=o.domElem;t.getUsernameBlock().val(r.find("input[name=login]").change().val()),t.getPasswordBlock().val(r.find("input[name=passwd]").change().val()),delete this.params.hidden,o.destruct()}return this._created=!0,this},open:function(){return BEM.blocks["i-global"].param("login")?this:(this._created||this.create(),this.close(),this._popup.show(),this.afterCurrentEvent(function(){BEM.blocks["i-ua"].ios||this._form.getUsernameBlock().setMod("focused","yes"),this._form.redraw()}),this)},close:function(){return this._popup.hide(),this},isOpened:function(){return this._popup&&this._popup.isShown()||!1},getFormBlock:function(){return this._form}},{_buildTypePopup:function(t,e,i){var n=(i||{}).explain,s={block:"popup",mix:[{block:"domik",elem:"popup"}],mods:{type:"modal",position:"fixed","body-scroll":"no",theme:"ffffff"},underMods:{type:"paranja"},content:{elem:"content",content:{block:"domik",js:$.extend({_uniqId:t},i),mods:$.extend({type:"popup"},e),content:[n?{elem:"explain",content:n}:"",{block:"auth",mods:{content:"auto"}}]}}};return BEM.blocks["i-ua"].ios>=8?$.extend(s,{js:{left:"50%",top:150},attrs:{style:"position: absolute;"}}):s}}),BEM.decl("domik_type_popup",{open:function(){var t=this;return BEM.blocks["i-global"].param("login")?this:(this._created||this.create(),this.close(),this._popup.show(),this.afterCurrentEvent(function(){!BEM.blocks["i-global"].param("tablet")&&t._form.getUsernameBlock().setMod("focused","yes"),t._form.redraw()}),this)}}),BEM.DOM.decl({block:"popup",modName:"type",modVal:"modal"},{getDefaultParams:function(){var t=this.__base();return t.top="50%",t.left="50%",t},_isPercentVal:function(t){return"string"==typeof t&&t.indexOf("%")>0},show:function(t){return this._moveToContainer(),this.setMod("visibility","outside").setMod("adaptive","no"),this.repaint(t),this},repaint:function(t){this._moveToContainer(),t||(t={left:this.params.left,top:this.params.top});var e=this.getPopupSize();return this._isPercentVal(t.left)&&!t.marginLeft&&(t.marginLeft=e.width/(-100/parseInt(t.left,10))),this._isPercentVal(t.top)&&!t.marginTop&&(t.marginTop=e.height/(-100/parseInt(t.top,10))),this._show(t),this}}),function(){var t={};BEM.DOM.decl({block:"popup",modName:"body-scroll",modVal:"no"},{onSetMod:{visibility:function(){return this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visibility","visible")?t[this.params.uniqId]=!0:delete t[this.params.uniqId],this._manageScopeOverflow()}),this.__base()}},destruct:function(){var e=this.params.uniqId;t[e]&&(delete t[e],this._manageScopeOverflow()),this.__base.apply(this,arguments)},_enableScroll:function(){return this._scope.css({overflow:""}),this},_disableScroll:function(){return this._scope.css({overflow:"hidden"}),this},_manageScopeOverflow:function(){var e=Object.keys(t).length;0===e?this._enableScroll():1===e&&this._disableScroll()}})}(),BEM.DOM.decl("auth",{onSetMod:{js:{inited:function(){this._username=this.findBlockInside("username","input"),this._password=this.findBlockInside("password","input"),this._button=this.findBlockInside("button","button2"),this._register=this.findBlockInside("register","button2"),this._remember=this.findBlockInside("remember","button2"),this._button||(this._button=this.findBlockInside("button","button")),this._register||(this._register=this.findBlockInside("register","button")),this._remember||(this._remember=this.findBlockInside("remember","button")),this._error=null,this._errorOwner=null,this._username.on("change",this._onInputChange,this),this._password.on("change",this._onInputChange,this),this.bindTo("submit",this._onBeforeSubmit),this.redraw()}}},_checkInput:function(t){var e=this,i=this.__self._getValidators(e,e._username.val(),e._password.val(),{checkEmpty:t}),n=i.every(function(t){var i=t();return Array.isArray(i)?(e.showError(i[0],BEM.I18N("auth",i[1])),i[0].elem("control").attr("aria-invalid",!0),!1):!0});return n&&(this.hideError(),this._username.elem("control").removeAttr("aria-invalid"),this._password.elem("control").removeAttr("aria-invalid")),n},_onInputChange:function(){this._checkInput(!1)},enableButton:function(){return this._button.delMod("disabled"),this},disableButton:function(){return this._button.setMod("disabled","yes"),this},_onBeforeSubmit:function(t){return this._username.val(this._username.val().trim()),this._checkInput(!0)?(this._onSubmit(t),void this.trigger("submit",t)):!1},_onSubmit:function(){this.disableButton().setRetpath(this.getRetpath(),!0),this.elem("timestamp").val((new Date).getTime())},_getError:function(){if(this._error)return this._error;var t=$(BEMHTML.apply(this.__self._buildError()));return BEM.DOM.append(this.domElem,t),this._error=this.findBlockOn(t,"popup"),this._errorMsg=this.findElem(t,"error"),this._error.on("hide",function(){this._errorOwner=null},this),this._error},showError:function(t,e){var i=this._getError();return this._curErrorMsg!==e&&(this._errorMsg.text(e),this._curErrorMsg=e),this._errorOwner!==t&&(this._errorOwner=t,i.hide().show(t)),this},hideError:function(){return this._error&&this._error.hide(),this},getUsernameBlock:function(){return this._username},getPasswordBlock:function(){return this._password},getHaunterBlock:function(){return this._haunter||(this._haunter=this.findBlockInside("haunter","checkbox")),this._haunter},submit:function(){return this.domElem.submit(),this},redraw:function(){return this._onInputChange(),this._register&&this._register.setUrl(this.getRegisterURL()),this._remember&&this._remember.setUrl(this.getRememberURL()),this},setRetpath:function(t){return this.elem("retpath").val(t),this},getRetpath:function(){return this.elem("retpath").val()},getRegisterURL:function(){return this._getPassportURL("registration")},getRememberURL:function(){return this._getPassportURL("restoration")},_getPassportURL:function(t){return this.params.passport+"/"+t+"?"+$.param({from:this.elem("from").val(),origin:this.elem("origin").val(),retpath:this.getRetpath()})},destruct:function(){this._error&&this._error.destruct(),this.__base.apply(this,arguments)},getDefaultParams:function(){return{passport:BEM.blocks["i-global"].param("passport-host")}}},{_fromName:"from",_retpathName:"retpath",_isUsernameValid:function(t,e){return this._isUsernameEmailValid(t)||this._isUsernameLoginValid(t)||this._isUsernamePhoneValid(t,e)},_isUsernameEmailValid:function(t){return/^\s*[^@\s]+@[^@\s]+\s*$/.test(t)},_isUsernameLoginValid:function(t){return/^\s*[-а-яА-ЯёЁA-Za-z0-9.]+\s*$/.test(t)},_isUsernamePhoneValid:function(t,e){return e?(t=t.trim(),t=t.replace(/-\)/,"+)"),t=t.replace(/(\d)-/g,"$1"),t=t.replace(/\((\d+)\)/,"$1"),t=t.replace(/(^|\d+)\(/,"$1"),t=t.replace(/^\+/,""),/^\d*$/.test(t)):/^\+?[-0-9]*(?:\([-0-9]+\))?[-0-9]+$/.test(t)},_isPasswordValid:function(t){return!/[^\-a-zA-Z0-9`!@#$%^&*()_=+\[\]{};:"\|\\,.<>\/?]/.test(t)},_getRetpath:function(){return BEM.blocks["i-global"].param("retpath")},_getPassportURL:function(t){var e=BEM.blocks["i-global"],i=e.param("passport-host"),n=e.param("passport-msg"),s=this._getRetpath();return[i,"/passport?mode=",t,n?"&"+this._fromName+"="+encodeURIComponent(n):"",s?"&"+this._retpathName+"="+encodeURIComponent(s):""].join("")},_getRegisterURL:function(){return this._getPassportURL("register")},_getRememberURL:function(){return this._getPassportURL("restore")},_buildError:function(){return{block:"popup",mods:{autoclosable:"no"},js:{directions:["right","left"]},attrs:{role:"alert","aria-live":"assertive","aria-atomic":!0},content:[{elem:"tail"},{elem:"content",mix:[{block:"auth",elem:"error"}]}]}},_getValidators:function(t,e,i,n){var s=n.checkEmpty,o=this;return[function(){return s&&0===e.length?[t._username,"fill-input"]:!0},function(){return s&&0===i.length?[t._password,"fill-input"]:!0},function(){return/[а-яА-ЯёЁ]/.test(i)?[t._password,"wrong-keyboard-layout"]:!0},function(){return o._isUsernameValid(e,!s)?!0:[t._username,"wrong-characters"]},function(){return o._isPasswordValid(i)?!0:[t._password,"wrong-characters"]},function(){return i&&i===e?[t._password,"wrong-password"]:!0}]}}),BEM.DOM.decl("auth",{},{_getRetpath:function(){var t=BEM.blocks.location.getInstance().getState().url;return t+(-1!==t.indexOf("?")?"&":"?")+"rnd="+Number(new Date)}}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base(),this._tailPos={}}}},_calcTailPos:function(t){var e=t.to,i=this._positions[t.key],n=t.tail.axis,s={};return"top"===e||"bottom"===e?s.left=this._calcTailLeft(n,i):("left"===e||"right"===e)&&(s.top=this._calcTailTop(n,i)),s},_calcTailTop:function(t,e){var i=0,n=this.getOwnerSize(),s=this.getOwnerPos(),o=this.params.tail.width,r=this.getPopupSize(),a=r.height,c=s.top-e.top,h=e.top+r.height-(s.top+n.height);return c>0&&(i+=c,a-=c),h>0&&(a-=h),"middle"===t?(a-=o,i+=a/2):"bottom"===t&&(a-=o,i+=a),0>i&&(i=0),i},_calcTailLeft:function(t,e){var i=0,n=this.getOwnerSize(),s=this.getOwnerPos(),o=this.params.tail.width,r=this.getPopupSize(),a=s.left-e.left,c=r.width,h=e.left+r.width-(s.left+n.width);return a>0&&(i+=a,c-=a),h>0&&(c-=h),"center"===t?(c-=o,i+=c/2):"right"===t&&(c-=o,i+=c),i},_calcOffsetByTail:function(t){var e=this.params.tail,i=e.height,n={};switch(t.to){case"top":n={top:-i};break;case"bottom":n={top:i};break;case"right":n={left:i};break;case"left":n={left:-i}}return n},_calcTailOffset:function(t){var e={},i=t.to,n=t.tail,s=n.offset,o=n.axis;return s?("top"===i||"bottom"===i?(e.left=0,"left"===o?e.left+=s.left:"center"===o?(s.left&&(e.left+=s.left),s.right&&(e.left-=s.right)):"right"===o&&(e.left-=s.right)):("left"===i||"right"===i)&&(e.top=0,"top"===o?e.top+=s.top:"middle"===o?(s.top&&(e.top+=s.top),s.bottom&&(e.top-=s.bottom)):"bottom"===o&&(e.top-=s.bottom)),e):!1},_resetTailPos:function(t){return t?this._tailPos[t]=null:this._tailPos={},this},_pushTailPos:function(t,e){return this._pushPosTo(this._tailPos,t,e),this}}),BEM.DOM.decl("auth",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._socialDropdown=null,this._socialBroker=null,this._initSocialProviders()}}},_initSocialProviders:function(){var t=BEM.blocks["i-global"],e=t.param("social-providers"),i=this;if(e)i._createSocial(e);else{var n=t.param("social-host");if(!n)return;i._getSocialProviders(n,function(t){i._createSocial(t)})}},_getSocialProviders:function(t,e){$.getJSON(this.__self._getProvidersURL(t),function(t){e(t.providers)})},_createSocial:function(t){return t.length?(BEM.DOM.update(this.elem("social"),BEMHTML.apply(this.__self._buildSocial(t,this._uniqId))),void(this._socialDropdown=this.findBlockInside("social","dropdown"))):(this.elem("social").remove(),void this.dropElemCache("social"))},_onSocialClick:function(t){var e=this;t.preventDefault(),this._socialDropdown&&this._socialDropdown.hide(),this._socialBroker&&this._socialBroker.destruct(),this._socialBroker=BEM.create("social-broker"),this._socialBroker.start(function(){var t=e.getRetpath(),i=this.__self._getTopWindow().location;t&&i.href!==t?i.href=t:i.reload()}.bind(this),$.noop,{provider:this.elemParams(t.data.domElem).provider})}},{live:function(){return this.liveBindTo("social-link","pointerclick",this.prototype._onSocialClick).liveBindTo("social-link","keyup",function(t){var e=t.keyCode===BEM.blocks.keycodes.SPACE;!e||t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||this._onSocialClick(t)}),this.__base(),!1},_getProvidersURL:function(t){return t+"/providers2.jsonp?callback=?"},_buildSocial:function(t,e){var i,n,s=[];if(t=t.filter(function(t){return t.enabled}),i=t.filter(function(t){return t.primary}).map(function(t){return{block:"link",mods:{theme:"normal"},mix:{block:"auth",elem:"social-link",js:{provider:t.code}},title:t.display_name,icon:{block:"auth",elem:"social-icon",elemMods:{code:t.code}}}}),s=s.concat(i),n=t.map(function(t){return{block:"link",mods:{theme:"normal"},mix:{block:"auth",elem:"social-link",js:{provider:t.code}},title:t.display_name,icon:{block:"auth",elem:"social-icon",elemMods:{code:t.code}},text:{mix:{block:"auth",elem:"social-text"},content:BEM.blocks["i-common__string"].escapeHTML(t.display_name)}}}),i.length<t.length){var o=BEM.I18N("auth","more");s.push({block:"dropdown",js:!0,content:[{block:"button",mods:{pseudo:"yes",theme:"pseudo",size:"s"},mix:[{block:"dropdown",elem:"switcher"}],attrs:{title:o,"aria-label":o},content:"· · ·"},{elem:"popup",content:{block:"auth",elem:"social-popup",mix:[{block:"auth",js:{uniqId:e}}],content:n}}]})}return s},_getTopWindow:function(){return window.top},_socialStubHeight:24}),BEM.decl("social-broker",{_windowWidth:500,_windowHeight:280,onSetMod:{js:{inited:function(){this._window=null,this._timer=0,this._salt=0
}}},start:function(t,e,i){var n,s,o,r,a=this;if(this._cleanup(),this._onSuccess=t,this._onFailure=e,i=$.extend({},a._getDefaultParams(),i),n=i.startUrl+"?",r=i.popupName,delete i.startUrl,delete i.popupName,s=i.display,o=i.retpath,s&&"popup"!==s&&(i.retpath=i.retnopopup||i.retpath||window.location.href,delete i.retnopopup),n+=Object.keys(i).reduce(function(t,e){return t.push(encodeURIComponent(e)+"="+encodeURIComponent(i[e])),t},[]).join("&"),s&&"popup"!==s)return void this._navigate(n);this._salt=Math.floor(1e9*Math.random()).toString(16);var c=r+"_"+this._salt;return this._lsLoginStatusKey="login_status_from_"+c,this._window=window.open(n,c,this._getPopupParams(),!1),this._window?(this._window.focus(),clearInterval(this._timer),void(this._timer=setInterval(function(){var t=window.localStorage.getItem(a._lsLoginStatusKey);if(a.isClosed()&&(clearInterval(a._timer),!t))return void a.onFailure({status:"error"});if(t){var e=a._deserialize(t);a._handleStatus(e)===!1&&a.onFailure({status:"error"})}},500))):void this.onFailure({status:"error"})},_deserialize:function(t){var e;try{e=JSON.parse(t)}catch(i){e={raw:t}}return e},_handleStatus:function(t){return"ok"===t.status?(this.onSuccess(t),!0):"error"===t.status?(this.onFailure(t),!0):!1},isClosed:function(){return this._window?this._window.closed:!0},_navigate:function(t){window.location.href=t},_getDefaultParams:function(){var t=BEM.blocks["i-global"],e=t.param("id");return{startUrl:t.param("social-startUrl")||t.param("social-host")+"/broker/start",retpath:t.param("social-retpath")||[location.protocol,"//",location.host,t.param("lego-path"),"/common.blocks/social-broker/__closer/social-broker__closer.html"].join(""),retnopopup:t.param("social-retnopopup")||!1,consumer:e||"morda",popupName:"social_"+(e||"morda"),action_if_anonymous:"authorize",result_location:"fragment"}},_getPositionedParams:function(t,e,i,n){return["scrollbars=yes, resizable=1, menubar=0, toolbar=0, status=0, location=0, directories=0",", left=",e,", top=",t,", width=",i,", height=",n].join("")},_getPopupParams:function(){var t,e,i=this._windowWidth,n=this._windowHeight;return window.opera?(t=(screen.availWidth-i)/2,e=(screen.availHeight-n)/2):(t=(window.innerWidth-i)/2,e=(window.innerHeight-n)/2),t=Math.round(t),e=Math.round(e),this._getPositionedParams(e,t,i,n)},_cleanup:function(){clearInterval(this._timer),this._lsLoginStatusKey&&window.localStorage.removeItem(this._lsLoginStatusKey),this.isClosed()||this._window.close(),this._window=null},onSuccess:function(t){this._cleanup(),this._onSuccess&&this._onSuccess(t)},onFailure:function(t){this._cleanup(),this._onFailure&&this._onFailure(t)},destruct:function(){this._cleanup(),this.__base.apply(this,arguments)}},{start:function(){this._current&&this._current.destruct(),this._current=BEM.create("social-broker"),this._current.start.apply(this._current,arguments)},onSuccess:function(){this._current.onSuccess.apply(this._current,arguments)},onFailure:function(){this._current.onFailure.apply(this._current,arguments)}}),BEM.DOM.decl("dropdown",{onSetMod:{js:{inited:function(){var t=this,e=t.params,i=t.findBlockOn(t.elem(e.popupElem),"popup"),n=t.elem("switcher"),s=e.switcherBlock;t._popup=i,t._switcher=n,i.on("show",t._onPopupShow,t).on("hide",t._onPopupHide,t),e.popupMethods.map(function(e){t[e]=i[e].bind(i)}),s&&(t._switcher=t.findBlockOn(n,s).domElem),n.attr({"aria-haspopup":!0,"aria-expanded":!1})}},action:function(t,e){var i="open"===e;this.elem("switcher").attr("aria-expanded",i),this._getButton()&&this._getButton().toggleMod("arrow","up","down",i)}},getPopup:function(){return this._popup},_getButton:function(){return this._button||(this._button=this.findBlockInside("switcher","button")),this._button},_toggle:function(){this._popup.toggle(this._switcher)},_onSwitcherClick:function(){this._toggle()},_onSwitcherKeyUp:function(t){if(!(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey)){var e=this.elem("switcher")[0].tagName.toLowerCase(),i=BEM.blocks.keycodes;"button"!==e&&("a"!==e&&t.keyCode===i.ENTER||t.keyCode===i.SPACE)&&(t.preventDefault(),this.params.switcherBlock||this._toggle())}},_onPopupShow:function(){this.setMod("action","open").trigger("show")},_onPopupHide:function(){this.setMod("action","closed").trigger("hide")},destruct:function(){this._popup.un("show",this._onPopupShow,this).un("hide",this._onPopupHide,this),this._popup.domElem&&BEM.DOM.destruct(this._popup.domElem),this.__base.apply(this,arguments)},getDefaultParams:function(){return{popupElem:"popup",popupMethods:["toggle","show","hide","setContent"]}}},{live:function(){this.liveBindTo("switcher","pointerclick",function(t){this._onSwitcherClick(t)}).liveBindTo("switcher","keyup",function(t){this._onSwitcherKeyUp(t)})}}),BEM.DOM.decl("i-ua",{},{placeholder:"placeholder"in document.createElement("input")}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this._val=this.elem("control").val()}},disabled:{"*":function(t,e){this.elem("control").attr("disabled","yes"===e)},yes:function(){this.delMod("focused")}},focused:function(t,e){if(this.hasMod("disabled","yes"))return!1;var i="yes"===e;i?this._focused||this._focus():this._focused&&this._blur(),this.afterCurrentEvent(function(){this.trigger(i?"focus":"blur")})}},isDisabled:function(){return this.hasMod("disabled","yes")},val:function(t,e){if("undefined"==typeof t)return this._val;t=null===t?"":t.toString();var i=this.elem("control");return i.val()!==t&&i.val(t),this._val=t,this.trigger("change",e),this},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getSelectionEnd:function(){var t=this.elem("control")[0],e=0;if("number"==typeof t.selectionEnd)e=t.selectionEnd;else{var i=document.selection.createRange();if(i&&i.parentElement()===t){var n=t.value.length,s=t.createTextRange();s.moveToBookmark(i.getBookmark());var o=t.createTextRange();o.collapse(!1),e=s.compareEndPoints("EndToEnd",o)>-1?n:-s.moveEnd("character",-n)}}return e},_onFocus:function(){return this._focused=!0,this.setMod("focused","yes")},_onBlur:function(){return this._returnFocus?(this.afterCurrentEvent(function(){this._focus()}),this):this.hasMod(this.elem("clear"),"pressed")?this:(this._focused=!1,this.delMod("focused"))},_focus:function(){return this.hasMod("disabled","yes")?!1:void this.elem("control").focus()},_blur:function(){this._returnFocus=!1,this.elem("control").blur()},destruct:function(){this._blur(),this.__base.apply(this,arguments)}},{live:function(){this.liveBindTo("control","focusin focusout",function(t){this["focusin"===t.type?"_onFocus":"_onBlur"](t)})}}),function(){var t,e=[],i=function(){e.forEach(function(t){t.val(t.elem("control").val())})};BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._instanceIndex=e.push(this)-1;var n=this.elem("control"),s=$.dom.getActiveElement(),o=this.params.autoFocus&&!s.is("input, textarea");(s[0]===n[0]||o)&&(this.setMod("focused","yes")._focused=!0),t||(t=this.channel("sys").on({tick:i,idle:this._onSysIdle,wakeup:this._onSysWakeup})),this.params.shortcut&&this.bindToDoc("keydown",function(t){t.ctrlKey&&t.which===BEM.blocks.keycodes.UP&&!$(t.target).is("input, textarea")&&this.setMod("focused","yes")})}}},val:function(t,e){var i="undefined"!=typeof t,n=this.elem("control");return t=i?null===t?"":t.toString():n.val(),this._val!==t&&(this._val=t,n.val()!==t&&n.val(t),this.trigger("change",e)),i?this:t},_focus:function(){if(this.__base()===!1)return!1;var t=this.elem("control")[0];if(t.createTextRange&&!t.selectionStart){var e=t.createTextRange();e.move("character",t.value.length),e.select()}},_onSysIdle:function(){t.un("tick",i)},_onSysWakeup:function(){t.on("tick",i)},destruct:function(){this.__base.apply(this,arguments),this.params.shortcut&&this.unbindFromDoc("keydown"),e.splice(this._instanceIndex,1),e.slice(this._instanceIndex).forEach(function(t){t._instanceIndex--}),t.un({idle:this._onSysIdle,wakeup:this._onSysWakeup})},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.__base()}})}(),BEM.DOM.decl("input",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindTo(this.domElem,"keypress",this._onKeyPress)}},_onKeyPress:function(t){this.trigger("keypress",t)},setFocus:function(){return this.setMod("focused","yes")}}),function(){var t,e=0,i=!1,n=0,s=BEM.channel("sys"),o=window.setTimeout,r=50;BEM.decl("i-system",{},{start:function(){$(document).bind("mousemove keydown",function(){n=0,i&&(i=!1,s.trigger("wakeup"))}),this._tick()},_tick:function a(){s.trigger("tick",{counter:e++}),!i&&(n+=r)>3e3&&(i=!0,s.trigger("idle")),t=o(a,r)}}).start()}(),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.on("change",this._updateClear)._updateClear()}}},_onClearClick:function(){return this.trigger("clear"),this.removeInsets&&this.removeInsets(),this.clearInput({source:"clear"})._focus()},clearInput:function(t){return this.val("",t),this},_updateClear:function(){return this.toggleMod(this.elem("clear"),"visibility","visible",Boolean(this._val))}},{live:function(){return this.liveBindTo("clear","pointerpress",function(){this.setMod(this.elem("clear"),"pressed","yes")}).liveBindTo("clear","pointerclick",function(){this.delMod(this.elem("clear"),"pressed"),this._onClearClick()}).liveBindTo("control","paste",function(){this.setMod(this.elem("clear"),"visibility","visible")}),this.__base()}}),BEM.DOM.decl("input",{_onBoxClear:function(){BEM.blocks["b-page"].preventFocus||this.__base.apply(this,arguments)}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){if(this.__base.apply(this,arguments),this.elem("found").length){var t=this.elem("control");$("<span/>",{"class":this.buildSelector("query-holder").slice(1)}).css({"font-family":t.css("font-family"),"font-size":t.css("font-size")}).text(this.val()).appendTo(this.domElem),this._controlQueryLeftOffset=parseInt(t.css("padding-left"),10)+(parseInt(t.css("border-left-width"),10)||0),this.on("change",this._toggleVisibility).bindToWin("resize",$.throttle(this._onWindowResize,100,this)).setPosition()}}}},_toggleVisibility:function(){var t=this.val()===this.elem("query-holder").text()&&this.textWidth<this.inputWidth&&Boolean(this.elem("found").text());this.toggleMod(this.elem("found"),"visibility","visible","",t)},setPosition:function(){var t=this.elem("control"),e=this.elem("found"),i=t.offset().left-this.domElem.offset().left+this._controlQueryLeftOffset+this.elem("query-holder").width();this.inputWidth=t.width(),this.textWidth=e.width()+i,e.css({left:i}),this._toggleVisibility()},_onWindowResize:function(){this.inputWidth=this.elem("control").width(),this._toggleVisibility()},setFound:function(t,e){this.elem("found").text(t),this.elem("query-holder").text(e),this.setPosition()}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindTo("found","pointerdown",function(){this.setMod("focused","yes")})}}}}),BEM.DOM.decl({block:"input",modName:"found",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._setLabelAjax();var t=BEM.blocks["i-global"].getFlag("video_mega_header")?"search2":"search";BEM.blocks[t].on("search:found:update",this._onFoundUpdate,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks.search.un("search:found:update",this._onFoundUpdate,this)},_onFoundUpdate:function(t,e){this.params.foundNum=e.foundNum,this.setFound(e.foundValue,BEM.blocks["i-common__string"].escapeHTML(e.text))},_setLabelAjax:function(){var t=this.findBlockInside("service"),e=t&&this.findBlockInside("link");!BEM.blocks["i-global"].param("isPumpkin")&&e&&e.setMod("ajax","yes")}}),BEM.DOM.decl("i-services",{getServicePath:function(t){var e=this.params[t],i=encodeURIComponent(BEM.blocks["i-global"].param("searchInputText").trim());return e&&i?e.search+i+(e.params||""):""},getServiceUrl:function(t){return(this.params[t]||{}).baseUrl}}),BEM.DOM.decl({block:"input",modName:"cbir",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindEvents().findBlocks()}},findBlocks:function(){return this.cbirIntent=BEM.blocks.header.getSearch().findBlockInside("cbir-intent"),this},bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo(this.domElem,"keypress",this._onKeyPress),BEM.blocks["cbir-intent"].on("enableInput",this._onEnableInput,this).on("disableInput",this._onDisableInput,this).on("inputFocus",this._onInputFocus,this),BEM.blocks["cbir-panel"].on("inputFocus",this._onInputFocus,this),this},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["cbir-intent"].un("enableInput",this._onEnableInput,this).un("disableInput",this._onDisableInput,this).un("inputFocus",this._onInputFocus,this),BEM.blocks["cbir-panel"].un("inputFocus",this._onInputFocus,this)},disableInput:function(){this.elem("control").attr("disabled",!0),this.delMod(this.elem("clear"),"visibility"),this.setMod(this.elem("box"),"cbir","yes"),this.val("")},_onDisableInput:function(){this.disableInput()},_onEnableInput:function(){this.elem("control").attr("disabled",!1),this.elem("control").val()&&this.setMod(this.elem("clear"),"visibility","visible"),this.delMod(this.elem("box"),"cbir")},_onInputFocus:function(){this.setFocus()}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),(this._hasHint=Boolean(this.elem("hint")[0]))&&this.on("change",this._updateHint)._updateHint()}},focused:function(){return this.__base.apply(this,arguments)===!1?!1:void(this._hasHint&&this._updateHint())}},_updateHint:function(){this.toggleMod(this.elem("hint"),"visibility","visible",!this.val())}}),BEM.DOM.decl({block:"checkbox",baseBlock:"control"},{onSetMod:{js:{inited:function(){var t=this.elem("control");this.toggleMod("checked","yes",t.prop("checked")),this.toggleMod("focused","yes",t.isFocused())}},focused:{yes:function(){return this.__base.apply(this,arguments)===!1?!1:(this.setMod(this.elem("box"),"focused","yes"),void this.afterCurrentEvent(function(){this.trigger("focus")}))},"":function(){this.__base.apply(this,arguments),this.delMod(this.elem("box"),"focused"),this.afterCurrentEvent(function(){this.trigger("blur")})}},hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},checked:function(t,e){this.elem("control").prop("checked","yes"===e),this.afterCurrentEvent(function(){this.trigger("change",{checked:"yes"===e})}),this.setMod(this.elem("box"),"checked",e)},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered").delMod("pressed")}}},isDisabled:function(){return this.hasMod("disabled","yes")},isChecked:function(){return this.hasMod("checked","yes")},toggle:function(){this.toggleMod("checked","yes")},val:function(t){var e=this.elem("control");return"undefined"==typeof t?e.val():(e.val(t),this)},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_onChange:function(t){this.toggleMod("checked","yes",t.target.checked)},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onPointerpress:function(){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){this.trigger("click",{domEvent:t}),this.setMod("focused","yes")},_onKeydown:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.setMod("pressed","yes")},_onKeyup:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.delMod("pressed")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}).liveBindTo("control","keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo("control","keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}).liveBindTo("control","change",function(t){this._onChange(t)}),this.__base()}}),BEM.DOM.decl({block:"user",modName:"menu",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=60;this._dropdown=this.findBlockOutside("dropdown-menu")||0,this._dropdown&&this._dropdown.on("show",function(){this.bindToWin("scroll",$.throttle(this._hide,t,this)).redraw().domElem.attr("aria-expanded",!0)}.bind(this)).on("hide",function(){this.unbindFromWin("scroll").domElem.attr("aria-expanded",!1)}.bind(this))}}},_hide:function(){this._dropdown&&this._dropdown.hide()},_onClick:function(t){t.preventDefault(),this.__base.apply(this,arguments),this._dropdown&&this._dropdown.toggle(this.elem(this.elem("icon").length?"icon":"name"))},redraw:function(){if(this.__base.apply(this,arguments),!this._dropdown)return this;var t=this.__self.getLogoutUrl();return this._dropdown._popup.findBlockInside("user").elem("logout").attr("href",t),this},destruct:function(){this._dropdown&&this._dropdown.domElem&&this._dropdown.destruct(),this.__base.apply(this,arguments)}},{live:function(){return this._menu||(this._menu=!0,this.liveBindTo("pointerclick",function(t){this._onClick(t)}).liveBindTo("keyup",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.SPACE&&this.domElem.click()})),this.__base(),!1}}),BEM.DOM.decl({block:"user",modName:"menu",modVal:"yes"},{_onClick:function(){this.__base.apply(this,arguments),BEM.blocks["i-global"].setParams({retpath:BEM.blocks.location.getInstance().getState().url}),this.redraw()}}),BEM.DOM.decl({block:"dropdown-menu",baseBlock:"dropdown"}),BEM.DOM.decl("i-menu",{onElemSetMod:{item:{state:{current:function(t,e,i,n){if("disabled"===n)return!1;var s=this.elem("item","state","current");this.delMod(s,"state").trigger("current",{prev:s,current:t})}}}},onItemSelectorClick:function(t){var e=this._getItemByEvent(t);this.setMod(e,"state","current")},_getItemByEvent:function(t){return t.data.domElem.closest(this.buildSelector("item"))}},{live:function(){this.liveBindTo("item-selector","pointerclick",function(t){this.onItemSelectorClick(t)})}}),BEM.DOM.decl({block:"b-menu-vert",baseBlock:"i-menu"}),BEM.DOM.decl({name:"b-menu-horiz",baseBlock:"i-menu"}),BEM.DOM.decl("user-menu-update",{onSetMod:{js:{inited:function(){this.updateInformer(this.onUpdateSuccess,this.onUpdateError)}}},updateInformer:function(t,e){this._getExporter().get({},function(i){i&&i.counters&&void 0!==i.counters.unread?t.call(this,i.counters):e&&e.call(this)},e)},onUpdateSuccess:function(t){var e=t.unread,i=this.params.unreadMax;e&&i&&e>i&&(e=i+"+");var n=e?e+" ":"";BEM.DOM.update(this.domElem,n+BEM.I18N("user","letter",{count:e}))},onUpdateError:function(){},_getExporter:function(){return this._exporter||(this._exporter=BEM.create("i-request_type_ajax",{url:this.__self.getExportApiUrl(this.params.caller),cache:!1,xhrFields:{withCredentials:!0},dataType:"json",callbackCtx:this}))},getDefaultParams:function(){return{unreadMax:99}}},{getExportApiUrl:function(t){return"https://mail.yandex."+BEM.blocks["i-global"].param("tld")+"/api/v2/"+(t?t+"/":"")+"counters?silent"}}),BEM.DOM.decl({block:"header",modName:"type",modVal:"advanced"},{getHeight:function(){if(this._height)return this._height;var t=this._getAdvanced();return this._height=this.domElem.height(),t&&(this._height+=t.domElem.height()-1),this._height}}),BEM.DOM.decl("header",{bindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks["advanced-search"].on("countUpdate",this._onCountUpdate,this),this},_onCountUpdate:function(t,e){this.setFiltersCount(e.count)},_isFiltersCountHidden:function(){return this.hasMod(this.getFiltersCountElem(),"hidden","yes")},setFiltersCount:function(t){return this.getFiltersCountElem().text(t),this.setMod(this.getFiltersCountElem(),"hidden",t?"":"yes")},getFiltersCount:function(){return Number(this.getFiltersCountElem().text())},getFiltersCountElem:function(){return this._filtersCount||(this._filtersCount=this.elem("filters-count"))}}),BEM.DOM.decl("header",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._openedSlide=null}}},onElemSetMod:{action:{pressed:{"":function(t){this.elemParams(t).releaseByDocumentScroll&&this.unbindFromWin("scroll"),this._openedSlide&&(this._openedSlide.unbindFromDoc("pointerclick"),this._openedSlide=null),this.unbindFromWin("closeUnder"),t.attr({"aria-pressed":!1,"aria-expanded":!1}),t.trigger("released")},yes:function(t,e){var i=this;i.delMod(this.elem("action"),e).bindToWin("closeUnder",function(){i.delMod(t,e)}),i.elemParams(t).releaseByHeaderOutsideClick&&i.afterCurrentEvent(function(){if(i.domElem){var e=i._openedSlide=i._getOpenedSlide(t);e&&i._slideOnClick(e,t)}}),i.elemParams(t).releaseByDocumentScroll&&this.bindToWin("scroll",function(){i._onScroll(t)}),t.attr({"aria-pressed":!0,"aria-expanded":!0}),t.trigger("pressed")}}}},_getOpenedSlide:function(t){var e,i=this.buildSelector("action","type",this.getMod(t,"type"));return this.findBlocksInside("slide").some(function(t){return t.params.rel&&t.params.rel[0].elem===i?(e=t,!0):void 0}),e},_onScroll:function(t){this.delMod(t,"pressed")},_slideOnClick:function(t,e){var i=this;t.bindToDoc("pointerclick",function(n){var s=$(n.target);t.containsDomElem(s)||s.is(i.elem("main"))||s.is(i.elem("action-i"))||i.delMod(e,"pressed")})},_onActionClick:function(t){t.preventDefault(),BEM.blocks["i-ua"].opera<13&&t.stopPropagation(),this.toggleMod(t.data.domElem,"pressed","yes","")},_onActionKeyup:function(t){var e=BEM.blocks["i-ua"].opera<13,i=BEM.blocks.keycodes;(!e&&t.keyCode===i.ENTER||t.keyCode===i.SPACE)&&(t.preventDefault(),this.toggleMod(t.data.domElem,"pressed","yes",""))},destruct:function(){this._openedSlide&&(this._openedSlide.unbindFromDoc("pointerclick"),this._openedSlide=null),this.__base.apply(this,arguments)}},{live:function(){return this.liveBindTo("action","pointerclick",function(t){this._onActionClick(t)}).liveBindTo("action","keyup",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||this._onActionKeyup(t)}),this.__base()}}),BEM.DOM.decl("header",{onElemSetMod:{action:{pressed:{yes:function(t){this.__base.apply(this,arguments),this.hasMod(t,"type","srv")&&this.bindToDoc("keydown",function(e){e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||e.keyCode===BEM.blocks.keycodes.ESC&&this.delMod(t,"pressed","yes")})},"":function(t){this.__base.apply(this,arguments),this.hasMod(t,"type","srv")&&this.unbindFromDoc("keydown")}}}}}),BEM.DOM.decl("ticker",{onSetMod:{js:{inited:function(){this._count=this.params.count}}},show:function(){return this.setMod("state","normal")},hide:function(){return this.setMod("state","empty")},val:function(t){if(!arguments.length)return this._count;var e=this.params.maxCount;return this._count=t,this.elem("value").attr("title",t).text(t>e?e+"+":t),t?this.show():this.hide(),this}}),BEM.DOM.decl("slide",{onSetMod:{js:{inited:function(){var t=this;$(t.params.rel).each(function(){$(this.elem||t.domElem).on(this.event,t[this.method].bind(t))})}},state:{open:function(){this.afterCurrentEvent(function(){this._bindFocusEvents()}),this.domElem.attr("aria-hidden",!1).trigger("open")},close:function(){this._unbindFocusEvents(),this._returnFocus(),this.domElem.attr("aria-hidden",!0).trigger("close")}}},open:function(){var t=this;this.setMod("state","open"),this._resize(t._getSlideParams())},close:function(){var t=this;this.setMod("state","close"),this._resize(t._getSlideParams())},_bindFocusEvents:function(){this._lastFocused=$.dom.getActiveElement()||BEM.DOM.scope;var t=this.__self._getFocusable(this.domElem);return this._firstFocusable=t.first(),this._lastFocusable=t.last(),0===this._firstFocusable.length?void(this._skipReturnFocus=!0):(this.bindTo(this._lastFocused,"keydown",this._onLastFocusedKeyDown).bindTo(this._firstFocusable,"keydown",this._onFirstFocusableKeyDown).bindTo(this._lastFocusable,"keydown",this._onLastFocusableKeyDown),this._skipReturnFocus=!1,void this.bindToDoc("mousedown.returnFocus",function(){this._skipReturnFocus=!0}))},_unbindFocusEvents:function(){this.unbindFromDoc("mousedown.returnFocus"),this.unbindFrom(this._firstFocusable,"keydown"),this.unbindFrom(this._lastFocusable,"keydown"),this.unbindFrom(this._lastFocused,"keydown")},_onLastFocusedKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this[t.shiftKey?"_lastFocusable":"_firstFocusable"].focus())},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_returnFocus:function(){this._skipReturnFocus||this.afterCurrentEvent(function(){this._lastFocused.focus()})},_resize:function(t){this._body=this._body||this.findBlockOutside("b-page");var e=this,i=this.domElem,n=t.dur,s=this.hasMod("state","open"),o="right"===t.dir,r={},a={};s?(o&&this._body.setMod("overflow","hidden"),r[t.sizeType]=t.sizeVal,r[t.dir]=-t.sizeVal,a[t.dir]=0,i.css(r).css("visibility","visible").stop().animate(a,n,function(){o&&e._body.delMod("overflow")})):(o&&this._body.setMod("overflow","hidden"),r[t.sizeType]="",r[t.dir]="",a[t.dir]=-t.sizeVal,i.stop().animate(a,n,function(){i.css("visibility","hidden").css(r),o&&e._body.delMod("overflow")}))},_getSlideParams:function t(){if(!t[this._uniqId]){var e=0,i={t:{meth:"outerHeight",sizeType:"height",direction:"top"},r:{meth:"outerWidth",sizeType:"width",direction:"right"},b:{meth:"outerHeight",sizeType:"height",direction:"bottom"},l:{meth:"outerWidth",sizeType:"width",direction:"left"}}[this.getMod("dir")],n=this.getMod("dur");this.domElem.children().each(function(){e+=$(this)[i.meth](!0)}),t[this._uniqId]={sizeType:i.sizeType,sizeVal:e,dir:i.direction,dur:Number(n)}}return t[this._uniqId]}},{live:!1,_getFocusable:function(t){var e=$.data(t,"slide-getFocusable-id");e||(e=$.identify(),$.data(t,"slide-getFocusable-id",e)),e='*[data-slide-getFocusable-id="'+e+'"]';var i=BEM.blocks["i-ua"].opera<13?"":"a[href], link, ";return t.find(i+'*[tabindex], button, input:not([type="hidden"]), textarea, select, menuitem').filter(function(){var t=$(this),i=!0;return parseInt(t.prop("tabindex"),10)<0||"hidden"===t.css("visibility")?!1:($(this).parentsUntil(e).each(function(){var t=$(this);return"none"===t.css("display")?i=!1:void 0}),i)})}}),BEM.DOM.decl("slide",{onSetMod:{state:{open:function(){this.__base.apply(this,arguments),this.trigger("open")},close:function(){this.__base.apply(this,arguments),this.trigger("close")}}},_getSlideParams:function(){var t=this.__base.apply(this,arguments),e=0;return this.hasMod("type","advanced")?(this.domElem.children().each(function(){e+=$(this).outerHeight(!0)}),t.sizeVal=e,t):t}}),BEM.DOM.decl("advanced-search",{onSetMod:{js:function(){this._vals=[],this.findBlocks().bindEvents()}},findBlocks:function(){return this.page=this.findBlockOutside("b-page"),this.dropdowns=this.findBlocksInside({block:"dropdown",modName:"advanced",modVal:"yes"}),this.checkboxes=this.findBlocksInside({block:"check-button",modName:"advanced",modVal:"yes"}),this.filters=this.dropdowns.concat(this.checkboxes),this._resetButton=this.elem("action","type","reset"),this},_onTouchMove:function(){this.dropdowns.forEach(function(t){t.hide()})},bindEvents:function(){return BEM.blocks["b-page"].on("filters:update",this.updateFilters,this),BEM.blocks["b-page"].on("touchmove",this._onTouchMove,this),this.bindTo(this.domElem,"submit",this._onSubmit),this.filters.forEach(this._initSearchControl.bind(this)),this.afterCurrentEvent(function(){this.filters.forEach(function(t){t.on("change",this.submit,this)},this),this._updateResetButton()}),this.dropdowns.forEach(function(t){t.on("change",this._onDropdownItemChange,this)},this),this.bindTo(this._resetButton,"click",this._onResetClick),this.page.on("change",this._onPageChange,this),this},unbindEvents:function(){return BEM.blocks["b-page"].un("filters:update",this.updateFilters,this),BEM.blocks["b-page"].un("touchmove",this._onTouchMove,this),this.afterCurrentEvent(function(){this.filters.forEach(function(t){t.un("change",this.submit,this)},this),this._updateResetButton()}),this.dropdowns.forEach(function(t){t.un("change",this._onDropdownItemChange,this)},this),this.page.un("change",this._onPageChange,this),this},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},_onSubmit:function(){return this.submit(),!1},_onResetClick:function(){this.reset()},_initSearchControl:function(t,e){this._vals.push(t.val()),t.on("change silentChange",function(t){this._vals[e]=t.block.val(),this._updateResetButton()},this)},_onDropdownItemChange:function(t){var e=t.block;t.target.hide(),e.setMod("applied",e.val()?"yes":"")},updateFilters:function(t,e){var i=e.params.filters;_.isEmpty(i)||(_.forEach(this.dropdowns,function(t){this.updateDropdown(t,i)},this),_.forEach(this.checkboxes,function(t){this.updateCheckButton(t,i)},this))},updateDropdown:function(t,e){t._control.val(e[t.params.name]||""),t.trigger("silentChange")},updateCheckButton:function(t,e){e[t.params.name]&&t.setMod("checked","yes")},_onPageChange:function(t,e){"search"===e.type||this.reset()},isDefaultState:function(){return!this._vals.some(_.identity)},submit:$.debounce(function(){if(this.page.hasMod("type","search")){var t=this.page.findBlockInside("search")||this.page.findBlockInside("search2");t.domElem.submit()}},50),reset:function(){this.isDefaultState()||(this._disableCounters(),this.controlsToReset().forEach(function(t){t.reset()}),this.findBlocksInside("input").forEach(function(t){t.val("")}),this.submit(),this.afterCurrentEvent(function(){this._updateResetButton()}),this._enableCounters())},controlsToReset:function(){return this.filters},_updateResetButton:function(){this._updateSelectedCounter(),this.setMod(this._resetButton,"hidden",this.isDefaultState()?"yes":"")},_updateSelectedCounter:function(){var t=this._vals.filter(function(t){return t&&""!==t});this.trigger("countUpdate",{count:t.length})},_enableCounters:function(){this.filters.forEach(function(t){t.enableCounters()})},_disableCounters:function(){this.filters.forEach(function(t){t.disableCounters()})},getParams:function(){return this.domElem.serialize().replace(/&?[^&?]+=(?=(?:&|$))/g,"").replace(/^&/,"")}},{live:!0}),BEM.DOM.decl("advanced-search",{onSetMod:{js:function(){this.params.disabled||(this.__base.apply(this,arguments),this._initSearchControl(this.site,this._vals.length))}},findBlocks:function(){return this.__base.apply(this,arguments),this.site=this.findBlockInside("custom-site"),this.size=this.findBlockInside("custom-size"),this.sizesDropdown=this.findBlockInside({block:"dropdown",modName:"custom-size",modVal:"yes"}),this.wallpaperButton=this.findBlockInside({block:"check-button",modName:"wallpaper",modVal:"yes"}),this},bindEvents:function(){return this.__base.apply(this,arguments),this.site.on("change",this.submit,this),this.afterCurrentEvent(function(){this.wallpaperButton.bindTo("pointerclick",this._onWallpaperClick.bind(this)),this.wallpaperButton.on("change",this._onWallpaperChange,this)}),this},destruct:function(){this.site.un("change",this.submit,this),this.wallpaperButton.un("change",this._onWallpaperChange,this),this.__base.apply(this,arguments)},_onWallpaperClick:function(){this._isWallpaperChangedByUser=!0},_onWallpaperChange:function(){this.wallpaperButton.isChecked()?(this.wallpaperButton.delMod("excluded"),this.resolveConflicts(this.wallpaperButton)):(this.wallpaperButton.setMod("excluded","yes"),this._isWallpaperChangedByUser&&this.wallpaperButton.val({wp:"off"}),this._isWallpaperChangedByUser=!1)
},_onDropdownItemChange:function(t){this.__base.apply(this,arguments);var e=t.block;e.hasMod("type","color-picker")&&this.updateColorThumb(e,e.val()),e.val()&&this.resolveConflicts(e)},_onPageChange:function(){this.__base.apply(this,arguments),this._isWallpaperChangedByUser=!1},_onResetClick:function(){this._isWallpaperChangedByUser=!0,this.reset(),BEM.blocks["b-statcounter"].hit({params:{query:{filter:{reset:"yes"}}}})},updateFilters:function(t,e){var i=e.params.filters;_.isEmpty(i)||BEM.blocks["i-global"].param("isPumpkin")||(this._submitDisabled=!0,this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this._submitDisabled=!1,this.trigger("show")}),i.site&&(this.site.findBlockInside("input").val(i.site),this.site.setMod("applied","yes").trigger("silentChange")),"eq"===i.isize&&this.size.updateSizes(i.iw,i.ih))},isWallpaper:function(t){return t&&t.isize&&"wallpaper"===t.isize},updateDropdown:function(t,e){var i="isize"===t.params.name?!this.isWallpaper(e):!0;i&&this.__base.apply(this,arguments)},updateCheckButton:function(t,e){var i="isize"===t.params.name?this.isWallpaper(e):!0;i&&this.__base.apply(this,arguments)},submit:function(){if(!this._submitDisabled){var t=this.site.searchedSite;this.site.val()!==t&&this.site.input.val(t),"search"===BEM.blocks["i-global"].param("page")&&(BEM.blocks.header.getSearch().submitByFilters=!0),this.__base.apply(this,arguments)}},resolveConflicts:function(t){var e=t.params.name,i=this.isWallpaper(t.params.values);return"isize"===e&&i&&(this.sizesDropdown.disableCounters(),this.sizesDropdown.reset(),this.sizesDropdown.enableCounters()),"isize"!==e||t._isCustom||i||this.wallpaperButton.reset(),this},controlsToReset:function(){var t=_.extend([],this.__base.apply(this,arguments));return t.push(this.site),this.wallpaperButton.hasMod("excluded","yes")?_.without(t,this.wallpaperButton):t},updateColorThumb:function(t,e){t.setMod("color-thumb",e&&e[0]?e[0].val:"none")}},{live:!1,getHeight:function(){return 28}}),BEM.DOM.decl({block:"check-button",baseBlock:"checkbox"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindTo("keyup",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.which===BEM.blocks.keycodes.ENTER&&this.elem("control").click()})}},checked:function(t,e){return this.__base.apply(this,arguments)===!1?!1:void this.elem("control").attr("aria-pressed","yes"===e)}}}),BEM.DOM.decl({block:"check-button",modName:"advanced",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindEvents().initButton()}},bindEvents:function(){return this.on("change",this._onAdvancedClick),this},_onAdvancedClick:function(){this.delMod("focused")},_generateHidden:function(t,e){return BEMHTML.apply({block:"check-button",mods:{advanced:"yes"},elem:"hidden-value",tag:"input",attrs:{type:"hidden",name:t,value:e}})},initButton:function(){this.on("change",function(t){this._buttonProcess(t.target.val())},this),this._buttonProcess(this.val())},_buttonProcess:function(t){this.params.generateHidden&&(this.findElem("hidden-value").remove(),t!==this.params.defaultValue?this.val(t):this.trigger("reset"))},val:function(t){if(t)for(var e=Object.keys(t),i=0,n=e.length;n>i;i++)this.domElem.append(this._generateHidden(e[i],t[e[i]]));return this.isChecked()?this.params.values:""},reset:function(){this.findElem("hidden-value").remove(),this.delMod("checked"),this.trigger("reset")},enableCounters:function(){this._countersDisabled=!1},disableCounters:function(){this._countersDisabled=!0},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{generateHidden:!0})}}),BEM.DOM.decl({block:"check-button",modName:"advanced",modVal:"yes"},{_onChange:function(){if(this.__base.apply(this,arguments),!this._countersDisabled){var t=this.params.name,e={ifreshness:"fresh"},i={ifreshness:"week",isize:"wallpaper"},n=this.val()?i[t]:"any",s={};s[e[t]||t]=n,BEM.blocks["b-statcounter"].hit({params:{query:{filter:s}}})}}}),BEM.DOM.decl({block:"dropdown",modName:"advanced",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._popup=this.findBlockInside("popup"),this._button=this.findBlockInside("button"),this._buttonText=this.findElem(this._button.domElem,"switcher-text"),0===this._buttonText.length&&(this._buttonText=this._button.elem("text")),this._buttonDefaultTitle=this._buttonText.text(),this._buttonIcon=this.findElem(this._button.domElem,"icon"),this._initControl(),this._afterInit()}},_initControl:function(){this._control=this.findBlockInside("radiobox"),this._control.on("change",function(t,e){this._radioboxProcess(e.current,t.target.val(),this._control.name()),this.trigger("change")},this)},_afterInit:function(){this._radioboxProcess(this._control.getCurrent(),this._control.val(),this._control.name())},_buildHidden:function(t,e){return BEMHTML.apply({block:"dropdown",mods:{advanced:"yes"},elem:"hidden-value",name:e,value:t})},_radioboxProcess:function(t,e){var i=this.findElem(t,"text").text(),n=Number(e)!==this.params.defaultValue?i:this._buttonDefaultTitle;this._buttonText.empty().append(n),this.params.withIcons&&this.setMod(this._buttonIcon,"type",this.params.withIcons[e]),this._generateHidden()},_generateHidden:function(){if(this.params.generateHidden&&!this.findBlockInside("popup")){this.findElem("hidden-value").remove();var t=this._control.val();t!==this.params.defaultValue&&this.domElem.append(this._buildHidden(t,this._control.name()))}},val:function(){return this._control.val()!==this.params.defaultValue?[{name:this.params.name,val:this._control.val()}]:void 0},reset:function(){this.findElem("hidden-value").remove(),"undefined"!=typeof this.params.defaultValue&&this._control.val(this.params.defaultValue)},getDefaultParams:function(){return _.assign(this.__base.apply(this,arguments),{generateHidden:!0})},enableCounters:function(){this._countersDisabled=!1},disableCounters:function(){this._countersDisabled=!0}}),BEM.DOM.decl({block:"dropdown",modName:"advanced",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this.on("change",this._onChange,this)})}},_onChange:function(t){if(!this._countersDisabled){var e=t.block,i=e.val(),n=e.params.name,s={itype:"format",icolor:"color"},o={};o[s[n]||n]=i&&i[0]?i[0].val:"any",BEM.blocks["b-statcounter"].hit({params:{query:{filter:o}}})}}}),function(t){"use strict";t.ajaxPrefilter(function(t){return"iframe"===t.type.toLowerCase()?"iframe":void 0}),t.ajaxTransport("iframe",function(e,i){var n,s,o=t(e.file),r="iframe-"+t.now(),a=t("<form></form>").hide().attr({action:e.url,target:r}),c=function(){s&&s.replaceWith(o),a.remove(),n.attr("src","javascript:false;").remove()};return e.dataTypes.shift(),t.each(i.data||{},function(e,i){t("<input />").attr({type:"hidden",name:e,value:i}).appendTo(a)}),o.length&&(s=o.after(o.clone().prop("disabled",!0)).next(),a.attr({enctype:"multipart/form-data",method:"POST"}),a.append(o)),{send:function(e,i){n=t("<iframe></iframe>").hide().attr({name:r,id:r,src:"javascript:false;"}),n.one("load",function(){n.bind("load",function(){try{var t=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,e=t.documentElement?t.documentElement:t.body;i(200,e.innerHTML)}catch(n){i(500)}setTimeout(function(){c()},42)}),a[0].submit()}),t("body").append(a,n)},abort:function(){null!==n&&(n.unbind("load").attr("src","javascript:false;"),c())}}})}(jQuery),BEM.DOM.decl("advanced-search",{findBlocks:function(){return this.__base.apply(this,arguments),this.backButton=this.findBlockInside(this.elem("back"),"button"),this},bindEvents:function(){return this.__base.apply(this,arguments),this.backButton&&BEM.blocks["b-page"].on("search:input:update",this._onSearchUpdate,this),this},unbindEvents:function(){return this.__base.apply(this,arguments),this.backButton&&BEM.blocks["b-page"].un("search:input:update",this._onSearchUpdate,this),this},_onSearchUpdate:function(t,e){var i=BEM.blocks.uri.setParam(this.backButton.url(),"text",e.params.text);this.backButton.url(i)}}),BEM.DOM.decl({block:"dropdown",modName:"custom-size",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=BEM.blocks["i-global"].param("mobile");this.afterCurrentEvent(function(){BEM.blocks["custom-size"].on("change",this._onCustomChange,this).on("reset",this._onCustomReset,this)}),t||this._popup.on("show",this._onPopupShow,this),t&&this.bindTo("size-input","blur",this._popupKeyboardHideFix)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["custom-size"].un("change",this._onCustomChange,this).un("reset",this._onCustomReset,this)},_popupKeyboardHideFix:function(){this.afterCurrentEvent(function(){window.scrollTo(0,0)})},_onPopupShow:function(){this.setMod("action","open"),this.getCustomSize().focus()},_onCustomChange:function(){this._isCustom=!0,this.getAdvancedSearch().submit(),this._popup.hide(),this.trigger("silentChange")},_onCustomReset:function(){this._isCustom=!1,this.trigger("silentChange")},val:function(){return this._isCustom?this.getCustomSize().selected:this.__base.apply(this,arguments)},_radioboxReset:function(){this.__base.apply(this,arguments),this.getCustomSize().reset()},getCustomSize:function(){return this._customSize||(this._customSize=this.findBlockOn("custom-size")),this._customSize},getAdvancedSearch:function(){return this._advancedSearch||(this._advancedSearch=$(".advanced-search").bem("advanced-search")),this._advancedSearch}}),BEM.DOM.decl("custom-site",{onSetMod:{js:function(){this.findBlocks().bindEvents(),this.searchedSite=this.input.val()}},findBlocks:function(){return this.input=this.findBlockInside("input"),this.button=this.findBlockInside("button"),this.popup=this.findBlockInside("popup"),this},bindEvents:function(){return this.button.on("click",this.trySubmit,this),this.input.on("change",this._onInputUpdate,this),this.input.on("focus",this._onFocus,this),this.input.on("blur",this._onBlur,this),this.input.bindTo("keypress",this.changeThis(this._onKeyPress)),this},destruct:function(){this.__base.apply(this,arguments),this.button.un("click",this.trySubmit,this),this.input.un("change",this._onInputUpdate,this),this.input.un("focus",this._onFocus,this),this.input.un("blur",this._onBlur,this)},_onKeyPress:function(t){13===t.which&&this.trySubmit()},trySubmit:function(){var t=this.input.val(),e=this.checkVal(t),i=""===t;this.setMod("applied",e&&!i?"yes":"").hideError(),e||i?this.submit(t):this.showError()},_onFocus:function(){this.delMod("applied")},_onBlur:function(){this.button.hasMod("pressed","yes")||(this.setMod("applied",""===this.searchedSite?"":"yes"),""===this.input.val()&&""!==this.searchedSite&&this.input.val(this.searchedSite))},_onInputUpdate:function(){this.input.hasMod("invalid")&&this.hideError()},checkVal:function(t){var e=new RegExp("^(?:(?:https?|ftp)://)?(?:(?:(?:xn--)?(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:xn--)?(:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:xn--)?(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/[^\\s]*)?");return t.match(e)},showError:function(){return this.popup.show(this.domElem),this.input.setMod("invalid","yes"),this},hideError:function(){return this.popup.hide(this.domElem),this.input.delMod("invalid"),this},val:function(){return this.input.val()},submit:function(t){BEM.blocks["b-statcounter"].hit({params:{query:{filter:{site:t?"on":"any"}}}}),this.searchedSite=t,this.input.findElem("control").blur(),this.trigger("change")},reset:function(){this.hideError().delMod("applied").input.val(""),this.searchedSite="",this.trigger("change")}}),BEM.DOM.decl("custom-size",{onSetMod:{js:function(){var t=this.params.values;this.findBlocks().bindEvents(),this.select(t.iw,t.ih),this.setHints()}},findBlocks:function(){return this.dropdown=this.findBlockOn("dropdown"),this.radiobox=this.dropdown.findBlockInside("radiobox"),this.switcher=this.dropdown.findBlockOn(this.dropdown.elem("switcher"),"button"),this.inputs=this.findBlocksInside("input"),this.button=this.findBlockOn(this.elem("button"),"button"),this.message=this.elem("message"),this},bindEvents:function(){return this.button.on("click",this.trySubmit,this),this.dropdown.on("change",this.reset,this),_.forEach(this.inputs,function(t){t.on("change",this._onInputUpdate,this).bindTo("keypress",this.changeThis(this._onKeyPress))},this),this},destruct:function(){this.button.un("click",this.trySubmit,this),this.dropdown.un("change",this.reset,this),_.forEach(this.inputs,function(t){t.un("change",this._onInputUpdate,this)},this),this.__base.apply(this,arguments)},_onKeyPress:function(t){13===t.which&&this.trySubmit()},trySubmit:function(){var t=this.getVals(),e=this.checkVal(t.width),i=this.checkVal(t.height);this.hideError(),e&&i?this.select(t.width,t.height):this.showError(e,i)},_onInputUpdate:function(){_.forEach(this.inputs,function(t){t.hasMod("invalid")&&this.hideError()},this)},select:function(t,e){return t&&e?(this.removeVals().setCustomValues().setText(t,e).trigger("change"),this):this},setCustomValues:function(){for(var t=[{name:"isize",val:"eq"}],e=this.getVals(),i={isize:this.params.values.isize,iw:e.width,ih:e.height},n=Object.keys(i),s=0,o=n.length;o>s;s++)this.dropdown.domElem.append(this._generateHidden(n[s],i[n[s]]));return this.selected=t,this},removeVals:function(){return this.radiobox.val("custom"),this.dropdown.findElem("hidden-value").remove(),this},reset:function(){return"custom"===this.radiobox.val()?this:(this.selected=!1,this.setVals(),this.hideError().trigger("reset"),this.dropdown.val()||this.dropdown.delMod("applied"),this)},_generateHidden:function(t,e){return BEMHTML.apply({block:"dropdown",mods:{advanced:"yes"},elem:"hidden-value",tag:"input",attrs:{type:"hidden",name:t,value:e}})},showError:function(t,e){return this.highlightInvalidFields(t,e),this.setMod(this.message,"hidden",""),this},hideError:function(){return this.highlightInvalidFields(!0,!0),this.setMod(this.message,"hidden","yes"),this},highlightInvalidFields:function(t,e){return this.inputs[0].setMod("invalid",t?"":"yes"),this.inputs[1].setMod("invalid",e?"":"yes"),this},checkVal:function(t){return/^[0-9]+$/.test(t)&&Number(t)>0},setText:function(t,e){return this.switcher.elem("text").text(t+"x"+e),this},getVals:function(){return{width:this.inputs[0].val(),height:this.inputs[1].val()}},setVals:function(t,e){return this.inputs[0].val(t||""),this.inputs[1].val(e||""),this},setHints:function(){var t=BEM.blocks["i-userinfo"].get().getScreenSize();this.inputs[0].elem("hint").text(t.width),this.inputs[1].elem("hint").text(t.height)},updateSizes:function(t,e){this.setVals(t,e).select(t,e)},focus:function(){this.inputs[0].elem("control").focus()}},{live:!0}),BEM.DOM.decl("wallpaper",{onSetMod:{js:function(){this.checkButton=this.findBlockOn("check-button"),this.params.text=this.checkButton.elem("text").text(),this.setResolution()}},setResolution:function(){var t=this.checkButton,e=BEM.blocks["i-userinfo"].get(),i=e.getScreenInfo();return t.elem("text").text(this.params.text+" "+i.width+"×"+i.height),t.params.values.wp="wh"+e.getWP(),this}}),BEM.DOM.decl("paranja",{onSetMod:{js:{inited:function(){var t=this;$(t.params.rel).each(function(){$(this.elem||t.domElem).on(this.event,t[this.method].bind(t))}),this.bindTo("pointerclick",function(){this.trigger("click")})}},state:{open:function(){this.trigger("open")},close:function(){this.trigger("close")}}},open:function(){this.setMod("state","open")},close:function(){this.setMod("state","close")}},{live:!1}),BEM.DOM.decl("paranja",{setTheme:function(t){return this.setMod("theme",t)},delTheme:function(){return this.delMod("theme")}}),BEM.DOM.decl("services-table",{onSetMod:{js:function(){this._globalServices=this.findBlockOutside("i-services"),this._services=this.findBlocksInside("service")}},updateServicesLink:function(){var t=this;$.each(this._services,function(){var e=t._globalServices.getServicePath(this.getMod("name")),i=this.elem("url"),n=i.attr("href"),s=BEM.blocks.uri.parse(n.replace(/#.*$/,"")).getRoot();s=t._globalServices.getServiceUrl(this.getMod("name"))||s,i.attr("href",s.replace(/\/$/,"")+e)})}},{live:!0}),BEM.DOM.decl("search",{_onInputChange:function(){BEM.blocks["i-global"].setParams({searchInputText:_.escape(this._input.val())})},reset:function(){return this._input.val("",{suggest:!1}),this},focus:function(){var t=this._suggest.params.onFocus;return this._suggest.params.onFocus=!1,this._input.elem("control").focus(),this.afterCurrentEvent(function(){this._suggest.params.onFocus=t},this),this}}),BEM.DOM.decl("search",{onSetMod:{js:function(){this.findBlocks().bindEvents()._initServiceLabel()}},_initServiceLabel:function(){return this.afterCurrentEvent(function(){var t=this._input.findBlockInside("service");t&&t.elem("url").attr("href",BEM.blocks["i-global"].param("router").index)}),this},findBlocks:function(){return this._location=BEM.blocks.location.getInstance(),this._input=this.findBlockInside("input"),this._suggest=this.findBlockInside("suggest2"),this},bindEvents:function(){return this._location.on("change",this._onChange,this),this._suggest&&this._suggest.on("select",this._onSuggestSelect,this),this._input.on("change",this._onInputChange,this),this._input.on("focus",this._onInputFocus,this),BEM.blocks["b-page"].on("search:input:update",this.updateSearchPage,this),BEM.blocks["i-global"].param("isPumpkin")||this.bindTo("submit",this._onSubmit),this},_onInputFocus:function(){this.trigger("input:focus")},_onSuggestSelect:function(t){this._location.change({url:this._buildUrl()},t),t.preventDefault()},_onSubmit:function(t){this.submit(t),t.preventDefault()},submit:function(t){var e=BEM.blocks["i-global"].getFlag("suggest_context_redirect"),i=BEM.blocks["i-global"].param("tld");e&&"ru"===i?this._checkRedirectURL(t,e):this._ajaxSubmit(t)},_ajaxSubmit:function(t){this._location.change({url:this._buildUrl()},t)},_checkRedirectURL:function(t,e){var i=BEM.blocks["i-global"].param("id"),n=this._input.val(),s="images"===i?40:197,o="images"===i?72863:72894,r=2===e?"control-":"",a=this;$.ajax({url:"//yandex.ru/suggest/suggest-redir",data:{current:i,part:n,lr:BEM.blocks["i-global"].param("lr")},dataType:"json",context:this,cache:!1}).then(function(t,e,i){var n=_.get(t,"redirect_info.url"),s=$.Deferred();return n?s.resolve(n):s.reject(i,"no"),s.promise()}).then(function(c){cp({pid:s,cid:o,path:r+"yes",text:n,service:i},{href:c}),2===e?a._ajaxSubmit(t):location.href=c},function(e,c){cp({pid:s,cid:o,path:r+c,text:n,service:i}),a._ajaxSubmit(t)})},_buildUrl:function(){var t=this.getAdvancedSearch();return this.domElem.attr("action")+"?"+this.domElem.serialize()+(t?"&"+t.getParams():"")},_onChange:function(t,e){switch(this.__self.win.scrollTop(0),e.block){case"b-page_type_index":case"b-page_type_favorites":this.updateIndexPage(t,e);break;case"b-page_type_search":this.updateSearchPage(t,e)}},updateIndexPage:function(){this.reset().focus()},updateSearchPage:function(t,e){this.fill(e.params.text),"search:input:update"===t.type&&this.updateFound(e.params),this._input._updateClear(),this._input.delMod("focused")},val:function(){return this._input.val()},fill:function(t){return _.isArray(t)&&(t=t[0]),BEM.blocks["i-global"].param("isPumpkin")&&this._input&&this._input.val(t),this._suggest&&this._suggest.params["suggest2-input"]&&this._suggest.params["suggest2-input"].valWithoutSuggest(t),this},updateFound:function(t){return this.trigger("search:found:update",t),this},getAdvancedSearch:function(){if(!this._advancedSearch){var t=$(".advanced-search");this._advancedSearch=!_.isEmpty(t)&&t.bem("advanced-search")}return this._advancedSearch}}),BEM.decl("i-statface",{onSetMod:{js:{inited:function(){this._data={},this._needSend=!1,this.hasMod("send","manual")||$(window).unload(this.changeThis(this.send))}}},set:function(t,e){this._needSend=!0;var i=this._data;return"object"==typeof t?$.each(t,function(t,e){i[t]=e}):i[t]=e,this},reset:function(){var t=this;return arguments[0]?$.each(arguments,function(e,i){delete t._data[i]}):this._data={},$.isEmptyObject(this._data)&&(this._needSend=!1),this},serialize:function(){var t=this;return $.map(t.params.keys,function(e){return t._data[e]}).join(".")+(t.params.customKeys?$.map(t.params.customKeys,function(e){var i=t._data[e];return"/"+e+"="+(void 0===i?"":i)}).join(""):"")},send:function(t){if(this._needSend){var e=this.params,i=["//",e.host,"/",e.path,"/dtype=stred","/pid=",e.pid,"/cid=",e.cid,"/cts=",(new Date).getTime(),"/path=",this.serialize(),"/*data=",encodeURIComponent("url="+encodeURIComponent(e.url))].join("");"click"===e.path?document.createElement("IMG").src=i:$.ajax({type:"GET",url:i,data:null,complete:t||$.noop,dataType:"script",timeout:500}),this._needSend=!1}return this},getDefaultParams:function(){return{host:"clck.yandex.ru",path:"jclck",url:location.href}}}),BEM.decl("i-statface",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.customKeys.push("u","reqid")}},sendCounter:function(t){this.set({u:(new Date).getTime(),reqid:BEM.blocks["i-global"].param("serpid")}).send(t).reset()},getDefaultParams:function(){return $.extend(this.__base(),{pid:this.projectId,host:BEM.blocks["i-global"].param("click-host"),customKeys:[]})}}),BEM.decl("i-statface",{projectId:40}),BEM.DOM.decl("suggest2",{onSetMod:{js:{inited:function(){this.params.form||this.findBlockOutside("suggest2-form"),this._lastSubmitTime=0,this._lastBlurTime=0,this._clear()}}},_bodyHandler:function(t){if(!this._isDestructing){var e=$(t.target),i=this.containsDomElem(e)||this.params.form.containsDomElem(e);i||(this._freezeInputFocus=!1)}},getDefaultParams:function(){return{submitBySelect:!1,updateOnEnterByKeyboard:!0,onFocus:"request",requestOnEmptyInput:!1,abortQueries:!1,sequentialQueriesTimeout:!1}},destruct:function(){this.unbindAllEvents(),this.__base.apply(this,arguments)},init:function(){var t=this;return t.params.form.on("submit",function(e,i){t._lastSubmitTime=(new Date).getTime(),t._isActualSearchCGIParams?t._isActualSearchCGIParams=!1:"suggest2-counter"!==i.data.block&&i.data.prevent!==!1&&this.removeHiddenInputs(),t._clear(),t._popup.hide()}),t._input=t.params["suggest2-input"],t._popup=t.params["suggest2-popup"],t._inputValue=t._input.val(),t._model=t.initModel(),t._view=t.initView(),t._counter=t.initCounter(),t._model.on({response:this.setItems,reject:function(e,i){2===i.code&&(t._popup.hide(),t._clear())}},t),t.bindToDoc("click tap leftclick",t._bodyHandler),t.bindEvents(),t},initModel:function(){return BEM.create("suggest2-model",this.params)},getModel:function(){return this._model},initView:function(t,e){return BEM.create({block:"suggest2-view",mods:t||{}},e||{})},getView:function(){return this._view},initCounter:function(){return this.params.counter?this.params.counter.initValues().bindEvents():void 0},getCounter:function(){return this._counter},setDataConverter:function(t){return this.getModel().getProvider().convert=t,this},setRequestData:function(t){return this.getModel().getProvider().getRequestData=t,this},setRequestUrl:function(t){return this.getModel().getProvider().getRequestUrl=t,this},setOwner:function(t){return this._popup.owner(t),this},bindEvents:function(){var t=this;return t._input.bindEvents({change:t._onChange,focus:t._onFocus,blur:t._onBlur},t),t._popup.on({preshow:function(){t.trigger("preshow")},show:function(){t._onShow()},hide:function(e,i){t._onHide(i)}}),t.params.form&&t.params.form.on("button-press",t._onSearchButtonMousedown,t),BEM.blocks["suggest2-item"].on(t.domElem,{"link-click":function(e,i){t._counter&&"_self"===$(i.$e.target).attr("target")&&i.$e.preventDefault()}}),t},_onShow:function(){this.trigger("show")},_onHide:function(t){this.trigger("hide",t)},_onSearchButtonMousedown:function(){this._input.realVal(this._input.val()),this._popup.hide()},unbindAllEvents:function(){var t=this;return t.unbindFromDoc("click tap leftclick"),t._input.unbindAllEvents(),t.params.form.un("submit"),t._model.un("response").un("reject"),t._popup.un("preshow").un("show").un("hide"),t.params.form&&t.params.form.un("button-press",t._onSearchButtonMousedown,t),t},setItems:function(t,e){var i=this,n=e.data.items||[];return i._isFormSubmitDurinQuery()||!n.length?(i._popup.hide(),i._clear()):this.params.sequentialQueriesTimeout||i._input.val()===e.val?(i._text=e.val,i._pos=e.pos,i._meta=e.data.meta||{},i._popup.show(i._view.html(n,i._meta)).width(i.getPopupWidth()),i._items=i.findBlocksInside("suggest2-item"),i._clearItems().trigger("update",{val:i._text,pos:i._pos,items:i._items}),i):i._clear()},getItems:function(){return this._items||[]},isBlur:function(){return this._isBlur&&!this._isMouseDown},getPopupWidth:function(){},getInputWidth:function(){return 0},isNeedSubmitFormOnSelectItem:function(t){return this.params.submitBySelect&&"link"!==t.getMod("interact")},_isFormSubmitDurinQuery:function(){return this._lastSubmitTime?(this._model.filterRequestsByVal(this._input.realVal()),this._model.isTimeInRequestInterval(this._lastSubmitTime)):!1},_onChange:function(t,e){this._inputValue!==this._input.val()&&(this._inputValue=this._input.val(),this._doRequest(e))},_doRequest:function(t){this._model.request(this._input.realVal(this._input.val()),this._input.getCaretPosition(),t)},_onFocus:function(){!this._popup.isShown()&&this._isBlur&&this.params.onFocus&&this._isLastBlurTimeLater(50)&&(this.getItems().length&&this._input.val()===this._text?(this._clearItems(),this._popup.show()):this._isMouseDown||"request"!==this.params.onFocus||this._doRequest())},_onBlur:function(){this._isBlur?(this._clear(),this._popup.hide()):this._freezeInputFocus?(this._clear(),this._input.focus()):this._isMouseDown&&this._input.focus(),this._lastBlurTime=(new Date).getTime(),this._isBlur=!0},_getItemIndex:function(t){return this.getItems().indexOf(t)},_clear:function(){return this._isBlur=!0,this._freezeInputFocus=!1,this._clearItems()},_clearItems:function(){return this._isMouseDown=!1,this._enterItemIndex=-1,this._unselectItems()},_isLastBlurTimeLater:function(t){return(new Date).getTime()-this._lastBlurTime>t},_unselectItems:function(t){var e=t?[].slice.call(arguments):this.getItems();return e.forEach(function(t){t.onLeave()}),this},_onSelectItem:function(t,e){var i=this,n=i._getItemIndex(t),s=t.onSelect(e),o=t.valOnSelect();return i._text=i._input.realVal(o),i._isBlur=!0,i._freezeInputFocus=!1,i._setSearchCGIParams(t),i.trigger("select",{val:i._text,pos:i._pos,item:t,meta:i._meta,itemIndex:n,byKeyboard:e,callbackOnSelect:s}),o!==!1&&(i._items=[],this.isNeedSubmitFormOnSelectItem(t)&&i.params.form.submit()),n},_isActualSearchCGIParams:!1,_setSearchCGIParams:function(t){this.params.form.removeHiddenInputs(),t.params.searchCGI&&(this._isActualSearchCGIParams=!0,this.params.form.appendHiddenInputs(t.params.searchCGI.map(function(t){return{name:t[0],value:t[1]}})))},_onDownItem:function(){this._isBlur=!1,this._isMouseDown=!0}}),BEM.DOM.decl("suggest2",{getInputLeft:function(){return 0},getInputWidth:function(){return 0},getContainerWidth:function(){return 0},getMetrics:function(){var t=this.getInputLeft(),e=this.getInputWidth(),i=this.getContainerWidth()-t;return{marginLeft:t,minWidth:e>=i?i:e,maxWidth:i}},adjustView:function(){return{}}}),BEM.DOM.decl("suggest2",{bindEvents:function(){var t=this;return t._input.bindEvents({keydown:t._onKeyDown,keyup:t._onKeyUp,keypress:t._onKeyPress,mousedown:function(){t._input.isFocused()&&t._onFocus()}},t),BEM.blocks["suggest2-item"].on(t.domElem,{mouseover:function(e){t._onEnterItem(e.block,!1)},mouseout:function(e,i){var n=e.block.domElem[0];n===i.relatedTarget||$.contains(n,i.relatedTarget)||t._onLeaveItem(e.block,!1)},mousedown:function(){t._onDownItem()},leftclick:function(e){t._onSelectItem(e.block,!1)}}),t.__base.apply(t,arguments)},_onKeyDown:function(t){var e=this.__self.keyboard,i=t.which;!this._popup.isShown()||i!==e.up&&i!==e.down||(t.preventDefault(),this._enterByKeyboard(i))},_onKeyUp:function(t){var e=this.__self.keyboard;if((t.which===e.left||t.which===e.right)&&(this.trigger("change-cursor-pos"),this._model.request(this._input.realVal(this._input.val()),this._input.getCaretPosition())),t.which===e.right&&~this._enterItemIndex&&this._enterItemByKeyboard){var i=this._items[this._enterItemIndex];i&&this.trigger("ahead",{item:i,val:"link"===i.getMod("interact")?i.elem("text").text():i.val()})}},_onKeyPress:function(t){if(t.which===this.__self.keyboard.enter&&~this._enterItemIndex&&this._enterItemByKeyboard){var e=this._items[this._enterItemIndex];e&&(t.preventDefault(),this._onSelectItem(e,!0))}},_enterByKeyboard:function(t){var e=t-39,i=this._items.length,n=this._enterItemIndex+e;return-1===n||n===i?(this._enterItemIndex=n,this._unselectItems(this._items[n]),this.trigger("out",{val:this._text,byKeyboard:!0})):(0>n?n=i-1:n>=i&&(n=0),void this._onEnterItem(this._items[n],!0))},_onEnterItem:function(t,e){this._enterItemIndex=this._getItemIndex(t),this._enterItemByKeyboard=e,this._unselectItems(),t.onEnter(e)},_onLeaveItem:function(t){this._clearItems()._unselectItems(t)}},{keyboard:{enter:13,left:37,up:38,right:39,down:40},live:function(){this.liveBindTo("mousedown",function(){this._onDownItem()})}}),BEM.decl("suggest2-model",{onSetMod:{js:{inited:function(){this._requests=[]}}},destruct:function(){this._provider&&this._provider.destruct(),this.__base.apply(this,arguments)},getProvider:function(){return this._provider?this._provider:(this._provider=this.setProvider(this.params),this._provider)},setProvider:function(t){return this._provider=BEM.create("suggest2-provider",t),this._provider},getCancelRequestConditions:function(){return[{block:"suggest2",show:!1},{block:"suggest2",event:"select"},{block:"suggest2-item",event:"select"},{block:"suggest2",event:"out"},{block:"suggest2-item",show:!1},{block:"suggest2-popup",event:"hide"},{suggest:!1},{source:"sample"}]},request:function(t,e,i){var n=this,s={val:t,caretPosition:e,data:i};n._requests.push(s);var o=n._isNeedRequest(t,i);return o.need?(s.requestTime=(new Date).getTime(),n.trigger("request",{val:t,pos:e}),n.getProvider().get(t,e,function(t,e,i){s.responseTime=(new Date).getTime(),n._onResponse(t,e,i);var o=n._requests[n._requests.length-1];n.params.sequentialQueriesTimeout&&o.val!==t&&n.request(o.val,o.caretPosition,o.data)}),n):n.trigger("reject",{val:t,pos:e,code:o.code,reason:o.reason||{}})},isTimeInRequestInterval:function(t){for(var e=this._requests.length-1;e>=0;e--)if(t>this._requests[e].requestTime&&t<this._requests[e].responseTime)return!0;return!1},filterRequestsByVal:function(t){this._requests=this._requests.filter(function(e){return e.val===t})},_isNeedRequest:function(t,e){if(""===t&&!this.params.requestOnEmptyInput)return{need:!1,code:2};var i;if(this.params.sequentialQueriesTimeout)for(i=this._requests.length-1;i>=0;i--){var n=this._requests[i];if(void 0===n.responseTime&&(new Date).getTime()-n.requestTime<this.params.sequentialQueriesTimeout)return{need:!1,code:3,reason:{request:n}}}if(!e)return{need:!0};var s,o=this.getCancelRequestConditions();t:for(i=0;i<o.length;i++){s=o[i];for(var r in s)if(s.hasOwnProperty(r)&&s[r]!==e[r])continue t;return{need:!1,code:1,reason:{condition:s}}}return{need:!0}},_onResponse:function(t,e,i){this.trigger("response",{val:t,pos:e,data:i})}}),BEM.DOM.decl("suggest2-detect",{onSetMod:{js:{inited:function(){this.bindToDoc("keydown",function(t){this.__self._pressedKeyCode=t.which},this).bindToDoc("keyup",function(){this.__self._pressedKeyCode=null},this),this.__self.isSupportInlineSVG()||this.setMod("inlinesvg","no")}}}},{_pressedKeyCode:null,isPressedEscape:function(){return 27===this._pressedKeyCode},_isSupportInlineSVG:null,isSupportInlineSVG:function(){if(null!==this._isSupportInlineSVG)return this._isSupportInlineSVG;var t=document.createElement("div");return t.innerHTML="<svg/>",this._isSupportInlineSVG="http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI),this._isSupportInlineSVG}}),function(t){if(t.support.cors||!t.ajaxTransport||!window.XDomainRequest)return t;var e=/^(https?:)?\/\//i,i=/^get|post$/i,n=new RegExp("^(//|"+location.protocol+")","i");
return t.ajaxTransport("* text html json",function(s,o){if(s.crossDomain&&s.async&&i.test(s.type)&&e.test(s.url)&&n.test(s.url)){var r=null;return{send:function(e,i){var n="",a=(o.dataType||"").toLowerCase();r=new XDomainRequest,/^\d+$/.test(o.timeout)&&(r.timeout=o.timeout),r.ontimeout=function(){i(500,"timeout")},r.onload=function(){var e="Content-Length: "+r.responseText.length+"\r\nContent-Type: "+r.contentType,n={code:200,message:"success"},s={text:r.responseText};try{if("html"===a||/text\/html/i.test(r.contentType))s.html=r.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(r.contentType))try{s.json=t.parseJSON(r.responseText)}catch(o){n.code=500,n.message="parseerror"}}catch(c){throw c}finally{i(n.code,n.message,s,e)}},r.onprogress=function(){},r.onerror=function(){i(500,"error",{text:r.responseText})},o.data&&(n="string"===t.type(o.data)?o.data:t.param(o.data)),r.open(s.type,s.url),r.send(n)},abort:function(){r&&r.abort()}}}}),t}(jQuery),function(t){if(t.support.cors||!t.ajaxTransport||!window.XDomainRequest)return t;var e=/^(https?:)?\/\//i,i=/^get|post$/i,n=new RegExp("^(//|"+location.protocol+")","i");return t.ajaxTransport("* text html json",function(s,o){if(s.crossDomain&&s.async&&i.test(s.type)&&e.test(s.url)&&n.test(s.url)){var r=null;return{send:function(e,i){var n="",a=(o.dataType||"").toLowerCase();r=new XDomainRequest,/^\d+$/.test(o.timeout)&&(r.timeout=o.timeout),r.ontimeout=function(){i(500,"timeout")},r.onload=function(){var e="Content-Length: "+r.responseText.length+"\r\nContent-Type: "+r.contentType,n={code:200,message:"success"},s={text:r.responseText};try{if("html"===a||/text\/html/i.test(r.contentType))s.html=r.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(r.contentType))try{s.json=t.parseJSON(r.responseText)}catch(o){n.code=500,n.message="parseerror"}}catch(c){throw c}finally{i(n.code,n.message,s,e)}},r.onprogress=function(){},r.onerror=function(){i(500,"error",{text:r.responseText})},o.data&&(n="string"===t.type(o.data)?o.data:t.param(o.data)),r.open(s.type,s.url),r.send(n)},abort:function(){r&&r.abort()}}}}),t}(jQuery),BEM.decl("suggest2-provider",{getDefaultParams:function(){return{cache:!1,type:"GET",dataType:"jsonp",timeout:2e3}},_lastQuery:null,get:function(t,e,i){var n=this,s=this.params.abortQueries,o=function(){i.call(n,t,e,n.convert(n._lastData))};return n._lastText===t?this._lastQuery.always(o):(n._lastText=t,s&&null!==this._lastQuery&&this._lastQuery.abort(),void(this._lastQuery=$.ajax(n._extendParamsData(n.getRequestData(t,e))).done(function(t){n._lastData=t,s&&o()}).fail(function(){n._lastData=[]}).always(function(){s||o()})))},convert:function(t){return{orig:t[0],items:t[1],meta:t[2]}},getRequestData:function(t,e){var i={};return BEM.blocks["suggest2-detect"].isSupportInlineSVG()&&(i.svg=1),$.extend({part:t,pos:e},i)},getRequestUrl:function(){return this.params.url},_extendParamsData:function(t){return this.params.url=this.getRequestUrl(),this.params.data=$.extend(this.params.data||{},t),this.params},_lastText:void 0,_lastData:[]}),BEM.decl("suggest2-provider",{getRequestData:function(){return $.extend(this.__base.apply(this,arguments),{"prev-query":BEM.blocks["i-global"].param("query")})}}),BEM.decl("suggest2-view",{html:function(t,e){return BEMHTML.apply(this.build(t,e))},build:function(t,e){return{block:"suggest2",elem:"content",mods:{theme:"normal"},content:this.buildItems(t,e)}},buildItems:function(t){return t.reduce(function(t,e){return t.push(this.buildItem(e)),t}.bind(this),[])},buildItem:function(t){var e=this.__self._getPrefs(t),i=this.__self._getType(t,e),n="html"===i||"bemjson"===i?{}:{type:i};return this._getItemByType(t,e,i,{text:{elem:"text",content:this.__self._highlight(this.__self._getText(t,e),e)},mods:n,js:e.js||{},props:{},content:[]})},_getItemByType:function(t,e,i,n){var s=n.text,o=n.mods,r=n.js,a=n.props,c=n.content;if(e.pers&&(o.personal="yes"),"fact"===i)c.push(s,{elem:"bullet"},{elem:"fact",content:t[2]});else if("weather"===i)c.push(s,{elem:"icon",elemMods:{weather:t[3]}},{elem:"fact",content:t[2]});else if("traffic"===i)c.push(s,{elem:"icon",elemMods:{traffic:t[3]}},{elem:"fact",content:t[2]});else if("nav"===i)r.val=t[1],o.interact="link",a.url=this.__self._resolveUrl(t[4]),c.push({elem:"text",content:t[3]},{elem:"bullet"},{elem:"fact",content:t[2]});else if("icon"===i){var h={};e.icon.forEach(function(t,e,i){Array.isArray(t)?h[t[0]]=t[1]:0===e&&(h[t]=i[e+1])}),c.push(s,$.extend({elem:"icon",elemMods:{size:"s"}},h)),e.fact&&c.push({elem:"fact",content:e.fact})}else"html"===i?(r.val=t[1],c.push(e.body)):"bemjson"===i?(r.val=t[1],c=c.concat(e.bemjson)):c.push(s);return e.url&&(o.interact="link",a.url=this.__self._resolveUrl(e.url),e.target&&(a.target=e.target)),e.search_cgi&&(r.searchCGI=e.search_cgi),$.extend({block:"suggest2-item",mods:o,js:r,content:c},a)}},{_getPrefs:function(t){if(!Array.isArray(t))return{};var e=t[t.length-1];return $.isPlainObject(e)?e:{}},_getType:function(t,e){var i=Array.isArray(t)?t[0]||"text":"text";return"icon"!==i||e.icon?i:"text"},_getText:function(t){return Array.isArray(t)?t[1]:t},_highlight:function(t,e){if(!e.hl)return t;var i,n=e.hl.sort(function(t,e){return t[0]-e[0]}).filter(function(t){return t[0]>=0}),s=[],o=0;return n.length?(n.forEach(function(e){i=o>e[0]?o:e[0],s.push(t.slice(o,i)),s.push({elem:"highlight",content:t.slice(i,o=e[1])})},this),s.push(t.slice(o)),s.filter(function(t){return!!t})):t},_resolveUrl:function(t){return(/[\/]{2}/.test(t)?"":"http://")+t}}),BEM.decl("suggest2-view",{},{_getGroupType:function(t,e){return t.pers?"nah":~["nav"].indexOf(e)?e:"text"},_getTextLabel:function(t){return BEM.I18N("suggest2",t)}}),BEM.decl("suggest2-view",{},{_getTextLabel:function(t){return"text"===t?BEM.blocks["i-global"].param("serviceName"):BEM.I18N("suggest2",t)}}),BEM.decl("suggest2-popup",{onSetMod:{js:{inited:function(){this._popup=this.params.popup,this.bindSuggestEvents()}}},show:function(){throw new Error("Этот метод должен быть переопределен в модификаторе _for")},hide:function(){throw new Error("Этот метод должен быть переопределен в модификаторе _for")},setContent:function(t){return this._popup.setContent(t),this},isShown:function(){throw new Error("Этот метод должен быть переопределен в модификаторе _for")},owner:function(t){return t?(this.params.owner=t,this):this.params.owner},get:function(){return this._popup},width:function(t){return void 0===t?this._popup.domElem.outerWidth():(this._popup.domElem.outerWidth(t),this)},destruct:function(){this._popup&&(this.unbindAllEvents(),this.__base.apply(this,arguments))},bindSuggestEvents:function(){return this.params.suggest.on({select:this._onSuggestSelect,update:this._onSuggestUpdate},this),this},_onSuggestSelect:function(t,e){this.hide(e)},_onSuggestUpdate:function(t,e){e.items.length||this.hide({response:"empty"})},unbindAllEvents:function(){return this.params.suggest.un("select").un("update"),this}}),BEM.decl("suggest2-input",{onSetMod:{js:{inited:function(){var t=this;t._input=t.params.input,t.disableBrowserAutocomplete(),t.realVal(t.val()),t.bindEvents({change:function(e,i){t._onChange(e,i)},clear:$.throttle(function(e,i){t._onClear(e,i)},300)}),t.bindSuggestEvents()}}},_onChange:function(t,e){this.trigger("change",e)},_onClear:function(t,e){this.trigger("clear",e)},destruct:function(){this.unbindAllEvents(),this.__base.apply(this,arguments)},get:function(){return this._input},isFocused:function(){return this._input.hasMod("focused")},focus:function(){return this._input.setMod("focused","yes"),this},blur:function(){return this._input.delMod("focused"),this},getControl:function(){return this._input.elem("control")},val:function(){return this._input.val.apply(this._input,arguments)},valWithoutSuggest:function(t,e){return this._input.val.call(this._input,t,$.extend(e,{suggest:!1}))},realVal:function(t){return void 0===t?this._realVal:("string"==typeof t&&(this._realVal=t),this._realVal)},width:function(){return this._input.domElem.width()},getCaretPosition:function(){var t,e=this.getControl()[0],i=this.val().length;return document.selection?(t=document.selection.createRange(),t.moveStart("character",-i),t.text.length):"number"==typeof e.selectionStart?e.selectionStart:i},moveCaretToEnd:function(){var t=this.getControl()[0],e=t.value.length;if("undefined"!=typeof t.createTextRange){var i=t.createTextRange();i.collapse(!1),i.select()}else"number"==typeof t.selectionStart&&(t.scrollLeft=999999,t.setSelectionRange(e,e));return this},disableBrowserAutocomplete:function(){var t=this._input.hasMod("focused");t&&this._input.delMod("focused"),this.getControl().attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-autocomplete":"list"}),t&&this._input.setMod("focused","yes")},_bindedEventsNames:[],bindEvents:function(t,e){return Object.keys(t).forEach(function(i){-1===this._bindedEventsNames.indexOf(i)&&this._bindedEventsNames.push(i),this._eventsFilter(i).on(i,t[i].bind(e||this))},this),this},bindSuggestEvents:function(){var t=this.params.suggest;return t.on({out:function(t,e){this.a11yDeactive(),this._changeValueByEvent(t,e)}},this),BEM.blocks["suggest2-item"].on(t.domElem,{tpah:this._onSuggestItemTpah,select:this._onSuggestItemSelect,enter:this._onSuggestItemEnter},this),this},_onSuggestItemTpah:function(t,e){this._changeValueByEvent(t,e),this.moveCaretToEnd()},_onSuggestItemSelect:function(t,e){"link"!==t.block.getMod("interact")&&(this._changeValueByEvent(t,e),this.moveCaretToEnd())},_onSuggestItemEnter:function(t,e){this.a11yActive(e.id),e.byKeyboard&&this.params.updateOnEnterByKeyboard&&(this._changeValueByEvent(t,e),this.moveCaretToEnd())},unbindAllEvents:function(){return this._input.domElem&&this._bindedEventsNames.forEach(function(t){var e=this._eventsFilter(t);e[e instanceof BEM.DOM?"un":"off"](t)},this),this._bindedEventsNames=[],this.params.suggest.un("out"),this},a11yActive:function(t){this.getControl().attr("aria-activedescendant",t)},a11yDeactive:function(){this.getControl().removeAttr("aria-activedescendant")},_eventsFilter:function(t){return~["blur","focus","change","clear"].indexOf(t)?this._input:this.getControl()},_changeValueByEvent:function(t,e){var i=e&&void 0!==e.val?e.val:this.realVal();this.val(i,$.extend({block:t.block.__self.getName(),event:t.type},e))}}),BEM.decl("suggest2-input",{onSetMod:{js:{inited:function(){var t=this;t.__base.apply(this,arguments),t.bindEvents({keydown:function(e){t._onKeyDown(e)}},t)}}},_onKeyDown:function(t){t.which===this.params.suggest.__self.keyboard.enter&&this.trigger("enter")}}),BEM.DOM.decl("suggest2-item",{val:function(){if(void 0!==this.params.val)return this.params.val;var t=this.elem("text");return(t.length?t:this.domElem).text()},valOnSelect:function(){return this.val()},valOnEnter:function(){return this.val()},valOnLeave:function(){return this.val()},onEnter:function(t){return this.setMod("selected","yes").triggerEvent("enter",{val:this.valOnEnter(),byKeyboard:t})},onLeave:function(t){return this.delMod("selected").triggerEvent("leave",{val:this.valOnLeave(),byKeyboard:t})},onSelect:function(t){this.triggerEvent("select",{val:this.valOnSelect(),byKeyboard:t})},triggerEvent:function(t,e){return this.trigger(t,{val:e.val,id:this.domElem.attr("id"),show:!1,byKeyboard:e.byKeyboard})}}),BEM.DOM.decl("suggest2-item",{},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("mouseover mouseout mousedown leftclick",function(t){this.trigger(t.type,t)}).liveBindTo("link","leftclick",function(t){this.trigger("link-click",{$e:t})})}}),BEM.DOM.decl({block:"suggest2-item",modName:"interact",modVal:"link"},{onSelect:function(t){var e=this;e.__base.apply(e,arguments);var i=e.elem("link");return t||"_self"===i.attr("target")?function(){e._locationChange(i.attr("href"))}:void 0},_locationChange:function(t){window.location=t},valOnSelect:function(){return!1}}),BEM.decl({block:"suggest2-popup",modName:"for",modVal:"popup"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup.on("hide",function(){BEM.blocks["suggest2-detect"].isPressedEscape()&&this.trigger("hide",{})},this)}}},show:function(t){return this._popup.domElem?(t&&this._popup.setContent(t),this.isShown()?this:(this.trigger("preshow"),this._popup.show(this.params.owner),this.trigger("show"),this)):this},hide:function(t){return this.isShown()&&(this._popup.hide(),this.trigger("hide",t||{})),this},isShown:function(){return this._popup?this._popup.isShown():!1}}),function(t){var e=t.event.special.leftclick={setup:function(){t(this).bind("click",e.handler)},teardown:function(){t(this).unbind("click",e.handler)},handler:function(e){e.button||(e.type="leftclick",t.event.dispatch.apply(this,arguments),e.type="click")}}}(jQuery),BEM.DOM.decl({block:"suggest2",modName:"theme",modVal:"large"},{init:function(){this.__base.apply(this,arguments),this.adjustView()},initView:function(t,e){return t=t||{},this.__base($.extend(t,{theme:"large",group:t.group||this.getMod("group")||"type"}),e)},adjustView:function(){this.__base.apply(this,arguments);var t=this.getMetrics();this._view.setMarginLeft(t.marginLeft),this._view.setMinWidth(t.minWidth),this._view.setMaxWidth(t.maxWidth)},getInputLeft:function(){var t=this._input.get().findElem("control"),e=t.offset(),i=t[0];if(!i)return 0;var n=i.currentStyle?i.currentStyle:window.getComputedStyle(i),s=parseInt(n.borderLeftWidth,10)||0,o=parseInt(n.paddingLeft,10)||0;return e.left+s+o},getInputWidth:function(){return this._input.get().domElem.outerWidth()},getContainerWidth:function(){return BEM.DOM.scope.width()}}),BEM.DOM.decl({block:"suggest2",modName:"theme",modVal:"large"},{getInputWidth:function(){return this._input.get().elem("control").outerWidth()}}),BEM.decl({block:"suggest2-view",modName:"theme",modVal:"large"},{build:function(){var t=this.__base.apply(this,arguments);return t.mods.theme="large",t}}),BEM.decl({block:"suggest2-view",modName:"theme",modVal:"large"},{getMinWidth:function(){return this._minWidth||0},getMaxWidth:function(){return this._maxWidth||0},setMinWidth:function(t){return this._minWidth=t,this},setMaxWidth:function(t){return this._maxWidth=t,this},getMarginLeft:function(){return this._marginLeft},setMarginLeft:function(t){return this._marginLeft=t,this},build:function(){var t=this.__base.apply(this,arguments),e=["min-width:"+this.getMinWidth()+"px;"],i=this.getMaxWidth();i&&e.push("max-width:"+i+"px;");var n=this.getMarginLeft();return n&&e.push("margin-left:"+n+"px;"),t.attrs={style:e.join(" ")},t}}),BEM.decl({block:"suggest2-view",modName:"group",modVal:"type"},{buildItems:function(t){var e,i;return t.reduce(function(t,n){var s=this.__self._getPrefs(n),o=this.__self._getType(n,s),r=this.__self._getGroupType(s,o);return e!==r&&(e=r,i=[],t.push({block:"suggest2",elem:"group",content:[{elem:"title",content:this.__self._getTextLabel(e)},{elem:"items",content:i}]})),i.push(this.buildItem(n)),t}.bind(this),[])}}),BEM.DOM.decl({block:"suggest2",modName:"group",modVal:"label"},{initView:function(t,e){return this.__base($.extend(t||{},{group:"label"}),$.extend(e||{},{label:this.params.label}))}}),BEM.decl({block:"suggest2-view",modName:"group",modVal:"label"},{buildItems:function(t){var e,i;return t.reduce(function(t,n,s){var o=this.__self._getPrefs(n).label||"";if(e!==o){e=o,i=[];var r;r=o?o:0===s?"":this.params.label||this.__self._getTextLabel("text"),t.push({block:"suggest2",elem:"group",content:[{elem:"title",content:r},{elem:"items",content:i}]})}return i.push(this.buildItem(n)),t}.bind(this),[])}}),BEM.DOM.decl("suggest2-form",{onSetMod:{js:{inited:function(){this._isReady=!1,this._nodes=this.initNodes()}}},getDefaultParams:function(){return{inputName:"input",buttonName:"button",popupName:"popup"}},destruct:function(){this._nodes.forEach(function(t){t.suggest.domElem&&BEM.DOM.destruct(t.suggest.domElem),this.unbindFormEvents(t),t.counter&&t.counter.destruct(),t.proxies.input.destruct(),t.proxies.popup.destruct()},this),this.__base.apply(this,arguments)},getOwner:function(){},isReady:function(){return this._isReady},initNodes:function(){var t=this.getNodes();return t.forEach(function(t){t.suggest.init()}),this._isReady=!0,this.trigger("ready",{nodes:t}),t},getNodes:function(){return this.getNodeList().map(function(t){var e=t.suggest,i=e.params;return i.input=t.input,i.button=t.button,i.form=this,t.proxies={},t.proxies.popup=i["suggest2-popup"]=BEM.create({block:"suggest2-popup",mods:{"for":this.params.popupName}},{suggest:e,popup:e.findBlockOn(this.params.popupName),owner:this.getOwner(t)||i.input}),t.proxies.input=i["suggest2-input"]=BEM.create("suggest2-input",{suggest:e,input:i.input,updateOnEnterByKeyboard:i.updateOnEnterByKeyboard}),t.counter&&(t.counter.params.suggest=e,t.counter.params.form=this,i.counter=t.counter),this.bindFormEvents(t),t},this)},bindFormEvents:function(t){var e=this;return t.button&&t.button.bindTo("click press",function(t){e._onButtonClick(t)}),e.bindTo("submit",function(t,i){e.onSubmit(t,i)}),e},_onButtonClick:function(t){this.trigger("button-click",t)},unbindFormEvents:function(t){var e=this;return t.button&&t.button.un("click press"),e.unbindFrom("submit"),e},submit:function(t){return this.domElem.trigger("submit",t||{}),this},onSubmit:function(t,e){t.data=e||{},this.trigger("submit",t)},getNodeList:function(){var t=this,e=[];return t.elem("node").each(function(i,n){var s=$(n),o=t.findBlockInside(s,"suggest2"),r={input:t.findElem(s,"input"),button:t.findElem(s,"button")};e.push({node:s,suggest:o,counter:t.findBlockOn("suggest2-counter"),input:t.findBlockOn(r.input,t.params.inputName),button:t.findBlockOn(r.button,t.params.buttonName),popup:o.findBlockOn(t.params.popupName)})}),e},appendHiddenInputs:function(t){return BEM.DOM.append(this.domElem,BEMHTML.apply(t.map(function(t){return{block:this.__self.getName(),elem:"hidden-input",tag:"input",attrs:{type:"hidden",name:t.name,value:t.value}}},this))),this},removeHiddenInputs:function(){return BEM.DOM.destruct(this.findElem(this.domElem,"hidden-input")),this}}),BEM.DOM.decl("suggest2-form",{getOwner:function(){var t="images"===BEM.blocks["i-global"].param("id")||BEM.blocks["i-global"].getFlag("video_mega_header");if(t)return this.__base.apply(this,arguments);var e=this.findBlockOutside("header"),i=e.elem("wrapper");return i[0]&&i||e}}),BEM.DOM.decl("suggest2-counter",{onSetMod:{js:{inited:function(){this.clear()}}},destruct:function(){this.unbindAllEvents()},getDefaultParams:function(){return{submitBySelect:!1,suggestReqID:!1,preventSubmit:!0,host:"//yandex.ru",path:"clck/jclck",dataUrl:"http://ya.ru",params:{},timeout:300}},metaProps:{exprt:"exprt",r:"region",log:"log"},clear:function(){var t=this;return t._params={user_input:"",text:""},t._times=[],t._renderTimes=[],t._requestTime=0,t._renderTime=0,t._path={service:t.params.service,state:"not_shown",index:0,personal:"nah_not_shown",submit:""},t._ratio={len:0,queryLen:0,actionsCount:0},t._firstChange=0,t._lastChange=0,t._sinceChange={first:0,last:0},t._selectedText="",t._session=0,t._reqID=0,t._meta={},t._afterSendAjaxCallback,t},submit:function(t){var e=this,i=e.params.suggest.params["suggest2-input"],n=i.val();e._params.text=n,e._params.pos=i.getCaretPosition(),e._selectedText&&e._selectedText!==e._params.text&&(e._path.state="edit"),e.params.suggestReqID&&e.attachReqID(),e.sendAjax(e.getUrl(),$.extend({submitForm:!0,afterSendAjaxCallback:function(){}},t)),e.trigger("submit",e._getSubmitEventData()).clear(),e._params.prev_query=n},_getSubmitEventData:function(){var t=this;return{path:t._path,times:t._times,render_times:t._renderTimes,prev_query:t._params.prev_query,user_input:t._params.user_input,text:t._params.text,pos:t._params.pos,ratio:t._ratio,since_first_change:t._sinceChange.first,since_last_change:t._sinceChange.last,session:t._session,suggest_reqid:t._reqID,meta:t._meta,url:t.getUrl()}},sendAjax:function(t,e){return $.ajax({type:"GET",url:t,dataType:"script",timeout:this.params.timeout,cache:!0}).always(this._sendAjaxAlways.bind(this,e)),this},afterSendAjax:function(t){return this._afterSendAjaxCallback=t,this},getUrl:function(){return this.params.host+["/",this.params.path].concat(this._getUrlParams()).join("/").replace(/(\/+)/g,"/")},_sendAjaxAlways:function(t){this.params.preventSubmit&&t.submitForm&&this.params.form.submit({block:this.__self.getName(),prevent:!1}),t.afterSendAjaxCallback(),this._afterSendAjaxCallback&&this._afterSendAjaxCallback()},_getUrlParams:function(){var t=this;return this._getParamsList().concat(t._getData()).reduce(function(e,i){return e.concat(t._getParams(i))},[]).concat(["/"])},_getParamsList:function(){var t=this;return[t.params.params,t._getPath(),t._params,t._getRatio(),t._getSinceChange(),t._getSession(),{suggest_reqid:t._reqID}]},initValues:function(){return this._params.prev_query=this.params.suggest.params["suggest2-input"].val(),this},attachReqID:function(){this._reqID=this.__self._generateReqID(),this.params.form.appendHiddenInputs([{name:"suggest_reqid",value:this._reqID}])},bindEvents:function(){var t=this,e=t.params,i=e.suggest,n=e.form,s=i.getModel(),o=i.params["suggest2-input"],r=i.params["suggest2-popup"];return n.on({"button-click":t._onFormButtonClick,submit:t._onFormSubmit},t),s.on({request:t._onModelRequest,response:t._onModelResponse},t),o.on({change:t._onInputChange,enter:t._onInputEnter},t),r.on({show:t._onPopupShow,hide:t._onPopupHide},t),BEM.blocks["suggest2-item"].on(i.domElem,"enter",t._onSuggestItemEnter,t),i.on({update:t._onSuggestUpdate,select:t._onSuggestSelect},t),t},_onFormButtonClick:function(){"keyboard"!==this._path.submit&&(this._path.submit="button_by_mouse")},_onFormSubmit:function(t,e){e.data.block!==this.__self.getName()&&e.data.prevent!==!1&&(this.params.preventSubmit&&(e.stopImmediatePropagation(),e.preventDefault()),this.submit())},_onModelRequest:function(){this._requestTime=new Date},_onModelResponse:function(t,e){e.data.items&&(this._path.personal=this._hasPersonal(e.data.items)?"nah_not_used":"nah_not_shown",this._meta=e.data.meta||{},this._addTime(new Date-this._requestTime),this._renderTime=new Date,this._setMetaProps(e))},_onInputChange:function(t,e){e&&"clear"!==e.source||(this._params.user_input=t.block.val(),this[this._firstChange?"_lastChange":"_firstChange"]=new Date),this._ratio.actionsCount++},_onInputEnter:function(){this._path.submit="keyboard"},_onPopupShow:function(){this._path.state="not_used"},_onPopupHide:function(t,e){"empty"===e.response&&(this._path.state="not_shown")},_onSuggestItemEnter:function(t,e){e.byKeyboard&&this.params.suggest.params.updateOnEnterByKeyboard&&(this._selectedText=e.val,this._path.state="suggest")},_onSuggestUpdate:function(){this._addRenderTime(new Date-this._renderTime)},_onSuggestSelect:function(t,e){var i=this;i._path.state=e.byKeyboard?"keyboard":"mouse",i._path.index=e.itemIndex+1,i._selectedText=e.val,e.item.hasMod("personal")&&(i._path.personal="nah_used"),i.params.submitBySelect&&(i._path.submit=e.byKeyboard?"keyboard":"click_by_mouse",i._params.pos=e.pos,i._params.text=this._selectedText),i.params.suggest.isNeedSubmitFormOnSelectItem(e.item)||i.submit({submitForm:!1,afterSendAjaxCallback:e.callbackOnSelect})},unbindAllEvents:function(){var t=this.params,e=t.suggest,i=t.form;return i.un("button-click").un("submit"),e.getModel().un("request").un("response"),e.params["suggest2-input"].un("change").un("enter"),e.params["suggest2-popup"].un("show").un("hide"),e.un("select"),this},_hasPersonal:function(t){return t.some(function(t){return 1===BEM.blocks["suggest2-view"]._getPrefs(t).pers})},_setMetaProps:function(t){t.data.meta&&Object.keys(this.metaProps).forEach(function(e){this._params[this.metaProps[e]]=t.data.meta[e]||""},this)},_getParams:function(t){return Object.keys(t).reduce(function(e,i){return""===t[i]?e:(e.push(i+"="+encodeURIComponent(t[i]).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%2C/g,",")),e)},[])},_getPath:function(){return{path:[this._path.service,this._path.state,"p"+this._path.index,this._path.personal,this._path.submit].join(".")}},_getSession:function(){return this._session=(new Date).getTime()+Math.round(1e4*Math.random()),{session:this._session}},_getSinceChange:function(){return{since_first_change:this._getSinceTime("first"),since_last_change:this._getSinceTime("last")}},_getSinceTime:function(t){var e="_"+t+"Change";return this._sinceChange[t]=this[e]?(new Date).getTime()-this[e]:0,this._sinceChange[t]},_getRatio:function(){return this._ratio.len=this._params.user_input.length,this._ratio.queryLen=this._params.text.length,{ratio:[this._ratio.len,this._ratio.queryLen,this._ratio.actionsCount].join(".")}},_addTime:function(t){return this._times.push(t),this._params.times=this._times.join("."),this},_addRenderTime:function(t){return this._renderTimes.push(t),this._params.render_times=this._renderTimes.join("."),this},_getData:function(){return{"*data":"url="+this.params.dataUrl}}},{_generateReqID:function(){var t=BEM.blocks["i-global"]&&BEM.blocks["i-global"].param("yandexuid")?BEM.blocks["i-global"].param("yandexuid"):this._random(9)+this._random(9);return t+(+new Date).toString().slice(-7)+this._random(7)},_random:function(t){return Math.random().toString().slice(2,Math.min(t,10)+2)}}),BEM.DOM.decl({block:"search2",baseBlock:"search"}),BEM.DOM.decl("search2",{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=this._location;BEM.blocks["i-ua"].isYandexAppIos()||Ya.AppsApi.whenAvailable("query",function(e){t.on("change",function(t,i){i.params.text&&e.setText(i.params.text[0])})})}},bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo("label","pointerclick",this._onLabelClick),this},countSubmit:function(){return this.submitByFilters?void(this.submitByFilters=!1):this.submitBySuggest?void(this.submitBySuggest=!1):void("index"===BEM.blocks["i-global"].param("page")?(_.includes(["ru","ua","com.tr"],BEM.blocks["i-global"].param("tld"))&&BEM.blocks["b-statcounter"].goal({goal:"button",params:{query:{morda:"submit"}}}),BEM.blocks["b-statcounter"].hit({params:{query:{morda:"submit"}}})):BEM.blocks["b-statcounter"].hit({params:{query:{reform:"submit"}}}))},_onSuggestSelect:function(t){return BEM.blocks["i-global"].param("isPumpkin")?(this._location.change({url:this._buildUrl(),reload:!0},t),void t.preventDefault()):(this.__base.apply(this,arguments),this.submitBySuggest=!0,void BEM.blocks["b-statcounter"].hit({params:{query:"index"===BEM.blocks["i-global"].param("page")?{morda:"suggest"}:{reform:"suggest"}}}))},_onLabelClick:function(){BEM.blocks["b-statcounter"].hit({params:{query:{reform:"label"}}})},updateIndexPage:function(){this.reset()},updateCbirPage:function(){this.fill("")}},{live:function(){this.liveBindTo("label","click",function(t){t.preventDefault()})}}),function(){var t=function(t){var e=t.charCode||t.keyCode||t.which||0,i=t.ctrlKey||t.altKey||t.metaKey,n=e>=48&&57>=e,s=e>=96&&105>=e,o=[e>=65&&90>=e,e>=1025&&1071>=e,0===e,231===e].some(Boolean);return!i&&(n||s||o)};BEM.DOM.decl({name:"input",modName:"autofocus",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindToDoc("keydown",this._autoFocusBind)}},autofocus:{yes:function(){this.bindToDoc("keydown",this._autoFocusBind)},"":function(){this.unbindFromDoc("keydown")}}},_autoFocusBind:function(e){if(!this.hasMod("focused","yes")){var i;try{i=document.activeElement.tagName.toLowerCase()}catch(n){}if(t(e)&&"input"!==i&&"textarea"!==i){var s=this.elem("control")[0],o=this.val();if(o.length>0&&" "!==o.slice(-1)&&(o+=" ",this.val(o)),s.createTextRange){var r=s.createTextRange();r.collapse(!1),r.select()}else s.selectionStart&&s.setSelectionRange(o.length,o.length);this.setMod("focused","yes")}}}})}(),BEM.DOM.decl({block:"suggest2",modName:"adaptive",modVal:"yes"},{init:function(){this.__base.apply(this,arguments),this._boundResizeHandler=this._resizeHandler.bind(this),this.__self._bindToWinResize(this._boundResizeHandler)},_resizeHandler:function(){this._popup.width(this.getPopupWidth())},destruct:function(){this.__self._unbindFromWinResize(this._boundResizeHandler),this._boundResizeHandler=null,this.__base.apply(this,arguments)}},{_resizeCallbacks:[],_bindToWinResize:function(t){return this._resizeCallbacks.push(t),this},_unbindFromWinResize:function(t){for(var e=0;e<this._resizeCallbacks.length;e++)if(this._resizeCallbacks[e]===t)return this._resizeCallbacks.splice(e,1),this;return this},_getResizeCallback:function(){return $.throttle(function(){var t=arguments;this._resizeCallbacks.forEach(function(e){e.apply(this,t)},this)},300,this)},live:function(){this.__base.apply(this,arguments),this._resizeCallback=this._getResizeCallback(),BEM.DOM.win.on("resize",this._resizeCallback)}}),BEM.DOM.decl({block:"suggest2",modName:"adaptive",modVal:"yes"},{_minWidth:0,_maxWidth:0,_resizeHandler:function(){this.__base.apply(this),this.hasMod("theme","large")&&this.adjustView()},_onShow:function(){this.__base.apply(this),this.hasMod("theme","large")&&this._applyMetricsToContent()},adjustView:function(){this.__base.apply(this,arguments);var t=this.getMetrics(),e=t.minWidth,i=t.maxWidth,n=!1;return e!==this._minWidth&&(this._minWidth=e,n=!0),i!==this._maxWidth&&(this._maxWidth=i,n=!0),n&&this._popup.isShown()&&this._applyMetricsToContent(),t},_applyMetricsToContent:function(){var t=this.findElem("content");this._minWidth&&t.css("min-width",this._minWidth),this._maxWidth&&t.css("max-width",this._maxWidth)}}),BEM.decl({block:"suggest2-popup",modName:"for",modVal:"popup2"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup.on("beforeClose",function(){this.afterCurrentEvent(function(){BEM.blocks["suggest2-detect"].isPressedEscape()&&this.trigger("hide",{})})},this)}}},show:function(t){return this._popup.domElem?(t&&this._popup.setContent(t),this.isShown()?this:(this.trigger("preshow"),this._popup.setAnchor(this.params.owner),this._popup.setMod("visible","yes"),this.trigger("show"),this)):this},hide:function(t){return this.isShown()&&(this._popup.delMod("visible"),this.trigger("hide",t||{})),this},isShown:function(){return this._popup?this._popup.hasMod("visible","yes"):!1}}),BEM.DOM.decl("popup2",{onSetMod:{js:{inited:function(){this._parentPopup=void 0,this._zIndex=null,this._zIndexGroupLevel=null,this._isAttachedToScope=!1}},visible:{yes:function(){this.trigger("beforeOpen"),this._isAttachedToScope||(BEM.DOM.scope.append(this.domElem),this._isAttachedToScope=!0),this._captureZIndex()._bindToParentPopup().bindTo("pointerdown pointerclick",this._setPreventHideByClick)},"":function(){this.trigger("beforeClose")._releaseZIndex()._unbindFromParentPopup().unbindFrom("pointerdown pointerclick")}}},destruct:function(){this.delMod("visible"),this.__base.apply(this,arguments)},setContent:function(t){return BEM.DOM.update(this.domElem,t),this},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),t},_setPreventHideByClick:function(){var t=this;do t._preventHideByClick=!0,t=t._getParentPopup();while(t)},_bindToParentPopup:function(){var t=this._getParentPopup();return t&&t.on("beforeClose",this._onParentPopupClose,this),this},_unbindFromParentPopup:function(){return this._parentPopup&&this._parentPopup.un("beforeClose",this._onParentPopupClose,this),this._parentPopup=void 0,this},_onParentPopupClose:function(){this.delMod("visible")},_getParentPopup:function(){return this._parentPopup},_captureZIndex:function(){null===this._zIndexGroupLevel&&(this._zIndexGroupLevel=this._calcZIndexGroupLevel());var t=this.__self._visiblePopupsZIndexes,e=this._zIndexGroupLevel,i=t[e],n=this._zIndex;return i||(i=t[e]=[(e+1)*this.__self.ZINDEX_FACTOR]),this._zIndex=i[i.length-1]+1,i.push(this._zIndex),this._zIndex!==n&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];return t.splice(t.indexOf(this._zIndex),1),this},_recaptureZIndex:function(){return this._releaseZIndex(),this._zIndexGroupLevel=null,this._captureZIndex()
},getDefaultParams:function(){return{zIndexGroupLevel:0}}},{live:!0,_visiblePopupsZIndexes:{},ZINDEX_FACTOR:1e3}),BEM.DOM.decl({block:"popup2",modName:"fixed",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchor=null,this._lastDrawingCss={left:void 0,top:void 0}}},visible:{yes:function(){if(!this._anchor)throw new Error("Can't show popup without anchor");this.setMod("outside","yes").redraw().delMod("outside"),this.__base.apply(this,arguments)}}},show:function(t){return this.setAnchor(t).setMod("visible","yes")},hide:function(){return this.delMod("visible")},setAnchor:function(t){return this._anchor=t instanceof BEM.DOM?t.domElem:t,this},redraw:function(){if(!this.hasMod("visible","yes")&&!this.hasMod("outside","yes"))return this;var t=this._lastDrawingCss,e=!1;return $.each(this._calcDrawingParams(),function(i,n){t[i]!==n&&(t[i]=n,e=!0)}),e&&this.domElem.css(t),this},_calcDrawingParams:function(){var t=this._calcAnchorDimensions();return{left:t.left,top:t.top+t.height}},_calcAnchorDimensions:function(){var t=this._anchor,e=t.offset(),i=BEM.DOM.win;return{left:e.left-i.scrollLeft(),top:e.top-i.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}},_calcZIndexGroupLevel:function(){var t=this.__base.apply(this,arguments);return this.findBlocksOutside(this._anchor,"z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t)}}),BEM.DOM.decl({block:"popup2",modName:"autoclosable",modVal:"yes"},{onSetMod:{visible:{yes:function(){this.__self._visiblePopupsStack.unshift(this),this.afterCurrentEvent(function(){this.domElem&&this.bindToDoc("pointerclick",this._onDocClick)}),this.__base.apply(this,arguments)},"":function(){var t=this.__self._visiblePopupsStack;t.splice(t.indexOf(this),1),this.unbindFromDoc("pointerclick").__base.apply(this,arguments)}}},_onDocClick:function(t){this.hasMod("target","anchor")&&(this._anchor[0]===t.target||this._anchor.find(t.target).length>0)||(this._preventHideByClick?this._preventHideByClick=null:this.delMod("visible"))}},{live:function(){return BEM.DOM.doc.on("keydown",this._onDocKeyPress.bind(this)),this.__base()},_visiblePopupsStack:[],_onDocKeyPress:function(t){BEM.blocks.keycodes.is(t.keyCode,"ESC")&&this._visiblePopupsStack.length&&this._visiblePopupsStack[0].delMod("visible")}}),BEM.DOM.decl({block:"popup2",modName:"autoclosable",modVal:"yes"},{_onDocClick:function(t){return this.hasMod("fixed","yes")&&(this._anchor[0]===t.target||this._anchor.find(t.target).length>0)?void 0:this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"popup2",modName:"theme",modVal:"normal"},{getDefaultParams:function(){return $.extend(this.__base(),{mainOffset:5,viewportOffset:5})}}),BEM.DOM.decl({block:"popup2",modName:"target"},{onSetMod:{js:{inited:function(){var t=this.__self.AVAILABLE_DIRECTIONS;this.params.directions.forEach(function(e){if(-1===t.indexOf(e))throw new Error("Can't init popup with \""+e+'" direction. Available directions: '+t.join(", "))}),this.__base.apply(this,arguments),this._lastDrawingCss={left:void 0,top:void 0,zIndex:void 0,display:void 0}}},visible:{yes:function(){this.__base.apply(this,arguments),this.bindToWin("scroll resize",this._onWinScollAndResize).setMod("outside","yes").redraw().delMod("outside")},"":function(){this.__base.apply(this,arguments),this.unbindFromWin("scroll resize")}}},setContent:function(){return this.__base.apply(this,arguments).redraw()},redraw:function(){if(!this.hasMod("visible","yes")&&!this.hasMod("outside","yes"))return this;var t=this._calcBestDrawingParams();this.setMod("direction",t.direction);var e=this._lastDrawingCss,i=!1;return $.each(this._calcDrawingCss(t),function(t,n){e[t]!==n&&(e[t]=n,i=!0)}),i&&this.domElem.css(e),this},_calcDrawingCss:function(t){return{left:t.left,top:t.top}},calcPossibleDrawingParams:function(){var t=this._calcTargetDimensions(),e=this._calcViewportDimensions(),i=this.params,n=i.mainOffset,s=i.secondaryOffset,o=i.viewportOffset;return this.params.directions.map(function(i){var r={direction:i,width:0,height:0,left:0,top:0};return this._checkMainDirection(i,"bottom")?(r.top=t.top+t.height+n,r.height=e.bottom-r.top-o):this._checkMainDirection(i,"top")?(r.height=t.top-e.top-n-o,r.top=t.top-r.height-n):(this._checkSecondaryDirection(i,"center")?(r.height=e.bottom-e.top-2*o,r.top=t.top+(t.height-r.height)/2):this._checkSecondaryDirection(i,"bottom")?(r.height=t.top+t.height-e.top-s-o,r.top=t.top+t.height-r.height-s):this._checkSecondaryDirection(i,"top")&&(r.top=t.top+s,r.height=e.bottom-r.top-o),this._checkMainDirection(i,"left")?(r.width=t.left-e.left-n-o,r.left=t.left-r.width-n):(r.left=t.left+t.width+n,r.width=e.right-r.left-o)),this._checkSecondaryDirection(i,"right")?(r.width=t.left+t.width-e.left-s-o,r.left=t.left+t.width-r.width-s):this._checkSecondaryDirection(i,"left")?(r.left=t.left+s,r.width=e.right-r.left-o):this._checkSecondaryDirection(i,"center")&&this._checkMainDirection(i,"top","bottom")&&(r.width=e.right-e.left-2*o,r.left=t.left+t.width/2-r.width/2),r},this)},_calcBestDrawingParams:function(){for(var t,e,i,n,s,o,r=this._calcPopupDimensions(),a=this._calcTargetDimensions(),c=this._calcViewportDimensions(),h=this.params.directions,u=h.length,l=0;u>l&&(t=h[l],e=this._calcPos(t,a,r),i=this._calcViewportFactor(e,c,r),(0===l||i>o||!o&&this.hasMod("direction",t))&&(n=t,o=i,s=e),!(o>this.__self.VIEWPORT_ACCURACY_FACTOR));l++);return{direction:n,left:s.left,top:s.top}},_calcPopupDimensions:function(){var t=this.domElem.outerWidth(),e=this.domElem.outerHeight();return{width:t,height:e,area:t*e}},_calcTargetDimensions:function(){},_calcViewportDimensions:function(){var t=BEM.DOM.win,e=t.scrollTop(),i=t.scrollLeft(),n=t.width(),s=t.height();return{top:e,left:i,bottom:e+s,right:i+n}},_calcPos:function(t,e,i){var n={},s=this.params.mainOffset,o=this.params.secondaryOffset;return this._checkMainDirection(t,"bottom")?n.top=e.top+e.height+s:this._checkMainDirection(t,"top")?n.top=e.top-i.height-s:this._checkMainDirection(t,"left")?n.left=e.left-i.width-s:this._checkMainDirection(t,"right")&&(n.left=e.left+e.width+s),this._checkSecondaryDirection(t,"right")?n.left=e.left+e.width-i.width-o:this._checkSecondaryDirection(t,"left")?n.left=e.left+o:this._checkSecondaryDirection(t,"bottom")?n.top=e.top+e.height-i.height-o:this._checkSecondaryDirection(t,"top")?n.top=e.top+o:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?n.left=e.left+e.width/2-i.width/2:this._checkMainDirection(t,"left","right")&&(n.top=e.top+e.height/2-i.height/2)),n},_calcViewportFactor:function(t,e,i){var n=this.params.viewportOffset,s=Math.max(t.left,e.left+n),o=Math.min(t.left+i.width,e.right-n),r=Math.max(t.top,e.top+n),a=Math.min(t.top+i.height,e.bottom-n);return o>s&&a>r?(o-s)*(a-r)/i.area:0},_checkMainDirection:function(t,e,i){return 0===t.indexOf(e)||i&&0===t.indexOf(i)},_checkSecondaryDirection:function(t,e){return t.indexOf("-"+e)>0},_checkDirection:function(t,e){return t.indexOf(e)>=0},_onWinScollAndResize:function(){this.redraw()},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{mainOffset:0,secondaryOffset:0,viewportOffset:0,directions:this.__self.AVAILABLE_DIRECTIONS})}},{VIEWPORT_ACCURACY_FACTOR:.99,AVAILABLE_DIRECTIONS:["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right-top","right-center","right-bottom","left-top","left-center","left-bottom"]}),function(t){function e(t,e){return t.addClass("i-bem "+e).bem(e)}BEM.DOM.decl({block:"popup2",modName:"target",modVal:"anchor"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchor=null,this._anchorParents=null,this._destructor=null,this._isAnchorVisible=void 0,this._updateIsAnchorVisible=t.throttle(this._updateIsAnchorVisible,this.__self.UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL,this)}},visible:{yes:function(){if(!this._anchor)throw new Error("Can't show popup without anchor");this._anchorParents=this._anchor.parents(),this._bindToAnchorParents(),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this._unbindFromAnchorParents(),this._anchorParents=null,this._isAnchorVisible=void 0}}},destruct:function(){this._unbindFromDestructor(),this.__base.apply(this,arguments)},setAnchor:function(t){return this._unbindFromAnchorParents()._unbindFromParentPopup()._unbindFromDestructor(),this._anchor=t instanceof BEM.DOM?t.domElem:t,this._destructor=e(this._anchor,"_"+this.__self.getName()+"-destructor"),this._isAnchorVisible=void 0,this._bindToDestructor(),this.hasMod("visible","yes")?(this._anchorParents=this._anchor.parents(),this._recaptureZIndex()._bindToAnchorParents()._bindToParentPopup().redraw()):(this._anchorParents=null,this._zIndexGroupLevel=null),this},_calcTargetDimensions:function(){var t=this._anchor,e=this._getOffsetOf(t);return{left:e.left,top:e.top,width:t.outerWidth(),height:t.outerHeight()}},_getOffsetOf:function(t){var e=t.offset();return"pageYOffset"in window&&(e.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),e.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft)),e},_calcDrawingCss:function(e){return"undefined"==typeof this._isAnchorVisible&&(this._isAnchorVisible=this._calcIsAnchorVisible()),t.extend(this.__base(e),{display:this._isAnchorVisible?"":"none"})},_calcIsAnchorVisible:function(){var e=this._anchor,i=this._getOffsetOf(e),n=i.left,s=i.top,o=n+e.outerWidth(),r=s+e.outerHeight(),a=this.getMod("direction"),c=Math.floor(this._checkDirection(a,"top")?s:r),h=Math.floor(this._checkDirection(a,"left")?n:o),u=!0;return this._anchorParents.each(function(e,i){if("BODY"===i.tagName)return!1;i=t(i);var n=/scroll|hidden|auto/,s=n.test(i.css("overflow-y")),o=n.test(i.css("overflow-x"));if(s||o){var r=this._getOffsetOf(i),a=Math.floor(r.top);if(a>c||a+i.outerHeight()<c)return u=!1;var l=Math.floor(r.left);return u=h>=l&&l+i.outerWidth()>=h}}.bind(this)),u},_calcZIndexGroupLevel:function(){var t=this.__base.apply(this,arguments);return this._destructor.findBlocksOutside("z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t)},_bindToAnchorParents:function(){return this.bindTo(this._anchorParents,"scroll",this._onAnchorParentsScroll)},_unbindFromAnchorParents:function(){return this._anchorParents&&this.unbindFrom(this._anchorParents,"scroll"),this},_onAnchorParentsScroll:function(){this.redraw()._updateIsAnchorVisible()},_onWinScollAndResize:function(){this.__base.apply(this,arguments),this._updateIsAnchorVisible()},_updateIsAnchorVisible:function(){var t=this._calcIsAnchorVisible();t!==this._isAnchorVisible&&(this._isAnchorVisible=t,this.redraw())},_bindToDestructor:function(){return this._destructor.on("destruct",this._onPopupAnchorDestruct,this),this},_unbindFromDestructor:function(){return this._destructor&&this._destructor.un("destruct",this._onPopupAnchorDestruct,this),this},_onPopupAnchorDestruct:function(){this.domElem&&BEM.DOM.destruct(this.domElem)},_getParentPopup:function(){return void 0===this._parentPopup&&(this._parentPopup=this.findBlockOutside(this._anchor,this.__self.getName())),this._parentPopup}},{UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL:100});var i=BEM.DOM;i.decl("_popup2-destructor",{destruct:function(){this.trigger("destruct"),this.__base.apply(this,arguments)}})}(jQuery),BEM.DOM.decl({block:"search2",modName:"cbir",modVal:"yes"},{_onSubmit:function(t){this.trigger("search:submit",t),t.preventDefault()},getErrorTargetDomElem:function(){return this.elem("input")}}),BEM.DOM.decl("cbir-logo",{_onClick:function(){this.trigger("showPanel")}},{live:function(){this.liveBindTo("pointerclick",function(t){this._onClick(t)})}}),BEM.DOM.decl("tooltip",{onSetMod:{js:{inited:function(){this._popup=null,this._owner=null}},shown:{yes:function(){if(!this._owner)throw new Error("Owner is unset");this._getPopup().show(this._owner).unbindFromDoc("keydown")},"":function(){this._getPopup().hide()}}},getOwner:function(){return this._owner},setOwner:function(t){return this._owner=t,this},setContent:function(t){return this._getPopup().setContent(t),this},redraw:function(){return this.hasMod("shown","yes")&&this._getPopup().repaint(),this},destruct:function(){this.delMod("shown"),this.__base.apply(this,arguments)},_getPopup:function(){return this._popup||(this._popup=this.findBlockOn("popup").on("show",this._onPopupShow,this).on("hide",this._onPopupHide,this)),this._popup},_onPopupShow:function(){this.trigger("show")},_onPopupHide:function(){this.delMod("shown").trigger("hide")},_onClick:function(){this.trigger("click").delMod("shown")}},{live:function(){this.liveBindTo("click",function(){this._onClick()})}}),BEM.DOM.decl("tooltip",{_onEnter:function(){this.setMod("hovered","yes")},_onLeave:function(){this.delMod("hovered")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onEnter(t):this._onLeave(t))}),this.__base()}}),BEM.DOM.decl("tooltip",{show:function(){return this.setMod("shown","yes")},hide:function(){return this.delMod("shown")}}),BEM.DOM.decl("cbir-intent",{onSetMod:{js:function(){this._intentTexts=this.params.texts,this.bindEvents().checkIntent()},loading:{yes:function(){this.setIntentTitle("loading").startSpin()}}},bindEvents:function(){return this.bindTo("close","pointerclick",this._onClearClick),BEM.blocks["b-page"].on("cbir-intent:loaded",this.prepareInputForCBIR,this),this},destruct:function(){BEM.blocks["b-page"].un("cbir-intent:loaded",this.prepareInputForCBIR,this),this.__base.apply(this,arguments)},_onClearClick:function(){this.delMod("visibility").enableInput().trigger("focusInput")},checkIntent:function(){var t=this.elem("thumb").attr("data-src");t&&this.bindLoadThumbEvent().setThumbSrc(t).makeIntentLoading(),(this.isVisible()||t)&&this.disableInput()},bindLoadThumbEvent:function(){return this.elem("thumb").one("load",this.makeIntentNormal.bind(this)),this},setThumbSrc:function(t){return this.elem("thumb").attr("src",t),this},isVisible:function(){return this.hasMod("visibility","visible")},startSpin:function(){return this.getSpin().setMod("progress","yes"),this},getSpin:function(){return this._spin||(this._spin=this.findBlockOn(this.elem("spinner"),"spinner"))},setIntentTitle:function(t){var e=this._intentTexts[t];return e&&this.elem("title").text(e),this},stopSpin:function(){return this.getSpin().delMod("progress"),this},makeIntentLoading:function(){var t=this.elem("thumb"),e=!_.isEmpty(t[0])&&t[0].width>0;return this.setMod("visibility","visible"),e||this.setMod("loading","yes").delMod(this.elem("thumb"),"visibility"),this},makeIntentNormal:function(){var t=this.elem("thumb").attr("src");return t?this.setMod(this.elem("thumb"),"visibility","visible").setIntentTitle("loaded").stopSpin():this.delMod("visibility").stopSpin(),this},prepareInputForIndex:function(){return this.delMod("visibility").delMod(this.elem("thumb"),"visibility").enableInput()},disableInput:function(){return this.trigger("disableInput"),this},enableInput:function(){return this.trigger("enableInput"),this},focusInput:function(){return this.trigger("focusInput"),this},prepareInputForCBIR:function(t,e){return _.isEmpty(e.html)?void 0:(this.elem("thumb").attr("src",e.html),this.setMod("visibility","visible").delMod("loading").makeIntentNormal().disableInput())},prepareInputForSearch:function(){return this.clearThumb(),this.delMod(this.elem("thumb"),"visibility").delMod("loading").delMod("visibility").enableInput()},clearThumb:function(){this.elem("thumb").attr("src","")}}),BEM.DOM.decl({block:"header",modName:"tableau",modVal:"yes"},{LOGOTABLO_INIT_DELAY:6e3,bindEvents:function(){this.__base.apply(this,arguments),this.bindTo("logo","mouseenter",this._onLogoMouseEnter),setTimeout(this._initTableau.bind(this),this.LOGOTABLO_INIT_DELAY)},_onLogoMouseEnter:function(){this._initTableau()},_initTableau:function(){if(this.unbindFrom("logo","mouseenter",this._onLogoMouseEnter),!this._tableau){var t=this.params.tableau;this._tableau=$.Tableau({serviceId:t.serviceId,headerElem:$(".header"),triggerElem:this.elem("logo"),device:"desktop",width:370,lang:t.lang,preset:t.preset}),$(this._tableau.getNode()).on("open",this._updateTableauSearchText.bind(this))}},_updateTableauSearchText:function(){this._tableau.setSearchText(_.unescape(BEM.blocks["i-global"].param("searchInputText")))}}),function(t,e){function i(s){if(!s.serviceId)throw new Error("Parameter 'serviceId' is required");if(this.constructor!==i)return new i(s);if(b&&this._addStyle(b),!s.device){if(1!==y.length)throw new Error("Parameter 'device' is required");s.device=y[0]}this._useDeviceSpecificMethods(s.device),this._params=s,this._isOpened=!1,this._isInited=!1,this._handlers=[],this._bindHandler(e(t),"message",n),this._$iframe=this._buildIframe(this._buildUrl(this._params)),this._$tail=this._buildTail(),this._$tableau=this._buildAndAppendTableau(this._params,this._$iframe,this._$tail),s.headerElem&&this._bindWiringHandlers()}function n(t){var e=t.originalEvent.data;if("string"==typeof e&&0===e.indexOf(d)){var i=e.split(":");switch(i[0]){case p:this._isInited=!0,this._isOpened&&this._open(),this._$tableau.trigger("init");break;case m:this._params.height||this._$tableau.height(parseInt(i[1],10)+2*_);break;case f:this.close()}}}var s="https://yastatic.net",o="/tableau/tableau.html",r="tableau",a=r+"_opened",c=r+"_closed",h=r+"_device_",u=r+"__content",l=r+"__tail",d="tableau.",p=d+"ready",f=d+"close",m=d+"height",_=1,g=150,b="",v=!1,y=[],k={};i.prototype.setSearchText=function(t){return this._postMessage({fnName:"updateUrls",fnArgs:[{text:t,serviceId:this._params.serviceId}]}),this},i.prototype._postMessage=function(t){function e(){i.postMessage(n,"*")}var i=this._$iframe[0].contentWindow,n=JSON.stringify(t);this._isInited?e():this._$tableau.on("init",e)},i.prototype.setPos=function(t){return"number"==typeof t.top&&(this._top=t.top),"number"==typeof t.left&&(this._left=t.left),"number"==typeof t.tail&&(this._tail=t.tail),this._isOpened&&this._reposition(),this},i.prototype._reposition=function(){"number"==typeof this._top&&this._$tableau.css("top",this._top-_),"number"==typeof this._left&&this._$tableau.css("left",this._left-_),"number"==typeof this._tail&&this._$tail.css("left",this._tail)},i.prototype.open=function(){var t=this._isOpened;return this._isOpened=!0,!t&&this._isInited&&this._open(),this},i.prototype._open=function(){this._reposition(),this._$tableau.removeClass(c).addClass(a),this._postMessage({fnName:"open"}),this._$tableau.trigger("open")},i.prototype.close=function(){var t=this._isOpened;return this._isOpened=!1,t&&this._isInited&&this._close(),this},i.prototype._close=function(){this._$tableau.removeClass(a);var t=this;setTimeout(function(){t._isOpened||t._$tableau.addClass(c)},g),this._$tableau.trigger("close")},i.prototype.isOpened=function(){return this._isOpened},i.prototype.isInited=function(){return this._isInited},i.prototype.getNode=function(){return this._$tableau[0]},i.prototype.destruct=function(){var t=this;e.when(this._$tableau.trigger("destruct")).done(function(){e.each(t._handlers,function(t,e){e.$node.off(e.event,e.callback)}),t._handlers=[],t._$tableau.remove()})},i.prototype._bindHandler=function(t,i,n){var s=e.proxy(n,this);return t.on(i,s),this._handlers.push({$node:t,event:i,callback:s}),this},i.prototype._buildUrl=function(t){var i={};e.each(["preset","lang","domain","device","target","serviceId"],function(e,n){var s=t[n];if(s){var o=n.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});i[o]=s}});var n=t.host||s,r=t.path||o;return n+r+(r.indexOf("?")>-1?"":"?"+e.param(i))},i.prototype._buildIframe=function(t){return e("<iframe/>",{"class":u,src:t,frameborder:0,allowtransparency:!0})},i.prototype._buildTail=function(){return e("<div/>",{"class":l})},i.prototype._buildAndAppendTableau=function(t,i,n){return e("<div/>",{"class":[r,h+t.device,c].join(" "),css:{width:t.width+2*_,height:t.height&&t.height+2*_,zIndex:t.zIndex}}).append(n).append(i).appendTo("body")},i.prototype._addStyle=function(t){if(!v){var e=document.createElement("style");e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),e.styleSheet?e.styleSheet.cssText=t:"textContent"in e?e.textContent=t:e.innerHTML=t,v=!0}},i._onDevice=function(t,i){function n(t,n){var s=k[n]||(k[n]={});e.each(i,function(t,e){var i=s[t]||(s[t]=[]);i.push(e)})}"string"==typeof t?(n(0,t),y.push(t)):e.each(t,n)},i.prototype._useDeviceSpecificMethods=function(t){var i=this,n=function(){};e.each(k[t],function(t,s){var o=i[t]?e.proxy(i[t],i):n;e.each(s,function(t,n){o=e.proxy(n,i,o)}),i[t]=o})},e.Tableau=i}(window,jQuery),function(t,e){function i(){var t=this;this._clearToggleTimer(),this.isOpened()||this._mousePressed||(this._toggleTimer=setTimeout(function(){t.open(),t._toggleTimer=null},a))}function n(t){var e=this;this._clearToggleTimer()||s(t,this._params.triggerElem)||(this._toggleTimer=setTimeout(function(){e.close(),e._toggleTimer=null},a))}function s(t,e){var i=e.offset();return t.clientX>0&&t.clientY>0&&t.pageX<e.outerWidth()+i.left&&t.pageY<e.outerHeight()+i.top}function o(){this.isOpened()||this._clearToggleTimer(),this._mousePressed=!0}function r(){this._mousePressed=!1}var a=300;e._onDevice("desktop",{_bindWiringHandlers:function(e){e(),this._toggleTimer=null,this._mousePressed=!1;var s=this._params.triggerElem,a=t(document.body);this._bindHandler(s,"mousemove",i)._bindHandler(s,"mouseleave",n)._bindHandler(a,"mousedown",o)._bindHandler(a,"mouseup dragend",r)._bindHandler(this._$tableau,"mouseenter mousemove",i)._bindHandler(this._$tableau,"mouseleave",n)}}),e.prototype._clearToggleTimer=function(){return this._toggleTimer?(clearTimeout(this._toggleTimer),this._toggleTimer=null,!0):!1}}(jQuery,jQuery.Tableau),function(t,e){var i=-2;e._onDevice(["desktop","touch-pad"],{_reposition:function(t){var e=this._params,n=e.headerElem;if(n){var s=e.triggerElem,o=this._$tableau,r=n.offset().top+n.outerHeight()+i,a=s.offset().left-o.offset().left+(s.outerWidth()-this._$tail.outerWidth())/2;this._top=Math.round(r),this._tail=Math.round(a)}t()}})}(jQuery,jQuery.Tableau),BEM.DOM.decl({block:"header",modName:"tablet",modVal:"yes"},{bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo(this.elem("nav-trigger"),"click",this.navExpand),BEM.blocks.search2.on("input:focus",this.navShrink,this),BEM.blocks["b-page"].on("change",this.navShrink,this),this},destruct:function(){BEM.blocks.search2.un("input:focus",this.navShrink,this),BEM.blocks["b-page"].un("change",this.navShrink,this),this.__base.apply(this,arguments)},navExpand:function(){this.setMod("nav-state","expanded")},navShrink:function(){this.delMod("nav-state")}}),BEM.DOM.decl("cbir-panel",{onSetMod:{js:function(){this.detectDragDrop()&&this.setMod("dragdrop","yes"),this.findBlocks().bindEvents()}},detectDragDrop:function(){var t=$("<div />")[0];return("draggable"in t||"ondragstart"in t&&"ondrop"in t)&&!window.opera&&(!BEM.blocks["i-ua"].ie||BEM.blocks["i-ua"].ie>=10)},findBlocks:function(){return this.file=this.elem("file-input"),this.input=this.findBlockInside({block:"input",modName:"type",modVal:"cbir"}),this},bindEvents:function(){return this.bindTo("find-button","pointerclick",this._onFindButtonClick).bindTo(this.file,"change",this._onFileChange).bindTo("input","pointerclick",this._onInputBoxClick).bindTo("input","submit",this._onFormSubmit).bindTo("close","keypress",this._onCloseKeyboard).bindTo("close","pointerclick",this._onCloseClick).bindTo("input","keydown",this._onInputChange),BEM.blocks["i-keyrouter"].on("esc",this.hidePanel,this),this.bindToDoc("pointerclick",this._onOutsideClick),BEM.blocks["b-page"].on("contentLoaded",this.hidePanel,this),this},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["i-keyrouter"].un("esc",this.hidePanel,this),this.unbindFromDoc("pointerclick",this._onOutsideClick),BEM.blocks["b-page"].un("contentLoaded",this.hidePanel,this)},getController:function(){return BEM.blocks["i-cbir-controller"].get()},_onFindButtonClick:function(){this.getController().submit()},_onCloseClick:function(){this.hidePanel()},_onCloseKeyboard:function(t){(13===t.which||32===t.which)&&(t.preventDefault(),this.hidePanel())},_onInputBoxClick:function(){this.input.setFocus()},_onFormSubmit:function(t){t.preventDefault(),this.getController().submit()},_onOutsideClick:function(t){this.hasMod("visibility","visible")&&(this.containsDomElem($(t.target))||this.hidePanel())},_onInputChange:function(t){switch(t.keyCode){case 13:this.getController().submit();break;case 27:this.hidePanel()}},_onFileChange:function(t){this.trigger("filechange",t)},showPanel:function(t){var e=this;return this.getController().runCBIRRequest().showParanja(),this.domElem.fadeIn(250,function(){e.setMod("visibility","visible")}),t&&this.input.setFocus(),this},hidePanel:function(){var t=this;return this.getController().cancelCBIRRequest().hideParanja(),this.input.val(""),this.delMod("opened"),this.domElem.fadeOut(250,function(){t.setMod("visibility","hidden")}),this._isPopupShowedByCode=!1,this.getController().hideError(),this},clearFileInput:function(){return BEM.blocks["i-ua"].ie?setTimeout(function(){this.file.replaceWith(this.file=this.file.clone(!0))}.bind(this),100):this.file.val(""),this},val:function(){return this.input.val()},setThreateningLook:function(){this.setMod(this.elem("input"),"error","yes")},unsetThreateningLook:function(){this.delMod(this.elem("input"),"error")},getErrorTargetDomElem:function(t){return this.elem("url"===t?"input":"dragzone")},isDragSupported:function(){return this.hasMod("dragdrop","yes")}},{live:!0}),BEM.DOM.decl({block:"cbir-panel",modName:"dragdrop",modVal:"yes"},{bindEvents:function(){return this.__base.apply(this,arguments),this.bindToDoc("dragover dragend",this.processDragEvent),this.bindToDomElem(this.elem("dragzone"),{"dragenter dragover dragleave":this._onDrag,drop:this._onDrop}),this._onImageDragStart=this._onImageDragStart.bind(this),this.bindedDragendHack=this.dragendHack.bind(this),$("body").on("dragstart",this._onImageDragStart),this},destruct:function(){this.__base.apply(this,arguments),this.unbindFromDoc("dragover dragend",this.processDragEvent),this.unbindFromDoc({dragover:this._onDragOver,dragend:this._onDragEnd}),$("body").off("dragstart",this._onImageDragStart)},processDragEvent:function(t){switch(t.type){case"dragover":return this.showPanelOnDrag(t);case"dragend":return this.hidePanelAfterDrag(t);case"dragstart":return this.processImageDragStartEvent(t)}},processImageDragStartEvent:function(t){var e,i=t.originalEvent.dataTransfer,n=$(t.target);return n.is("img")||(n=n.find("img:eq(0)")),n.length?(this.hasMod("visibility","visible")&&this.setMod("opened","yes"),void(i&&(e=n.attr("src"),e.indexOf("//")||(e=location.protocol+e),i.setData("text",e)))):!1},_onImageDragStart:function(t){return this.processImageDragStartEvent(t)},_onDrag:function(t){return this.toggleStroke("dragleave"!==t.type),!1},_onDrop:function(t){this._isPopupShowedByCode=!1,this.toggleStroke(!1).uninstallDragendHack(),this.getController().hideError();var e,i,n=t.originalEvent.dataTransfer,s=n.files[0];try{e=n.getData("text"),i=this.extractImageFromHtml(n.getData("text/html"))}catch(o){}return s?this.getController().tryUploadFile(s):i?this.getController().tryUploadURL(i):e&&this.getController().tryUploadURL(e),!1},showPanelOnDrag:function(){this.getController().toggleLayoutPointerEvents(!0),this.hasMod("visibility","visible")||(this._isPopupShowedByCode=!0,this.showPanel().uninstallDragendHack().installDragendHack())},hidePanelAfterDrag:function(t){this.hideUploaderAfterDrag(t)},installDragendHack:function(){return $("body").one("mousemove",this.bindedDragendHack),this},uninstallDragendHack:function(){return $("body").unbind("mousemove",this.bindedDragendHack),this},dragendHack:function(){return setTimeout(function(){this._isPopupShowedByCode&&this.hideUploaderAfterDrag()}.bind(this),42),!1},hideUploaderAfterDrag:function(t){return this.getController().toggleLayoutPointerEvents(!0),this.hasMod("opened","yes")&&"none"===t.originalEvent.dataTransfer.dropEffect?!1:(this.uninstallDragendHack().hidePanel(),this)},toggleStroke:function(t){return this.setMod(this.elem("wrap"),"hover",t?"yes":""),this},extractImageFromHtml:function(t){var e=t.match(/<img.*?src=['"](.+?)['"]/i);return e&&e[1]}}),BEM.DOM.decl("i-cbir-controller",{onSetMod:{js:function(){this.findBlocks().bindEvents()}},findBlocks:function(){return this.cbirPanel=this.findBlockInside("cbir-panel"),this.cbirError=this.findBlockInside("cbir-error"),this.cbirIntent=this.findBlockInside("cbir-intent"),this.search=BEM.blocks.header.getSearch(),this.layout=this.findBlockInside("page-layout"),this.paranja=this.findBlockInside("paranja"),this._location=BEM.blocks.location.getInstance(),this},bindEvents:function(){return BEM.blocks["b-page"].on("change",this._onPageChange,this),BEM.blocks["cbir-logo"].on("showPanel",this._onLogoClick,this),BEM.blocks["cbir-error"].on("showParanja",this.showParanja,this).on("hideParanja",this.hideParanja,this),this},unbindEvents:function(){return BEM.blocks["b-page"].un("change",this._onPageChange,this),BEM.blocks["cbir-logo"].un("showPanel",this._onLogoClick,this),BEM.blocks["cbir-error"].un("showParanja",this.showParanja,this).un("hideParanja",this.hideParanja,this),this},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},_onPageChange:function(){var t=this._location.getState().block,e=["b-page_type_search-by-image","b-page_type_similar"];"b-page_type_search-by-image"===t||this.setCachedUrl(""),_.contains(e,t)||this.clearIntent(),this.toggleLayoutPointerEvents(!0)},_onLogoClick:function(){this.showPanel(!BEM.blocks["i-global"].param("mobile"))},showError:function(t){return this.getRequestStatus()?this.cbirError.showError(t,this.cbirPanel):this.cbirError.showError(t,this.search),this},hideError:function(){return this.cbirError.hideError(),this},showPanel:function(t){return this.cbirPanel.showPanel(t),this},hidePanel:function(){return this.cbirPanel.hidePanel(),this},getRequestStatus:function(){return this.__self.getRequestStatus()},setRequestStatus:function(t){return this.__self.setRequestStatus(Boolean(t)),this},cancelCBIRRequest:function(){return this.setRequestStatus(!1),this},runCBIRRequest:function(){return this.setRequestStatus(!0),this},clearIntent:function(){return this.cbirIntent.clearThumb(),this},showLoader:function(){return this.cbirIntent.makeIntentLoading(),this},hideLoader:function(){return this.cbirIntent.makeIntentNormal(),this},showParanja:function(){return this.layout.toggleCBIRMode(!0),this.paranja.setTheme("dark").open(),this},hideParanja:function(){return this.layout.toggleCBIRMode(!1),this.paranja.delTheme().close(),this},toggleLayoutPointerEvents:function(t){return this.layout.togglePointerEvents(t),this}},{live:!0,_instance:null,getRequestStatus:function(){return this.isRequestRunning},setRequestStatus:function(t){this.isRequestRunning=Boolean(t)},get:function(){return this._instance||(this._instance=$(this.buildSelector()).bem(this.getName()))}}),BEM.decl("i-cbir-controller",{validateFile:function(t){return this.isValidFile(t)?this.isValidFileSize(t)?!0:(this.showError("size"),!1):(this.showError("format"),!1)},isValidFile:function(t){return t&&/image.*/.test(t.type)},isValidFileSize:function(t){return t.size<=8388608},validateURL:function(t){return t.indexOf("http")&&(t="http://"+t),BEM.blocks.uri.isAcceptable(t)}}),function(){var t;BEM.decl("i-cbir-controller",{setCachedUrl:function(e){t=e},checkCachedUrl:function(e){return t===e}})}(),BEM.decl("i-cbir-controller",{linkBlockName:"b-page_type_search-by-image__link",queryArgs:{rpt:"imageview"},_makeUrl:function(t){return BEM.blocks.uri.buildRelativeUrl(BEM.blocks["i-global"].param("router").search,BEM.blocks["i-url-controller"].mergePassedUrlParams(BEM.blocks["serp-controller"].getUrlRequestParams(),this.queryArgs,t))},uploadFileNormal:function(t){var e=new FormData;
return this.setRequestStatus(!0),e.append("upfile",t),e.append("format","json"),e.append("request",JSON.stringify([{block:this.linkBlockName}])),_.forOwn(this.queryArgs,function(t,i){e.append(i,t)}),this.fade(),this.showLoader(),$.ajax({type:"post",url:this._makeUrl(),data:e,dataType:"json",context:this,cache:!1,contentType:!1,processData:!1,success:this._onSuccess.bind(this),error:this.showUploadError.bind(this)}),this},_onSuccess:function(t){var e=this._retrieveUrlParams(t);e?(this._hitCounter(),this._loadCbirPage(e)):this.showUploadError()},_retrieveUrlParams:function(t){return _.get(t,"blocks.0.params.url")},_hitCounter:function(){BEM.blocks["b-statcounter"].hit({params:{query:{cbir:"file"}}})},uploadFileFrame:function(t){var e=_.extend({from:"cbirFrame",request:JSON.stringify([{block:this.linkBlockName}])},this.queryArgs);return this.fade(),this.showLoader(),BEM.create("i-request_type_ajax",{url:this._makeUrl(),type:"iframe",dataType:"html",file:t.target,cache:!1,paramsToSettings:["file","cache"],data:e,callbackCtx:this}).get({},function(){this._frameSuccess(arguments[2])},function(){this._frameError()}),this},_frameSuccess:function(t){var e;try{e=$(t.statusText).text()}catch(i){}e?(BEM.blocks["b-statcounter"].hit({params:{query:{cbir:"file"}}}),this._loadCbirPage(e)):this.showUploadError()},_frameError:function(){this.showUploadError()},uploadURL:function(t){var e=this;-1===t.indexOf("://")&&(t=location.protocol+"//"+t),this.fade().checkImageAccessibility(t).done(function(t){e.setRequestStatus(!0).showLoader().setCachedUrl(t),BEM.blocks["b-statcounter"].hit({params:{query:{cbir:"url"}}}),BEM.blocks.location.getInstance().change({block:"b-page_type_search-by-image",url:BEM.blocks.uri.buildRelativeUrl(BEM.blocks["i-global"].param("router").search,_.assign({img_url:t},e.queryArgs))})}).fail(function(){e.showError("url").unfade()})},checkImageAccessibility:function(t){var e,i=$.Deferred(),n=!1,s=new Image;return s.onload=function(){n||(clearTimeout(e),n=!0,i.resolve(t))},s.onerror=function(){n=!0,clearTimeout(e),i.reject()},e=setTimeout(s.onerror,3e5),s.src=t,s.complete&&s.onload(),i.promise()},tryUploadURL:function(t){if(t)if(this.validateURL(t)){if(this.checkCachedUrl(t))return;this.uploadURL(t)}else this.showError("url")},tryUploadFile:function(t){this.validateFile(t)?this.uploadFileNormal(t):this.clearFileInput()}}),BEM.decl("i-cbir-controller",{bindEvents:function(){return this.__base.apply(this,arguments),this.search.on("search:submit",this._onSearchSubmit,this),this},unbindEvents:function(){return this.__base.apply(this,arguments),this.search.un("search:submit",this._onSearchSubmit,this),this},_onSearchSubmit:function(t,e){this.processSubmitEvent(e)},processSubmitEvent:function(t){this.submit()!==!1&&(this.search.submit(t),this.search.countSubmit())},submit:function(){if(this.isCBIRRequest()||this.isExcessSearch()){var t=this.getURL();return""===t||this.tryUploadURL(t),!1}return!0},isCBIRRequest:function(){return this.getRequestStatus()},getURL:function(){return this.getRequestStatus()?this.cbirPanel.val():this.search.val()},isExcessSearch:function(){return""===this.getURL()&&"b-page_type_search-by-image"===this._location.getState().block}}),BEM.decl("i-cbir-controller",{fade:function(){return this.trigger("fade"),this},unfade:function(){return this.trigger("unfade"),this}}),BEM.DOM.decl("i-cbir-controller",{bindEvents:function(){return this.cbirPanel.on("filechange",this._onFileChange,this),this.__base.apply(this,arguments)},unbindEvents:function(){return this.cbirPanel.un("filechange",this._onFileChange,this),this.__base.apply(this,arguments)},_onFileChange:function(t,e){var i=this.getFile(e);-1!==i&&(i?this.tryUploadFile(i):this.uploadFileFrame(e))},getFile:function(t){var e,i,n;if(t){if(t.target&&(i=t.target.files),t.dataTransfer&&(n=t.dataTransfer.files),i)return i.length?i[0]:-1;if(n)return n[0]}else if(e=this.cbirPanel.fileInput,e&&(i=e.get(0).files),i)return i[0]},clearFileInput:function(){return this.cbirPanel.clearFileInput(),this}}),BEM.DOM.decl("i-cbir-controller",{_loadCbirPage:function(t){var e=this._buildFullUrl(t);this.clearFileInput().hideLoader(),this._isRepeatedRequest(e)?this.unfade().hidePanel():(this.setCachedUrl(""),this._location.change({block:"b-page_type_search-by-image",url:e}))},_buildFullUrl:function(t){var e=BEM.blocks["i-global"].param("router").search,i=e+"?"+t;return BEM.blocks.uri.setParams(i,{rpt:"imageview",from:""})},_isRepeatedRequest:function(t){var e=BEM.blocks.uri.getParamValue(t,"cbir_id"),i=BEM.blocks.uri.getParamValue("cbir_id");return e===i},showUploadError:function(){this.hideLoader().showError("upload").unfade()}}),BEM.decl("downscale",{resize:function(t,e,i){var n=window.URL?window.URL:window.webkitURL,s=n.createObjectURL(t);return this._loadImage(s).then(this._getOrientation.bind(this,t)).then(this._putImageOnCanvas.bind(this)).then(this._resizeImage.bind(this,e,i)).always(n.revokeObjectURL.bind(this,s))},canvasToBlob:function(t,e,i){var n=$.Deferred();try{i.toBlob(n.resolve,t,e)}catch(s){n.reject(s)}return n.promise()},shouldEnable:function(){var t=window.URL||window.webkitURL;return t?t.createObjectURL:!1},_getOrientation:function(t,e){var i,n=$.Deferred(),s=new FileReader;return s.onload=function(t){if(i=new DataView(t.target.result),65496!==i.getUint16(0,!1))return n.resolve(e,-2);for(var s,o,r,a=i.byteLength,c=2;a>c;)if(s=i.getUint16(c,!1),c+=2,65505===s){o=18761===i.getUint16(c+=8,!1),c+=i.getUint32(c+4,o),r=i.getUint16(c,o),c+=2;for(var h=0;r>h;h++)if(274===i.getUint16(c+12*h,o)){n.resolve(e,i.getUint16(c+12*h+8,o));break}}else{if(65280!==(65280&s))break;c+=i.getUint16(c,!1)}return n.resolve(e,-1)},s.error=n.reject,s.readAsArrayBuffer(t.slice(0,65536)),n.promise()},_putImageOnCanvas:function(t,e){var i=this._getSizeByOrientation(t,e),n=this._getMaxSize(i),s=i.transform,o=document.createElement("canvas"),r=o.getContext("2d");return o.width=n.width,o.height=n.height,"left"===s?(r.setTransform(0,-1,1,0,0,n.height),r.drawImage(t,0,0,n.height,n.width)):"right"===s?(r.setTransform(0,1,-1,0,n.width,0),r.drawImage(t,0,0,n.height,n.width)):"flip"===s?(r.setTransform(-1,0,0,-1,n.width,n.height),r.drawImage(t,0,0,n.width,n.height)):(r.setTransform(1,0,0,1,0,0),r.drawImage(t,0,0,n.width,n.height)),o},_getMaxSize:function(t){var e=5e6,i=4096,n=Math.sqrt(e*(t.width/t.height)),s=Math.floor(n),o=Math.floor(e/n),r=t.width/t.height,a=t.width,c=t.height;return s>i&&(a=i,c=Math.round(a/r)),o>i&&(c=i,a=Math.round(r*o)),t.width<s&&(a=t.width,c=t.height),{width:a,height:c}},_getSizeByOrientation:function(t,e){var i,n,s="none";return 8===e?(i=t.height,n=t.width,s="left"):6===e?(i=t.height,n=t.width,s="right"):3===e?(i=t.width,n=t.height,s="flip"):1===e?(i=t.width,n=t.height):(i=t.width,n=t.height),{width:i,height:n,transform:s}},_resizeImage:function(t,e,i){var n=i.width/i.height,s=$.Deferred();return t>e?e=Math.round(t/n):t=Math.round(e*n),this.shouldResizeImage(i,t,e)?(this._initResize(i.width,t,e),this._stepResize(i,t,e,s.resolve.bind(s)),s.promise()):s.resolve(i)},shouldResizeImage:function(t,e,i){return t.width>e&&t.height>i},_initResize:function(t,e,i){this._steps=Math.ceil(Math.log(t/e)/Math.LN2),this._currentWidth=e*Math.pow(2,this._steps-1),this._currentHeight=i*Math.pow(2,this._steps-1)},_stepResize:function(t,e,i,n){return this._steps&&this.shouldResizeImage(t,e,i)?void this.afterCurrentEvent(this._stepResizeDelay.bind(this,t,e,i,n)):void n(t)},_stepResizeDelay:function(t,e,i,n){var s=document.createElement("canvas");s.width=this._currentWidth,s.height=this._currentHeight,s.getContext("2d").drawImage(t,0,0,this._currentWidth,this._currentHeight),t.width=1,t.height=1,t=s,this._currentWidth=Math.round(this._currentWidth/2),this._currentHeight=Math.round(this._currentHeight/2),--this._steps,this._stepResize(t,e,i,n)},_loadImage:function(t){var e=$.Deferred(),i=new Image;return i.onload=e.resolve.bind(this,i),i.onerror=e.reject.bind(this,i),i.src=t,e.promise()}}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,i){for(var n=atob(this.toDataURL(e,i).split(",")[1]),s=n.length,o=new Uint8Array(s),r=0;s>r;r++)o[r]=n.charCodeAt(r);t(new Blob([o],{type:e||"image/jpeg"}))}}),BEM.DOM.decl("cbir-error",{onSetMod:{js:function(){this.setTexts().findBlocks().bindEvents(),this.params.searchError&&(this.afterCurrentEvent(this.showSearchError),BEM.blocks.location.getInstance().change({url:BEM.blocks.uri.delParams(["cbirerror"]),history:!1,trigger:!1}))}},findBlocks:function(){return this.popupUser=this.findBlockOn(this.elem("popup","type","user"),"popup"),this.popupSearch=this.findBlockOn(this.elem("popup","type","search"),"popup"),this.popupSearch&&(this.closeSearchErrorButton=this.findBlockOn(this.elem("close-error-button"),"button")),this},bindEvents:function(){this.popupUser.on("hide",this._onUserPopupHide,this),this.popupSearch&&(this.popupSearch.on("hide",this._onSearchPopupHide,this),this.closeSearchErrorButton.on("click",this._onCloseErrorClick,this))},destruct:function(){this.popupUser.un("hide",this._onUserPopupHide,this).destruct(),this.popupSearch&&(this.closeSearchErrorButton.un("click",this._onCloseErrorClick,this),this.popupSearch.un("hide",this._onSearchPopupHide,this).destruct()),this.__base.apply(this,arguments)},setTexts:function(){return this.errorTexts={size:BEM.I18N("cbir-error_spok_yes","Слишком большой файл, попробуйте загрузить другую картинку."),format:BEM.I18N("cbir-error_spok_yes","Неправильный формат загружаемого файла. Попробуйте загрузить файл изображения."),upload:BEM.I18N("cbir-error_spok_yes","Картинка не загрузилась, попробуйте загрузить другую."),url:BEM.I18N("cbir-error_spok_yes","По указанному адресу не смогли найти картинку, попробуйте ввести другой адрес.")},this},_onCloseErrorClick:function(){this.popupSearch.hide()},_onUserPopupHide:function(){this.delMod(this.elem("input"),"error"),this.hidePopupTimeout&&(clearTimeout(this.hidePopupTimeout),this.hidePopupTimeout=null)},_onSearchPopupHide:function(){this.trigger("hideParanja")},hideError:function(){return this.popupUser.hide(),this.popupSearch&&this.popupSearch.hide(),this._lastErrorTager&&(this._lastErrorTager.unsetThreateningLook(),this._lastErrorTager=null),this},showSearchError:function(){return this.popupSearch.show(),this.trigger("showParanja"),this},showError:function(t,e){var i=this.errorTexts[t],n=this;return i?(this.popupUser.elem("error-text").text(i),"url"===t&&e.setThreateningLook&&(this._lastErrorTager=e,e.setThreateningLook()),this.popupUser.show(e.getErrorTargetDomElem(t)),this.hidePopupTimeout=setTimeout(function(){n.hidePopupTimeout=null,n.hideError()},5e3),this):this}}),BEM.DOM.decl("tooltip-owner",{onSetMod:{js:function(){this.findBlocks().bindEvents()}},findBlocks:function(){return this.tooltip=this.findBlockInside("tooltip"),this},bindEvents:function(){return this.bindTo("mouseleave",this._onMouseOut),this},_onMouseOver:function(){this.tooltip.setOwner(this.domElem).show()},_onMouseOut:function(){this.tooltip.hide()},_onClick:function(){this.tooltip.hide()},setContent:function(t){this.tooltip.setContent(t)}},{live:function(){this.liveInitOnEvent("mousemove"),this.liveBindTo("pointerclick",function(t){this._onClick(t)}),this.liveBindTo("pointerover",function(t){BEM.blocks["i-global"].param("mobile")||this._onMouseOver(t)})}}),BEM.DOM.decl("disk-logo",{bounce:function(){return this._bounceTimer=setTimeout(function(){this.offColoredIcon().offBounce()}.bind(this),5500),this.toggleColoredIcon().toggleBounce()},toggleColoredIcon:function(){return this.toggleMod(this._getColorIcon(),"visibility","","hidden")},toggleBounce:function(){return this.toggleMod(this._getColorIcon(),"action","bounce","")},offBounce:function(){return this.delMod(this._getColorIcon(),"action")},offColoredIcon:function(){return this.setMod(this._getColorIcon(),"visibility","hidden")},showPopup:function(t){return this._getPopup().show(t||this.domElem),this},_onClick:function(){this.trigger("click"),c.hit({dtype:"stred",pid:40,cid:72947,path:"disk.logo"})},_onAnimationEnd:function(){clearTimeout(this._bounceTimer),this.toggleColoredIcon().toggleBounce()},_getPopup:function(){return this._tooltip||(this._tooltip=this.findBlockInside("popup"))},_getColorIcon:function(){return this._colorIcon||(this._colorIcon=this.elem("icon","theme","color"))}},{live:function(){this.liveBindTo("button","pointerclick",function(t){this._onClick(t)}).liveBindTo("icon","animationend webkitAnimationEnd oAnimationEnd",function(t){this._onAnimationEnd(t)})}}),BEM.decl("counter",{_dict:{}}),function(){var t={all:"136",any:"146",big:"148",bing:"568",black:"201",blue:"198",bottom:"668",bw:"666",cbir:"1031",ces:"1057",clear:"477",click:"882",clipart:"758",close:"486",color:"169",commercial:"2043",copyright:"1305",customize:"178",cyan:"197",demotivator:"760",duplicates:"269",face:"276",facebook:"520",fade:"1059",filters:"618",format:"675",fotki:"174",fresh:"598",fullscreen:"665",gif:"677",google:"66",gray:"733",green:"196",horizontal:"672",image:"8",images:"277",imgclick:"835",index:"629",iorient:"671",isize:"145",jpg:"676",keyboard:"492",large:"157",lineart:"759",list:"436",medium:"149",message:"1304",moderate:"681",more:"75",mouse:"491",navig:"208","new":"228",next:"407",normal:"141",nps:"1056",odnoklassniki:"526",off:"11",on:"10",open:"842",orange:"194",othersize:"924",p0:"85",p1:"86",p10:"95",p11:"96",p12:"97",p13:"98",p14:"99",p15:"100",p16:"101",p17:"102",p18:"103",p19:"104",p2:"87",p20:"105",p3:"88",p4:"89",p5:"90",p6:"91",p7:"92",p8:"93",p9:"94",page:"143",photo:"275",picsearch:"173",pinterest:"1009",play:"331",png:"679",prev:"406",preview:"670",promo:"714",red:"193",related_query:"391",result:"884",results:"241",save:"691",scroll:"768",search:"153","search-by-image":"1277",serp:"471",share:"599",show:"487",similar:"469",site:"202",slideshow:"479",small:"150",soo:"65",square:"674",stop:"529",thumb:"184",top:"77",twitter:"521",type:"76",url:"13",user:"538",vertical:"673",violet:"199",visiblefresh:"639",vkontakte:"496",wallpaper:"158",wallpaper_category:"1129",week:"796",white:"200",yellow:"195",video:"231",maps:"23",market:"4",music:"56",loaded:"1007",ads:"991",categories:"1429",px500:"1224",submit:"297",width:"1473",height:"1474",time:"207",hover:"858",abuse:"1436",sticky:"1578",pad:"1667",footer:"295",default_search:"1620",popup_close:"1781",error:"1030",install:"705",inline_home_set:"1918",incut:"1073",behavioral:"1999",context:"60",item:"22",title:"82",link:"513",button:"440",direct:"155",browser_yandex:"935",disk:"1032",radio:"1079",mobile:"1006",mobile_browsers_ipad:"1013",mobile_browsers_android:"1014",wp:"895",element:"1518",set:"1920",inline_set:"1651",home:"1319",inline_home:"1870",vb:"1921",inline_vb:"1652",middle:"2028"};"undefined"!=typeof BEM&&BEM.decl("counter",{_dict:t}),"undefined"!=typeof exports&&(exports.dict=t)}(),BEM.decl("counter",{HIT_DELAY:200,onSetMod:{js:function(){window.Ya=window.Ya||{},window.Ya.counter=this,window.c=this,window.w=this.w,window.cp=this.cp,window.rc=this.redir}},_getExtParams:$.noop,redir:function(t,e){var i=t.href;e=e.replace(/=8(?=&|$)/,"=0"),t.href=e,setTimeout(function(){t.href=i},500)},w:function(t,e,i){var n=window.Ya.counter;e&&n.hit({path:e,vars:n._getVars(i),dtype:"iweb"},t)},wHitDelayed:function(t,e,i){setTimeout(function(){c.w(t,e,i)},this.HIT_DELAY)},cp:function(t,e){t.path&&(t.dtype="stred",window.Ya.counter.hit(t,e))},cpHitDelayed:function(t,e){setTimeout(function(){c.cp(t,e)},this.HIT_DELAY)},hit:function(t,e){var i=e&&(e.onclick||e.ondblclick),n=this._getExtParams();i&&$.extend(t,i().counter__params),n&&$.extend(t,n),t.path&&(t.path=this.getPath(t.path),this.log(t,e),this.makeReq(this.getUrl(t,e)))},hitDelayed:function(t,e){setTimeout(function(){c.hit(t,e)},this.HIT_DELAY)},log:function(t,e){BEM.blocks.counter.debug("counter",{pid:t.pid,cid:t.cid,path:t.path,decoded:this.getHumanText(t.path),vars:t.vars&&t.vars,href:e&&e.href})},makeReq:function(t){$.ajax({url:location.protocol+t,cache:!0,dataType:"script"})},getUrl:function(t,e){var i=$.extend({rnd:BEM.blocks.utils.getRnd(2),yuid:this.getUid(),reqid:this.getReqId(e),serpid:t.serpid||this.getSerpId()},t),n=this.stringifyParams(i,"/");return["//",this.getClickHost(),"/jclck/",n,"/*",this._getAsterixData(e)].join("")},_getVars:function(t){return"object"==typeof t?this.stringifyParams(t,","):t},getReqId:function(t){var e,i,n=BEM.blocks["i-global"],s=n.param("reqid")||n.param("serpid")||"";return t?(e=$(t).closest(".counter__reqid"),i=e.length?BEM.DOM.extractParams(e[0]).counter__reqid:{},i.reqid||s):s},getSerpId:function(){return BEM.blocks["i-global"].param("serpid")},getUid:function(){return BEM.blocks["i-global"].param("yandexuid")},getClickHost:function(){return BEM.blocks["i-global"].param("click-host")},_getAsterixData:function(t){return t&&t.href?t.href:location.href},stringifyParams:function(t,e){var i,n=[];return Object.keys(t).forEach(function(e){i=t[e],"undefined"!=typeof i&&""!==i&&n.push(e+"="+i)}),n.join(e||"&")},getPath:function(t){var e="/"===t[0];return e&&this._dict&&this._decodePath(t)||t},_decodePath:function(t){var e=t.split("/").slice(1),i=this._dict;return i&&e.length&&e.map(function(t){return i[t]||t}).join(".")},decodeBlockstatKey:function(t){return _.findKey(this._dict,function(e){return e===t})||t},getHumanText:function(t){return"/"+t.split(".").map(this.decodeBlockstatKey.bind(this)).join("/")}},{debug:function(t,e){BEM.blocks["i-global"].param("counterDebug")&&(e=e||"","undefined"!=typeof console&&"function"==typeof console.info&&(console.group("Счётчик "+t),e.pid?console.info("pid:	"+e.pid+",	cid:	"+e.cid+"\npath:	"+e.path+",	decoded:	"+e.decoded+"\nvars:	"+e.vars+", 	href:	"+e.href):console.info("params: ",e),console.groupEnd("Счётчик "+t)),window.mm||(window.mm={}),window.mm.counters||(window.mm.counters=[]),window.mm.counters.push({name:t,params:e}))}}),BEM.create("counter"),BEM.decl("counter",{_getExtParams:function(){var t=BEM.blocks["i-global"],e=t.param("page"),i=t.param("isYandexApp"),n="yandex",s="images.yandex";switch(e){case"index":n="portal."+n;break;case"search":n="images."+n;break;case"search-by-image":case"similar":n="cbir."+n}return i?("search-by-image"===e&&(n="rich.sugget.yandex"),s="webmobileapp.yandex"):t.param("tablet")?s+="/pad":t.param("mobile")&&(s+="/touch"),{service:n,ui:encodeURIComponent(s),cts:Number(new Date)}}}),BEM.DOM.decl("footer",{hide:function(){this.setMod("hidden","yes"),this.trigger("hide")},transparent:function(){this.setMod("hidden","yes"),this.trigger("transparent")},show:function(){this.delMod("hidden"),this.trigger("show")}}),BEM.DOM.decl("footer",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].on("change",this._onPageChange,this)}},destruct:function(){BEM.blocks["b-page"].un("change",this._onPageChange,this),this.__base.apply(this,arguments)},_onPageChange:function(){BEM.blocks["i-global"].param("mobile")&&!BEM.blocks["i-global"].param("tablet")&&this.updateMobileLink()},updateMobileLink:function(){var t=this.elem("link","mobile","yes"),e=t.attr("href"),i=BEM.blocks.uri.getParamValue(e,"retpath"),n=BEM.blocks.uri.getParamValue("text"),s=BEM.blocks.uri.parse(i),o=_.isEmpty(n)?s.getRoot():s.getRoot()+"/search?text="+encodeURIComponent(n);t.attr("href",BEM.blocks.uri.setParam(e,"retpath",o))}}),BEM.DOM.decl("footer",{_onPageChange:function(t,e){this.__base.apply(this,arguments);var i=this.params.links;this.elem("link","type","help").attr({href:"index"===e.type?i["help-index"]:i.help})}}),BEM.DOM.decl("footer",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.distro=this.findBlockInside("distro"),this.hasMod("distro","yes")&&(this.distroCounterOnScroll(),this._onScroll())}},distroCounterOnScroll:function(){BEM.blocks["b-page"].on("scroll",this._onScroll,this)},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["b-page"].un("scroll",this._onScroll,this)},showDistro:function(){this.setMod("distro","yes"),this.distro.show(),this.trigger("distro","show")},hideDistro:function(){this.delMod("distro"),this.distro.hide()},_onPageChange:function(){this.__base.apply(this,arguments),this.distro&&"ru"===BEM.blocks["i-global"].param("tld")&&(this.distroCounterOnScroll(),this._onScroll())},_onScroll:function(){var t=BEM.DOM.win,e=this.distro.domElem;!this.hasMod("hidden")&&t.scrollTop()+t.height()>=e.offset().top+e.height()&&(this.showDistro(),BEM.blocks["b-page"].un("scroll",this._onScroll,this))}}),BEM.DOM.decl("lang-switcher",{onSetMod:{js:{inited:function(){this.params["secret-key"]&&this.bindTo("lang","pointerdown keydown",this._preprocessOpenLink)}}},_preprocessOpenLink:function(t){var e=$(t.currentTarget),i=this.elemParams(e);this.hasMod(e,"selected","yes")||i.url||e.attr("href",this._getUrl(this._getLang(i)))},_getLang:function(t){var e=t.lang;return"gb"===e?"en":e},_getUrl:function(t){return this.params.tune+"/api/lang/v1.1/save.xml?"+$.param({intl:t,sk:this.params["secret-key"],retpath:this.params.retpath||BEM.blocks["i-global"].param("retpath")||window.location.href})}},{live:function(){this.liveInitOnBlockEvent("init","dropdown-menu")}}),BEM.DOM.decl("lang-switcher",{onSetMod:{js:function(){var t=this.findBlockOn("dropdown-menu")._popup.domElem;this.langs=this.findElem(t,"lang")}}},{live:function(){this.liveBindTo("click",function(){this.langs.each(function(){var t=$(this).attr("href"),e=BEM.blocks.uri;t&&$(this).attr("href",e.setParam(t,"retpath",e.clearHashSymbol(location.href)))})})}}),BEM.DOM.decl({block:"link",modName:"pseudo",modVal:"yes"},{_onClick:function(t){t.preventDefault(),this.hasMod("disabled")||this.afterCurrentEvent(function(){this.trigger("click")})},_onKeydown:function(t){t.shiftKey||t.altKey||BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&t.preventDefault(),this.setMod("pressed","yes"))},_onKeyup:function(t){t.shiftKey||t.altKey||BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&this.afterCurrentEvent(function(){this.trigger("click")}),this.delMod("pressed"))}},{live:function(){return this.liveBindTo({modName:"pseudo",modVal:"yes"},"pointerclick",function(t){this._onClick(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"click",function(t){t.preventDefault()}),this.__base()}}),BEM.DOM.decl("b-statcounter",{onSetMod:{js:function(){this.findElem("metrika").length<1||(this.location=BEM.blocks.location.getInstance().on("change",this._onChange,this),this.__self.on("hit",this.hitMetrika,this),this.__self.on("goal",this.reachGoal,this),this.trigger("hitAndGoalInited"),this.__base.apply(this,arguments))}},destruct:function(){this.__base.apply(this,arguments),this.location.un("change",this._onChange,this),this.__self.un("hit",this.hitMetrika,this),this.__self.un("goal",this.reachGoal,this)},_onChange:function(){this.hitMetrika()},hitMetrika:function(t,e){e||(e={});var i=this.getMetrika();i&&i.hit(e.url||window.location.href,e.title,e.referer,e.params),BEM.blocks.counter.debug("metrika hit",JSON.stringify(e.params))},reachGoal:function(t,e){e||(e={});var i=this.getMetrika();i&&i.reachGoal(e.goal,e.params),BEM.blocks.counter.debug("metrika reachGoal",JSON.stringify(e))},getMetrika:function(){return this._mc||(this._mc=window["yaCounter"+this.elemParams("metrika").id])}},{hit:function(t){this.trigger("hit",t)},goal:function(t){this.trigger("goal",t)}}),BEM.DOM.decl("b-statcounter",{_onChange:$.noop}),function(t){t.decl("b-statcounter__metrika",{onSetMod:{js:{inited:function(){this.__self.loadMetrika(),this.addCounter(this.params)}}},addCounter:function(t){var e=window.Ya&&Ya.Metrika,i=window.yandex_metrika_callbacks||(window.yandex_metrika_callbacks=[]),n=function(){window["yaCounter"+t.id]=new Ya.Metrika(t)};if(!t.id)throw new Error([BEM.I18N("b-statcounter__metrika","JSERR_incorrectID"),"block: "+this.__self.getName(),"method: addCounter"].join("\n"));e?n():i.push(n)},getDefaultParams:function(){return{enableAll:!0}}},{loadMetrika:function(){var t=window.Ya&&Ya.Metrika,e="https:"===document.location.protocol?"https:":"http:",i="//mc.yandex.ru/metrika/watch.js";!t&&$.getScript(e+i),this.loadMetrika=function(){}}})}(BEM.DOM),BEM.DOM.decl("b-statcounter__metrika",{addCounter:function(t){this.params.includeFrom&&this.__self.updateFromParam(t),this.__base.apply(this,arguments)},hit:function(t){var e=window.Ya&&Ya.Metrika,i=window.yandex_metrika_callbacks||(window.yandex_metrika_callbacks=[]),n=function(){window["yaCounter"+this.params.id].hit(t.url||window.location.href,t)}.bind(this);e?n():i.push(n),BEM.blocks.counter.debug("metrika hit",JSON.stringify(t))}},{updateFromParam:function(t){var e=$.cookie("mfrom");return t.params||(t.params={}),e?t.params.from=e:this._setCookie(t.params.from||"organic"),this},_setCookie:function(t){return $.cookie("mfrom",t,{expires:3650,path:BEM.blocks["i-global"].param("router").index}),this}}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.internal.on("showRelevance",this._onShowRelevance,this).on("hideRelevance",this._onHideRelevance,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.blocks.internal.un("showRelevance",this._onShowRelevance,this).un("hideRelevance",this._onHideRelevance,this)},_onShowRelevance:function(){this.setMod("relevance","yes")},_onHideRelevance:function(){this.setMod("relevance","no")}}),BEM.DOM.decl("page-layout",{_trigger:!0,onSetMod:{page:{search:function(){var t=this.findBlockInside(this.elem("column","type","navigation"),"navigation");t&&t.reflow()}},layout:function(t,e){this._trigger&&this.trigger(t,e),this._trigger=!0}},disableTrigger:function(){return this._trigger=!1,this}}),BEM.DOM.decl("page-layout",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["i-global"].param("tablet")&&this.adjustMinHeight()}},changeHeight:function(t){return this.elem("content-wrapper").css("min-height","+="+t),this},getHeight:function(){return this.elem("content-wrapper").height()},setHeight:function(t){return this.elem("content-wrapper").css("min-height",t),this},setDefaultHeight:function(){return this.elem("content-wrapper").css("min-height",""),this},adjustMinHeight:function(){this.domElem.css("min-height",this.elem("column","type","navigation").outerHeight())}}),BEM.DOM.decl("page-layout",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.footer.on("distro",this._onDistroShow,this)}},destruct:function(){BEM.blocks.footer.un("distro",this._onDistroShow,this),this.__base.apply(this,arguments)},_onDistroShow:function(){this.setMod("distro-footer","yes")}}),BEM.DOM.decl("page-layout",{toggleCBIRMode:function(t){return this.toggleMod("cbir","visible","",t)},togglePointerEvents:function(t){return this.toggleMod("pointer","","none",t)}}),BEM.DOM.decl("pane2",{getDefaultParams:function(){var t=this.__base.apply(this,arguments)||{};return t.ANIMATION_DURATION=300,t},onSetMod:{js:function(){this.setMod("flexbox",BEM.blocks["i-ua"].hasFlexbox()?"yes":"no"),this.setMod(this.elem("column","type","info"),"flexbox",BEM.blocks["i-ua"].hasFlexbox()?"yes":"no"),this.findBlocks().bindEvents()}},onElemSetMod:{column:{hidden:function(t,e,i){this.hasMod(t,"type","info")&&this.afterCurrentEvent(function(){this.trigger("info:"+("yes"===i?"closed":"opened"))})}}},findBlocks:function(){return this},bindEvents:function(){return this},unbindEvents:function(){return this},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},isOrientationChanged:function(){return this._isVerticalOrientation!=window.innerHeight>window.innerWidth?(this._isVerticalOrientation=!this._isVerticalOrientation,!0):!1},_onKeyboardClose:function(){this.close("mouse")},_onMouseClose:function(){this.close("mouse")},open:function(){return this.isMobile()&&(this._isVerticalOrientation=window.innerHeight>window.innerWidth)?this.hideInfoPanel():this.showInfoPanel(),this.setMod("visibility","visible"),this.domElem.animateRaf([{property:"opacity",from:0,to:1,duration:this.params.ANIMATION_DURATION,timing:"ease"}],function(){this.trigger("open")}.bind(this)),this.hasMod("mobile","yes")&&window.scrollBy(0,1),this},isOpened:function(){return this.hasMod("visibility","visible")},update:function(){return this.getPreview().hideError().load(),BEM.blocks["pane2-api"].frameQueue.add(function(){this._updateSnippet()},this),this},_updateSnippet:function(){return this._getSnippet().update(BEM.blocks["pane2-api"].getItemParams()),this},_getSnippet:function(){return this._snippet||(this._snippet=this.findBlockInside("snippet2"))},close:function(t){return this.domElem.animateRaf([{property:"opacity",from:1,to:0,duration:this.params.ANIMATION_DURATION,timing:"ease"}],function(){this.delMod("visibility"),this.trigger("close",t)}.bind(this)),this},toggleInfoPanel:function(){this.toggleMod(this.elem("column","type","info"),"hidden","yes","")},showInfoPanel:function(){this.delMod(this.elem("column","type","info"),"hidden")},hideInfoPanel:function(){this.setMod(this.elem("column","type","info"),"hidden","yes")},isInfoPanelOpened:function(){return!this.hasMod(this.elem("column","type","info"),"hidden","yes")},isMobile:function(){return this.hasMod("mobile","yes")},getPreview:function(){return this.preview||(this.preview=this.findBlockOn("preview","preview2"))}},{live:function(){this.liveBindTo("close","keypress",function(t){13===t.keyCode&&this._onKeyboardClose(t)}),this.liveBindTo("close","pointerclick",function(t){this._onMouseClose(t)}),this.liveBindTo("pointerclick",function(t){$(t.target).is(this.domElem)&&this._onMouseClose(t)})}}),BEM.DOM.decl("pane2",{getDefaultParams:function(){var t=this.__base.apply(this,arguments)||{};return t.MOUSE_MOVING_TIMEOUT_DELAY=2e3,t.playTimeoutDelay=4e3,t},onSetMod:{js:function(){this.__base.apply(this,arguments),this.playback=this.playback.bind(this)},fullscreen:{yes:function(){this._onThrottledMouseMove=$.throttle(this._onMouseMove,100,this),this.bindTo("mousemove",this._onThrottledMouseMove),this.bindTo("pointerclick",this._onPageClick)},no:function(){this.unbindFrom("mousemove"),this.unbindFrom("click")}}},bindEvents:function(){return BEM.blocks.preview2.on("fullscreen:enter",this._onEnterFullscreen,this),this.on("fullscreen:exit",this._onExitFullscreen,this),screenfull.enabled&&(this.bindToDoc(screenfull.raw.fullscreenchange,this._onFullscreenChange),this.bindToDoc(screenfull.raw.fullscreenerror,this._onFullscreenError),BEM.blocks["slideshow-switcher"].on("start",this._onSlideshowStart,this),BEM.blocks["slideshow-switcher"].on("stop",this._onSlideshowStop,this)),this},unbindEvents:function(){return BEM.blocks.preview2.un("fullscreen:enter",this._onEnterFullscreen,this),this.un("fullscreen:exit",this._onExitFullscreen,this),screenfull.enabled&&(BEM.blocks["slideshow-switcher"].un("start",this._onSlideshowStart,this),BEM.blocks["slideshow-switcher"].un("stop",this._onSlideshowStop,this)),this},_onSlideshowStart:function(){this.playTimeout=setTimeout(this.playback,this.params.playTimeoutDelay)},_onSlideshowStop:function(){clearTimeout(this.playTimeout)},_onFullscreenChange:function(){screenfull.isFullscreen===!1&&window.inNextFrame(function(){this.trigger("fullscreen:exit")}.bind(this))},_onFullscreenError:function(){window.inNextFrame(function(){this.trigger("fullscreen:exit")}.bind(this))},_onMouseMove:function(){this.updateControls()},_onPageClick:function(){this.updateControls()},playback:function(){this.trigger("slideshow:next"),this.playTimeout=setTimeout(this.playback,this.params.playTimeoutDelay)},updateControls:function(){return this.setMod("mouse-moving","yes"),clearTimeout(this.mouseMovingTimeout),this.mouseMovingTimeout=setTimeout(function(){this.delMod("mouse-moving")}.bind(this),this.params.MOUSE_MOVING_TIMEOUT_DELAY),this},_onEnterFullscreen:function(){return this.setMod(this.elem("close"),"color","white"),this.setMod("fullscreen","yes"),this.trigger("fullscreen:enter"),this
},_onExitFullscreen:function(){return this.getPreview().exitFullscreen(),this.setMod(this.elem("close"),"color",this.params.originCloseColor),this.setMod("fullscreen","no"),this},close:function(){return this.hasMod("fullscreen","yes")?this.trigger("fullscreen:exit"):this.__base.apply(this,arguments),this}}),BEM.DOM.decl("pane2",{bindEvents:function(){return this._getShare()&&this._getShareMenu().on("show",this._updateShare,this),BEM.blocks.complain.on(this.elem("complain-button"),"click",this._onComplainClick,this),BEM.blocks["pane2-api"].on("fullscreen:enter",this._onFullscreenEnter,this),BEM.blocks["pane2-api"].on("fullscreen:exit",this._onFullscreenExit,this),this.__base.apply(this,arguments)},unbindEvents:function(){return this._getShare()&&this._getShareMenu().un("show",this._updateShare,this),BEM.blocks.complain.un(this.elem("complain-button"),"click",this._onComplainClick,this),BEM.blocks["pane2-api"].un("fullscreen:enter",this._onFullscreenEnter,this),BEM.blocks["pane2-api"].un("fullscreen:exit",this._onFullscreenExit,this),this.__base.apply(this,arguments)},findBlocks:function(){return this.__base.apply(this,arguments),this._getSearchByImage(),this},_onComplainClick:function(){BEM.blocks.feedback.showPopup(BEM.blocks["pane2-api"].getItem())},_onFullscreenEnter:function(){this.isFullscreen=!0},_onFullscreenExit:function(){this.isFullscreen=!1,this.update()},getRelated:function(){return this.elem("related")[0]&&this.elem("related")[0].outerHTML},_updateMarketState:function(){var t=BEM.blocks["pane2-api"].getItemParams(),e=this.isMarketState();return this.setMod("market",e?"yes":"no"),this._getSizes().setButtonTheme(e?"normal":"action"),e&&this._getMarketSnippet().update(t.marketSnippet),this},isMarketState:function(){return Boolean(BEM.blocks["pane2-api"].getItemParams().isMarketIncut)},_updateDiskState:function(){return this._getDisk().updateButton(),this},_updateShare:function(){var t=BEM.blocks["pane2-api"].getItemParams(),e=this._getPage().params.seo.shareTitle.replace(" - "," — "),i=$("<div>",{html:t.snippet.text}).text(),n=BEM.blocks.uri.setParam(BEM.blocks.location.getInstance().getState().url,"ts",String((new Date).getTime())),s=t.thumb.url,o=t.reqid;this._getShare().updateLink("pinterest",{title:e+(i?" – "+i:""),image:s,counterUrl:t.img_href,reqid:o}).updateLink("vkontakte",{description:i,title:e,url:n,image:s,counterUrl:t.img_href,reqid:o}).updateLink("odnoklassniki",{description:i,title:e,url:n,image:s,counterUrl:t.img_href,reqid:o}).updateLink("facebook",{description:i,title:e,url:n,image:s,counterUrl:t.img_href,reqid:o}).updateLink("twitter",{title:e+" #yandeximages",counterUrl:t.img_href,reqid:o})},update:function(){var t=BEM.blocks["pane2-api"].frameQueue;if(this.__base.apply(this,arguments),this.isFullscreen)return this;var e=this;return BEM.blocks["i-global"].getFlag("images_market_bages")&&t.add(function(){e._updateMarketState()}),this._getDisk()&&this.isInfoPanelOpened()&&t.add(function(){e._updateDiskState()}),this},updateRelated:function(t){return BEM.DOM.replace(this.findElem("related"),t.html),this},_getPage:function(){return this.page||(this.page=this.findBlockOutside("b-page"))},_getSizes:function(){return this.sizes||(this.sizes=this.findBlockInside("sizes"))},_getSearchByImage:function(){return this._searchByImage||(this._searchByImage=this.findBlockInside("search-by-image"))},_getShare:function(){return this._share||(this._share=this.findBlockInside("share-dropdown"))},_getShareMenu:function(){return this._shareMenu||(this._shareMenu=this._getShare().findBlockInside("dropdown-menu"))},_getDisk:function(){return this._disk||(this._disk=BEM.blocks["disk-controller"].get())},_getMarketSnippet:function(){return this._marketSnippet||(this._marketSnippet=this.findBlockInside("market-snippet"))}}),BEM.DOM.decl({block:"pane2",modName:"scroll-fridge",modVal:"yes"},{bindEvents:function(){return this.bindTo(this.elem("scroll-section"),BEM.blocks["pane2-api"]._getWheelEvent(),this._onFridgeScroll),BEM.blocks["i-ua"].hasFlexbox()||BEM.blocks.snippet2.on("updated",this._onSnippetUpdated,this),this.__base.apply(this,arguments)},unbindEvents:function(){return BEM.blocks["i-ua"].hasFlexbox()||BEM.blocks.snippet2.un("updated",this._onSnippetUpdated,this),this.__base.apply(this,arguments)},_onFridgeScroll:function(t){var e,i,n=t.originalEvent;t.preventDefault(),t.stopImmediatePropagation(),e=n.deltaY||n.detail,e&&(i=this.elem("scroll-section").scrollTop(),this.elem("scroll-section").scrollTop(i+e))},_onSnippetUpdated:function(t){window.inNextFrame(function(){var e=this.elem("column").height()-t.target.domElem.height()-this.elem("buttons").height()-30;this.elem("scroll-section").height(e)},this)}}),BEM.DOM.decl({block:"pane2",modName:"color-position",modVal:"yes"},{getDefaultParams:function(){var t=this.__base.apply(this,arguments)||{};return t.closeButtonColorInversion={white:"black","black-white":"white"},t},onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.originClosePos=this.getMod(this.elem("close"),"pos"),this.params.originCloseColor=this.getMod(this.elem("close"),"color"),this.params.isCloseButtonRight={"paranja-right":!0,"preview-right":!0}[this.params.originClosePos]}},onElemSetMod:{column:{hidden:function(t,e,i){this.__base.apply(this,arguments);var n,s,o=BEM.blocks["i-global"].getFlag("doge_preview_color")||"black-white";"yes"===i?(n=this.params.closeButtonColorInversion[o],s="default"):(n=this.params.originCloseColor,s=this.params.originClosePos),this.setMod(this.elem("close"),"color",n),this.params.isCloseButtonRight&&this.setMod(this.elem("close"),"pos",s)}}}}),BEM.DOM.decl("pane2-api",{isOpened:!1,_scrollStart:null,destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},bindEvents:function(){return BEM.blocks.gallery.on("click",this._onGalleryItemClicked,this),BEM.blocks.preview2.on("thumbClick",this._onThumbClick,this),BEM.blocks.preview2.on("rightClick",this._onRightClick,this),BEM.blocks.preview2.on("arrowClick",this._onArrowClick,this),BEM.blocks.preview2.on("loaded",this._onPreviewDupLoaded,this),BEM.blocks.preview2.on("notfound",this._onPreviewNotfound,this),BEM.blocks.preview2.on("timeout",this._onPreviewTimeout,this),BEM.blocks.preview2.on("error",this._onPreviewError,this),BEM.blocks.snippet2.on("title:click",this._onTitleClick,this),BEM.blocks.snippet2.on("link:click",this._onLinkClick,this),BEM.blocks["market-snippet"].on("market:button:click market:link:click market:title:click",this._onMarketSnippetClick,this),BEM.blocks.carousel.on("listOut",this._onListOut,this),BEM.blocks.pane2.on("open",this._onPaneOpen,this),BEM.blocks.pane2.on("close",this._onPaneClose,this),BEM.blocks.pane2.on("info:opened info:closed",this._onInfoToggle,this),this.bindToWin(this._getWheelEvent(),this._onMouseWheel),this.bindToWin("resize orientationchange",$.debounce(this._onResize,100,!0,this)),BEM.blocks["i-global"].param("tablet")&&this.bindToWin("touchmove",this._onTouchMove),BEM.blocks["i-keyrouter"].on("space left right up down",this._onKeyNavigation,this).on("esc backspace",this._closeByKeyboard,this).on("o v",this._onKeyPress,this),this},unbindEvents:function(){return BEM.blocks.gallery.un("click",this._onGalleryItemClicked,this),BEM.blocks.preview2.un("thumbClick",this._onThumbClick,this),BEM.blocks.preview2.un("rightClick",this._onRightClick,this),BEM.blocks.preview2.un("arrowClick",this._onArrowClick,this),BEM.blocks.preview2.un("loaded",this._onPreviewDupLoaded,this),BEM.blocks.preview2.on("notfound",this._onPreviewNotfound,this),BEM.blocks.preview2.on("timeout",this._onPreviewTimeout,this),BEM.blocks.preview2.un("error",this._onPreviewError,this),BEM.blocks.snippet2.un("title:click",this._onTitleClick,this),BEM.blocks.snippet2.un("link:click",this._onLinkClick,this),BEM.blocks["market-snippet"].un("market:button:click market:link:click market:title:click",this._onMarketSnippetClick,this),BEM.blocks.carousel.un("listOut",this._onListOut,this),BEM.blocks.pane2.un("open",this._onPaneOpen,this),BEM.blocks.pane2.un("close",this._onPaneClose,this),BEM.blocks.pane2.un("info:opened info:closed",this._onInfoToggle,this),this.unbindFromWin(this._getWheelEvent(),this._onMouseWheel),this.unbindFromWin("resize orientationchange",$.debounce(this._onResize,100,!0,this)),BEM.blocks["i-global"].param("tablet")&&this.unbindFromWin("touchmove",this._onTouchMove),BEM.blocks["i-keyrouter"].un("space left right up down",this._onKeyNavigation,this).un("esc backspace",this._closeByKeyboard,this).un("o v",this._onKeyPress,this),this},open:function(t){return this.__self.setItem(t),this.bindEvents(),this.isOpened=!0,this._getPane().open(),this._getGallery().init(),this.loadItem(t),this},close:function(t){return this._getPane().close(t),this},loadItem:function(t){this.__self.setItem(t),this._canSelectItem()&&this.selectCurrentItem(),this.updatePane()},_canSelectItem:function(){return!0},preloadItems:function(t){return this._getPreloader().setImages(t).batchLoad(),this},showSpin:function(t){this._getGallery().showSpin(this.getDirectionByPageNum(t))},hideSpin:function(t){this._getGallery().hideSpin(this.getDirectionByPageNum(t))},loadGallery:function(t,e){var i,n=this._getGallery();if(!n.needAddList(e))return!1;i=this.getDirectionByPageNum(e),n.hideSpin(i),n.savePageNum(e);var s=n.addList(t,i);return this.isOpened&&"left"===i&&n.move(n.getCurrentScrollPos()+(n._getItemWidth()+n.params.thumbsMargin)*s),!0},getDirectionByPageNum:function(t){return this._getGallery().getDirectionByNum(t)},selectCurrentItem:function(){var t=this.__self.getItemParams();this._getGallery().selectItemByID(t.id)},updatePane:function(){return this._getPane().update(),this},_onResize:function(){var t=this._getPane();t.isMobile()&&t.isOrientationChanged()?t.toggleInfoPanel():this.updatePreviewSize()},_onInfoToggle:function(){this.__self.currentDuplicate&&this.updatePreviewSize()},updatePreviewSize:function(){return this._getPreview().updateWrapperSize().setThumbSize(this.__self.currentDuplicate),this},_onGalleryItemClicked:function(t,e){this.trigger("gallery:click",e)},_onPreviewDupLoaded:function(t,e){this.trigger("preview:loaded",e)},_onPreviewNotfound:function(t,e){this.trigger("preview:notfound",e)},_onPreviewTimeout:function(t,e){this.trigger("preview:timeout",e)},_onPreviewError:function(){this.trigger("preview:error")},_onArrowClick:function(t,e){this._getGallery().isScrolling()||(this.hasMod(e.data.domElem,"side","right")?this.trigger("next",{source:"arrow"}):this.trigger("prev",{source:"arrow"}))},_onThumbClick:function(){this._getGallery().isScrolling()||this.trigger("thumb:click")},_onRightClick:function(){this.trigger("preview:rightClick")},_onListOut:function(t,e){this._getGallery().isSpinVisible(e)||this.trigger("gallery:listOut",this._getGallery().getPageNumByDirection(e))},_onPaneOpen:function(){this.trigger("pane:open")},_onPaneClose:function(t,e){this.isOpened=!1,this.unbindEvents(),this._getPreview().removeImageParams(),this.trigger("pane:close",e),this._getGallery().delSelected()},_onKeyNavigation:function(t,e){e.preventDefault(),this._getGallery().isScrolling()||("left"===t.type||"up"===t.type?this.trigger("prev",{source:"keyboard"}):this.trigger("next",{source:"keyboard"}))},_onTouchMove:function(t){t.target.classList&&t.target.classList.contains("gallery__item")||t.preventDefault()},_closeByKeyboard:function(t,e){e.stopImmediatePropagation(),this.close("keyboard")},_onKeyPress:function(t){var e=this.__self.getItemParams();switch(t.type){case"o":this._openURL(e.preview[0].url),this.trigger("open:image");break;case"v":this._openURL(e.snippet.url),this.trigger("open:site")}},_onTitleClick:function(t,e){this.trigger("title:click",e)},_onLinkClick:function(t,e){this.trigger("link:click",e)},_onMarketSnippetClick:function(t,e){this.trigger(t.type,e)},_openURL:function(t){window.open(t,"_blank")},_onMouseWheel:function(t){var e,i=t.originalEvent;e=i.deltaY||5*i.detail,e&&(1===t.originalEvent.deltaMode&&(e*=16),this._getGallery().move(this._getGallery().getCurrentScrollPos()+e),t.preventDefault())},_getWheelEvent:function(){return this.__self._getWheelEvent()},_getPreloader:function(){return this._batchPreloader||(this._batchPreloader=BEM.create({block:"i-preloader",mods:{batch:"yes",timeout:"yes","preview-speed":"yes"}})),this._batchPreloader},_getPane:function(){return this.pane||(this.pane=this.findBlockOn("pane2"))},_getPreview:function(){return this.preview||(this.preview=this.findBlockInside("preview2"))},_getGallery:function(){return this.gallery||(this.gallery=this.findBlockInside("gallery"))}},{live:function(){return BEM.blocks.preview2.on("duplicate:loaded",this._onDuplicateLoaded,this),this.frameQueue=new window.rafQueue,!1},currentDuplicate:null,_onDuplicateLoaded:function(t,e){this.currentDuplicate=e,this.trigger("duplicate:loaded",e)},currentItem:null,getCurrentDuplicate:function(){return this.currentDuplicate},setItem:function(t){this.currentItem=t},getItem:function(){return this.currentItem},getItemParams:function(){return this.currentItem.params},_getWheelEvent:function(){return this._wheelEvent||(this._wheelEvent="onwheel"in document||document.documentMode>=9?"wheel":"mousewheel")}}),BEM.DOM.decl("pane2-api",{isFullscreen:!1,isSlideshowActive:!1,bindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks.pane2.on("fullscreen:enter",this._onFullscreenEnter,this),BEM.blocks.pane2.on("fullscreen:exit",this._onFullscreenExit,this),BEM.blocks.pane2.on("slideshow:next",this._onSlideshowNext,this),BEM.blocks["slideshow-switcher"].on("start",this._onSlideshowStart,this),BEM.blocks["slideshow-switcher"].on("stop",this._onSlideshowStop,this),this},unbindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks.pane2.un("fullscreen:enter",this._onFullscreenEnter,this),BEM.blocks.pane2.un("fullscreen:exit",this._onFullscreenExit,this),BEM.blocks.pane2.un("slideshow:next",this._onSlideshowNext,this),BEM.blocks["slideshow-switcher"].un("start",this._onSlideshowStart,this),BEM.blocks["slideshow-switcher"].un("stop",this._onSlideshowStop,this),this},_onFullscreenEnter:function(){this.isFullscreen=!0,this.trigger("fullscreen:enter")},_onFullscreenExit:function(){this.isFullscreen=!1,BEM.blocks["pane2-api"].frameQueue.add(this.selectCurrentItem.bind(this)).run(),this.trigger("fullscreen:exit")},_onSlideshowStart:function(){this.isSlideshowActive=!0,this.trigger("slideshow:start")},_onSlideshowStop:function(){this.isSlideshowActive=!1,this.trigger("slideshow:stop")},_onSlideshowNext:function(){this.trigger("next",{source:"slideshow"})},_canSelectItem:function(){return!this.isFullscreen}}),BEM.DOM.decl("i-keyrouter",{onSetMod:{js:function(){this.bindToDoc("keydown",function(t){return this.__self.instance=this,document.activeElement&&/(INPUT|TEXTAREA)/.test(document.activeElement.nodeName)?void 0:this._onKeydown(t)})}},_onKeydown:function(t){switch(t.keyCode){case 37:case 65:case 72:this.__self.isSpecialKey(t)&&this.trigger("left",t);break;case 39:case 68:case 76:this.__self.isSpecialKey(t)&&this.trigger("right",t);break;case 32:this.trigger("space",t);break;case 70:this.trigger("f",t);break;case 79:this.trigger("o",t);break;case 86:this.trigger("v",t);break;case 34:this.trigger("pagedown",t);break;case 33:this.trigger("pageup",t);break;case 13:this.trigger("enter",t);break;case 27:this.trigger("esc",t),t.stopImmediatePropagation();break;case 8:this.trigger("backspace",t);break;case 38:case 87:case 75:this.__self.isSpecialKey(t)&&this.trigger("up",t);break;case 40:case 83:case 74:this.__self.isSpecialKey(t)&&this.trigger("down",t)}return!t.isImmediatePropagationStopped()}},{get:function(){return this.instance},isSpecialKey:function(t){return!(t.ctrlKey||t.altKey||t.metaKey||t.shiftKey)}}),BEM.DOM.decl("snippet2",{update:function(t){this.__base.apply(this,arguments);var e=t.snippet,i=e.domain,n=BEM.blocks["i-global"].param("isPumpkin")?e.url:e.redirUrl;return this.elem("link").attr("href",n).text(i),this.elem("title").attr("href",n).text(_.trunc(e.title,60)),this.elem("text").html(e.text),this.trigger("updated"),this},updateFavicon:function(t){var e=window.location.protocol+this.params.faviconURL+t,i=new Image,n=this,s=function(){i.width>1&&i.height>1?n.showFavicon(e):n.hideFavicon()};return i.onload=s,i.onerror=s,i.src=e,i.complete&&s(),this},showFavicon:function(t){return this.elem("link").css("background-image","url("+t+")"),this.setMod(this.elem("link"),"favicon","yes"),this},hideFavicon:function(){return this.delMod(this.elem("link"),"favicon"),this.elem("link").css("background-image","none"),this},getDefaultParams:function(){return{faviconURL:"//favicon.yandex.net/favicon/"}},_triggerOnMiddleClick:function(t,e){1===e.button&&this.trigger(t+":click",e.target)}},{live:function(){this.liveBindTo("title","pointerclick contextmenu",function(t){this.trigger("title:click",t.target)}).liveBindTo("link","pointerclick contextmenu",function(t){this.trigger("link:click",t.target)}).liveBindTo("title","click",function(t){this._triggerOnMiddleClick("title",t)}).liveBindTo("link","click",function(t){this._triggerOnMiddleClick("link",t)})}}),BEM.DOM.decl("snippet2",{update:function(t){this.__base.apply(this,arguments);var e=t.snippet;return t.isMarketIncut?(this.setMod("type","market"),e.price?(this.elem("price-value").text(e.visiblePrice),this.delMod(this.elem("price"),"visibility"),e.discount?(this.elem("discount-percent").text(e.discount+"%"),this.delMod(this.elem("discount"),"visibility")):this.setMod(this.elem("discount"),"visibility","hidden")):this.setMod(this.elem("price"),"visibility","hidden"),this.elem("link").text(e.shopName),this.elem("shopping-button").attr("href",e.redirUrl)):this.delMod("type"),this},isShoppingButton:function(){return Boolean(this.elem("shopping-button")[0])}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("shopping-button","pointerclick",function(t){this.trigger("shopping:click",t.target)})}}),BEM.DOM.decl("preview2",{onSetMod:{js:function(){this.findBlocks().bindEvents().updateWrapperSize()}},findBlocks:function(){return this._preloader=BEM.create({block:"i-preloader",mods:{timeout:"yes","preview-speed":"yes"}}),this.thumb=this.elem("thumb"),this._spin=this.findBlockOn(this.elem("spin"),"spinner"),this._store=window.Ya.Images.ThumbsStore,this},bindEvents:function(){return this.bindTo("wrapper","pointerclick",this._onThumbClick).bindTo("thumb","contextmenu",this._onRightClick).bindTo("arrow","pointerclick",this._onArrowClick),this._preloader.on("success",this._onPreloaderSuccess,this).on("notfound",this._onPreloaderNotfound,this).on("timeout",this._onPreloaderTimeout,this).on("error",this._onPreloaderError,this),this},destruct:function(){this.__base.apply(this,arguments),this._preloader.un("success",this._onPreloaderSuccess,this).un("notfound",this._onPreloaderNotfound,this).un("timeout",this._onPreloaderTimeout,this).un("error",this._onPreloaderError,this)},load:function(){var t=BEM.blocks["pane2-api"].getItemParams(),e=t.thumb&&t.thumb.url,i=t.images,n=this._preloader.getSuccessfulDup(i),s=this;return!_.isEmpty(t.dups)&&this.trigger("load:started",t.dups[0]),_.isEmpty(i)?this:(this._preloader.stop(),void(n?BEM.blocks["pane2-api"].frameQueue.add(function(){s.hideSpin()._dupLoaded(n)._setPreview(n)._anyLoaded(n)}):(n=i[0],BEM.blocks["pane2-api"].frameQueue.add(function(){var t={width:n.width,height:n.height,url:e};s.hideSpin().showSpin()._setPreview(t)._anyLoaded(t)}).add(function(){s._preloader.load(i)}))))},_anyLoaded:function(t){this.trigger("duplicate:loaded",t)},_setMaxThumbSize:function(t,e){return this.elem("thumb").css({"max-width":t,"max-height":e}),this},_setPreview:function(t){return this._setPreviewSrc(t.url).setThumbSize(t),this},_setPreviewSrc:function(t){return this.thumb.attr("src",t),window.opera&&this._forceOperaRepaint(),this},_forceOperaRepaint:function(){var t=document.body.style;return t.position="static",setTimeout(function(){t.position="relative"},1),this},setThumbSize:function(t){var e=this._wrapper.width/this._wrapper.height,i=t.width/t.height;return this._setMaxThumbSize(t.width,t.height),i>e?this.setMod(this.elem("thumb"),"fit","width"):this.setMod(this.elem("thumb"),"fit","height"),this},updateWrapperSize:function(){return this._wrapper={width:this.elem("wrapper").width(),height:this.elem("wrapper").height()},this},_onThumbClick:function(t){this.trigger("thumbClick",t)},_onRightClick:function(t){this.trigger("rightClick",t)},_onArrowClick:function(t){this.trigger("arrowClick",t)},_onPreloaderSuccess:function(t,e){this.hideError().trigger("success",e).hideSpin()._dupLoaded(e)._setPreview(e)._anyLoaded(e)},_onPreloaderNotfound:function(t,e){this.trigger("notfound",e)},_onPreloaderTimeout:function(t,e){this.trigger("timeout",e)},_onPreloaderError:function(){var t=BEM.blocks["pane2-api"].getItemParams().thumb,e={url:t.url,width:t.size.width,height:t.size.height};this.trigger("error",e),this.hideSpin().updateErrorLink().showError()._setPreview(e)._anyLoaded(e)},updateErrorLink:function(){var t=BEM.blocks["pane2-api"].getItemParams();return this.elem("error-link").attr("href",t.snippet.url),this},showError:function(){return this.setMod("error","yes")},hideError:function(){return this.delMod("error")},_dupLoaded:function(t){return this.trigger("loaded",{image:t,stats:this._preloader._getImageStats(t.url)}),this},removeImageParams:function(){return this.elem("thumb").removeAttr("src style"),this},showSpin:function(){var t=this._spin;return this._spinnerTimer=setTimeout(function(){t.setMod("progress","yes")},1e3),this},hideSpin:function(){return clearTimeout(this._spinnerTimer),this._spin.delMod("progress"),this}}),BEM.DOM.decl("preview2",{onSetMod:{js:function(){this.__base.apply(this,arguments),screenfull&&screenfull.enabled||this.setMod(this.elem("fullscreen"),"disabled","yes")},fullscreen:{yes:function(){screenfull.request(),this.trigger("fullscreen:enter")},no:function(){this.trigger("fullscreen:exit")}}},bindEvents:function(){return this.__base.apply(this,arguments),this.bindTo("fullscreen","pointerclick",this._onFullscreenEnter),BEM.blocks["i-keyrouter"].on("f",this._onFullscreenEnter,this),this},destruct:function(){BEM.blocks["i-keyrouter"].un("f",this._onFullscreenEnter,this),this.__base.apply(this,arguments)},_onFullscreenEnter:function(t,e){return screenfull.enabled&&("f"!==t.type||BEM.blocks["i-keyrouter"].isSpecialKey(e))?this.hasMod("animation","yes")?!1:this.hasMod("fullscreen","yes")?!1:(this.setMod("fullscreen","yes"),void this.trigger("fullscreen:enter")):!1},exitFullscreen:function(){return this.setMod("fullscreen","no"),screenfull.exit(),this}}),BEM.decl({block:"i-preloader",modName:"preview-speed",modVal:"yes"},{loadImage:function(t){return this._getImageStats(t.url)||this._setImageStats(t.url,{start:Number(new Date)}),this.__base.apply(this,arguments)},_onSuccess:function(t){var e=this._getImageStats(t.url);return e&&!e.latency&&(e.latency=Number(new Date)-e.start,this._setImageStats(t.url,e)),this.__base.apply(this,arguments)},_getImageStats:function(t){return this.__self._imagesLoadingStats[t]},_setImageStats:function(t,e){return this.__self._imagesLoadingStats[t]=e,this}},{_imagesLoadingStats:{}}),BEM.decl({block:"i-preloader",modName:"timeout",modVal:"yes"},{totalImages:0,totalTime:0,loadTimeout:15e3,createLoader:function(t){return this._timeout=setTimeout(function(){this._onError(t),this.trigger("timeout",t.url)}.bind(this),this.loadTimeout),this._loadStart=Number(new Date),this.__base.apply(this,arguments)},destroyLoader:function(){return clearTimeout(this._timeout),this._loader&&this._loader.complete&&(this._loadEnd=Number(new Date),this.totalImages++,this.totalTime+=this._loadEnd-this._loadStart,this.totalImages>10&&(this.loadTimeout=Math.max(4*Math.floor(this.totalTime/this.totalImages),6e3))),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"i-preloader",modName:"batch",modVal:"yes"},{images:[],onSetMod:{js:function(){this.__base.apply(this,arguments),this.on("success error",this.batchLoad)}},batchLoad:function(){return this.load(this.images.shift()),this},setImages:function(t){return this.images=t,this}}),BEM.DOM.decl("preview2",{onSetMod:{fullscreen:{yes:function(){this.__base.apply(this,arguments),this._hitFullscreenCounter("open")},no:function(){this.__base.apply(this,arguments),this._hitFullscreenCounter("close")}}},_hitFullscreenCounter:function(t){return c.hitDelayed({dtype:"iweb",path:"/image/new/fullscreen/"+t,reqid:BEM.blocks["pane2-api"].getItemParams().reqid}),this}}),BEM.DOM.decl("slideshow-switcher",{onSetMod:{js:function(){this.bindEvents()},active:{yes:function(){this.trigger("start")},"":function(){this.trigger("stop")}}},bindEvents:function(){return this.findBlockOn("button").on("click",this._onButtonClick,this),BEM.blocks["pane2-api"].on("fullscreen:exit",this._onFullscreenExit,this),this},destruct:function(){this.__base.apply(this,arguments),BEM.blocks["pane2-api"].un("fullscreen:exit",this._onFullscreenExit,this)},_onButtonClick:function(){this.toggleMod("active","yes")},_onFullscreenExit:function(){this.delMod("active")}}),BEM.DOM.decl("slideshow-icon",{onSetMod:{js:function(){BEM.blocks["slideshow-switcher"].on("start",this._onSlideshowStart,this).on("stop",this._onSlideshowStop,this)}},destruct:function(){BEM.blocks["slideshow-switcher"].un("start",this._onSlideshowStart,this).un("stop",this._onSlideshowStop,this),this.__base.apply(this,arguments)},_onSlideshowStart:function(){this._animate(function(){this.setMod("active","yes")})},_onSlideshowStop:function(){this._animate(function(){this.delMod("active")})},_animate:function(t){this.setMod("animation","yes"),setTimeout(function(){this.delMod("animation"),t.apply(this)}.bind(this),2e3)}}),BEM.DOM.decl("button",{onSetMod:{focused:{yes:function(){return this.hasMod("focus","no")?!1:this.__base.apply(this,arguments)}}}}),BEM.DOM.decl("gallery",{getDefaultParams:function(){return{animationTime:100,thumbsMargin:10,pages:[],minPage:-1,maxPage:-1}},init:function(){return this},selectItem:function(t){var e=this.findElem("item","selected","yes");return this.delMod(e,"selected").setMod(t,"selected","yes"),_.isEmpty(e)||window.opera?this._scrollTo(t,e):this._animatedScrollTo(t,e),this},selectItemByID:function(t){this.selectItem(this._getItemBySerpItemId(t))},isSpinVisible:function(t){return Boolean(this.hasMod(this._getSpinner(t),"visibility","visible"))},showSpin:function(t){return this._getSpinner(t)&&(this._moveSpinner(t),this.setMod(this._getSpinner(t),"visibility","visible")),this},delSelected:function(){this.delMod(this.findElem("item","selected","yes"),"selected")},_moveSpinner:function(t){return"left"===t?this._getSpinner(t).prependTo(this.getCarousel().getList()):this._getSpinner(t).appendTo(this.getCarousel().getList()),this},_getSpinner:function(t){return this.spinner||(this.spinner=[]),this.spinner[t]||(this.setContent(BEMHTML.apply({block:"gallery",elem:"spinner",mods:{direction:t},content:{block:"spinner",mods:{size:"m",progress:"yes"}}}),t),this.spinner[t]=this.findElem("spinner","direction",t)),this.spinner[t]},hideSpin:function(t){return this.delMod(this._getSpinner(t),"visibility","visible")},scrollToItemByID:function(t,e){this.move(this.getScrollPos(this._getItemBySerpItemId(t)),e)},_scrollTo:function(t,e){this.move(this.getScrollPos(t,e))},_animatedScrollTo:function(t,e){this.move(this.getScrollPos(t,e),!0)},getScrollPos:function(t,e){if(_.isEmpty(e))return t.position().left+(this._getItemWidth()+this.params.thumbsMargin)/2;var i,n=0,s=this._getItemWidth(),o=this.getCurrentScrollPos(),r=e.index()<t.index();return this.itemClickOffsetX?(i=this.itemClickOffsetX,n=this.params.thumbsMargin+s/2,n=r?s-i+n:-i-n,this.itemClickOffsetX=null,o+n):r?this.isItemLeftFromCenter(t)?o:this.calcItemCenterPos(t):this.isItemRightFromCenter(t)?o:this.calcItemCenterPos(t)},isItemLeftFromCenter:function(t){return t.position().left<this.calcCenterPos()},isItemRightFromCenter:function(t){return t.position().left>this.calcCenterPos()},calcCenterPos:function(){return Math.round(this.getCurrentScrollPos()-this._getItemWidth()/2)},calcItemCenterPos:function(t){return Math.round(t.position().left+this._getItemWidth()/2)},getCurrentScrollPos:function(){return this.getCarouselWrap().scrollLeft()},_getWrapLeft:function(){return this._wrapLeft||(this._wrapLeft=this.getCarouselWrap().offset().left)},_getItemWidth:function(){return this._itemWidth||(this._itemWidth=this.elem("item").width())},clear:function(){return this.params.maxPage=-1,this.params.minPage=-1,this.params.pages=[],this.spinner=[],this._uniqIds={},this.getCarousel().elem("list").empty(),this},move:function(t,e){var i=this.getCarouselWrap();return e?(this.hasMod("scrolling")&&i.stop(),this.setMod("scrolling","yes"),void i.animate({scrollLeft:t},{queue:!1,easing:"linear",duration:this.params.animationTime,complete:function(){this.delMod("scrolling"),i.stop()}.bind(this)})):void i.scrollLeft(t)},_onItemClick:function(t){var e,i=t.data.domElem;t.preventDefault(),this.hasMod(i,"selected","yes")||(this.itemClickOffsetX=t.offsetX,e=this._getSerpItemId(i),this.trigger("click",e),$("#"+e).bem("serp-item").sendClickCounter())},_getSerpItemId:function(t){return t.attr("id").replace("gallery-","")},getDirectionByNum:function(t){var e="direct";return-1===this.params.maxPage&&-1===this.params.minPage?e="direct":t>this.params.maxPage?e="right":t<this.params.minPage&&(e="left"),e},savePageNum:function(t){return-1===this.params.maxPage&&-1===this.params.minPage?(this.params.maxPage=t,this.params.minPage=t):t>this.params.maxPage?this.params.maxPage=t:t<this.params.minPage&&(this.params.minPage=t),this.params.pages.push(t),this},needAddList:function(t){return-1===_.indexOf(this.params.pages,t)},getPageNumByDirection:function(t){var e;return"left"===t?e=this.params.minPage-1:"right"===t&&(e=this.params.maxPage+1),e},setContent:function(t,e){var i=this.getCarousel();switch(e){case"left":i.prependItemsInList(t);break;case"right":i.appendItemsInList(t);break;default:i.setItemsInList(t)}return window.inNextFrame(i.setScrollMod,i),this},addList:function(t,e){t=$("<div>").append(t),this._removeDuplicates(t);var i=this.prepareItems(t.contents());return this.setContent(i,e),i.length},prepareItems:function(t){return t},_getItemBySerpItemId:function(t){return $("#gallery-"+t)},getCarousel:function(){return this.carousel||(this.carousel=this.findBlockInside("carousel"))},getCarouselWrap:function(){return this.carouselWrap||(this.carouselWrap=this.getCarousel().elem("wrap"))},isScrolling:function(){return this.hasMod("scrolling","yes")},setBase64FromSerpList:function(t){var e=this;return _.forEach(t.getIds(),function(t){var i=e._getItemBySerpItemId(t).find(".gallery__thumb"),n=$("#"+t).find("img").attr("src");i.attr("src",n)}),this},_removeDuplicates:function(t){this._uniqIds||(this._uniqIds={});var e=this;_.forEach(t.find(".gallery__item"),function(t){e._uniqIds[t.id]?$(t).remove():e._uniqIds[t.id]=!0})},insertAfterThumb:function(t,e){this.getCarousel().insertAfterThumb(t,e)},insertBeforeAllThumbs:function(t){this.getCarousel().insertBeforeAllThumbs(t)}},{live:function(){this.liveBindTo("item","pointerclick",function(t){this._onItemClick(t)}),this.liveBindTo("item","click",function(t){t.preventDefault()})}}),BEM.DOM.decl({block:"gallery",modName:"lazy-thumbs",modVal:"yes"},{init:function(){return this.__base.apply(this,arguments),this.findElem("item").each(this._initThumbSrc.bind(this)),this},prepareItems:function(t){return t=this.__base.apply(this,arguments),t.each(this._initThumbSrc.bind(this)),t},_initThumbSrc:function(t,e){var i=e.firstChild,n=i.getAttribute("data-src");if(n){var s=window.Ya.Images.ThumbsStore.get(e.id.substr(8),"fittedItem.newThumbSrc");s&&(n=s),i.src=n,i.removeAttribute("data-src")}}}),BEM.DOM.decl("related2",{_onItemClick:function(t){var e={};e[this.getMod("position")]="p"+this.getItemIndex(t.data.domElem),BEM.blocks["b-statcounter"].hit({params:{query:{related:{preview:e}}}})},getItemIndex:function(t){return this.elem("thumb").index(t)
}},{live:function(){return this.liveBindTo("thumb","pointerclick",function(t){this._onItemClick(t)}),this.liveBindTo("thumb","click",function(t){t.preventDefault()}),!1}}),BEM.DOM.decl("sizes",{onSetMod:{js:function(){this._store=window.Ya.Images.ThumbsStore,this.bindEvents()}},bindEvents:function(){this.getDropdown().on("show",this._onPopupShow,this),this.getDownload().bindTo({contextmenu:this._onClick.bind(this),click:this._onClick.bind(this)})},unbindEvents:function(){return this.getDropdown().un("show",this._onPopupShow,this),this},destruct:function(){this.unbindEvents().__base.apply(this,arguments)},_onPopupShow:function(){this._updateLinks()},_onClick:function(){this.trigger("download")},getDropdown:function(){return this._dropdown||(this._dropdown=this.findBlockInside("dropdown-menu"))},getDownload:function(){return this._downloadButton||(this._downloadButton=this.findBlockOn("download","button2")),this._downloadButton},getDownloadSwitcher:function(){return this._downloadSwitcher||(this._downloadSwitcher=this.findBlockInside({block:"button2",modName:"side",modVal:"right"}))},getDownloadDOMNode:function(){return this.elem("download")[0]},_updateButton:function(t){var e=this.getDownload();if(!this.__self.isSameImages(this._image,t))return this.elem("width").text(t.width),this.elem("height").text(t.height),e.setUrl(t.url),this._image=t,this},_updateLinks:function(){var t=BEM.blocks["pane2-api"].getItemParams(),e=_.filter(this._dups,this._isDupSuccessful.bind(this)),i=t.reqid;this.getDropdown().setContent(BEMHTML.apply({block:"dropdown-menu",elem:"menu",content:e.map(function(t,e){return{elem:"item",content:{block:"link",url:t.url,counter:"c.hit("+JSON.stringify({dtype:"iweb",path:"/image/new/preview/duplicates/image/othersize/p"+(e+1),reqid:i})+")",target:"_blank",content:t.width+"&times;"+t.height}}})}))},_isDupSuccessful:function(t){var e=BEM.blocks["pane2-controller"]._encodeUrlForStore(t.url);return!this._store.get(BEM.blocks["pane2-api"].getItemParams().id,"dups.broken."+e)},update:function(t){var e=BEM.blocks["pane2-api"].getItemParams();return this._dups=e.dups||[],this._toggleDropdownButton()._updateButton(t)},_toggleDropdownButton:function(){return 1===this._dups.length?this._hideDropdown():this._showDropdown(),this},_showDropdown:function(){this.delMod("hide-dropdown"),this.getDownload().setMod("side","left")},_hideDropdown:function(){this.setMod("hide-dropdown","yes"),this.getDownload().delMod("side")},setButtonTheme:function(t){this.getDownload().setMod("theme",t),this.getDownloadSwitcher().setMod("theme",t)}},{isSameImages:function(t,e){return t&&e?t.url===e.url&&t.width===e.width&&t.height===e.height:void 0}}),BEM.DOM.decl("disk-button",{getDefaultParams:function(){return{i18n:{notEnoughSpace:BEM.I18N("disk-button","На Диске недостаточно места{br}для сохранения картинки.{br}",{br:"<br />",context:"Текст ошибки в попапе сохранения картинки в Диск https://nda.ya.ru/3R7FTd"}),increaseSpace:BEM.I18N("disk-button","Увеличить место на диске",{context:"Текст ссылки в попапе сохранения картинки в Диск https://nda.ya.ru/3R7FTd"}),somethingWrong:BEM.I18N("disk-button","Ой! Что-то пошло не так.{br}Попробуйте повторить еще{br}раз немного позже.",{br:"<br />",context:"Текст ошибки в попапе сохранения картинки в Диск https://nda.ya.ru/3R7FTi"}),socialAuth:BEM.I18N("disk-button","{authorize} с помощью аккаунта{br}Яндекса, чтобы сохранять{br}картинки на Диск.",{context:"Полный текст: Войдите с помощью аккаунта Яндекса, чтобы сохранять картинки на Диск.",br:"<br />",authorize:BEMHTML.apply({block:"link",mix:[{block:"disk-button",elem:"auth-link"}],url:"#",content:BEM.I18N("disk-button","Войдите",{context:"Предложение авторизоваться, полный текст: Войдите с помощью аккаунта Яндекса, чтобы сохранять картинки на Диск."})})})},hideTimeout:3e3}},onSetMod:{js:function(){BEM.blocks.button2.on(this.elem("button"),"click",this._onClick,this)}},destruct:function(){BEM.blocks.button2.un(this.elem("button"),"click",this._onClick,this),this.__base.apply(this,arguments)},disable:function(){return this._getButton().setMod("disabled","yes")},enable:function(){return this._getButton().delMod("disabled")},setSaved:function(){this.setMod("saved","yes"),this.disable()},setNotSaved:function(){this.delMod("saved"),this.enable()},showError:function(t){var e=this.params.i18n;switch(t){case"not-enough-space":this._showPopup("not-enough-space",[e.notEnoughSpace,{block:"link",url:"https://disk.yandex."+BEM.blocks["i-global"].param("tld")+"/tuning?source=save_images",target:"_blank",content:e.increaseSpace}]);break;case"social-auth":this._showPopup("social-auth",e.socialAuth);break;default:this._showPopup("something-wrong",e.somethingWrong)}return this},hidePopups:function(){return _.forEach(this._popup,function(t){t.hide()}),this},_bindPopupEvents:function(t){return"social-auth"===t&&this.bindTo("auth-link","pointerclick",this._onAuthLinkClick.bind(this)),this},_onClick:function(t){t.preventDefault(),this.trigger("click"),c.hit({dtype:"stred",pid:40,cid:72947,path:"preview.disk.save"})},_onAuthLinkClick:function(t){t.preventDefault(),this.trigger("auth:click"),this._getPopup("social-auth").hide()},_showPopup:function(t,e,i){var n=this._getPopup(t,e,i);return n&&n.show(this.domElem),-1!==["not-enough-space","something-wrong"].indexOf(t)&&this._hidePopupsTimeout(),this},_getPopup:function(t,e,i){return this._popup||(this._popup={}),this._popup[t]||this._createPopup(e,i)._bindPopupEvents(t),this._popup[t]||(this._popup[t]=this.findBlockOn("popup","popup"))},_createPopup:function(t,e){return BEM.DOM.append(this.domElem,BEMHTML.apply({block:"disk-button",elem:"popup",content:t,paranja:e})),this},_getButton:function(){return this._button||(this._button=this.findBlockOn("button","button2"))},_hidePopupsTimeout:function(){return setTimeout(this.hidePopups.bind(this),this.params.hideTimeout),this}},{live:function(){this.liveInitOnEvent("pointerclick")}}),BEM.DOM.decl({block:"disk-button",modName:"promo",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["pane2-api"].frameQueue.add(this.showPromo,this)}},destruct:function(){this.unbindFrom(this._getPopup("promo").domElem,"click",this._onPopupClick,this),this.__base.apply(this,arguments)},showPromo:function(){this._showPopup("promo",BEM.I18N("disk-button","Не теряйте свои находки.{br}Нажмите, чтобы сохранить{br}картинку на Диске.",{br:"<br />",context:"Текст в промо-попапе сохранения картинки в Диск https://nda.ya.ru/3R5JCA"}),!0),this._getPopup("promo").setMod("promo","yes"),this.bindTo(this._getPopup("promo").domElem,"click",this._onPopupClick,this),BEM.blocks.disk.setPromoShown()},_onPopupClick:function(){this.hidePopups()}}),BEM.DOM.decl("search-by-image",{onSetMod:{js:function(){this._button=this.findBlockInside("button2"),this._button.on("click",this._onButtonClick,this),BEM.blocks.preview2.on("duplicate:loaded",this._updateLink,this),BEM.blocks.preview2.on("load:started",this._updateLink,this)}},destruct:function(){this._button.un("click",this._onButtonClick,this),BEM.blocks.preview2.un("duplicate:loaded",this._updateLink,this),BEM.blocks.preview2.un("load:started",this._updateLink,this),this.__base.apply(this,arguments)},_onButtonClick:function(){BEM.blocks["b-statcounter"].hit({params:{query:{cbir:"view"}}})},update:function(t){return this._button.setUrl(this._getViewUrl(t)),this},_updateLink:function(t,e){e.url.match(/(^\/\/im[0123]-tub-(ru|tr))/)||this.update(e.url)},_getViewUrl:function(t){return BEM.blocks.uri.buildRelativeUrl(BEM.blocks["i-global"].param("router").search,{text:BEM.blocks["i-global"].param("query"),rpt:"imageview",url:t})}}),BEM.DOM.decl("open-image",{update:function(t){var e=t.preview[0];this.domElem.attr("href",e.url),this.findBlockOn("button").elem("sizes").html(" "+e.width+"×"+e.height)}}),BEM.DOM.decl("share-dropdown",{updateLink:function(t,e){var i=this.findBlockInside(this.elem("share-item","service",t),"link");return this._updateLink(i,e),this},updateLinks:function(t){var e=this;this.findBlocksInside("link").forEach(function(i){e._updateLink(i,t)})},_updateLink:function(t,e){var i=t.domElem;e=e||{},i.attr("href","//share.yandex.ru/go.xml?service="+(e.service?e.service:i.attr("data-service"))+"&url="+encodeURIComponent(void 0!==e.url?e.url:window.location.href)+"&title="+encodeURIComponent(e.title?e.title:document.title)+(e.image?"&image="+encodeURIComponent(e.image):"")+"&description="+encodeURIComponent(e.description?e.description:$("meta[name=description]").attr("content")||""))}},{live:!0}),BEM.DOM.decl("share-dropdown",{_onLinkClick:function(t){var e=this.__self._POPUP_SIZE;window.open(t.target.getAttribute("href"),"","width="+e.width+", height="+e.height)}},{live:function(){this.liveBindTo("share-item","pointerclick",function(t){t.preventDefault(),this._onLinkClick(t)})},_POPUP_SIZE:{width:600,height:500}}),BEM.DOM.decl("share-dropdown",{updateLink:function(t,e){var i=this.findBlockInside(this.elem("share-item","service",t),"link");return i&&this._updateLink(i,e),this}}),BEM.DOM.decl("share-dropdown",{_updateLink:function(t,e){this.__base.apply(this,arguments),t.params.mode=e.mode,t.params.reqid=e.reqid,t.params.url=void 0!==e.url?e.url:window.location.href,t.params.counterUrl=e.counterUrl,t.params.binded||t.bindTo("pointerclick",this._onLinkClick,this),t.params.binded=!0},_onLinkClick:function(t){var e=this.params,i="/image/new/"+(e.mode||"preview")+"/share/",n=$(t.target),s=n.attr("data-service");c.hit({dtype:"iweb",path:i+s,reqid:e.reqid},{href:e.counterUrl})}}),BEM.DOM.decl("market-snippet",{update:function(t){return this._updatePrice(t),this.elem("title").attr("href",t.url).text(_.trunc(t.title,60)),this.elem("link").attr("href",t.url).text(t.domain),this._updateText(t.text),this.elem("shopping-button").attr("href",t.url),this},_updateText:function(t){var e=this.elem("text");return _.isEmpty(e)||e.text(_.trunc(t,120)),this},_updatePrice:function(t){return t.price?(this.elem("price-value").text(t.visiblePrice),t.oldPrice?(this.elem("old-price-value").text(t.visibleOldPrice),this.delMod(this.elem("old-price"),"visibility")):this.setMod(this.elem("old-price"),"visibility","hidden"),t.discount?(this.elem("discount-percent").text(t.discount+"%"),this.delMod(this.elem("discount"),"visibility")):this.setMod(this.elem("discount"),"visibility","hidden"),this.delMod(this.elem("money"),"visibility")):this.setMod(this.elem("money"),"visibility","hidden"),this}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("title","pointerclick",function(t){this.trigger("market:title:click",t.target)}),this.liveBindTo("link","pointerclick",function(t){this.trigger("market:link:click",t.target)}),this.liveBindTo("shopping-button","pointerclick",function(t){this.trigger("market:button:click",t.target)})}}),BEM.DOM.decl("pane2-controller",{_viewParams:["img_url","rpt","pos"],_relatedRequest:null,getDefaultParams:function(){return{directUpdateTime:1e4}},onSetMod:{js:function(){this.findBlocks().bindEvents(),this._relatedBaseData=this._getPane().getRelated(),this._throttledUpdateDirect=$.throttle(this._tryUpdateDirect,this.params.directUpdateTime,this),this.loadInitialItem(),this._addInitialItemsToGallery()}},findBlocks:function(){return this.location=BEM.blocks.location.getInstance(),this._store=window.Ya.Images.ThumbsStore,this.changeUrlDebounced||(this.changeUrlDebounced=$.debounce(this.changeUrl,700,this)),this},bindEvents:function(){return BEM.blocks["b-page"].on("related2:update",this._onRelatedUpdate,this),BEM.blocks["b-page"].on("change",this._onPageChanged,this),BEM.blocks["serp-controller"].on("galleryLoaded",this._onGalleryLoaded,this),BEM.blocks["serp-item"].on("clicked",$.throttle(this._onSerpItemClicked.bind(this),100),this),this},unbindEvents:function(){BEM.blocks["b-page"].un("related2:update",this._onRelatedUpdate,this),BEM.blocks["b-page"].un("change",this._onPageChanged,this),BEM.blocks["serp-controller"].un("galleryLoaded",this._onGalleryLoaded,this),BEM.blocks["serp-item"].un(this.domElem,"open-pane2",this._onSerpItemClicked,this),this.unbindPane2Events()},destruct:function(){this.unbindEvents(),clearTimeout(this._locationTimeout),this.__base.apply(this,arguments)},bindPane2Events:function(){BEM.blocks["i-global"].param("isPumpkin")||BEM.blocks["pane2-api"].on("gallery:listOut",this._onGalleryListOut,this),BEM.blocks["pane2-api"].on("pane:open",this._onPaneOpen,this),BEM.blocks["pane2-api"].on("pane:close",this._onPaneClose,this),BEM.blocks["pane2-api"].on("gallery:click",this._onGalleryItemClicked,this),BEM.blocks["pane2-api"].on("preview:rightClick",this._onRightClick,this),BEM.blocks["pane2-api"].on("preview:loaded",this._onPreviewDupLoaded,this),BEM.blocks["pane2-api"].on("duplicate:loaded",this._onPreviewAnyLoaded,this),BEM.blocks["pane2-api"].on("preview:notfound",this._onPreviewNotfound,this),BEM.blocks["pane2-api"].on("preview:timeout",this._onPreviewTimeout,this),BEM.blocks["pane2-api"].on("preview:error",this._onPreviewError,this),BEM.blocks["pane2-api"].on("thumb:click",this._onThumbClick,this),BEM.blocks["pane2-api"].on("title:click",this._onTitleClick,this),BEM.blocks["pane2-api"].on("link:click",this._onLinkClick,this),BEM.blocks["pane2-api"].on("market:button:click market:link:click market:title:click",this._onMarketSnippetClick,this),BEM.blocks["pane2-api"].on("next prev",this._onImageSwitch,this),BEM.blocks.sizes.on("download",this._onDownloadClick,this),BEM.blocks["pane2-api"].on("open:image",this._onDownloadClick,this),BEM.blocks["pane2-api"].on("slideshow:start",this._onSlideshowStart,this),BEM.blocks["pane2-api"].on("slideshow:stop",this._onSlideshowStop,this)},unbindPane2Events:function(){BEM.blocks["i-global"].param("isPumpkin")||BEM.blocks["pane2-api"].un("gallery:listOut",this._onGalleryListOut,this),BEM.blocks["pane2-api"].un("pane:open",this._onPaneOpen,this),BEM.blocks["pane2-api"].un("pane:close",this._onPaneClose,this),BEM.blocks["pane2-api"].un("gallery:click",this._onGalleryItemClicked,this),BEM.blocks["pane2-api"].un("preview:rightClick",this._onRightClick,this),BEM.blocks["pane2-api"].un("preview:loaded",this._onPreviewDupLoaded,this),BEM.blocks["pane2-api"].un("duplicate:loaded",this._onPreviewAnyLoaded,this),BEM.blocks["pane2-api"].un("preview:notfound",this._onPreviewNotfound,this),BEM.blocks["pane2-api"].un("preview:timeout",this._onPreviewTimeout,this),BEM.blocks["pane2-api"].un("preview:error",this._onPreviewError,this),BEM.blocks["pane2-api"].un("thumb:click",this._onThumbClick,this),BEM.blocks["pane2-api"].un("title:click",this._onTitleClick,this),BEM.blocks["pane2-api"].un("link:click",this._onLinkClick,this),BEM.blocks["pane2-api"].on("market:button:click market:link:click market:title:click",this._onMarketSnippetClick,this),BEM.blocks["pane2-api"].un("next prev",this._onImageSwitch,this),BEM.blocks.sizes.un("download",this._onDownloadClick,this),BEM.blocks["pane2-api"].un("open:image",this._onDownloadClick,this),BEM.blocks["pane2-api"].un("slideshow:start",this._onSlideshowStart,this),BEM.blocks["pane2-api"].un("slideshow:stop",this._onSlideshowStop,this)},_getPane2API:function(){return this._pane2api||(this._pane2api=this.findBlockInside("pane2-api"))},_getPane:function(){return this._pane||(this._pane=this.findBlockInside("pane2"))},_getGallery:function(){return this._gallery||(this._gallery=this.findBlockInside("gallery"))},_getDirect:function(){return this._direct||(this._direct=this._getPane2API().findBlockInside({block:"direct",modName:"type",modVal:this._getDirectType()}))},_getDirectType:function(){var t=BEM.blocks["i-global"].getFlag("doge_fridge_direct");return t?"fridge":this._getDirectStripeType()},_getDirectStripeType:function(){var t=BEM.blocks["i-global"].getFlag("images_direct_stripe_over_gallery")&&BEM.blocks["i-ua"].ie>9&&BEM.blocks["i-ua"].opera&&Number(window.opera.version())>12.16;return t?"stripe-over-gallery":"stripe"},_getSizes:function(){return this.sizes||(this.sizes=this.findBlockInside("sizes"))},_onGalleryListOut:function(t,e){if(this.isPageExists(e)&&!this.isMissingIncut()){var i=this._getPane2API();i.showSpin(e),this.trigger("listOut",i.getDirectionByPageNum(e))}},isPageExists:function(t){return t>=0&&t<=BEM.blocks["serp-controller"].get().getLastPage()},isMissingIncut:function(){return 0===BEM.blocks["i-global"].getFlag("images_incut_position")&&!this.findBlockInside("serp-list_type_market")},_onGalleryItemClicked:function(t,e){this.getItemById(e).click("mouse")},_onImageSwitch:function(t,e){var i=t.type;this[i](e.source)},_onThumbClick:function(){this.next("mouse"),this._hitPreviewCounter("imgclick")},_onRightClick:function(){this._hitPreviewCounter("save")},_onTitleClick:function(t,e){var i=BEM.blocks["pane2-api"].getItemParams(),n=this._isMarketIncut(i)?"/commercial/"+i.marketSnippet.source:"";this._hitPreviewCounter("site"+n,e,{pos:n&&i.pos})},_onLinkClick:function(t,e){var i=BEM.blocks["pane2-api"].getItemParams(),n=this._isMarketIncut(i)?"/commercial/"+i.marketSnippet.source:"";this._hitPreviewCounter("duplicates/url"+n,e,{pos:n&&i.pos})},_onMarketSnippetClick:function(t,e){var i=BEM.blocks["pane2-api"].getItemParams(),n=t.type.match(/market:(button|link|title):click/)[1];this._hitPreviewCounter("commercial/"+n+"/"+i.marketSnippet.source,e,{pos:i.pos})},_onDownloadClick:function(){this._hitPreviewCounter("duplicates/image",this._getSizes().getDownloadDOMNode())},_onSlideshowStart:function(){this._hitPreviewCounter("slideshow/play")},_onSlideshowStop:function(){this._hitPreviewCounter("slideshow/stop")},_onPageChanged:function(){this._getPane2API().close("ajax"),this._addInitialItemsToGallery()},_onPaneOpen:function(){this._hitPreviewCounter("open")},_onPaneClose:function(t,e){clearTimeout(this._locationTimeout),("mouse"===e||"keyboard"===e)&&(this._hitPreviewCounter("close"),this.delViewParams()),"ajax"!==e&&BEM.blocks["navigation-controller"].get().scroll("down"),this.unbindPane2Events()},_onPreviewDupLoaded:function(t,e){this._countPreview(e)},_onPreviewAnyLoaded:function(t,e){this._updateSizes(e)},_onPreviewError:function(){errcnt(null,2104)},_onPreviewNotfound:function(t,e){this._excludeDup(e)},_onPreviewTimeout:function(t,e){this._excludeDup(e)},_excludeDup:function(t){var e=this.__self._encodeUrlForStore(t);return this._store.set(BEM.blocks["pane2-api"].getItemParams().id,"dups.broken."+e,!0),this},_onRelatedUpdate:function(t,e){this._relatedBaseData=e.html,this.updateRelated(e)},_isMarketIncut:function(t){return Boolean(t.isMarketIncut)},updateRelated:function(t){t.params.isEmpty&&(t.html=this._relatedBaseData),this._getPane().updateRelated(t)},loadRelated:function(t){this._relatedRequest&&this._relatedRequest.abort(),this._relatedRequest=BEM.create("i-request_type_bem",{url:t}).block("related2:ajax",this.updateRelated.bind(this)).get()},_hitPreviewCounter:function(t,e,i){return c.hitDelayed(_.assign({dtype:"iweb",path:"/image/new/preview/"+t,reqid:BEM.blocks["pane2-api"].getItemParams().reqid},i),e),this},loadItem:function(t){var e,i=this._getPane2API(),n=!i.isOpened,s=this;return BEM.blocks["i-global"].getFlag("images_thumbs_fullsize")&&(e=window.Ya.Images.ThumbsStore.get(t.params.id,"fittedItem.newThumbSrc"),e&&(t.params.thumb.url=e)),t.params.reqid||this._addReqId(t),t.params.images=this.getActualImages(t.params),n?(this.bindPane2Events(),BEM.blocks["pane2-api"].frameQueue.add(function(){i.open(t)})):BEM.blocks["pane2-api"].frameQueue.add(function(){i.loadItem(t)}),BEM.blocks["pane2-api"].frameQueue.add(function(){i.preloadItems(s.getNextImages(t.params.pos))}).add(function(){s.checkListOut(t)}),!i.isFullscreen&&BEM.blocks["pane2-api"].frameQueue.add(function(){s._shouldUpdateDirect()&&s._throttledUpdateDirect(t)}),i.isFullscreen||t.params.img_related_url&&BEM.blocks["pane2-api"].frameQueue.add(function(){s.loadRelated(t.params.img_related_url)}),BEM.blocks["pane2-api"].frameQueue.add(function(){s.changeUrlDebounced(s.getImageURL(t),n)}),BEM.blocks["pane2-api"].frameQueue.run(),this},_tryUpdateDirect:function(t){var e=this._getDirect(),i=this;e&&BEM.blocks["pane2-api"].frameQueue.add(function(){e&&e.update(i.getDirectGrab(t))})},_shouldUpdateDirect:function(){var t=this._getDirect();return t&&(!t.isExists()||this.params.directUpdateTime>0)&&!this._getPane().isMarketState()},getDirectGrab:function(t){return 0===t.params.pos?BEM.blocks["i-global"].param("query")+" - "+t.params.snippet.grab:t.params.snippet.grab||BEM.blocks["i-global"].param("query")},_addReqId:function(t){return t.params.reqid=c.getReqId(t.domElem)||!1,this},changeUrl:function(t,e){this.addViewParams(t,e)},_onSerpItemClicked:function(t,e){"search"===e.getMod("type")&&this.loadItem(e)._countSelected(e)},move:function(t,e){BEM.blocks["navigation-controller"].get().goTo(t,!1,e)},next:function(t){this.move("right",t)},prev:function(t){this.move("left",t)},addViewParams:function(t,e){return screenfull&&screenfull.isFullscreen||this.location.change({url:t,trigger:!1,history:Boolean(e)}),this},delViewParams:function(t){return t=t||location.href,this.location.change({url:BEM.blocks.uri.delParams(t,this._viewParams),trigger:!1,history:!1}),this},getImageURL:function(t){var e=t.params.detail_url;return this.updateLinkParams?this.updateLinkParams(e):e},updateLinkParams:function(t){return BEM.blocks.uri.setParams(t,{source:void 0})},getItemById:function(t){var e=$("#"+t);return e.length?e.bem("serp-item"):void 0},hasInitialItem:function(){return Boolean(this.params.item&&this.params.item.selected)},getInitialItem:function(){return this.hasInitialItem()?this.getItemById(this.params.item.selected):!1},loadInitialItem:function(){var t=this.getInitialItem();return t&&(BEM.blocks["serp-item"].setCurrent(t),this.params.dontOpenImage?t.setMod("selected","yes").saveCurrent():(this.loadItem(t),this.trigger("initialLoading",t))),this},_addInitialItemsToGallery:function(){var t,e=this.findBlockInside("serp-list");_.isEmpty(e)||(t=this.findElem("gallery-list").contents(),this._getGallery().clear(),this._getPane2API().loadGallery(t,e.getCurrentPageNumber()),BEM.blocks["i-global"].param("isPumpkin")&&this._getGallery().setBase64FromSerpList(e))},_onGalleryLoaded:function(t,e){return this._getPane2API().loadGallery(e.html,e.params.pageNum),this},_countSelected:function(t){var e=t.params,i=t.eventSource,n=t.eventParams,s="right"===n?"next":"prev",o="keyboard"===i&&n?"426,-info="+n:void 0;return("keyboard"===i||"slideshow"===i)&&c.hitDelayed({dtype:"iweb",path:"/image/new/serp/results/"+i+"/"+e.freshness,pos:e.pos,vars:o},t.domElem),"arrow"===i&&this._hitPreviewCounter(s+"/mouse"+(this._isMarketIncut(e)?"/commercial/"+e.marketSnippet.source:"")),this},_countPreview:function(t){var e=BEM.blocks["pane2-api"].getItemParams(),i=t.image,n=t.stats,s=["84="+e.pos,"1473="+i.width,"1474="+i.height,n&&n.latency?"207="+n.latency:void 0].join(",");return this._hitPreviewCounter("image/show",{href:i.url},{vars:s}),this},_updateSizes:function(t){return this._getSizes()&&this.sizes.update(t),this}},{_encodeUrlForStore:function(t){return t.replace(/[.\[\]]/g,"##")}}),BEM.DOM.decl("pane2-controller",{getItemById:function(t){var e=$("#"+t);return e.length?e.bem("serp-item"):void 0},getItemByPos:function(t){return $(".serp-item_pos_"+t+":eq(0)")},checkListOut:function(t){var e=Boolean(this.getItemByPos(Number(t.params.pos)+5).length);return e||this.trigger("listOut","right"),this},_getActualImages:function(t){if(!t)return[];var e=[];return e=this._getPane2API().isFullscreen?t.dups.concat(t.preview):t.preview.concat(t.dups),t.useProxy&&e.forEach(function(t){t.url=(t.proxy_url.indexOf("http")?location.protocol:"")+t.proxy_url}),e},getActualImages:function(t){var e=this._store.get(t.id,"images");return e||(e=this._getActualImages(t),this._store.set(t.id,"images",e)),e}}),BEM.DOM.decl({block:"pane2-controller",modName:"preload",modVal:"yes"},{IMAGES_COUNT:5,getNextImages:function(t){for(var e,i=t+1,n=this.IMAGES_COUNT,s=5,o=[];o.length<n&&n+s>=i-t;)e=document.querySelector(".serp-item_pos_"+i++),e&&o.push(JSON.parse(e.getAttribute("data-bem"))["serp-item"]);return _.map(o,this.getActualImages,this)}}),function(t){t.fn.animateRaf=function(t,e){function i(t,e){for(var i=0;i<e.length;i++)n(t,e[i])}function n(t,e){var i,n,a=e.duration,u=r(e.timing,a),l=function(){n||(n=Date.now()),i=o(e.from,e.to,n,a,u),t.css(s(e.property,i)),i!==e.to?h(l):c()};h(l)}function s(t,e){var i={},n=t,s=e;return"translateY"===t&&(n="transform",s="translateY("+e+"px)"),i[n]=s,i}function o(t,e,i,n,s){return(e-t)*s((Date.now()-i)/n)+t}function r(t,e){var i,n=1e3/60/e/4;switch(t){case"ease":i=a(.25,.1,.25,1,n);break;default:i=a(.08,.39,.25,1,n)}return i}function a(t,e,i,n,s){var o=function(e){var n=1-e;return 3*n*n*e*t+3*n*e*e*i+e*e*e},r=function(t){var i=1-t;return 3*i*i*t*e+3*i*t*t*n+t*t*t},a=function(e){var n=1-e;return 3*(2*(e-1)*e+n*n)*t+3*(-e*e*e+2*n*e)*i};return function(t){var e,i,n,c,h,u,l=t;for(n=l,u=0;8>u;u++){if(c=o(n)-l,Math.abs(c)<s)return r(n);if(h=a(n),Math.abs(h)<1e-6)break;n-=c/h}if(e=0,i=1,n=l,e>n)return r(e);if(n>i)return r(i);for(;i>e;){if(c=o(n),Math.abs(c-l)<s)return r(n);l>c?e=n:i=n,n=.5*(i-e)+e}return r(n)}}function c(){++u===t.length&&e&&h(e)}var h=window.requestAnimationFrame,u=0;return i(this,t),this}}(jQuery),BEM.DOM.decl("incut-controller",{onSetMod:{js:function(){BEM.blocks["b-page"].on("change",this._syncState,this),BEM.blocks["serp-controller"].on("loading",this._tryInitIncuts,this),BEM.blocks["serp-controller"].on("infiniteLoadStop",this._tryInitRelatedIncut,this),this._syncState()}},destruct:function(){BEM.blocks["b-page"].un("change",this._syncState,this),BEM.blocks["serp-controller"].un("loading",this._tryInitIncuts,this),BEM.blocks["serp-controller"].un("infiniteLoadStop",this._tryInitRelatedIncut,this),this.__base.apply(this,arguments)},_syncState:function(){this._serpList=void 0,this.incuts=this.findBlocksInside("incut"),this._tryInitIncuts()},_tryInitIncuts:function(){return this.incuts&&-1!==_.pluck(this.incuts,"isInserted").indexOf(!1)?(_.forEach(this.incuts,function(t){this._shouldShowIncut(t)&&this.initIncut(t.load())},this),this):this},_tryInitRelatedIncut:function(){return this.incuts&&-1!==_.pluck(this.incuts,"isInserted").indexOf(!1)?(_.forEach(this.incuts,function(t){-1===t.params.position&&this.initIncut(t.load())},this),this):this},_shouldShowIncut:function(t){var e=t.params,i=this._getSerpController(),n=this._getSerpList();return!t.isInserted&&{line:n&&n.isRowVisible(e.position-1),page:i.getListCount()===e.position,bottom:(i.getListCount()+1)%i.getScrollPagesCount()===0,top:!0}[e.positionType]},initIncut:function(t){var e,i,n=t.params;switch(n.positionType){case"line":e=-1===n.position?this._getSerpList().getPenultRowNum():n.position-1,i=this._getSerpList().getLastThumbOfRow(e),i.after(t.domElem.parent());break;case"page":this._getSerpList().appendIncutElem(t.domElem.parent());break;case"bottom":break;case"top":this._getSerpList().prependIncutElem(t.domElem.parent())}return t.setShown().checkFilling()},_getSerpList:function(){return this._serpList||(this._serpList=this.findBlockInside("serp-list"))},_getSerpController:function(){return this._serpController||(this._serpController=this.findBlockOn("serp-controller"))}}),BEM.DOM.decl("competitors",{onSetMod:{js:function(){BEM.blocks["i-global"].param("isPumpkin")&&this.delMod("visibility")}}}),BEM.DOM.decl("navigation",{onSetMod:{js:{inited:function(){this._selectedItem=-1,this._items=this.elem("item","service","yes").map(this.changeThis(this._processItem,this)),this._onWindowResize=$.throttle(this._onWindowResize,100,this),this._onWindowResize(),this.bindToWin("resize",this._onWindowResize)}}},onElemSetMod:{item:{state:{selected:function(t){t.attr({role:"link","aria-hidden":!0})},"":function(t){t.attr("role","listitem").removeAttr("aria-hidden")}}}},_processItem:function(t,e){var i=$(e),n=this.getMod(i,"name"),s=this.hasMod(i,"state","selected");return n?(s&&(this._selectedItem=t),$.extend(i,{_index:t,_cachedBottom:this._getBorders(i).bottom,_sticky:s}),i):null},_onWindowResize:function(){this.reflow()},reflow:function(){var t,e=this._getViewportThreshold(),i=this._items.length,n=0;for(t=i;t--;)this._items[t]._cachedBottom>e&&n++;if(n=this._reflowExtra(e,i,n),n===i)for(t=i;t--;)this.setMod(this._items[t],"stacked","yes");else{var s=n;for(t=i;t--;){var o=this._items[t];s&&!o._sticky?(this.setMod(o,"stacked","yes"),s--):this.delMod(o,"stacked")}}return n},_reflowExtra:function(t,e,i){return i},_onMoreClick:function(){},_getViewportThreshold:function(){return this.__self.win.height()},_getBorders:function(t){"number"==typeof t&&(t=this._items[t]),t instanceof $||(t=$(t));var e=t.outerHeight(),i=t.offset().top-BEM.DOM.win.scrollTop();return{top:i,bottom:e+i}}},{live:function(){return this.liveBindTo("more","pointerclick",function(t){this._onMoreClick(t)}).liveBindTo("more","keyup",function(t){t.shiftKey||t.ctrlKey||t.altKey||(13===t.which||32===t.which)&&this._onMoreClick(t)}),!1}}),BEM.DOM.decl("navigation",{_getBorders:function(){if(BEM.blocks["i-ua"].opera<13||BEM.blocks["i-ua"].ie<9){var t=this.elem("more").css("bottom");this.elem("more").css("bottom","0"),this.elem("more").offset().top,this.elem("more").css("bottom",t)}return this.__base.apply(this,arguments)}}),BEM.DOM.decl("navigation",{_getBorders:function(){return(BEM.blocks["i-ua"].opera||BEM.blocks["i-ua"].ie<=9)&&(this.elem("more").offset=function(){return{}}),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"navigation",modName:"more-type",modVal:"tablo"},{_onMoreClick:function(){var t=this._getHeader();t&&t.setMod(this._getActionSrv(t),"pressed","yes")},_getActionSrv:function(t){return t.elem("action","type","srv")},_getViewportThreshold:function(){return BEM.DOM.win.height()-this.elem("more").height()},_getHeader:function(){return this._header||(this._header=this.findBlockInside(BEM.DOM.doc,"header"))}}),BEM.DOM.decl({block:"navigation",modName:"more-type",modVal:"tablo"},{_onMoreClick:function(){this.__base.apply(this,arguments);var t=this._getHeader();t&&this._getActionSrv(t).focus()}}),BEM.DOM.decl("fade",{onSetMod:{progress:function(t,e){this.getSpin().setMod(t,e)}},getSpin:function(){return this._spin||(this._spin=this.findBlockInside("spinner")),this._spin},show:function(){this.setMod("progress","yes")},hide:function(){this.delMod("progress")}}),BEM.DOM.decl("internal",{onSetMod:{js:function(){function t(t){var i=t.params,n="bool"!=i.type?t.val():t.hasMod("checked")?1:0,s=t.domElem.find("[name]").attr("name");!e[i.rule]&&(e[i.rule]={}),e[i.rule][s]="&rearr="+s+"="+encodeURIComponent(n)}var e,i=this,n=this.findBlockInside("internal-table"),s=(this.findBlockInside("row","internal-table"),this.findBlockInside("wizard-debug","internal-table")),o=this.findBlockInside("rearrange","internal-table"),r=this.findBlockOutside("b-page").findBlockInside({blockName:"internal",modName:"for",modVal:"list"}),a=this.findBlockInside({blockName:"radio-button",modName:"type",modVal:"debug-switchers"}),c=this.findBlockInside({blockName:"checkbox",modName:"type",modVal:"rearrange"}),h=this.findBlockInside({blockName:"checkbox",modName:"type",modVal:"wizards"});this.cookieRelevSwitcher=this.domElem.parent().parent().find(".tumbler").bem("tumbler"),this.sbh=r&&r.params.sbh,this._isFullRelevance=!!this.sbh&&!!this.cookieRelevSwitcher,o&&(e=this.findBlockInside("rearrange","internal-table").params.rearr||{}),a&&a.on("change",function(){switch(this.val()){case"components":i.setMod(i.elem("eventlog"),"visibility","hidden"),i.delMod(i.elem("components"),"visibility"),localStorage.showComponents=!0;break;case"eventlog":i.setMod(i.elem("components"),"visibility","hidden"),i.delMod(i.elem("eventlog"),"visibility"),localStorage.showComponents=!1}i.delMod(i.elem("hide-debug"),"visibility")}),this.cookieRelevSwitcher&&this.cookieRelevSwitcher.on("change",function(){i._toggleInternal()}),a&&i.bindTo("hide-debug","click",function(){a.uncheckAll(),i.setMod(i.elem("hide-debug"),"visibility","hidden"),i.setMod(i.elem("components eventlog"),"visibility","hidden"),localStorage.showComponents=!1
}),"true"!==localStorage.showComponents&&i.elem("hide-debug").click(),s&&i.bindTo("wizards-switcher","click",function(){n.toggleMod(s.elem("row","working","no"),"visibility","visible")}),i.bindTo("rearrange-button","click",function(){var t=[],n=location.href,s={blockName:"checkbox",modName:"type",modVal:"components"};i.findBlocksInside("wizard-debug",s).forEach(function(e){!e.hasMod("checked")&&t.push("&rwr=-"+e.val())}),i.findBlocksInside("rearrange",s).forEach(function(i){var n,s=i.val();if(i.hasMod("checked")){if(e[s])for(n in e[s])t.push(e[s][n])}else t.push("&rearr="+s+"_off")});var o=i.findBlockOn("rearrange-button","button").params.confirmText;confirm(o)&&location.replace(n+t.join(""))}),i.bindTo("eventlog-button","click",function(){var t=i.findBlockOn("eventlog-button","button").params.confirmText;confirm(t)&&(document.location.href+="&dump=eventlog")});var u=this.findBlocksInside({block:"input",modName:"type",modVal:"rearr-param"})||[],l=this.findBlocksInside({block:"select",modName:"type",modVal:"rearr-param"})||[],d=this.findBlocksInside({block:"checkbox",modName:"type",modVal:"rearr-param"})||[];u.length&&$.each(u,function(e,i){i.on("change",function(){t(i)})}),l.length&&$.each(l,function(e,i){i.on("change",function(){t(i)})}),d.length&&$.each(d,function(e,i){i.on("change",function(){t(i)})}),c&&c.bindTo("click",function(){i._uncheckAllCheckboxes(this,"rearrange")}),h&&h.bindTo("click",function(){i._uncheckAllCheckboxes(this,"wizard-debug")}),i._toggleSwitchTree(i,"switch-ftree","ftree"),i._toggleSwitchTree(i,"switch-wzrdebug","wzrdebug"),this._initVisibility(),BEM.blocks["serp-list"].on("loaded",this._onListLoaded,this)}},destruct:function(){BEM.blocks["serp-list"].un("loaded",this._onListLoaded,this)},_onListLoaded:function(){var t=this._isFullRelevance?this.cookieRelevSwitcher.isChecked():!0;t&&this._showInternal(this._getInternalItems())},_initVisibility:function(){this.sbh&&(this._isFullRelevance?1==localStorage.showRelev&&this.cookieRelevSwitcher.toggle():this._toggleInternal())},_showInternal:function(t){t.forEach(function(t){t.delMod("visibility")})},_hideInternal:function(t){t.forEach(function(t){t.setMod("visibility","hidden")})},_toggleInternal:function(){var t=this._isFullRelevance?this.cookieRelevSwitcher.isChecked():!1;t?(this._hideInternal(this._getInternalSerpItems()),this._hideInternal(this._getInternalItems()),this._isFullRelevance&&(localStorage.showRelev=0,this.trigger("hideRelevance"))):(this._showInternal(this._getInternalSerpItems()),this._showInternal(this._getInternalItems()),this._isFullRelevance&&(localStorage.showRelev=1,this.trigger("showRelevance")))},_getInternalSerpItems:function(){return this.findBlockOutside("b-page").findBlocksInside({blockName:"serp-item",modName:"type",modVal:"internal"})},_getInternalItems:function(){return this.findBlockOutside("b-page").findBlocksInside("internal-item")},_toggleSwitchTree:function(t,e,i){t.bindTo(e,"click",function(){t.elem("info","type",i).show(),t.elem(e).hide()})},_uncheckAllCheckboxes:function(t,e){var i=this.findBlocksInside(e,{blockName:"checkbox",modName:"type",modVal:"components"});i.map(function(e){t.hasMod("checked","yes")?e.delMod("checked"):e.setMod("checked","yes")})}}),BEM.DOM.decl("internal-display-options",{onSetMod:{js:function(){this.relevDisplayOptions=this.canUseLocalStorage()&&localStorage.relevDisplayOptions?$.parseJSON(localStorage.relevDisplayOptions):{}}},canUseLocalStorage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},toggleInfoElems:function(t,e){var i=this,n=e.hasMod("opened");t.elem("info").each(function(){var e=$(this),s=t.getMod(e,"type");if(t.hasMod(e,"type","data")){var o=t.findBlockInside(e,"internal-data");o.elem("button-wrap").each(function(){var t=$(this),e=o.getMod(t,"type"),s=o.hasMod(t,"disabled");!n&&s?o.setMod(t,"visibility","hidden"):n&&s&&o.delMod(t,"visibility"),!n&&i.canUseLocalStorage()&&(i.relevDisplayOptions.buttons||(i.relevDisplayOptions.buttons={}),i.relevDisplayOptions.buttons[e]=s?0:1)})}else!n&&t.hasMod(e,"disabled")?t.setMod(e,"visibility","hidden"):n&&t.hasMod(e,"disabled")&&t.delMod(e,"visibility"),!n&&i.canUseLocalStorage()&&(i.relevDisplayOptions[s]=t.hasMod(e,"disabled")?0:1)}),!n&&i.canUseLocalStorage()&&(localStorage.relevDisplayOptions=JSON.stringify(i.relevDisplayOptions))},_relevDisplayOptionsInit:function(t,e){var i=this;e.forEach(function(t){t.elem("info").each(function(){var n=$(this),s=t.getMod(n,"type"),o=i.findBlockInside(n,{blockName:"checkbox",modName:"type",modVal:"display-options"});o?o.toggleMod("visibility","hidden"):(i._buildCheckboxes(s,n,"display-options"),t.findBlockInside(n,{blockName:"checkbox",modName:"type",modVal:"display-options"}).on("change",function(){var o=this;this.hasMod("checked")?t.delMod(n,"disabled"):t.setMod(n,"disabled","yes"),i._uncheckAllInternalCb(i,e,o,s)}))})}),t.forEach(function(e){var n=e,s=n.findBlockInside("internal-data");n.elem("info").each(function(){var e=$(this),s=n.getMod(e,"type"),o=i.findBlockInside(e,{blockName:"checkbox",modName:"type",modVal:"display-options"});n.hasMod(e,"type","data")||(o?o.toggleMod("visibility","hidden"):(i._buildCheckboxes(s,e,"display-options"),n.findBlockInside(e,{blockName:"checkbox",modName:"type",modVal:"display-options"}).on("change",function(){var o=this;this.hasMod("checked")?n.delMod(e,"disabled"):n.setMod(e,"disabled","yes"),i._uncheckAllInternalCb(i,t,o,s)})))}),s.elem("button-wrap").each(function(){var e=$(this),o=s.getMod(e,"type"),r=i.findBlockInside(e,{blockName:"checkbox",modName:"type",modVal:"display-buttons-options"});r?r.toggleMod("visibility","hidden"):(i._buildCheckboxes(o,e,"display-buttons-options",i.relevDisplayOptions.buttons),n.findBlockInside(e,{blockName:"checkbox",modName:"type",modVal:"display-buttons-options"}).on("change",function(){var n=this;this.hasMod("checked")?s.delMod(e,"disabled"):s.setMod(e,"disabled","yes"),this.hasMod("focused")&&t.forEach(function(t){var e=t,s=e.findBlockOutside("button-wrap","internal-data"),r=e.findBlockInside("internal-data"),a=r.findBlockInside(s,{blockName:"checkbox",modName:"for",modVal:o});i._unCheckIternalItems(a,n,r,s)})}))})})},_uncheckAllInternalCb:function(t,e,i,n){i.hasMod("focused")&&e.forEach(function(e){var s=e,o=i.findBlockOutside("info","internal"),r=s.findBlockInside(o,{blockName:"checkbox",modName:"for",modVal:n});t._unCheckIternalItems(r,i,s,o)})},_buildCheckboxes:function(t,e,i,n){BEM.DOM.prepend(e,BEMHTML.apply({block:"checkbox",mods:{size:"s",checked:n?n&&0===this.relevDisplayOptions.buttons[t]?"":"yes":0!==this.relevDisplayOptions[t]&&"yes",type:i,"for":t},checkboxAttrs:{name:t}}))},_unCheckIternalItems:function(t,e,i,n){t&&!t.hasMod("focused")&&(e.hasMod("checked")?(t.setMod("checked","yes"),i.delMod(n,"disabled")):(t.delMod("checked"),i.setMod(n,"disabled","yes")))}},{live:function(){return this.liveBindTo("display-button","click",function(){var t=this;this.internals=this.findBlockOutside("main").findBlocksInside({blockName:"internal",modName:"for",modVal:"list"}),this.iternalItems=this.findBlockOutside("main").findBlocksInside("internal-item"),this.toggleMod("opened","yes"),this._relevDisplayOptionsInit(this.iternalItems,this.internals),this.internals.forEach(function(e){t.toggleInfoElems(e,t)}),this.iternalItems.forEach(function(e){t.toggleInfoElems(e,t)})}),!1}}),BEM.DOM.decl("internal-data",{onSetMod:{js:function(){var t=this;t.findBlocksInside({blockName:"check-button",modName:"action",modVal:"info-request"}).forEach(function(e){e.bindTo("click",function(e){t.getInfo(e,this)})})}},getInfo:function(t,e){function i(t){return s.dataName||alert("infoReqConfig.dataName empty"),t?(n.analyzeMetadata(e,t,s,r),void n.showDataInfo(e,t,r,s)):void alert("document is empty")}var n=this,s=e.params,o=s.customImpl,r=n.params;return s.filterProps=s.defaultFilters?$.extend(!0,{},s.defaultFilters):{},o?void n.callFuncWithErrHandling(function(){switch(s.name){case"Doc attr":n.showDocAttr(r,s);break;case"Meta response":n.showMetaResponse(r,s);break;case"Markers":n.showMarkers(e,r,s);break;case"richtree":n.showRichTree(e,r,s);break;case"CGI":n.showCgiParams(e,r,s);break;case"CGI sep":n.showCgiSepParams(e,r,s);break;case"CGI snip":n.showSnipCgiParams(e,r,s);break;case"CGI snip sep":n.showSnipCgiSepParams(e,r,s)}}):s.cache?void n.switchInfo(e,s):void this.doInfoRequest(t,r,s,1,s.defaultFilters,i,null)},doInfoRequest:function(t,e,i,n,s,o,r,a){var c=this,h=c.getInfoHandlerUrl(e,i.requestType),u=c.getInfoRequestUrlForMetasearch(e,i,n,s,void 0);t&&t.ctrlKey&&alert(u),c.doHttpRequest(h,{url:u},o,r,a)},doHttpRequest:function(t,e,i,n,s){$.ajax({type:"POST",url:t,cache:!1,data:e,dataType:s?"text":"json",success:function(t,e){i(t,e)},error:function(t,e){alert(e+"\nresponse text:\n"+t.responseText),n&&n()}})},analyzeMetadata:function(t,e,i,n){function s(){return r.Relevance?"BOOKS"==n.serverDescr&&0x8000000000000000==n.docRelevance?!0:r.Relevance!=n.docRelevance?(alert("report: incorrect data received from server. incorrect metadata.Relevance: "+r.Relevance+"\ndocUrl: "+unescape(n.docUrl)+"\ndocRelevance: "+n.docRelevance+"\n try the same query with &nocache=da"),!1):!0:!0}function o(){var t={},i=e.MetaData;if(!i)return null;var n=i.rows;return t.PageCount=1,t.PageNumber=1,n.map(function(e){t[e.cells[0]]=e.cells[1]}),t.PageCount=parseInt(t.PageCount),t.PageNumber=parseInt(t.PageNumber),t}var r=o(e);r?(i.pageCount=r.PageCount,i.currentPage=r.PageNumber,i.ignoreRelev||s()||t.setMod("error","yes")):(i.pageCount=1,i.currentPage=1)},showDataInfo:function(t,e,i,n,s){function o(t){var e=1;return t.map(function(t){count=t.cells.length,count>e&&(e=count)}),e}var r=this,a={},c=e[n.dataName],h=c.rows||c.data;if(s||!n.cache){if(!c)return void r.showData(t,n,"no data returned from the server",null,"error");if(h.length>0)if("table"===c.type){var u=o(c.rows),l=[];c.rows.forEach(function(t,e){var s="",o="td",a="cell",c=!1;switch(t.t){case"0":break;case"1":o="th",a="head",c=!0;break;case"2":s="red";break;case"3":o="th",a="head",c=!0;break;default:alert("unknown row type: "+t.t)}var h=t.cells.map(function(t,h){return formatCell=n.cellFormatter?r.getFormatCell(t,n.dataName,h+1,e,i):t,{elem:a,mods:{color:s},js:{pos:h},tag:o,content:r._getTableContent(a,formatCell,c)}});if(h.length<u)for(var d=h.length;h.length<u;d++)h.push({elem:a,mods:{color:s},js:{pos:d},tag:o,content:r._getTableContent(a,"",c)});if(0===e&&"0"===t.t)var p=h.map(function(t,e){return{elem:"head",mix:[{block:"internal-table",elem:"head",mods:{empty:"yes"}}],js:{pos:e},tag:"th",content:[{elem:a+"-inner",content:""},{block:"input",mods:{size:"s"},mix:[{block:"internal-table",elem:"filter-input"}],content:{elem:"control"}}]}});l.push({elem:"row",tag:"tr",content:h}),0===e&&"0"===t.t&&l.unshift({elem:"row",tag:"tr",content:p})}),a=[{block:"internal-arrow",mods:{visibility:"hidden"},content:"►"},{block:"internal-table",tag:"table",content:l}]}else"text"===c.type&&(a={block:"internal-data",elem:"data-text",content:r._base64Decode(c.data)});else a={block:"internal-data",elem:"data-text",mods:{state:"error"},content:"the table is empty"};s?BEM.DOM.update(s,BEMHTML.apply({block:"internal-data",elem:"info-inner",content:a})):(n.cache=BEMHTML.apply({block:"internal-data",elem:"info",mods:{type:n.dataName},content:{elem:"info-inner",content:a}}),BEM.DOM.append(r.domElem,n.cache)),n.cache=r.elem("info","type",n.dataName);var d=r.findBlockInside(n.cache,"internal-table");d&&r.toggleFilterDataTable(d),n.filterControls&&(BEM.DOM.prepend(n.cache,BEMHTML.apply(r.createFilterControls(n,e))),r.initFilter(t,n,i)),n.pageCount>1&&(BEM.DOM.prepend(n.cache,BEMHTML.apply(r.createPagerControls(n))),r.initPager(t,n,i)),s||r.switchInfo(t,n),r.showTableArrow(d,n)}},_getTableContent:function(t,e,i){return[{elem:t+"-inner",content:e},i?{block:"input",mods:{size:"s"},mix:[{block:"internal-table",elem:"filter-input"}],content:{elem:"control"}}:""]},toggleFilterDataTable:function(t){var e=this;t.bindTo("head","click",function(i){this.head=$(i.data.domElem),this.elem("head").each(function(){t.hasMod($(this),"filter")&&t.delMod($(this),"filter")}),this.setMod(this.head,"filter","yes"),e.doFilterDataTable(this)}).bindToDoc("click",function(t){this.head&&(this.containsDomElem($(t.target))||this.delMod(this.head,"filter"))}).bindTo("cell","click",function(){this.head&&this.delMod(this.head,"filter")})},doFilterDataTable:function(t){function e(t,e){return t.toLowerCase().indexOf(e.toLowerCase())+1}var i=t.findBlockInside(t.head,"input"),n=t.elemParams(t.head).pos;i.hasMod("focused")||i.val(""),i.setMod("focused","yes"),i.on("change",function(){var i=this.val();t.elem("cell").each(function(){var s=t.elemParams($(this)).pos;n===s&&(e($(this).text(),i)?$(this).parent().show():$(this).parent().hide())})})},switchInfo:function(t,e){if(e.cache.toggle(),t.toggleMod("state","active"),t.setMod("pressed","yes"),!t.hasMod("state","active")){var i=this.findBlockInside(e.cache,"internal-arrow");this.setMod(this.findElem(e.cache,"info-inner"),"overflow","yes"),i&&i.delMod("visibility"),this.afterCurrentEvent(function(){t.delMod("pressed")})}},showTableArrow:function(t,e){var i=this,n=i.findBlockInside(e.cache,"internal-arrow");t&&(t.domElem.width()>e.cache.width()&&(i.setMod(i.findElem(e.cache,"info-inner"),"overflow","yes"),n.delMod("visibility")),n&&n.bindTo("click",function(){i.delMod(i.findElem(e.cache,"info-inner"),"overflow"),this.setMod("visibility","hidden")}))},getInfoHandlerUrl:function(t,e){return"//"+t.httpHost+"/search/inforequest?request_type="+e+"&doc_url="+t.docUrl},getInfoRequestUrlForMetasearch:function(t,e,i,n,s){return url=t.searchUrlFromEventLog,url=this.patchSearchUrl(url),url+=this.getInfoCgiParamStr(t,e,i,n,s)},getInfoCgiParamStr:function(t,e,n,s,o){var r=t.docId.indexOf("-"),a=t.docId.substr(r+1),c="&info="+e.requestType+":docid:"+a;if(t.docIndGen&&(c+=","+t.docIndGen),1!=n&&(c+=";p:"+n),o&&(c+=";dl:true"),null!=s)for(i in s){var h;h="boolean"==typeof s[i]?s[i]?"true":"false":s[i],c+=";flt_"+i+":"+this._base64Encode(h)}return c+";json"},patchSearchUrl:function(t){var e=this.getParamValue(t,"metahost");e&&(t=t.replace("&metahost="+e,""));var i=this.getParamValue(t,"p");if(!i)return t;if(i=parseInt(i),0==i)return t;var n=this.getParamValue(t,"g"),s=new RegExp("([^\\.]+\\.[^\\.]+\\.)([^\\.]+)(.+)"),o=s.exec(n);if(null==o)return alert("cannot parse grouping: "+n),t;var r=parseInt(o[2])*(i+1),a=n.replace(s,o[1]+r+o[3]);return t=t.replace("g="+n,"g="+a)},getParamValue:function(t,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=i.exec(t);return null==n?void 0:n[1]},getFormatCell:function(t,e,i,n,s){function o(t,e){return{block:"link",url:t,content:e}}function r(t,e){return{tag:"div",attrs:e&&{style:"width:"+e+"px"},content:t}}function a(t){return{tag:"span",content:t}}var c=this;switch(e){case"RelevFactors":case"FastRelevFactors":switch(i){case 1:t&&(t=[n-2+".&nbsp;",o(document.location.href+"&pron=sortby"+t,t)])}break;case"fm":switch(i){case 1:if("LR"==t){var h="FOREIGN"==s.serverDescr?"f":"r",u="https://ossa2.yandex.ru/dlnk/dlnk.py?query="+s.docUrl+"&amp;opt="+h;t=o(u,"LR")}}break;case"MatrixNet":case"MatrixNetFactors":switch(i){case 1:case 2:case 3:var l=c.htmlDecode(t).split("; "),d=l.map(function(t){return"*"==t.charAt(0)?(t=t.substr(1),"<b>"+c.htmlEncode(t)+"</b>"):c.htmlEncode(t)});t={elem:"inner",tag:"span",content:d.join("<br/>")}}break;case"MangoQuotes":switch(i){case 1:t=r(t,400);break;case 2:t=r(t,200);break;case 3:t=r(t,200);break;case 5:t=r(t)}break;case"Snippets":switch(i){case 1:case 2:t=a(t)}break;case"SnippetHits":switch(i){case 1:case 2:case 3:t={tag:"span",content:t}}break;case"SnippetDump":switch(i){case 1:t={tag:"div",content:[{block:"link",tag:"a",attrs:{style:"font-size:large",href:"data:text/plain,"+t,title:"Download the snippet context",target:"_blank"},content:"Download the snippet context"},{tag:"br"},"Use arcadia/tools/snipmake/csnip to decode"]}}}return t},createFilterControls:function(t,e){function i(t,e){return{block:"checkbox",mods:{size:"s"},mix:[{block:"internal-filters",elem:"name"}],checkboxAttrs:{name:t,value:"1"},content:{elem:"label",content:e}}}function n(t,e){return{block:"input",mods:{size:"s"},name:t,mix:[{block:"internal-filters",elem:t}],value:"",content:[{elem:"label",content:e},{elem:"control"}]}}function s(t,e,i){var n=[];return e.map(function(t){n.push({tag:"option",attrs:{value:t[1]},content:t[0]})}),{block:"internal-select",mods:i&&{submitonchange:"yes"},tag:"select",attrs:{name:t},content:n}}function o(t){return{block:"button",mods:{size:"s",valign:"middle"},mix:[{block:"internal-filters",elem:"submit"}],content:t}}function r(t){return{block:"internal-filters",elem:"label",tag:"span",content:t}}var a=[];switch(t.dataName){case"MatrixNet":a.push(n("factname","Factor name filter:"),i("usebias","Add bias"),i("usecoeff","Mult. by monom weight"),i("nodefault","Non-default trees only"));break;case"MatrixNetFactors":a.push(n("factname","Factor name filter:"),i("usebias","Add bias"),i("usecoeff","Mult. by monom weight"));break;case"MangoFactors":var c=this.getDataTableRowArrays(e.FactorGroupTypes);a.push(r("Factor group type: "),s("factor_group_type",c,!0));break;case"FreshRelevFactors":var c=this.getDataTableRowArrays(e.FactorGroupTypes);a.push(r("Factor slice:"),s("factor_group_type",c,!0));break;case"Snippets":var c=this.getDataTableRowArrays(e.SnippetsSectionNames);a.push(r("View mode: "),s("algoname",c,!0));break;case"SnippetHits":a.push(i("unpackall","Unpack all sentences",!0),i("markup","Show markup"),r("Archive: "),s("archive",[["Link","link"],["Text","text"]],!0))}return a.push(o("Apply")),{block:"internal-filters",content:{block:"internal-filters",elem:"form",tag:"form",attrs:{action:"#"},content:a}}},getDataTableRowArrays:function(t){var e=[];return t.rows.map(function(t){var i=[];t.cells.map(function(t){i.push(t)}),e.push(i)}),e},initFilter:function(t,e,i){function n(){for(p in l)d[p]=l[p];c.forEach(function(t){var e=t.elem("checkbox").attr("name");e in d&&(d[e]=t.isChecked())}),h.forEach(function(t){var e=t.elem("input").attr("name");e in d&&(d[e]=t.val())}),u.forEach(function(t){var e=t.domElem.attr("name");e in d&&(d[e]=t.domElem.val())}),e.filterProps=d}function s(){c.forEach(function(t){var e=t.elem("checkbox").attr("name");e in d&&d[e]&&t.setMod("checked","yes")}),h.forEach(function(t){var e=t.elem("input").attr("name");e in d&&t.val(d[e])}),u.forEach(function(t){var e=t.domElem.attr("name");e in d&&t.domElem.val(d[e])})}var o=this,r=o.elem("info","type",e.dataName),a=o.findBlockInside(r,"internal-filters"),c=a.findBlocksInside("checkbox"),h=a.findBlocksInside("input"),u=a.findBlocksInside("internal-select"),l=e.defaultFilters,d=e.filterProps;a.bindTo("form","submit",function(){return n(),o.loadPage(t,1,i,e,r),!1}),u.forEach(function(t){t.hasMod("submitonchange","yes")&&t.bindTo("change",function(){a.elem("form").submit()})}),s()},createPagerControls:function(t){var e={block:"internal-pager",content:[{block:"button",mods:{size:"s",pseudo:"yes"},mix:[{block:"internal-pager",elem:"first-page"}],content:"⇤"},{block:"button",mods:{size:"s",pseudo:"yes"},mix:[{block:"internal-pager",elem:"prev-page"}],content:"←"},"page ",{block:"input",mods:{size:"s"},mix:[{block:"internal-pager",elem:"form-input"}],value:t.currentPage,content:{elem:"control"}}," of "+t.pageCount,{block:"button",mods:{size:"s",pseudo:"yes"},mix:[{block:"internal-pager",elem:"next-page"}],content:"→"},{block:"button",mods:{size:"s",pseudo:"yes"},mix:[{block:"internal-pager",elem:"last-page"}],content:"⇥"}]};return e},initPager:function(t,e,i){function n(){1!=e.currentPage&&c.loadPage(t,1,i,e,h)}function s(){e.currentPage!=e.pageCount&&c.loadPage(t,e.currentPage+1,i,e,h)}function o(){1!=e.currentPage&&c.loadPage(t,e.currentPage-1,i,e,h)}function r(){e.currentPage!=e.pageCount&&c.loadPage(t,e.pageCount,i,e,h)}function a(n){return!n||1>n||n>e.pageCount?void alert("incorrect page number"):void c.loadPage(t,n,i,e,h)}var c=this,h=c.elem("info","type",e.dataName),u=c.findBlockInside(h,"internal-pager"),l=u.findBlockOn("form-input","input");u.bindTo("first-page","click",function(){n(t,i,e,h)}),u.bindTo("prev-page","click",function(){o(t,i,e,h)}),u.bindTo("next-page","click",function(){s(t,i,e,h)}),u.bindTo("last-page","click",function(){r(t,i,e,h)}),l.bindTo("control","keydown",function(t){13===t.keyCode&&a(parseInt(l.val()),10)})},showDocAttr:function(t,e){var i=this.getInfoHandlerUrl(t,e.requestType),n=this.getInfoRequestUrlForMetasearch(t,e,1,void 0,void 0);this.openWindowUsingPost(e,i,{url:n})},openWindowUsingPost:function(t,e,i){if(!t.cache){var n=[];for(p in i)n.push({tag:"input",attrs:{type:"text",name:p,value:i[p]}});t.cache=BEMHTML.apply({block:"internal-data",elem:"form",tag:"form",mods:{type:t.requestType},attrs:{action:e,target:"_blank",method:"post",style:"display: none"},content:n}),BEM.DOM.append(this.domElem,t.cache)}this.elem("form","type",t.requestType).submit()},showMetaResponse:function(t,e){var i=this.getInfoHandlerUrl(t,e.requestType),n=t.searchUrlFromEventLog+"&hr=da";this.openWindowUsingPost(e,i,{url:n,content_type:"text/plain"})},showMarkers:function(t,e,i){e.markers.length>0?this.showData(t,i,e.markers):this.showData(t,i,"no markers",null,"error")},showRichTree:function(t,e,i){function n(e){s.showData(t,i,e,null,null,!0)}var s=this;return i.cache?void s.switchInfo(t,i):void s.doInfoRequest(null,e,i,1,null,n,null,!0)},showCgiParams:function(t,e,i){return this.shouldReask()?void this.showData(t,i,e.firstStageUrl):!1},showSnipCgiParams:function(t,e,i){return this.shouldReask()?void this.showData(t,i,e.fetchStageUrl):!1},showCgiSepParams:function(t,e,i){return this.shouldReask()?void this.showData(t,i,this.beatutifyQueryString(e.firstStageUrl),!0):!1},showSnipCgiSepParams:function(t,e,i){return this.shouldReask()?void this.showData(t,i,this.beatutifyQueryString(e.fetchStageUrl),!0):!1},shouldReask:function(){for(var t=["nocache=da","fsgta=_SearchHttpUrl","gta=_SearchHttpUrl"],e="",i=0;i<t.length;++i)-1==document.location.href.indexOf(t[i])&&(e+="&"+t[i]);return e?confirm("To see cgi params you should reask query with "+e+"?")?void(document.location.href+=e):!1:!0},beatutifyQueryString:function(t){function e(t){return"rearr"==t||"relev"==t||"snip"==t}function i(t){var e=t.split(";").sort(),i=[];e.map(function(t){var e=t.split("="),n=[];n.push({elem:"cell",tag:"td",content:e[0]},{elem:"cell",tag:"td",content:e[1]?e[1]:""}),i.push({elem:"row",tag:"tr",content:n})});var n={block:"internal-table",tag:"table",content:i};return n}function n(t){t=t.sort();var e=[];return t.map(function(t){e.push({block:"internal-table",elem:"cgi-param",tag:"span",content:t})}),e}function s(t){t=t.sort();var e=[];return t.map(function(t){e.push(i(t))}),e}function o(t,o){var r;return r=o.length>1?e(t)?s(o):n(o):e(t)?i(o[0]):o[0]}var r=[],a=[],c=this.getUrlParameters(t);for(var h in c)a.push(h);a=a.sort(),a.map(function(t){var e=c[t],i=[];i.push({elem:"cell",tag:"td",content:t},{elem:"cell",tag:"td",content:o(t,e)}),r.push({elem:"row",tag:"tr",content:i})});var u={block:"internal-table",tag:"table",content:r};return u},getUrlParameters:function(t){var e={},i=t.split("?");i.length>1&&(t=i[1]);var i=t.split("#");i.length>1&&(t=i[0]),i=t.split("&");for(var n=0;n<i.length;++n)if(i[n]){var s=i[n].split("="),o=s.length>1?unescape(s[1]):"";e[s[0]]?e[s[0]].push(o):e[s[0]]=[o]}return e},showData:function(t,e,i,n,s,o){e.cache||(e.cache=BEMHTML.apply({block:"internal-data",elem:"info",mods:{type:e.dataName},content:n?i:{block:"internal-data",elem:"data-text",mods:s&&{state:"error"},content:[o?{tag:"pre",content:i}:this.htmlEncode(i)]}}),BEM.DOM.append(this.domElem,e.cache),e.cache=this.elem("info","type",e.dataName)),this.switchInfo(t,e)},loadPage:function(t,e,i,n,s){var o=this,r=function(e){o.callFuncWithErrHandling(function(){o.analyzeMetadata(t,e,n,i),o.showDataInfo(t,e,i,n,s)})};o.doInfoRequest(null,i,n,e,n.filterProps,r,null)},callFuncWithErrHandling:function(t){try{t()}catch(e){var i="Unknown error in report: ";e&&(i+=e.message?e.message:e),alert(i)}},htmlEncode:function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode:function(t){return String(t).replace(/(&amp;)/g,"&").replace(/(&quot;)/g,'"').replace(/(&#39;)/g,"'").replace(/(&lt;)/g,"<").replace(/(&gt;)/g,">")},_base64Encode:function(t){function e(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}var i,n,s,o,r,a,c,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_,",u="",l=0;for(t=e(t);l<t.length;)i=t.charCodeAt(l++),n=t.charCodeAt(l++),s=t.charCodeAt(l++),o=i>>2,r=(3&i)<<4|n>>4,a=(15&n)<<2|s>>6,c=63&s,isNaN(n)?a=c=64:isNaN(s)&&(c=64),u=u+h.charAt(o)+h.charAt(r)+h.charAt(a)+h.charAt(c);return u},_base64Decode:function(t){function e(t){for(var e="",i=0,n=c1=c2=0;i<t.length;)n=t.charCodeAt(i),128>n?(e+=String.fromCharCode(n),i++):n>191&&224>n?(c2=t.charCodeAt(i+1),e+=String.fromCharCode((31&n)<<6|63&c2),i+=2):(c2=t.charCodeAt(i+1),c3=t.charCodeAt(i+2),e+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),i+=3);return e}var i,n,s,o,r,a,c,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_,",u="",l=0;for(t=t.replace(/[^A-Za-z0-9\-\_\,]/g,"");l<t.length;)o=h.indexOf(t.charAt(l++)),r=h.indexOf(t.charAt(l++)),a=h.indexOf(t.charAt(l++)),c=h.indexOf(t.charAt(l++)),i=o<<2|r>>4,n=(15&r)<<4|a>>2,s=(3&a)<<6|c,u+=String.fromCharCode(i),64!=a&&(u+=String.fromCharCode(n)),64!=c&&(u+=String.fromCharCode(s));return u=e(u)}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this._items=[],this._curItemIndex=-1,this._scrollableElemOutsidePopup=null,this._rowHeight=22,this.on("change",this._redrawParentPopup);var t=this._getSelectedText();t&&t!==this._getButtonText()&&this.elem("control").trigger("change")}},disabled:function(t,e){var i="yes"===e;this.elem("control").attr("disabled",i),this._getButton().setMod(t,e),i&&this.delMod("opened").delMod("focused")},focused:{yes:function(){return this.hasMod("disabled","yes")?!1:(this._useNativeControl()||this.bindTo("keydown",this._onKeyDown),void this.afterCurrentEvent(function(){this.trigger("focus")}))},"":function(){this._useNativeControl()||this.delMod("opened").unbindFrom("keydown"),this.afterCurrentEvent(function(){this.trigger("blur")})}},opened:function(t,e){this._getButton()&&this._getButton().domElem&&this._getButton().toggleMod("arrow","up","down","yes"===e)}},isDisabled:function(){return this.hasMod("disabled","yes")},isOpened:function(){return this.hasMod("opened","yes")},open:function(){return this.setMod("opened","yes")},close:function(){return this.delMod("opened")},val:function(t,e){if("undefined"==typeof t)return this.elem("control").val();var i,n=-1;return this.findElem("option").each(function(e){this.value===t&&!this.disabled&&(i=$(this).parent("optgroup")[0],!(i&&i.disabled))&&(n=e)}),n>-1&&this._selectedIndex(n,e),this},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_selectedIndex:function(t,e){var i=this._getSelectedIndex();return"undefined"==typeof t||t===i?i:(this.elem("control").prop("selectedIndex",t),this._useNativeControl()||(this._setButtonText(this._getSelectedText()),this._items[0]&&this.delMod(this._items,"selected").setMod(this._items.eq(t),"selected","yes")),this.trigger("change",$.extend({index:t,prev:i},e)),t)},setOptions:function(t){return t?(BEM.DOM.update(this.elem("control"),BEMHTML.apply($.map(t,this.__self._buildOption))),this.redraw()):this},redraw:function(){return this._popup&&this._redrawList(),this.elem("control").trigger("change"),this},_useNativeControl:function(){return null!==this.__self.useNativeControl?this.__self.useNativeControl:this.__self.useNativeControl="none"!==this.elem("control").css("display")},_redrawParentPopup:function(){return this._isParentPopup()&&this._popup._parent.repaint(),this},_isParentPopup:function(){return this._popup&&this._popup._parent&&!this.hasMod("layout","fixed")},_onSelectChange:function(){var t=this;t._setButtonText(t._getSelectedText()),t.trigger("change",{index:t._getSelectedIndex(),prev:-1})},_onControlFocusInOut:function(t){this._useNativeControl()&&this.toggleMod("focused","yes","","focusin"===t.type)},_onMouseDown:function(t){this._isControlFocused()&&t.preventDefault()},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode===e.UP,n=t.keyCode===e.DOWN,s=t.keyCode===e.ENTER,o=t.keyCode===e.SPACE;if(i||n){if(t.preventDefault(),!this.isOpened())return this.open();var r=this._items.length,a=this._curItemIndex;if(i&&0===a||n&&a>r-2)return;if(r){var c,h=n?1:-1;for(c=a;c>=0&&r>=c;)if(c+=h,this._isSelectableItem(this._items.eq(c))){a=c;break}this._onEnterItem(this._items.eq(a),!0)}}(s||o)&&this._onEnterItem(this._items.eq(this._curItemIndex),!0,!0)},_onEnterItem:function(t,e,i){this.elem("button").attr("aria-activedescendant",t.attr("id"));var n=this._curItemIndex,s=this._getItemIndex(t),o=this._items;n>-1&&this.delMod(o.eq(n),"hovered"),s>-1&&(this._curItemIndex=s,this.setMod(o.eq(s),"hovered","yes")),i&&this._selectedIndex(this._curItemIndex),e&&this._scrollToCurrent()},_onLeaveItem:function(t){var e=this._curItemIndex;e>-1&&e===this._getItemIndex(t)&&(this.delMod(this._items.eq(e),"hovered")._curItemIndex=-1)},_onSelectItem:function(t){return this._isSelectableItem(t)&&this._selectedIndex(this._curItemIndex),this.close()},_onButtonFocus:function(){this.setMod("focused","yes")},_findScrollableElemOutsidePopup:function(){if(null===this._scrollableElemOutsidePopup){var t,e=this._getPopup().domElem;do e=e.parent(),t=e.css("overflow-y");while("scroll"!==t&&"auto"!==t&&"HTML"!==e.prop("tagName"));this._scrollableElemOutsidePopup=e}return this._scrollableElemOutsidePopup},_onButtonBlur:function(){if(this.isOpened()&&this._isPopupFocused())if(8===BEM.blocks["i-ua"].ie){var t=this._findScrollableElemOutsidePopup(),e=t.scrollTop();this._focusButton(),t.scrollTop(e)}else this._focusButton();else this.delMod("focused")},_onButtonPress:function(){this.toggleMod("opened","yes","")},_focusButton:function(){return this._getButton().setMod("focused","yes"),this},_blurButton:function(){return this._getButton().delMod("focused"),this},_isPopupFocused:function(){try{return this._getPopup().containsDomElem($(document.activeElement))}catch(t){return!1}},_getButtonText:function(){return this._getButton().elem("text").text()},_setButtonText:function(t){t.length&&(this._getButton().elem("text").text(t),BEM.blocks["i-ua"].ie<10&&this.domElem.parent().css("outline",""))},_isOutsideClicked:function(t,e){return this.containsDomElem($(e.target))},_getItemIndex:function(t){return $.inArray(t.get(0),this._items)},_getSelectedText:function(){return this.elem("control").find(":selected").text()},_getSelectedIndex:function(){return this.elem("control").prop("selectedIndex")},_isSelectableItem:function(t){var e;return e=this.hasMod(t,"disabled","yes")||this.hasMod(t,"label","yes")?!1:!0},_getButton:function(){return this._button||(this._button=this.findBlockOn("button","button"))},_getRowHeight:function(){return this.findElem(this._getPopup().domElem,"item").outerHeight()},_isControlFocused:function(){try{return this.containsDomElem($(this.__self.doc[0].activeElement))}catch(t){return!1}},destruct:function(){this._outPopup&&this._outPopup.un("outside-click"),this.delMod("opened"),this._popup&&this._popup.domElem&&BEM.DOM.destruct(this._popup.domElem),this.__base.apply(this,arguments)},getDefaultParams:function(){return{rows:15,popupMods:{direction:"down"}}}},{live:function(){this.liveBindTo("control","change",function(){this._onSelectChange()}),this.liveBindTo("control","focusin focusout",function(t){this._onControlFocusInOut(t)
}),this.liveBindTo("mousedown",function(t){this._onMouseDown(t)}),this.liveInitOnBlockInsideEvent("focus","button",function(){this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button",function(){this._onButtonBlur()}).liveInitOnBlockInsideEvent("press","button",function(){this._onButtonPress()})},useNativeControl:null,_buildOption:function e(t){var i={};return"option"===t.item?(i={block:"select",elem:"option",tag:"option",attrs:{value:t.value},content:t.content},t.disabled&&(i.attrs.disabled="disabled"),t.selected&&(i.attrs.selected="selected")):"optgroup"===t.item&&(i={elem:"option-group",tag:"optgroup",attrs:{label:t.label}},t.disabled&&(i.attrs.disabled="disabled"),i.content=Array.isArray(t.content)?t.content.map(e):t.content),i.block="select",i}}),BEM.DOM.decl("select",{onElemSetMod:{item:{hovered:function(){BEM.blocks["i-ua"].opera<13&&this._popup.domElem.css("display","inline").css("display","")}}}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._initButton()}}},_initButton:function(){},_redrawList:function(){var t,e=this,i=this._getPopup().domElem;return BEM.DOM.update(this.findElem(i,"list"),this.__self._buildItemsHtml(this.elem("control").children())),t=this.findElem(i,"item"),this._curItemIndex=-1,this._items=t.filter(function(){return!e.hasMod($(this),"label","yes")}),this.bindTo(e._items,{pointerclick:function(t){t.preventDefault(),e._onSelectItem(t.data.domElem)},pointerover:function(t){e._onEnterItem(t.data.domElem)},pointerout:function(t){e._onLeaveItem(t.data.domElem)}}),this}},{_buildItemsHtml:function(t){function e(t,e,i){var n={block:"select",elem:"item",content:{elem:"text",tag:"span",content:e||" &nbsp; "},elemMods:{}};return i&&(n.elemMods=i),n}function i(t,n){var c=t.length;if(c){var h=0;do{var u=$(t[h]),l=u.attr("disabled")&&{disabled:"yes"};if(u.is("optgroup")){a=!0,!u.prev().is("optgroup")&&h>0&&o.push(s),r.push(o),o=[],o.push(e(u,u.attr("label"),$.extend({label:"yes"},l,n))),i(u.children(),$.extend({inner:"yes"},l,n));var d=o;o=r.pop(),o.push({block:"select",elem:"group",content:d})}else o.push(e(u,u.html(),$.extend(l,u.is(":selected")&&{selected:"yes"},n)))}while(++h<c||(a=!1))}}var n="select",s={block:n,elem:"separator",tag:"i"},o=[],r=[],a=!1;return i(t),BEMHTML.apply(o)}}),BEM.DOM.decl("select",{onSetMod:{opened:{yes:function(){if(this.hasMod("disabled","yes"))return!1;this._drawPopup();var t=this.findElem(this._popup.domElem,"item","selected","yes");this.elem("button").attr({"aria-activedescendant":t.attr("id"),"aria-expanded":!0})},"":function(){this.elem("button").attr("aria-expanded",!1).removeAttr("aria-activedescendant"),this._getPopup().hide()}}},_getPopupContent:function(t){return{block:t,elem:"list"}},_getPopupMix:function(t){return{block:t,elem:"popup",elemMods:{}}},_getPopup:function(){if(this._popup)return this._popup;var t=this,e=t.params,i=t.__self.getName(),n=this._getPopupContent(i),s=this._getPopupMix(i),o={animate:"no"},r={directions:[{to:"bottom",axis:"left",offset:{top:8}},{to:"top",axis:"left",offset:{bottom:8}}]};["size","layout","theme","width"].forEach(function(e){t.hasMod(e)&&(s.elemMods[e]=t.getMod(e))}),$.extend(s.elemMods,e.elemPopupMods),$.extend(o,e.popupMods),$.extend(r,e.popupParams);var a=$(BEMHTML.apply({block:"popup",mods:o,mix:s,js:r,content:{elem:"content",content:n}}));return this._popup=this.findBlockOn(a,"popup"),this._popup.on({show:function(){t._curItemIndex=t._getSelectedIndex();var e=t._items.eq(t._curItemIndex);t.delMod(t._items,"selected").setMod(e,"hovered","yes").setMod(e,"selected","yes")},"outside-click":function(e,i){t._isOutsideClicked(e,i)?e.preventDefault():t._blurButton()},hide:function(){t.delMod("opened").delMod(t._items,"hovered").delMod(t.findElem(t._popup.domElem,"popup"),"scrollable")}}).bindTo("mousedown",function(t){t.preventDefault()}),BEM.DOM.append(BEM.DOM.scope,t._popup.domElem),t._redrawList(),t._outPopup=t.findBlockOutside("button","popup"),t._outPopup&&t._outPopup.on("outside-click",function(e,i){t._popup.containsDomElem($(i.target))&&e.preventDefault()}),t._popup},_calcPopupDimensions:function(){this._popupContent||(this._popupContent=this._getPopup().findBlockInside("popup").elem("content"));var t=parseInt(this.params.rows,10),e=this._getPopup();if(t&&this.findElem(this._popupContent,"item").size()>t){this._rowHeight=this._getRowHeight();var i=parseInt(e.domElem.css("height"),10),n=t*this._rowHeight;i!==n&&(e.setSize({height:n}),i>n&&this.setMod(this.findElem(e.domElem,"popup"),"scrollable","yes"))}else e.setSize({height:"auto"})},_drawPopup:function(){var t=this.findBlockInside("select"),e=this._getPopup();e.show(t),this._calcPopupDimensions(),this._scrollToCurrent()},_scrollToCurrent:function(){if(this._popupContent&&!(this._curItemIndex<0)){var t,e=this._items.eq(this._curItemIndex).get(0).offsetTop,i=this._popupContent,n=i.scrollTop(),s=e-n,o=2*this._rowHeight;s>i.height()-o?t=e-o:n&&o>s&&(t=e-i.height()+o),t&&i.scrollTop(t)}}},{SHADOW_OFFSET:1}),BEM.DOM.decl({block:"tumbler",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._check(this.hasMod("checked"));var t=this.elem("button").width();this._maxLeft=this.elem("box").width()-t,this._buttonWidth=t,this.elem("button").attr({role:"button","aria-pressed":this.hasMod("checked")}),this.elem("input").attr({tabindex:-1,"aria-hidden":!0})}},checked:function(t,e){this._check(e),this.elem("button").attr("aria-pressed","yes"===e),this.trigger("change",{checked:Boolean(e),value:this.val()})},disabled:function(t,e){this.__base.apply(this,arguments),this.elem("input").prop("disabled","yes"===e)}},toggle:function(){return this.toggleMod("checked","yes")},uncheck:function(){return this.delMod("checked")},check:function(){return this.setMod("checked","yes")},val:function(t){if("undefined"==typeof t)return this.elem("input").filter(":checked").val();var e=this.elem("input").filter(function(){return this.value===t});return e.length&&this[e.is(this.buildSelector("input","side","right"))?"check":"uncheck"](),this},isChecked:function(){return this.hasMod("checked")},isDisabled:function(){return this.hasMod("disabled","yes")},_check:function(t){return this.elem("input","side",t?"right":"left").attr("checked",!0)},_onChange:function(){return this.hasMod("disabled")?this:this.toggleMod("checked","yes")},_onInputClick:function(t){return this.toggleMod("checked","yes","right"===this.getMod(t.data.domElem,"side"))},_onPointerpress:function(){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_setPositions:function(t,e){var i=Math.min(Math.max(t+e,0),this._maxLeft);this.elem("button").css("left",i),this.elem("sticker","position","left").css("width",i+this._buttonWidth),this.elem("sticker","position","right").css("width",this._maxLeft-i+this._buttonWidth)}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("sticker","pointerclick",function(){this.hasMod("disabled")||this._onChange().setMod("focused","yes")}).liveBindTo("input","change",function(t){this._onInputClick(t)}).liveBindTo("button","keydown",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||BEM.blocks.keycodes.is(t.keyCode,"SPACE","LEFT","UP","RIGHT","DOWN")&&t.preventDefault()}).liveBindTo("button","keyup",function(t){var e=BEM.blocks.keycodes,i=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||(e.is(i,"ENTER","SPACE")?this._onChange():e.is(i,"LEFT","UP")?this.delMod("checked"):e.is(i,"RIGHT","DOWN")&&this.setMod("checked","yes"))}).liveBindTo("button","pointerpress",function(t){if(this.hasMod("disabled"))return!1;var e=t.clientX,i=this.elem("button").position().left,n=!1,s=!1;this.bindToDoc("pointermove",$.throttle(function(t){n=this.hasMod("checked")?t.clientX<e:t.clientX>e,!s&&n&&this._setPositions(i,t.clientX-e)},30)).bindToDoc("pointerrelease",function(){if(s=!0,n){var t=parseInt(this.elem("button").css("left"),10)>this._maxLeft/2;this.toggleMod("checked","yes",t),this.elem("button").css("left",""),this.elem("sticker").css("width","")}else this.toggleMod("checked","yes");this.unbindFromDoc("pointermove pointerrelease")})}),this.__base()}}),BEM.DOM.decl("tumbler",{_onPointerenter:function(){this.hasMod(this.elem("button"),"hovered")||this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onButtonPointerenter:function(){this.delMod("hovered").setMod(this.elem("button"),"hovered","yes")},_onButtonPointerleave:function(){this.delMod(this.elem("button"),"hovered").setMod("hovered","yes")}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("button","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("button")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onButtonPointerenter(t):this._onButtonPointerleave(t))}),this.__base()}}),BEM.DOM.decl("i-debugger",{onSetMod:{js:function(){this.bindTo("name","click",function(t){this.toggleMod(t.data.domElem.parent(),"collapsed","yes","")}).bindTo("name","dblclick",function(t){this.toggleMod(t.data.domElem.parent().children(".i-debugger__val").children(".i-debugger__node"),"collapsed","yes","")})}}}),BEM.DOM.decl("mobile-suggest",{onSetMod:{js:function(){this.findBlocks().bindEvents(),this.header.setMod("mobile-suggest","yes"),this.fade.setMod("mobile-suggest","yes")}},findBlocks:function(){return this.rejectButton=this.findBlockInside({block:"button",modName:"action",modVal:"reject"}),this.acceptButton=this.findBlockInside({block:"button",modName:"accept",modVal:"yes"}),this.page=this.findBlockOutside("b-page"),this.header=this.page.findBlockInside("header"),this.fade=this.page.findBlockInside({block:"fade",modName:"region",modVal:"main"}),this},bindEvents:function(){return this.rejectButton.on("click",this._onReject,this),BEM.blocks["b-page"].on("scroll",this._onPageScroll,this).on("change",this._onPageChange,this),this},destruct:function(){this.__base.apply(this,arguments),this.rejectButton.un("click",this._onReject,this),BEM.blocks["b-page"].un("scroll",this._onPageScroll,this).un("change",this._onPageChange,this)},_onReject:function(){var t=this.params,e=t.today,i=$.cookie("nmb")?"2":"1:"+e;this.fold(),$.cookie("nmb",i,{expires:365,path:"/"+t.service})},_onPageScroll:function(){this.domElem.css("left",BEM.DOM.win.scrollLeft())},fold:function(){this.header.delMod("mobile-suggest"),this.fade.delMod("mobile-suggest"),this.destruct()},_onPageChange:function(){this.updateMobileLink()},updateMobileLink:function(){var t=this.acceptButton.domElem.attr("href"),e=BEM.blocks.uri.getParamValue(t,"retpath"),i=BEM.blocks.uri.getParamValue("text"),n=BEM.blocks.uri.parse(e),s=_.isEmpty(i)?n.getRoot():n.getRoot()+"/search?text="+encodeURIComponent(i);this.acceptButton.domElem.attr("href",BEM.blocks.uri.setParam(t,"retpath",s))}}),BEM.DOM.decl("cookies",{onSetMod:{js:function(){this.__self.save(this.params.cookies)}}},{save:function(t){_.forEach(t,function(t){document.cookie=t})}}),function(){BEM.DOM.decl("b-mooa",{onSetMod:{js:function(){var e=this,i=e.params.checker,n=function(){e._show()};if($.isFunction(i))i.call(e,n);else if("string"==typeof i){if(!t[i])throw'b-mooa: undefined checker "'+i+'"';t[i].call(e,n)}else i&&n()},loading:{progress:function(){var t=this;BEM.blocks["i-loader"].load("b-mooa",t.params.bundlePath,function(){t._onBundleSuccess()},function(){t._onBundleError()},t.params.lang)}}},_show:function(){this.setMod("visibility","visible")},_onOpenClick:function(){this.setMod("loading","progress")},_onBundleError:function(){this.delMod("loading")},getDefaultParams:function(){return{checker:function(t){BEM.blocks["i-user-services"].get(function(e){e.sids[668]&&t()})},bundlePath:BEM.blocks["i-global"].param("lego-static-host")+"/blocks-desktop/b-mooa/_b-mooa.bembundle.js",standId:"test",apiUrl:"http://b.yandex.ru/api/1.0/",panels:[{type:"bug",title:BEM.I18N("b-mooa","error")},{type:"idea",title:BEM.I18N("b-mooa","idea")}],lang:BEM.blocks["i-global"].param("lang")}}},{regChecker:function(e,i){t[e]=i},live:function(){return this.liveBindTo("open","pointerclick",function(){this._onOpenClick()}),!1}});var t={}}(),function(t,e){var i,n={},s=BEM.decl("i-loader",{},{load:function(t,o,r,a,c){"string"!=typeof o&&(c=a,a=r,r=o,o=t),void 0===c&&void 0!==a&&"function"!=typeof a&&(c=a,a=void 0);var h=n[t];if(h)return void(h.successFns?(h.successFns.push(r),a&&h.errorFns.push(a)):this.afterCurrentEvent(function(){r()}));var u=document,l=u.createElement("script"),d=function(){s._error(t)},p=o.split("."),f=p.splice(-2,2);c&&f.unshift("string"==typeof c?c:BEM.blocks["i-global"].param("lang")),BEM.blocks["i-ua"].ie<9&&f.splice(-1,0,"ie"),l.type="text/javascript",l.charset="utf-8",l.src=p.concat(f).join("."),l.onerror=d,this.afterCurrentEvent(function(){(i||(i=e("head")[0])).insertBefore(l,i.firstChild)}),n[t]={successFns:[r],errorFns:a?[a]:[],timer:setTimeout(d,2e4)}},loaded:function(e){var i,o=n[e.id];if(clearTimeout(o.timer),e.js&&e.js(),e.css&&s._appendCss(e.css),e.hcss){var r=t._ycssjs;i=[],e.hcss.forEach(function(t){if(r){if(t[0]in r)return;r(t[0])}i.push(t[1])}),i.length&&s._appendCss(i.join(""))}if(e.hcss2){var a,c=e.hcss2,h=document,u=h.createElement("div"),l=h.body,d="ycssjs_";i=[],u.style.position="absolute",l.insertBefore(u,l.lastChild.nextSibling),a=window.getComputedStyle?window.getComputedStyle(u):u.currentStyle,Object.keys(c).forEach(function(t){u.className=d+t,"-"===a.top.charAt(0)||i.push(c[t])}),a=null,l.removeChild(u),i.length&&s._appendCss(i.join(""))}for(var p,f=o.successFns;p=f.shift();)p();delete o.successFns},_error:function(t){var e,i=n[t],s=i.errorFns;for(clearTimeout(i.timer);e=s.shift();)e();delete n[t]},_appendCss:function(t){var e=document.createElement("style");e.type="text/css",i.insertBefore(e,i.firstChild),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}})}(this,jQuery),function(t,e,i){function n(t,e,i){(t[e]||(t[e]=[])).unshift(i)}function s(t,e){return e.modName?function(i){(i._curBlock.mods||{})[e.modName]===e.modVal&&t(i)}:t}function o(t,i){var n,s=e.isArray(i);return e.isArray(t)?s?n=t.concat(i):(n=t).push(i):s?(n=i).unshift(t):n=[t,i],n}function r(t){return t.replace(f,function(t){return p[t]})}var a=t.INTERNAL,c=a.ELEM_DELIM,h={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1},u=a.buildClass,l=a.buildClasses,d={},p={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"},f=/["&<>]/g;t.HTML={decl:function(t,i){"string"==typeof t&&(t={block:t}),t.name&&(t.block=t.name);var o=d[t.block]||(d[t.block]={});i.onBlock&&n(o,"_block",s(i.onBlock,t)),i.onElem&&(e.isFunction(i.onElem)?n(o,"_elem",s(i.onElem,t)):e.each(i.onElem,function(e,i){n(o,"_elem"+("*"===e?"":c+e),s(i,t))}))},build:function(t){var e=new this.Ctx(t);return e._buildAll(),e._flush()},Ctx:e.inherit({__constructor:function(t){this._buffer=[],this._params=t,this._tParams=null,this._tParamsChanges=null,this._curBlock=i},pos:function(){return this._params._pos},isFirst:function(){return 1===this._params._pos},isLast:function(){var t=this._params;return t._pos===t._siblingsCount},params:function(t){var e=this;return"undefined"==typeof t?e._params:(e._params=t,e)},param:function(t,i,n,s){var o=this,r=o._params;return"undefined"==typeof i?r[t]:(!n&&t in r?s&&(r[t]=e.extend(i,r[t])):r[t]=i,o)},attrs:function(t,e){return this.param("attrs",t,e,!0)},attr:function(t,e,i){var n=this;if("undefined"==typeof e)return(n._params.attrs||{})[t];var s=n._params.attrs;return s?(i||!(t in s))&&(s[t]=e):(n._params.attrs={})[t]=e,n},tag:function(t,e){return this.param("tag",t,e)},cls:function(t,e){return this.param("cls",t,e)},mods:function(t,e){return this.param("mods",t,e,!0)},mod:function(t,e,i){var n=this;if("undefined"==typeof e)return(n._params.mods||{})[t];var s=n._params.mods;return s?(i||!(t in s))&&(s[t]=e):(n._params.mods={})[t]=e,n},mix:function(t,e){var i=this,n=i._params;return"undefined"==typeof t?n.mix:(n.mix=!e&&"mix"in n?n.mix.concat(t):t,i)},js:function(t){return this.param("js",t)},content:function(t,e){return this.param("content",t,e)},wrapContent:function(t){var e=this,i=e._params;return t.content=i.content,i.content=t,e},beforeContent:function(t){var e=this,i=e._params;return i.content=o(t,i.content),e},afterContent:function(t){var e=this,i=e._params;return i.content=o(i.content,t),e},wrap:function(t){var e=this,i=e._params;return t.block||(t._curBlock=e._curBlock),t.content=i._wrapper?i._wrapper:i,i._wrapper=t,e},tParam:function(t,e){var i=this,n=i._tParams||(i._tParams={});if("undefined"==typeof e)return n[t];var s=i._tParamsChanges||(i._tParamsChanges={});return t in s||(s[t]=n[t]),n[t]=e,i},generateId:function(){return e.identify()},stop:function(){this._params._isStopped=!0},_buildAll:function(){var t=this,i=t._buffer,n=t._params,s=typeof n;if("string"===s||"number"===s)i.push(n);else if(e.isArray(n))for(var o,r,a=0,c=n.length;c>a;)t._params=o=n[a++],r=typeof o,"string"===r||"number"===r?i.push(o):o&&(o._pos=a,o._siblingsCount=c,t._buildByDecl());else n&&(t._params._pos=t._params._siblingsCount=1,t._buildByDecl())},_build:function(){var t,i=this,n=i._buffer,s=i._params,o=s.tag||"div",a=s.block||s.elem,c=a&&(s.block||i._curBlock.block),d=!1;s.js&&((t={})[u(c,s.elem)]=s.js===!0?{}:s.js,d=!s.elem),n.push("<",o),(a||s.cls)&&(n.push(' class="'),a&&(l(c,s.elem,s.mods,n),s.mix&&e.each(s.mix,function(e,i){i&&(n.push(" "),l(i.block,i.elem,i.mods,n),i.js&&((t||(t={}))[u(i.block,i.elem)]=i.js===!0?{}:i.js,d||(d=!i.elem)))})),s.cls&&n.push(a?" ":"",s.cls),d&&n.push(" i-bem"),n.push('"')),t&&n.push(' onclick="return ',r(JSON.stringify(t)),'"'),s.attrs&&e.each(s.attrs,function(t,e){"undefined"!=typeof e&&null!==e&&e!==!1&&n.push(" ",t,'="',e.toString().replace(/"/g,"&quot;"),'"')}),h[o]?n.push("/>"):(n.push(">"),"undefined"!=typeof s.content&&(i._params=s.content,i._buildAll()),n.push("</",o,">"))},_flush:function(){var t=this._buffer.join("");return delete this._buffer,t},_buildByDecl:function(){var t=this,i=t._curBlock,n=t._params;if(n._curBlock&&(t._curBlock=n._curBlock),n.block&&(t._curBlock=n),!n._wrapper){if(n.block||n.elem){var s=d[t._curBlock.block];if(s){var o;if(n.elem?(o=s["_elem"+c+n.elem],s._elem&&(o=o?o.concat(s._elem):s._elem)):o=s._block,o)for(var r,a=0;(r=o[a++])&&(r(t),!n._isStopped););}}if(n._wrapper)return n._curBlock=t._curBlock,t._params=n._wrapper,t._buildAll()}var h=t._tParamsChanges;if(t._tParamsChanges=null,t._build(),t._curBlock=i,h){var u=t._tParams;e.each(h,function(t,e){"undefined"==typeof e?delete u[t]:u[t]=e})}}})}}(BEM,jQuery),BEM.DOM.decl("b-mooa",{onSetMod:{js:function(){var t=this,e=this.params.standId;this.__self.regChecker("beta",function(i){BEM.blocks["i-user-services"].get(function(n){n.sids[669]||n.attributes&&n.attributes.staff===!0&&"string"==typeof n.attributes["staff-login"]?(t.setMod("internal","yes"),t.params.standId=e,i()):n.sids[668]&&t.params.betaStandId&&(t.params.standId=t.params.betaStandId,i())})}),this.__base.apply(this,arguments)}}}),function(t){t.extend({browser:{}})}(jQuery),BEM.DOM.decl("b-page",{bindEvents:function(){return this.__base.apply(this,arguments),BEM.blocks["pane2-api"].on("fullscreen:enter",this._onFullscreenEnter,this).on("fullscreen:exit",this._onFullscreenExit,this),this},destruct:function(){BEM.blocks["pane2-api"].un("fullscreen:enter",this._onFullscreenEnter,this).un("fullscreen:exit",this._onFullscreenExit,this),this.__base.apply(this,arguments)},_onFullscreenEnter:function(){this.setMod("fullscreen","yes")},_onFullscreenExit:function(){this.setMod("fullscreen","no")}}),BEM.DOM.decl("sticky-controller",{onSetMod:{js:function(){this._page=this.findBlockOn("b-page"),this._page.on("change",this._onPageChange,this),this._header=this.findBlockInside("header"),this._onPageChange()}},bindEvents:function(){BEM.blocks["pane2-api"].on("pane:open pane:close",this._onPaneToggle,this),BEM.blocks["b-page"].on("scroll",this._onScroll,this),BEM.blocks.location.on("change",this._onLocationChange,this)},unbindEvents:function(){BEM.blocks["pane2-api"].un("pane:open pane:close",this._onPaneToggle,this),BEM.blocks["b-page"].un("scroll",this._onScroll,this),BEM.blocks.location.un("change",this._onLocationChange,this)},_onScroll:function(){this._isPane2Opened||this._setPosition()},_getPaneController:function(){return this.paneController||(this.paneController=this.findBlockInside("pane2-controller"))},_onPageChange:function(){this._stickyRelates=null,this._getRelates()?(this._counted=!1,this._getPaneController().hasInitialItem()?(this.fixHeader(),this._isPane2Opened=!0):(this._header.setMod("fixed",""),this._isPane2Opened=!1),this.bindEvents()):this.fixHeader()},_onLocationChange:function(){this.unbindEvents()},fixHeader:function(){this._header.setMod("fixed","yes")},_getRelates:function(){return this._stickyRelates||(this._stickyRelates=this.findBlockInside("sticky-relates"))},_count:function(){this._counted||(w(null,"/image/new/sticky/show"),this._counted=!0)},_onPaneToggle:function(){this._isPane2Opened=!this._isPane2Opened,this._scrolledEnough()&&this._getRelates().toggle(),this._header.toggleMod("fixed","yes","")},_setPosition:function(){this._shouldShowRelates&&this._count(),this._shouldToggleRelates()&&this._getRelates().toggle()},_shouldToggleRelates:function(){return this._shouldShowRelates()||this._shouldHideRelates()},_shouldShowRelates:function(){return this._scrolledEnough()&&!this._getRelates().isVisible()},_shouldHideRelates:function(){return!this._scrolledEnough()&&this._getRelates().isVisible()},_scrolledEnough:function(){return BEM.DOM.win.scrollTop()>218}}),BEM.DOM.decl({block:"sticky-controller",modName:"with-input",modVal:"yes"},{bindEvents:function(){this.__base.apply(this,arguments),BEM.blocks["sticky-relates"].on("animated",this._onStickyAnimatedEnd,this)},unbindEvents:function(){this.__base.apply(this,arguments),BEM.blocks["sticky-relates"].un("animated",this._onStickyAnimatedEnd,this)},_onLocationChange:function(){this.__base.apply(this,arguments),this._getRelates().isSearchArrow()&&this._moveSearchArrow2Header()},_onPageChange:function(){this.__base.apply(this,arguments),this._arrow=null,this._suggestForm=null,this._suggest=null},_getArrow:function(){return this._arrow||(this._arrow=this.findBlockInside("arrow"))},_getSuggestForm:function(){return this._suggestForm||(this._suggestForm=this._getArrow().findBlockInside("suggest2-form"))},_getSuggest:function(){return this._suggest||(this._suggest=this.findBlockInside("suggest2"))},_onPaneToggle:function(){this.__base.apply(this,arguments),this._scrolledEnough()&&(this._isPane2Opened?this._moveSearchArrow2Header():this._moveSearchArrow2Panel())},_setPosition:function(){this._shouldShowRelates()&&this._moveSearchArrow2Panel(),this._shouldHideRelates()&&this._moveSearchArrow2Header(),this.__base.apply(this,arguments)},_moveSearchArrow2Panel:function(){var t=this._getRelates();t.setArrowContent(this._getArrow().domElem),this._getSuggest().setOwner(t),this._getSuggest().setMod("sticky-relates","yes")},_moveSearchArrow2Header:function(){this._header.elem("search").html(this._getArrow().domElem),this._getRelates().setArrowContent(this._getArrow().domElem[0].cloneNode(!0)),this._getSuggest().setOwner(this._getSuggestForm().getOwner()),this._getSuggest().delMod("sticky-relates")},_onStickyAnimatedEnd:function(){var t=this._getRelates();t.isVisible()||t.elem("input").empty()}}),BEM.DOM.decl("sticky-relates",{toggle:function(){this.toggleMod("visibility","visible","")},setArrowContent:function(t){this.elem("input").html(t)},isSearchArrow:function(){return Boolean(this.findBlockInside("arrow"))},isVisible:function(){return this.hasMod("visibility","visible")},_onTransitionEnd:function(t){"transform"===t.originalEvent.propertyName&&this.trigger("animated")}},{live:function(){this.liveBindTo(BEM.blocks["i-ua"].getTransitionEndEvent(),function(t){this._onTransitionEnd(t)})}}),BEM.DOM.decl("head-filter",{getDefaultParams:function(){return{reloadParams:["p","img_url","rpt","pos"],pagesToFilter:{"search-by-image":["rpt","img_url"],similar:["rpt","img_url"]},popupDelay:1e3}},onSetMod:{js:function(){this.hasMod("disabled","yes")||this.findBlocks().bindEvents()},hovered:function(t,e){"yes"===e?this.setColorIcon():this.setBlackIcon()},menu:{hidden:function(){this.setBlackIcon(),BEM.blocks["i-keyrouter"].un("esc",this._onEsc,this)},visible:function(){this.setBlackIcon(),this.bindTo("item","keypress",this._onItemSelect),BEM.blocks["i-keyrouter"].on("esc",this._onEsc,this)}},type:function(t,e){this.params.selected=e,this.trigger("saved"),this.updatePage().updateTooltip().updateMenu().closeMenu()},disabled:function(t,e){this.button.setMod("disabled",e)}},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)},findBlocks:function(){return this.infoPopup=this.findBlockInside({block:"popup",modName:"type",modVal:"info"}),this.dropdown=this.findBlockOn("dropdown-menu"),this.button=this.dropdown.findBlockInside("button2"),this.filterPopup=this.findBlockOn("menu","popup"),this.menu=this.filterPopup.findBlockInside("b-menu-vert"),this.elem("item"),this},bindEvents:function(){return this.filterPopup.on("show",this._onMenuShow,this).on("hide",this._onMenuHide,this),this.infoPopup.on("show",this._onInfoShow,this).on("hide",this._onInfoHide,this),BEM.blocks["b-page"].on("warning",this._onWarning,this),this.bindTo("mouseover mouseout",this._onMouseMove,this),this.menu.bindTo(this.menu.elem("item"),"click",this.changeThis(this._onItemClick)),this},unbindEvents:function(){this.filterPopup.un("show",this._onMenuShow,this).un("hide",this._onMenuHide,this),this.infoPopup.un("show",this._onInfoShow,this).un("hide",this._onInfoHide,this),BEM.blocks["b-page"].un("warning",this._onWarning,this)},_onItemSelect:function(t){this.selectItem($(t.target))},_onEsc:function(){this.filterPopup.hide(),this.domElem.focus()},_onWarning:function(t,e){this.params.warning=e.pornoWarning,e.onlyFamily?(this.setMod("type","family").setMod("disabled","yes"),this.dropdown.params.switcherBlock=!0):(this.delMod("disabled"),this.dropdown.params.switcherBlock=!1)},_onMouseMove:function(t){this.hasMod("disabled","yes")||this.setMod("hovered","mouseover"===t.type?"yes":"")},_onItemClick:function(t){return this.selectItem($(t.target)),!1},_onMenuShow:function(){this.infoPopup.isShown()&&this.infoPopup.hide(),this.setMod("menu","visible")},_onMenuHide:function(){this.setMod("menu","hidden")},_onInfoShow:function(){this.closeMenu().setColorIcon().setMod("info","visible")},_onInfoHide:function(){this.delMod("info").setBlackIcon()},selectItem:function(t){var e=this.elemParams(t).value;e&&this.setMod("type",e),BEM.blocks["b-statcounter"].hit({params:{query:{safe:e}}})},updateMenu:function(){var t=this.getFilterData(this.params.selected),e=this.menu;return e.delMod(e.elem("item","selected","yes"),"selected").setMod(e.elem("item","type",t.type),"selected","yes"),this},updateTooltip:function(){var t=this.getFilterData(this.params.selected),e=this.findBlockOn("tooltip-owner");return e&&e.setContent(t.tooltip),this},updatePage:function(){var t=this.params,e=this.getFilterData(t.selected),i=BEM.blocks["i-global"],n=BEM.blocks.location.getInstance().getState(),s=n.url.replace("/images/images/","/images/"),o=BEM.blocks.uri.delParams(s,this.getFilteredParams(i.param("page")));return this.saveFilter({save:1,retpath:t.needRefresh?o:t.retpath,yandexuid:i.param("yandexuid"),family:e.value}),this},saveFilter:function(t){var e=this.params,i=e.saveUrl;e.needRefresh?location.href=i+BEM.blocks.uri.buildRelativeUrl("",t):BEM.create("i-request_type_ajax",{url:i,type:"iframe",cache:!1,dataType:"html"}).get(t,this.reloadPage.bind(this),this.reloadPage.bind(this))},reloadPage:function(){var t=BEM.blocks["i-global"].param("page");return BEM.blocks.location.getInstance().change({url:BEM.blocks.uri.delParams(this.getFilteredParams(t)),params:{ncrnd:Math.floor(1e4*Math.random())},history:!1}),this.checkInfoMessage(!0)},checkInfoMessage:function(t){var e=this.params,i=this.getFilterData(e.selected).type;return this.infoPopup?(t&&"unlimited"===i&&this.showInfo(),this):this},showInfo:function(){return this.prepareInfo(),setTimeout(this.changeThis(this.showInfoPopup),this.params.popupDelay),this},prepareInfo:function(){var t=this.getFilterData(this.params.selected),e=this.infoPopup;return e.setMod("filter",t.type),e.elem("content-wrap").html(t.info),this},showInfoPopup:function(){var t=this.infoPopup;return t.show(this.elem("icon")),this.setMod("info","visible")},closeMenu:function(){return this.filterPopup.isShown()&&this.filterPopup.hide(),this},getFilteredParams:function(t){var e=this.params.reloadParams,i=this.params.pagesToFilter[t];return i?_.difference(e,i):e},getFilterData:function(t){for(var e=this.params.filters,i=0,n=e.length;n>i;i++)if(e[i].type===t)return e[i]},setColorIcon:function(){return this.setMod("color","yes")},setBlackIcon:function(){return setTimeout(this.changeThis(function(){this.isActive()||this.setMod("color","no")}),150),this},isActive:function(){return this.hasMod("hovered","yes")||this.hasMod("menu","visible")||this.hasMod("info","visible")}}),function(){"use strict";var t="undefined"!=typeof module&&module.exports,e="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var t,e,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,s=i.length,o={};s>n;n++)if(t=i[n],t&&t[1]in document){for(n=0,e=t.length;e>n;n++)o[i[0][n]]=t[n];return o}return!1}(),n={request:function(t){var n=i.requestFullscreen;t=t||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?t[n]():t[n](e&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[i.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},raw:i};return i?(Object.defineProperties(n,{isFullscreen:{get:function(){return!!document[i.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[i.fullscreenEnabled]}}}),void(t?module.exports=n:window.screenfull=n)):void(t?module.exports=!1:window.screenfull=!1)}(),Date.now||(Date.now=function(){return(new Date).getTime()}),BEM.DOM.decl("b-page",{bindEvents:function(){return this.__base.apply(this,arguments),this._location.on("b-page_type_search-by-image",this._onCbirSearch,this),this},_onCbirSearch:function(t,e){this.checkCacheKey()&&this.loadPage(e,"search-by-image"),BEM.blocks.header.getSearch().updateCbirPage()}}),BEM.DOM.decl({block:"b-page",modName:"type",modVal:"search-by-image"},{buildCacheKey:function(){var t=this._location.getState();return[t.block?t.block:"",t.type?t.type:"",BEM.blocks.uri.delParams(t.url,_.without(this._getFilterParams(),"img_url"))].join("_")}}),BEM.DOM.decl("b-page",{bindEvents:function(){return this.__base.apply(this,arguments),this._location.on("b-page_type_similar",this._onPageSimilar,this),this},_onPageSimilar:function(t,e){this.checkCacheKey()&&this.loadPage(e,"similar"),BEM.blocks.header.getSearch().updateCbirPage()}}),BEM.DOM.decl("feedback",{externalData:{},onSetMod:{js:function(){this.checkboxes=this.findBlocksInside("checkbox"),this.submit=this.findBlockInside({block:"button",modName:"type",modVal:"submit"}).on("press",this.submitFeedback,this),this.findBlockInside({block:"button",modName:"type",modVal:"close"}).on("press",function(){this.popup.hide()
},this),this.popup=this.findBlockInside("popup").on("show",this.onShowPopup,this).on("hide",this.onHidePopup,this),this.popup.params.top="50%",this.setCheckboxEvent(),this._ajax=BEM.create("i-request_type_ajax",{url:this.params.abuseLink,cache:!1,dataType:"script",type:"POST"}),this.channel("feedback").on("show",this.showFeedback,this)}},showFeedback:function(t,e){this.externalData=e,this.resetPopup(),this.popup.toggle()},resetPopup:function(){this.checkboxes.forEach(function(t){t.delMod("checked")}),this.popup.findBlockInside("radiobox").val("no"),this.popup.delMod("thanks"),this.popup.findElem("result").hide(),this.popup.findElem("complaint").show()},setCheckboxEvent:function(){var t=this.findBlocksInside("checkbox"),e=this;t&&t.map(function(t){t.on("change",e.checkboxChanged,e)})},checkboxChanged:function(){this.submit.setMod("disabled",this.hasCheckedItems()?"no":"yes")},hasCheckedItems:function(){return this.checkboxes.filter(function(t){return t.isChecked()}).length>0},submitFeedback:function(){var t=this;this._ajax.params.url=this.externalData.abuseLink,this._ajax.get(t.getLogParams(),this.onSuccess),setTimeout(function(){t.popup.setMod("thanks","yes"),t.popup.findElem("result").show(),t.popup.findElem("complaint").hide()},200)},defaultParams:function(){var t=this.popup.findBlocksInside("checkbox").filter(function(t){return t.isChecked()}).map(function(t){return t.val()}).toString(),e=this.popup.findBlockInside("radiobox").val(),i=this.params&&this.params.request,n={"complaint-query":e,"reason-complaint":t};return i&&$.extend(n,i),n},getLogParams:function(){return this.defaultParams()},onShowPopup:function(){},onHidePopup:function(){var t=this.popup;t.setMod("modal","hide"),setTimeout(function(){t.delMod("visibility"),t.delMod("modal")},150)},onSuccess:function(){}}),BEM.DOM.decl("feedback",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({blockName:"button",modName:"type",modVal:"submit"}).domElem.attr("onmousedown",this.params.submitCounter)}},getLogParams:function(){return $.extend({},this.__base.apply(this,arguments),{query:BEM.blocks["i-global"].param("query"),lr:this.params.lr,service:[BEM.blocks["i-global"].param("id"),"yandex",BEM.blocks["i-global"].param("tld")].join("."),"url-complaint":this.externalData.url,reqid:BEM.blocks["i-global"].param("serpid")})}}),BEM.DOM.decl("feedback",{getLogParams:function(){return _.assign(this.__base.apply(this,arguments),{"shows-urls":BEM.blocks["serp-list"].getUrls().join(";"),reqid:BEM.blocks["i-global"].param("reqid")})}},{showPopup:function(t){BEM.channel("feedback").trigger("show",{url:BEM.blocks["serp-item"].getUrls(t).join(";"),timeQuery:t.params.timeQuery,abuseLink:BEM.blocks["i-global"].param("abuseLink")})}}),BEM.DOM.decl("i-cbir-initer",{onSetMod:{js:function(){this.bindEvents()}},bindEvents:function(){return this.bindToDoc("drag dragstart dragover drop",this._onFirstDragEvent),BEM.blocks.search2.onFirst("search:submit",this._onSearchSubmit,this),BEM.blocks["cbir-logo"].onFirst("showPanel",this._onLogoClick,this),BEM.blocks["cbir-error"].onFirst("showParanja",this.cbirControllerShowParanja,this).onFirst("hideParanja",this.cbirControllerHideParanja,this),this},destruct:function(){this._unbindControllerEvents().__base.apply(this,arguments)},_onLogoClick:function(){this.getController().showPanel(!BEM.blocks["i-global"].param("mobile"))},cbirControllerShowParanja:function(){this.getController().showParanja()},cbirControllerHideParanja:function(){this.getController().hideParanja()},_onSearchSubmit:function(t,e){this.getController().processSubmitEvent(e)},_onFirstDragEvent:function(t){var e=this.getPanel();return e&&e.isDragSupported()?e.processDragEvent(t):void 0},_unbindControllerEvents:function(){return BEM.blocks.search2.un("search:submit",this._onSearchSubmit,this),BEM.blocks["cbir-logo"].un("showPanel",this._onLogoClick,this),BEM.blocks["cbir-error"].un("showParanja",this.cbirControllerShowParanja,this).un("hideParanja",this.cbirControllerHideParanja,this),this.unbindFromDoc("drag dragstart dragover drop",this._onFirstDragEvent)},getPanel:function(){return this._unbindControllerEvents().findBlockInside("cbir-panel")},getController:function(){return this._unbindControllerEvents().findBlockOn("i-cbir-controller")}}),BEM.DOM.decl("incut",{isInserted:!1,isIncutShown:!1,onSetMod:{js:function(){this.justifier=BEM.blocks.justifier,this.prepareToView(),BEM.blocks["b-page"].on("resize",this._onPageResize,this)}},destruct:function(){BEM.blocks["b-page"].un("resize",this._onPageResize,this),this.__base.apply(this,arguments)},hitCounter:function(){var t=this.params.cpHitLoadPath;return this.isIncutVisible()&&(this.params.goalLoadPath&&BEM.blocks["b-statcounter"].on("hitAndGoalInited",this._reachGoalMetrikaCounter,this),c.cpHitDelayed({pid:40,cid:72872,path:t,vars:this.getVarsForHitCounter()})),this},_reachGoalMetrikaCounter:function(){var t=setInterval(function(){window.Ya&&Ya.Metrika&&(BEM.blocks["b-statcounter"].goal({goal:this.params.goalLoadPath}),clearInterval(t))}.bind(this),1e3);BEM.blocks["b-statcounter"].un("hitAndGoalInited",this._reachGoalMetrikaCounter,this)},_onPageResize:function(){return this.prepareToView().checkFilling(),this},prepareToView:function(){return this.setThumbRows(this.justifier.fitImages({container:this.domElem[0],containerWidth:this.domElem.parent().parent().width(),showDangling:!1,itemSelector:".incut__item"})).removeExtraRows(),this},checkFilling:function(){var t=this.findElem("item").first();return 0===t.length||"none"===t.css("display")?this.isIncutVisible()&&this.hide():(this.show(),this._hitDisplayCounters(),BEM.blocks["b-page"].on("scroll",this._hitDisplayCounters,this)),this},load:function(){return this},show:function(){return this.isIncutShown=!0,this.delMod("visibility")},_hitDisplayCounters:function(){this.isIncutInViewport()&&(this.hitCounter(),BEM.blocks["b-page"].un("scroll",this._hitDisplayCounters,this))},isIncutVisible:function(){return!this.hasMod("visibility")},hide:function(){var t=this.params.cpHitHidePath;return t&&c.cpHitDelayed({pid:40,cid:72872,path:t}),this.setMod("visibility","hidden")},removeExtraRows:function(){var t,e=this.params.incutRows;return this.thumbRows.length>e?(t=_.flatten(this.thumbRows.slice(e)),$("#"+t.join(",#")).remove(),$("#gallery-"+t.join(",#gallery-")).remove(),this.setThumbRows(this.thumbRows.slice(0,e))):(this.findElem("item").each(function(){"none"===this.style.display&&($("#gallery-"+this.id).remove(),this.remove())}),this.setThumbRows(this.thumbRows.slice(0,1))),this},setThumbRows:function(t){return this.thumbRows=t,this},getGalleryItems:function(){return this.elem("gallery-list").contents()},getVarsForHitCounter:function(){return"1341,-info="+_.pluck(this.thumbRows,"length").join("-")},setShown:function(){return this.isInserted=!0,this},isIncutInViewport:function(){var t=this.domElem&&this.domElem[0].getBoundingClientRect();return t&&t.top>=0&&t.left>=0&&t.bottom-t.height/2<=$(window).height()&&t.right<=$(window).width()}},{live:!0}),BEM.DOM.decl({block:"incut",modName:"type",modVal:"direct-like"},{_jsonData:null,onSetMod:{js:function(){BEM.blocks["b-page"].on("resize",this._onPageResize,this),this._fillCounterPathParams()}},_getDataPromise:function(){return BEM.create("direct-parser",{url:this._getDirectUrl()}).load().then(this._fillBemhtml.bind(this))},_fillCounterPathParams:function(){var t=this.params.counterPath;return _.assign(this.params,{cpHitLoadPath:t+".loaded",cpHitHidePath:t+".hide",itemClickPath:t+".item"}),this},destruct:function(){this.unbindFrom(this.elem("item"),"click",this._onItemClick),this.__base.apply(this,arguments)},_onPageResize:function(){return this.updateWidth()},_getDirectUrl:function(){var t=BEM.blocks["i-global"].param("query"),e=this.params.positionType,i="top"===e?1e3:"bottom"===e?1e6:this.params.position+1;return BEM.blocks.uri.setParams(this.params.linkHead,{"target-ref":encodeURI(window.location.href),grab:BEM.blocks["i-global__utils"].base64Encode("t"+(this.params.tags||t)),"stat-id":i})},checkFilling:function(){return this._dataPromise.then(this._initItems.bind(this))},_fillBemhtml:function(t){_.isEmpty(t.direct.ads)||(BEM.DOM.append(this.domElem,_.reduce(t.direct.ads,function(t,e){var i={width:_.last(e.images)[1],height:_.last(e.images)[2]};return i.width&&i.height?t+BEMHTML.apply({block:"incut",elem:"item",mods:{type:"direct-like"},size:i,description:e.body,title:e.title,img_href:_.last(e.images)[0],url:e.url,domain:e.domain,warning:e.warning}):t},"",this)),this._jsonData=t)},_initItems:function(){return this.updateWidth(),this._jsonData&&this._checkOccupancy()?(BEM.blocks["b-page"].on("scroll",this._hitDisplayCounters,this),this.show()._prepareIncutToVisibilityOnPage()._hitDisplayCounters(),this.bindTo(this.elem("item"),"click",this._onItemClick),this):this},_prepareIncutToVisibilityOnPage:function(){return this._checkDanglingThumbs()&&this._removeDanglingThumbs(),_.isEmpty(this.elem("warning"))||this.setMod("warning","yes"),this.setMod("flexbox","yes"),this},_hitDisplayCounters:function(){if(this.isIncutInViewport()){var t=this._jsonData,e=this.findElem("item").length;$.ajax({url:t.common.linkHead+_.pluck(t.direct.ads,"linkTail").slice(0,e).join(""),dataType:"script",cache:!0}),this.hitCounter(),BEM.blocks["b-page"].un("scroll",this._hitDisplayCounters,this)}},updateWidth:function(){var t=$(".serp-controller").width()-$(".incut__header").outerWidth();return this.domElem.css("width",t),this},getDefaultParams:function(){return{widthPercent:.8}},_onItemClick:function(){c.hitDelayed({dtype:"iweb",path:this.params.itemClickPath,reqid:this.params.reqid})},hitCounter:function(){return c.hitDelayed({dtype:"iweb",path:this.params.cpHitLoadPath,reqid:this.params.reqid}),this},_checkDanglingThumbs:function(){var t=this.domElem,e=t.find(".incut__item:first"),i=t.find(".incut__item:last");return e.offset().top!==i.offset().top},_checkOccupancy:function(){var t=this.domElem,e=this.elem("thumb"),i=_.reduce(e,function(t,e){return t+=parseInt(e.style.width,10)},0);return i/t.width()>this.params.widthPercent},_removeDanglingThumbs:function(){for(var t,e,i=this.findElem("item").last().offset().top,n=this.elem("item").toArray().reverse(),s=1,o=1,r=0,a=n.length;a>r&&(e=$(n[r]),t=e.offset().top,t!==i&&(i=t,s++),!(s>o));r++)e.remove();return this}}),BEM.DOM.decl({block:"incut",modName:"type",modVal:"market"},{getDefaultParams:function(){return{goalLoadPath:"fake-market:load",cpHitLoadPath:"image.new.serp.incut.market.loaded",cpHitHidePath:"image.new.serp.incut.market.hide"}}}),BEM.DOM.decl({block:"incut",modName:"type",modVal:"direct"},{getDefaultParams:function(){return{goalLoadPath:"fake-direct:load",cpHitLoadPath:"image.new.serp.incut.direct.loaded",cpHitHidePath:"image.new.serp.incut.direct.hide"}}}),BEM.DOM.decl({block:"incut",modName:"type",modVal:"related"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.related=this.findBlockInside("related")}},setShown:function(){return this.__base.apply(this,arguments),this.related?(this.show(),this.related.reduceLabelHeight().setCarouselMod().setCarouselSizes(),this):this},checkFilling:function(){return this},prepareToView:function(){return this}}),BEM.DOM.decl({block:"incut",modName:"kind",modVal:"context"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._dataPromise=this._getDataPromise()}}}),BEM.DOM.decl({block:"incut",modName:"kind",modVal:"behavioral"},{load:function(){return!this._dataPromise&&(this._dataPromise=this._getDataPromise()),this}}),BEM.decl("direct-parser",{load:function(){var t=$.Deferred(),e=this.__base.apply(this,arguments);return e?e:($.ajax({url:this.params.url,xhrFields:{withCredentials:!0}}).success(function(e){try{t.resolve(new Function("return"+e.match(/^(\/\*\*\/)?\('(.*)\'\)$/)[2])())}catch(i){t.reject(i)}}).error(t.reject),t)}}),BEM.DOM.decl("disk-controller",{getDefaultParams:function(){return{pendingKey:"pendingSave"}},onSetMod:{js:function(){this.__self._instance=this,this._uploadedState={},this._setDiskAPIURL(),this.bindEvents()}},bindEvents:function(){BEM.blocks["pane2-api"].on("duplicate:loaded",this._onDuplicateLoaded,this),BEM.blocks["disk-button"].on("click",this._onSaveClick,this),BEM.blocks.disk.on("firstUpload",this._onFirstUpload,this),BEM.blocks.disk.on("upload",this._onUpload,this),BEM.blocks.disk.on("error",this._onError,this)},destruct:function(){BEM.blocks["pane2-api"].un("duplicate:loaded",this._onDuplicateLoaded,this),BEM.blocks["disk-button"].un("click",this._onSaveClick,this),BEM.blocks.disk.un("firstUpload",this._onFirstUpload,this),BEM.blocks.disk.un("upload",this._onUpload,this),BEM.blocks.disk.un("error",this._onError,this),this.__base.apply(this,arguments)},_onSaveClick:function(){this.saveFile()},_onFirstUpload:function(){this.showFirstUploadPopup()},_onUpload:function(t,e){this.addUploaded(e.file.id),this._getLogo().bounce(),this.updateButton()},_onError:function(t,e){this.getCurrentItemParams().id===e.file.id&&this._getSaveButton().showError(e.error).enable()},_onDuplicateLoaded:function(){!this.isThumbLoaded()&&this.getPending()&&this.checkPending(this.getFileData())},showFirstUploadPopup:function(){var t=BEM.blocks["i-global"].param("tablet");this._getLogo().showPopup(t&&this._getSaveButton().domElem)},updateButton:function(){var t=this._getSaveButton();t.hidePopups(),this.isUploaded()?t.setSaved():t.setNotSaved()},getCurrentItemParams:function(){return BEM.blocks["pane2-api"].getItemParams()},getCurrentDuplicate:function(){return BEM.blocks["pane2-api"].getCurrentDuplicate()},getPending:function(){return this._getStorage().get(this.params.pendingKey)},setPending:function(t){this._getStorage().set(this.params.pendingKey,t.id)},delPending:function(){this._getStorage().del(this.params.pendingKey)},checkPending:function(t){t.id!==this.getPending()||this.hasMod("unauthorized","yes")||(this.saveFile(),this.delPending())},saveFile:function(){var t=this.getFileData();this._getSaveButton().disable(),this.isThumbLoaded()?this.setPending(t):this._getDisk().saveFile(t)},isThumbLoaded:function(){var t=this.getCurrentItemParams(),e=this.getCurrentDuplicate();return t.thumb.url===e.url},getFileData:function(){var t=this.getCurrentItemParams(),e=this.getCurrentDuplicate();return{id:t.id,url:e.url,meta:{page_url:t.snippet.url,yaimages_search_url:location.origin+t.detail_url,yaimages_search_request:BEM.blocks["i-global"].param("query")}}},addUploaded:function(t){this._uploadedState[t]=!0},isUploaded:function(){return this._uploadedState[this.getCurrentItemParams().id]},_setDiskAPIURL:function(){var t=BEM.blocks["i-global"].param("tld");"ru"!==t&&BEM.blocks["disk-api"].setAPIURL("https://cloud-api.yandex."+t+"/images/v1/disk")},_getStorage:function(){return BEM.blocks.localstorage.getInstance()},_getDisk:function(){return this._disk||(this._disk=BEM.create("disk",{dirName:this.params.dirName}))},_getLogo:function(){return this._logo||(this._logo=this.findBlockInside("disk-logo"))},_getSaveButton:function(){return this._saveButton||(this._saveButton=this.findBlockInside("disk-button"))}},{_instance:null,get:function(){return this._instance}}),BEM.decl("disk",{getDefaultParams:function(){return{maxPollingRequests:2,pollingTimeout:300,filename:"Image.jpg",dirName:"Images"}},checkDir:function(){var t=this.params.dirName,e=$.Deferred(),i=this;return this._isDirExists?e.resolve():this._getAPI().isPathExists(t).then(function(){i._isDirExists=!0})},saveFile:function(t){var e=this;t.dir=this.params.dirName,t.count=0,t.name||(t.name=this._getFileName(t.url)),this._checkOrCreateDir(t.dir).then(function(){e._saveFile(t)}).fail(function(i){e._triggerError(i,t)})},_getFileName:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length),i=e.indexOf("#"),n=e.indexOf("?");-1!==n?e=e.substring(0,n):-1!==i&&(e=e.substring(0,i));try{e=decodeURIComponent(e)}catch(s){}return e.length>250&&(e=e.substr(0,250)),e=e.replace(/(\*|\||\\|:|"|<|>)/gi,"-"),e||this.params.filename},_checkOrCreateDir:function(t){var e=$.Deferred(),i=this;return this.checkDir().then(function(){e.resolve()}).fail(function(n){return n&&404===n.status?void i._getAPI().mkdir(t).then(function(){e.resolve()}).fail(function(t){e.reject(t)}):void e.reject(n)}),e.promise()},_saveFile:function(t){var e=t.dir+"/"+this._buildUniqFilename(t),i=this;this._getAPI().upload(e,t.url).then(function(n){i._waitAndSetMeta(e,t,n.href)}).fail(function(e){409===e.status?(t.count++,i._saveFile(t)):i._triggerError(e,t)})},_waitAndSetMeta:function(t,e,i){var n=this;this._waitForUpload(e,i).then(function(){n._getAPI().setMeta(t,e.meta),n._triggerSuccess(e)}).fail(function(t){n._triggerError(t,e)})},_buildUniqFilename:function(t){var e=t.name,i=t.count,n=e.lastIndexOf("."),s="";return n>=0&&(s=e.substring(n),e=e.substring(n,-1)),e+(i>0?" ("+i+")":"")+s},_triggerSuccess:function(t){this.trigger("upload",{file:t}),this.__self.isImgLoaded()||(this.__self.setImgLoaded(),this.trigger("firstUpload"))},_triggerError:function(t,e){var i={file:e,result:this._parseResponse(t),error:t&&507===t.status?"not-enough-space":""};this.trigger("error",i)},_waitForUpload:function(t,e){var i=$.Deferred();return this._pollingRequestsCount=0,this._polling(i,t,e),i.promise()},_polling:function(t,e,i){var n=this;this._getAPI().status(i).then(function(s,o,r){return s&&"failed"!==s.status?void("success"===s.status?t.resolve(s):n._resumePolling(t,e,i)):void t.reject(r)}).fail(function(s){n._pollingRequestsCount<n.params.maxPollingRequests?(n._pollingRequestsCount++,n._resumePolling(t,e,i)):t.reject(s)})},_resumePolling:function(t,e,i){var n=this;setTimeout(function(){n._polling(t,e,i)},this.params.pollingTimeout)},_parseResponse:function(t){var e;try{e=t.responseText&&JSON.parse(t.responseText)}catch(i){}return e},_getAPI:function(){return this._api||(this._api=BEM.blocks["disk-api"])}}),BEM.decl("disk",{onSetMod:{js:function(){this.bindEvents(),this.__base.apply(this,arguments)}},bindEvents:function(){return this.on("error",this._onError,this),this},unbindEvents:function(){return this.on("error",this._onError,this),this},_onError:function(t,e){var i=e.error;return c.hit({dtype:"stred",pid:40,cid:72947,path:"disk.api.error",vars:i?"status="+i:""}),this},destruct:function(){this.unbindEvents(),this.__base.apply(this,arguments)}}),BEM.decl("disk",{},{isPromoShown:function(){return this._getUserState("promo",0)},setPromoShown:function(){this._setUserState("promo",1)},isImgLoaded:function(){return this._getUserState("loaded",0)},setImgLoaded:function(){this._setUserState("loaded",1)},_getUserState:function(t,e){var i=this._getCookieState();return t?i[t]||e:i},_getCookieState:function(){return this._parseState(this._getCookie())},_parseState:function(t){var e=t.split(".");return{promo:Number(e[0])||0,loaded:Number(e[1])||0}},_setUserState:function(t,e){var i=this._getCookieState();return i[t]=e,this._setCookie([i.promo,i.loaded].join(".")),i[t]},_getCookie:function(){return $.cookie("dps")||""},_setCookie:function(t){$.cookie("dps",t,{expires:3650,path:BEM.blocks["i-global"].param("router").index})}}),BEM.decl("disk-api",{},{API_URL:"https://cloud-api.yandex.ru/images/v1/disk",PATHS:{info:"/",resources:"/resources/",operations:"/operations/",upload:"/resources/upload/"},info:function(){return this._req("get",{method:"info"})},setAPIURL:function(t){this.API_URL=t},setMeta:function(t,e){return this._req("patch",{method:"resources",query:{path:t},data:{custom_properties:e}})},status:function(t){return this._req("get",{url:t})},upload:function(t,e){return this._req("post",{method:"upload",query:{url:e,path:t,disable_redirects:!0}})},isPathExists:function(t){return this._req("get",{method:"resources",query:{path:t,limit:1}})},mkdir:function(t){return this._req("put",{method:"resources",query:{path:t}})},_getURL:function(t,e){return this.API_URL+this.PATHS[t]+(e?"?"+$.param(e):"")},_req:function(t,e){var i=e.data;return $.ajax({url:e.url||this._getURL(e.method,e.query),data:i&&JSON.stringify(i),processData:!1,contentType:"application/json",dataType:"json",type:t,cache:!1,xhrFields:{withCredentials:!0}})}}),BEM.DOM.decl("disk-domik",{onSetMod:{js:function(){BEM.blocks.popup.on(this.elem("popup"),"show",this._onPopupShow,this).on(this.elem("popup"),"hide",this._onPopupHide,this)}},destruct:function(){BEM.blocks.popup.un(this.elem("popup"),"show",this._onPopupShow,this).un(this.elem("popup"),"hide",this._onPopupHide,this),this.__base.apply(this,arguments)},show:function(){this._getPopup().show()},_onPopupShow:function(){this.trigger("show")},_onPopupHide:function(){this.trigger("hide")},_getPopup:function(){return this._popup||(this._popup=this.findBlockOn("popup","popup"))}},{live:!0}),BEM.DOM.decl({block:"disk-controller",modName:"unauthorized",modVal:"yes"},{bindEvents:function(){this.__base.apply(this,arguments),BEM.blocks["disk-logo"].on("click",this._onLogoClick,this),BEM.blocks["disk-domik"].on("hide",this._onDomikHide,this),BEM.blocks["disk-button"].on("auth:click",this._onAuthLinkClick,this)},destruct:function(){BEM.blocks["disk-logo"].un("click",this._onLogoClick,this),BEM.blocks["disk-domik"].un("hide",this._onDomikHide,this),BEM.blocks["disk-button"].un("auth:click",this._onAuthLinkClick,this),this.__base.apply(this,arguments)},showDomik:function(t){t&&this.setPending(this.getCurrentItemParams()),this._getDomik().show()},_onSaveClick:function(){this.hasMod("social-auth","yes")?this._getSaveButton().showError("social-auth"):this.showDomik(!0)},_onAuthLinkClick:function(){this.showDomik(!0)},_onLogoClick:function(){this.hasMod("social-auth","yes")||this.showDomik()},_onDomikHide:function(){this.delPending()},_getDomik:function(){return this._domik||(this._domik=this.findBlockInside("disk-domik"))}}),BEM.DOM.decl({block:"disk-controller",modName:"no-save",modVal:"yes"},{_onSaveClick:function(){this._getSaveButton().setSaved()}}),window.Ya=window.Ya||{},Ya.AppsApi=Ya.AppsApi||{},Ya.AppsApi.init=function(t){if(Ya.AppsApi.__frontend)throw new Error("Ya.AppsApi already inited");Ya.AppsApi.__listeners={};var e=Ya.AppsApi.__frontend=Ya.AppsApi.createFrontend(t);Ya.AppsApi.whenAvailable=e.whenAvailable.bind(e),Ya.AppsApi.whenUnavailable=e.whenUnavailable.bind(e),e.init()},Ya.AppsApi.destroy=function(){Ya.AppsApi.__listeners={},Ya.AppsApi.__frontend.destroy(),Ya.AppsApi.__frontend=null,Ya.AppsApi.whenAvailable=null,Ya.AppsApi.whenUnavailable=null},Ya.AppsApi.createFrontend=function(t){return new Ya.AppsApi.Frontend(t)},Ya.AppsApi.Frontend=$.inherit({__constructor:function(t){this._api=null,this._apiWaitersQueue=[],this._noApiWaitersQueue=[],this._instanceNumber=this.__self._instanceCounter++,this._eventNamespace="i"+this._instanceNumber,this._listeners=Ya.AppsApi.__listeners[this._eventNamespace]={},this._listenerPath="Ya.AppsApi.__listeners."+this._eventNamespace+".",this._isBackendExpected=t||"undefined"==typeof t,this._pollingStage="not started"},destroy:function(){this._apiWaitersQueue=[],this._noApiWaitersQueue=[],delete Ya.AppsApi.__listeners[this._eventNamespace]},init:function(){this._isBackendExpected&&this._pickUpBackend()},whenAvailable:function(t,e,i){$.isFunction(t)&&(i=e,e=t,t=null),t=[].concat(t||[]);var n=function(){var n=[];t.forEach(function(t){this._api[t]&&n.push(this._api[t])},this),n.length===t.length&&(n.push(this._api),e.apply(i,n))}.bind(this);this._api?n():this._apiWaitersQueue.push(n)},whenUnavailable:function(t,e){var i=t.bind(e);return!this._isBackendExpected||!this._api&&"finished"===this._pollingStage?i():void this._noApiWaitersQueue.push(i)},_pickUpBackend:function(){this._pollingStart=Date.now(),this._pollingStage="in progress",setTimeout(this._checkApiBackend.bind(this),0)},_checkApiBackend:function(){var t=this._getBackend();if(t)for(this._pollingStage="finished",this._createApi(t);this._apiWaitersQueue.length;)this._apiWaitersQueue.shift()();else if(Date.now()-this._pollingStart<this.__self.MAX_POLLING_TIME)setTimeout(this._checkApiBackend.bind(this),this.__self.TICK_TIMEOUT);else for(this._pollingStage="finished";this._noApiWaitersQueue.length;)this._noApiWaitersQueue.shift()()},_getBackend:function(){return self.YandexApplicationsAPIBackend},_createApi:function(t){var e=this._api=new $.observable;this._backend=e.__backend=t,["freeze","unfreeze"].forEach(function(t){this._bindToBackend(t,e,t)},this),t.openSplitView&&(e.splitView=new $.observable,this._bindToBackend("openSplitView",e.splitView,"open"),this._bindToBackend("closeSplitView",e.splitView,"close"),e.splitView.open=function(e){return t.openSplitView(e),this},e.splitView.close=function(e){return t.closeSplitView(e),this}),t.openFullScreen&&(e.fullScreen=new $.observable,this._bindToBackend("openFullScreen",e.fullScreen,"open"),this._bindToBackend("closeFullScreen",e.fullScreen,"close"),e.fullScreen.open=function(){return t.openFullScreen(),this},e.fullScreen.close=function(){return t.closeFullScreen(),this}),t.openVertService&&(e.verticalServices=new $.observable,e.verticalServices.open=function(e,i,n){return t.openVertService(e,i,n),this}),t.setQueryText&&(e.query=new $.observable,e.query.setText=function(e){return t.setQueryText(e),this}),t.voiceAnswer&&(e.voice=new $.observable,e.voice.answer=function(e){return e=e||{},e.lang=e.lang||"ru",t.voiceAnswer(JSON.stringify(e)),this}),t.log&&(e.log=function(e){return e=[].concat(e),t.log(e),this}),t.capturePointer&&t.releasePointer&&(e.pointer=new $.observable,e.pointer.capture=function(){return t.capturePointer(),this},e.pointer.release=function(){return t.releasePointer(),this})},_bindToBackend:function(t,e,i){this._listeners[t]=function(t){e.trigger(i,t)},this._backend.on(t,this._listenerPath+t)}},{TICK_TIMEOUT:50,MAX_POLLING_TIME:2e3,_instanceCounter:0}),function(){Ya.AppsApi.init(Boolean(Ya.AppsApiEnabled)),Ya.AppsApi.whenAvailable(function(t){var e=!1,i=function(){e||(t.trigger("unfreeze"),e=!0)};BEM.DOM.win.one("scroll",i),BEM.DOM.scope.one("click",i)}),window.__enableFakeYandexApplicationsAPI&&setTimeout(function(){Ya.AppsApi.enableSimulator()},100)}(),Ya.AppsApi.whenAvailable(function(){parseFloat(BEM.blocks["i-ua"].android)<4.4&&(BEM.DOM.scope.scrollTop(1),BEM.DOM.scope.scrollTop(0))}),BEM.DOM.decl("distro",{_onItemClick:function(t){t.preventDefault();var e=this.elemParams("item"),i=e.counter,n=e.url;BEM.create("chrome-webstore-item",{url:n}).on({installed:function(){c.hit({dtype:"iweb",path:i+"install",vars:"-app_url="+n})},installationFailed:function(t,e){c.hit({dtype:"iweb",path:i+"error",vars:"-app_url="+n+",-error_code="+e.errorCode})},installationCancelled:function(){c.hit({dtype:"iweb",path:i+"popup_close",vars:"-app_url="+n})}}).install()},show:function(){this.delMod("hidden"),this.setMod("shown","yes"),this._hitCounter()},hide:function(){this.delMod("shown"),this.setMod("hidden","yes")},_hitCounter:function(){c.cpHitDelayed({pid:40,cid:72921,path:"image.serp.footer.show"})}},{live:function(){return this.liveBindTo({elem:"item",modName:"inline",modVal:"yes"},"click",function(t){this._onItemClick(t)}),!1}}),BEM.decl("chrome-webstore-item",{onSetMod:{js:function(){this.url=this.params.url}},install:function(){this.addLink(),chrome.webstore.install(this.url,this.onInstalled.bind(this),this.onInstallationFailed.bind(this))},addLink:function(){this.linkAdded||($(document.head).append($("<link />").attr({rel:"chrome-webstore-item",href:this.url})),this.linkAdded=!0)},onInstalled:function(){this.trigger("installed")},onInstallationFailed:function(t,e){var i="userCancelled"===e?"installationCancelled":"installationFailed";this.trigger(i,{errorMessage:t,errorCode:e})}});var BEMHTML;!function(t){var e=function(e,i){var n=function(e,i){return function(n){if("object"==typeof i&&"undefined"!=typeof e)e.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var s;s="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:this,s.BEMHTML=n()}}(function(){return function t(e,i,n){function s(r,a){if(!i[r]){if(!e[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(o)return o(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[r]={exports:{}};e[r][0].call(u.exports,function(t){var i=e[r][1][t];return s(i?i:t)},u,u.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){function n(t){this.modDelim=t.mod||"_",this.elemDelim=t.elem||"__"}i.ClassBuilder=n,n.prototype.build=function(t,e){return void 0===e?t:t+this.elemDelim+e},n.prototype.buildModPostfix=function(t,e){var i=this.modDelim+t;return e!==!0&&(i+=this.modDelim+e),i},n.prototype.buildBlockClass=function(t,e,i){var n=t;return i&&(n+=this.buildModPostfix(e,i)),n},n.prototype.buildElemClass=function(t,e,i,n){var s=this.buildBlockClass(t)+this.elemDelim+e;return n&&(s+=this.buildModPostfix(i,n)),s},n.prototype.split=function(t){return t.split(this.elemDelim,2)}},{}],2:[function(t,e,i){function n(t){this._bemhtml=t,this.ctx=null,this.block="",this._currBlock="",this.elem=null,this.mods={},this.elemMods={},this.position=0,this._listLength=0,this._notNewList=!1,this._onceRef={}}var s=t("./utils");i.Context=n,n.prototype._flush=null,n.prototype.isArray=s.isArray,n.prototype.isSimple=s.isSimple,n.prototype.isShortTag=s.isShortTag,n.prototype.extend=s.extend,n.prototype.identify=s.identify,n.prototype.xmlEscape=s.xmlEscape,n.prototype.attrEscape=s.attrEscape,n.prototype.jsAttrEscape=s.jsAttrEscape,n.prototype.BEM={},n.prototype.isFirst=function(){return 1===this.position},n.prototype.isLast=function(){return this.position===this._listLength},n.prototype.generateId=function(){return s.identify(this.ctx)},n.prototype.reapply=function(t){return this._bemhtml.run(t)}},{"./utils":7}],3:[function(t,e,i){function n(t,e,i,n){this.bemhtml=t,this.block=null,this.elem=null,this.jsClass=null,this.canFlush=!0,this.options={},this.def=new h(this),this.tag=new h(this),this.attrs=new h(this),this.mod=new h(this),this.js=new h(this),this.mix=new h(this),this.bem=new h(this),this.cls=new h(this),this.content=new h(this),this.rest={},this.init(e,i),this.initModes(n)}function s(){return this.ctx.content}var o=t("./utils"),r=t("./tree").Template,a=t("./tree").PropertyMatch,c=t("./tree").CompilerOptions,h=t("./match").Match;i.Entity=n,n.prototype.init=function(t,e){this.block=t,this.elem=e,this.jsClass=this.bemhtml.classBuilder.build(this.block,this.elem)},n.prototype.initModes=function(t){for(var e=0;e<t.length;e++){for(var i=t[e],n=i.predicates.length-1;n>=0;n--){var s=i.predicates[n];if(s instanceof a&&"_mode"===s.key){i.predicates.splice(n,1),this._initRest(s.value),this.rest[s.value].push(i);break}}-1===n&&this.def.push(i);for(var n=i.predicates.length-1;n>=0;n--){var s=i.predicates[n];s instanceof c&&(this.options=o.extend(this.options,s.options))}}},n.prototype._initRest=function(t){"tag"===t||"attrs"===t||"js"===t||"mix"===t||"bem"===t||"cls"===t||"content"===t||"default"===t?this.rest[t]="default"===t?this.def:this[t]:this.rest.hasOwnProperty(t)||(this.rest[t]=new h(this))},n.prototype.setDefaults=function(){if(0!==this.content.count&&this.content.push(new r([],s)),0!==this.def.count){this.canFlush=this.options.flush||!1;var t=this;this.def.push(new r([],function(){return t.defaultBody(this)}))}},n.prototype.prepend=function(t){for(var e=Object.keys(this.rest),i=0;i<e.length;i++){var n=e[i];t.rest[n]&&this.rest[n].prepend(t.rest[n])}e=Object.keys(t.rest);for(var i=0;i<e.length;i++){var n=e[i];this.rest[n]||(this._initRest(n),this.rest[n].prepend(t.rest[n]))}},n.prototype.run=function(t){return 0!==this.def.count?this.def.exec(t):this.defaultBody(t)},n.prototype.defaultBody=function(t){var e=t.ctx.tag;void 0===e&&(e=this.tag.exec(t));var i;t.ctx.js!==!1&&(i=this.js.exec(t));var n=this.bem.exec(t),s=this.cls.exec(t),o=this.mix.exec(t),r=this.attrs.exec(t),a=this.content.exec(t);return 0===this.content.count&&void 0===a&&(a=t.ctx.content),this.bemhtml.render(t,this,e,i,n,s,o,r,a)}},{"./match":5,"./tree":6,"./utils":7}],4:[function(t,e){function i(t){this.options=t||{},this.entities=null,this.defaultEnt=null,this.tree=null,this.match=null,this.contextConstructor=function(t){a.call(this,t)
},n(this.contextConstructor,a),this.context=null,this.classBuilder=new c(this.options.naming||{}),this.depth=0,this.canFlush=!1,this.oninit=null,this.defaultEnt=new r(this,"","",[]),this.defaultElemEnt=new r(this,"","",[])}var n=t("inherits"),s=t("./tree").Tree,o=t("./tree").PropertyMatch,r=t("./entity").Entity,a=t("./context").Context,c=t("./class-builder").ClassBuilder,h=t("./utils");e.exports=i,i.locals=s.methods.concat("local","applyCtx","applyNext","apply"),i.prototype.compile=function(t){function e(){return r._run(r.context.ctx)}function i(t,i){return i?r.local(i,function(){return r.local({ctx:t},e)}):r.local({ctx:t},e)}function n(t,e){return r.applyMode(t,e)}function o(t){return function(e){return r.local(t,e)}}var r=this,a=new s({refs:{applyCtx:i,local:o}}),c=this.recompileInput(t),h=a.build(c,[o,i,function l(t){return t?r.local(t,l):r.applyNext()},n]);this.tree&&(h={templates:h.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(h.oninit)}),this.tree=h;var u=this.groupEntities(h.templates);u=this.transformEntities(u),this.entities=u,this.oninit=h.oninit},i.prototype.recompileInput=function(t){var e=t.toString(),n=i.locals;return"function"==typeof t&&t.length===n.length?t:(e=e.replace(/^function[^{]+{|}$/g,""),e=new Function(n.join(", "),e))},i.prototype.groupEntities=function(t){for(var e={},i=0;i<t.length;i++){var n,s=t[i].clone(),r=null;n=void 0;for(var a=0;a<s.predicates.length;a++){var c=s.predicates[a];if(c instanceof o){if("block"===c.key)r=c.value;else{if("elem"!==c.key)continue;n=c.value}s.predicates.splice(a,1),a--}}if(null===r)throw new Error('block("...") not found in one of the templates');var h=this.classBuilder.build(r,n);e[h]||(e[h]=[]),e[h].push(s)}return e},i.prototype.transformEntities=function(t){for(var e=[],i=Object.keys(t),n=0;n<i.length;n++){var s=i[n],o=this.classBuilder.split(s),a=o[0],c=o[1];"*"===c&&e.push(a),t[s]=new r(this,a,c,t[s])}if(t.hasOwnProperty("*")){for(var h=t["*"],n=0;n<i.length;n++){var s=i[n];"*"!==s&&t[s].prepend(h)}this.defaultEnt.prepend(h),this.defaultElemEnt.prepend(h)}for(var n=0;n<e.length;n++){for(var a=e[n],u=this.classBuilder.build(a,"*"),h=t[u],n=0;n<i.length;n++){var s=i[n];if(s!==u){var l=t[s];l.block===a&&void 0!==l.elem&&t[s].prepend(h)}}this.defaultElemEnt.prepend(h)}for(var n=0;n<i.length;n++){var s=i[n];t[s].setDefaults(),this.defaultEnt.setDefaults(),this.defaultElemEnt.setDefaults()}return t},i.prototype._run=function(t){var e;return e=void 0===t||""===t||null===t?this.runEmpty():h.isArray(t)?this.runMany(t):h.isSimple(t)?this.runSimple(t):this.runOne(t)},i.prototype.run=function(t){var e=this.match,i=this.context;this.match=null,this.context=new this.contextConstructor(this),this.canFlush=null!==this.context._flush,this.depth=0;var n=this._run(t);return this.canFlush&&(n=this.context._flush(n)),this.match=e,this.context=i,n},i.prototype.runEmpty=function(){return this.context._listLength--,""},i.prototype.runMany=function(t){var e="",i=this.context,n=i.position,s=i._notNewList;if(s?i._listLength+=t.length-1:(i.position=0,i._listLength=t.length),i._notNewList=!0,this.canFlush)for(var o=0;o<t.length;o++)e+=i._flush(this._run(t[o]));else for(var o=0;o<t.length;o++)e+=this._run(t[o]);return s||(i.position=n),e},i.prototype.runSimple=function(t){this.context._listLength--;var e="";return(t&&t!==!0||0===t)&&(e+=t),e},i.prototype.runOne=function(t){var e=this.context,i=e.ctx,n=e.block,s=e._currBlock,o=e.elem,r=e.mods,a=e.elemMods;e._currBlock=t.block||t.elem?"":e.block,e.ctx=t,t.block?(e.block=t.block,e.mods=t.mods?t.mods:{}):t.elem?s&&(e.block=s):e.block="",e.elem=t.elem,e.elemMods=t.elemMods?t.elemMods:{};var c=e.block||"",h=e.elem;c||h?e.position++:e._listLength--,this.depth++;var u=this.classBuilder.build(c,h),l=!1,d=this.entities[u];d?this.canFlush&&!d.canFlush&&(l=!0,this.canFlush=!1):(d=this.defaultEnt,void 0!==h&&(d=this.defaultElemEnt),d.init(c,h));var p=d.run(e);return e.ctx=i,e.block=n,e.elem=o,e.mods=r,e.elemMods=a,e._currBlock=s,this.depth--,l&&(this.canFlush=!0),p},i.prototype.render=function(t,e,i,n,s,o,r,a,c){var u=t.ctx;if(void 0===i&&(i="div"),!i)return this.renderNoTag(t,n,s,o,r,a,c);var l="<"+i,d=u.js;d!==!1&&(n===!0&&(n={}),n?d!==!0&&(n=h.extend(d,n)):n=d===!0?{}:d);var p;n&&(p={},p[e.jsClass]=n);var f=s;void 0===f&&(f=void 0===u.bem?e.block||e.elem:u.bem),f=!!f,void 0===o&&(o=u.cls);var m=e.block&&p&&!e.elem;if(!f&&!o)return this.renderClose(l,t,i,a,f,u,c);if(l+=' class="',f){var _=u.elemMods||u.mods;!_&&u.block&&(_=t.mods),l+=e.jsClass,l+=this.buildModsClasses(e.block,e.elem,_);var g=r;if(u.mix&&(g=g?[].concat(g,u.mix):u.mix),g){var b=this.renderMix(e,g,p,m);l+=b.out,p=b.jsParams,m=b.addJSInitClass}o&&(l+=" "+o)}else o&&(l+=o);return l+=m?' i-bem"':'"',f&&p&&(l+=" data-bem='"+h.jsAttrEscape(JSON.stringify(p))+"'"),this.renderClose(l,t,i,a,f,u,c)},i.prototype.renderClose=function(t,e,i,n,s,o,r){var a=t;if(n=h.extend(n,o.attrs)){var c;for(c in n){var u=n[c];void 0!==u&&(a+=" "+c+'="'+h.attrEscape(h.isSimple(u)?u:this.reapply(u))+'"')}}return h.isShortTag(i)?(a+="/>",this.canFlush&&(a=e._flush(a))):(a+=">",this.canFlush&&(a=e._flush(a)),(r||0===r)&&(a+=this.renderContent(r,s)),a+="</"+i+">"),this.canFlush&&(a=e._flush(a)),a},i.prototype.renderMix=function(t,e,i,n){var s={},o=this.context,r=i,a=n;s[t.jsClass]=!0,h.isArray(e)||(e=[e]);for(var c=this.classBuilder,u="",l=0;l<e.length;l++){var d=e[l];if(void 0!==d){"string"==typeof d&&(d={block:d,elem:void 0});var p=d.block||d.elem,f=d.block||d._block||o.block,m=d.elem||d._elem||o.elem,_=c.build(f,m),g=d.elem||d._elem||(d.block?void 0:o.elem);if(p&&(u+=" "+c.build(f,g)),u+=this.buildModsClasses(f,g,d.elemMods||d.mods),d.js&&(r||(r={}),r[c.build(f,d.elem)]=d.js===!0?{}:d.js,a||(a=f&&!d.elem)),p&&!s[_]){s[_]=!0;var b=this.entities[_];if(b){var v=o.block,y=o.elem,k=b.mix.exec(o);if(o.elem=y,o.block=v,k)for(var M=0;M<k.length;M++){var w=k[M];(w.block||w.elem)&&s[c.build(w.block,w.elem)]||(w._block=f,w._elem=m,e=e.slice(0,l+1).concat(w,e.slice(l+1)))}}}}}return{out:u,jsParams:r,addJSInitClass:a}},i.prototype.buildModsClasses=function(t,e,i){if(!i)return"";var n,s="";for(n in i)if(i.hasOwnProperty(n)){var o=i[n];if(o||0===o){"boolean"!=typeof o&&(o+="");var r=this.classBuilder;s+=" "+(e?r.buildElemClass(t,e,n,o):r.buildBlockClass(t,n,o))}}return s},i.prototype.renderContent=function(t,e){var i=this.context,n=i.position,s=i._listLength,o=i._notNewList;i._notNewList=!1,e&&(i.position=1,i._listLength=1);var r=this._run(t);return i.position=n,i._listLength=s,i._notNewList=o,r},i.prototype.renderNoTag=function(t,e,i,n,s,o,r){return r||0===r?this._run(r):""},i.prototype.local=function(t,e){for(var i=Object.keys(t),n=[],s=0;s<i.length;s++){for(var o=i[s],r=o.split("."),a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];n.push({parts:r,value:a[r[c]]}),a[r[c]]=t[o]}for(var h=e.call(this.context),s=0;s<n.length;s++){for(var r=n[s].parts,a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];a[r[c]]=n[s].value}return h},i.prototype.applyNext=function(){return this.match.exec(this.context)},i.prototype.applyMode=function(t,e){var i=this.match.entity.rest[t];if(i){if(!e)return i.exec(this.context);var n=this,s=function(){return i.exec(n.context)};return this.local(e,s)}},i.prototype.exportApply=function(t){var e=this;t.apply=function(t){return e.run(t)},t.compile=function(t){return e.compile(t)};var i={};t.BEMContext=this.contextConstructor,i.BEMContext=t.BEMContext;for(var n=0;n<this.oninit.length;n++){var s=this.oninit[n];s(t,i)}}},{"./class-builder":1,"./context":2,"./entity":3,"./tree":6,"./utils":7,inherits:8}],5:[function(t,e,i){function n(t,e){this.template=t,this.key=e.key,this.value=e.value}function s(t,e){this.template=t,this.keys=e.key,this.value=e.value}function o(t,e){this.template=t,this.key=e.key}function r(t,e){this.template=t,this.body=e.body}function a(t){this.template=t,this.once=null}function c(t){this.template=t,this.wrap=null}function h(t,e){this.mode=t,this.predicates=new Array(e.predicates.length),this.body=e.body;for(var i=[],h=0,u=0;h<this.predicates.length;h++,u++){var g=e.predicates[h];g instanceof d?this.predicates[u]=l.isArray(g.key)?new s(this,g):new n(this,g):g instanceof m?this.predicates[u]=new o(this,g):g instanceof _?this.predicates[u]=new r(this,g):g instanceof p?(u--,i.push(new a(this))):g instanceof f?(u--,i.push(new c(this))):u--}for(var h=i.length-1;h>=0;h--)this.predicates[h+u]=this.predicates[h];for(var h=0;h<i.length;h++)this.predicates[h]=i[h];u+=i.length,this.predicates.length!==u&&(this.predicates.length=u)}function u(t){this.entity=t,this.bemhtml=this.entity.bemhtml,this.templates=[],this.mask=[0],this.maskSize=0,this.maskOffset=0,this.count=0,this.depth=-1,this.thrownError=null}var l=t("./utils"),d=t("./tree").PropertyMatch,p=t("./tree").OnceMatch,f=t("./tree").WrapMatch,m=t("./tree").PropertyAbsent,_=t("./tree").CustomMatch;n.prototype.exec=function(t){return t[this.key]===this.value},s.prototype.exec=function(t){for(var e=t,i=0;i<this.keys.length-1;i++)if(e=e[this.keys[i]],!e)return!1;return e[this.keys[i]]===this.value},o.prototype.exec=function(t){return!t[this.key]},r.prototype.exec=function(t){return this.body.call(t)},a.prototype.exec=function(t){var e=this.once!==t._onceRef;return this.once=t._onceRef,e},c.prototype.exec=function(t){var e=this.wrap!==t.ctx;return this.wrap=t.ctx,e},i.MatchTemplate=h,i.Match=u,u.prototype.clone=function(t){var e=new u(t);return e.templates=this.templates.slice(),e.mask=this.mask.slice(),e.maskSize=this.maskSize,e.count=this.count,e},u.prototype.prepend=function(t){for(this.templates=t.templates.concat(this.templates),this.count+=t.count;Math.ceil(this.count/31)>this.mask.length;)this.mask.push(0);this.maskSize=this.mask.length},u.prototype.push=function(t){this.templates.push(new h(this,t)),this.count++,Math.ceil(this.count/31)>this.mask.length&&this.mask.push(0),this.maskSize=this.mask.length},u.prototype.tryCatch=function(t,e){try{return t.call(e)}catch(i){this.thrownError=i}},u.prototype.exec=function(t){for(var e,i=this.checkDepth(),n=this.maskOffset,s=this.mask[n],o=1,r=0;r<this.count;r++){if(0===(s&o)){e=this.templates[r];for(var a=e.predicates.length-1;a>=0;a--){var c=e.predicates[a];if(!c.exec(t))break}if(-1===a)break}1073741824===o?(n++,s=this.mask[n],o=1):o<<=1}if(r===this.count)return void 0;var h=s,u=this.bemhtml.match;this.mask[n]|=o,this.bemhtml.match=this,this.thrownError=null;var l;l="function"==typeof e.body?this.tryCatch(e.body,t):e.body,this.mask[n]=h,this.bemhtml.match=u,this.restoreDepth(i);var d=this.thrownError;if(null!==d)throw this.thrownError=null,d;return l},u.prototype.checkDepth=function(){if(-1===this.depth)return this.depth=this.bemhtml.depth,-1;if(this.bemhtml.depth===this.depth)return this.depth;var t=this.depth;for(this.depth=this.bemhtml.depth,this.maskOffset+=this.maskSize;this.mask.length<this.maskOffset+this.maskSize;)this.mask.push(0);return t},u.prototype.restoreDepth=function(t){-1!==t&&t!==this.depth&&(this.maskOffset-=this.maskSize),this.depth=t}},{"./tree":6,"./utils":7}],6:[function(t,e,i){function n(t,e){this.predicates=t,this.body=e}function s(){}function o(t,e){this.conditions=[],this.children=[];for(var i=e.length-1;i>=0;i--){var n=e[i];n instanceof s?this.conditions.push(n):this.children[i]=n===t.boundBody?t.queue.pop():n}}function r(){s.call(this)}function a(t){s.call(this),this.refs=t}function c(t){s.call(this),this.refs=t}function h(t){s.call(this),this.refs=t}function u(t){s.call(this),this.options=t}function l(t,e){s.call(this),this.key=t,this.value=e}function d(t){s.call(this),this.key=t}function p(t){s.call(this),this.body=t}function f(t){this.options=t,this.refs=this.options.refs,this.boundBody=this.body.bind(this);for(var e=this.methods("body"),i=0;i<e.length;i++){var n=e[i];this.boundBody[f.methods[i]]=n}this.queue=[],this.templates=[],this.initializers=[]}function m(t,e,i){var n=t[i],s=t.boundBody;return"body"!==e?"replace"===i||"extend"===i||"wrap"===i?function(){return n.apply(t,arguments)}:function(){return n.apply(t,arguments),s}:function(){var e=n.apply(t,arguments),o=t.queue.pop(),r=t.queue[t.queue.length-1];return r.conditions=r.conditions.concat(o.conditions),r.children=r.children.concat(o.children),"replace"===i||"extend"===i||"wrap"===i?e:s}}var _=t("minimalistic-assert"),g=t("inherits");i.Template=n,n.prototype.wrap=function(){for(var t=this.body,e=0;e<this.predicates.length;e++){var i=this.predicates[e];t=i.wrapBody(t)}this.body=t},n.prototype.clone=function(){return new n(this.predicates.slice(),this.body)},i.MatchBase=s,s.prototype.wrapBody=function(t){return t},g(r,s),i.OnceMatch=r,g(a,s),i.WrapMatch=a,a.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this))}},g(c,s),i.ReplaceMatch=c,c.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this))}},g(h,s),i.ExtendMatch=h,h.prototype.wrapBody=function(t){var e=this.refs.applyCtx,i=this.refs.local;return"function"!=typeof t?function(){for(var n={},s=Object.keys(t),o=0;o<s.length;o++)n["ctx."+s[o]]=t[s[o]];return i(n)(function(){return e(this.ctx)})}:function(){for(var n={},s=t.call(this),o=Object.keys(s),r=0;r<o.length;r++)n["ctx."+o[r]]=s[o[r]];return i(n)(function(){return e(this.ctx)})}},g(u,s),i.CompilerOptions=u,g(l,s),i.PropertyMatch=l,g(d,s),i.PropertyAbsent=d,g(p,s),i.CustomMatch=p,i.Tree=f,f.methods=["match","once","wrap","elemMatch","block","elem","mode","mod","elemMod","def","tag","attrs","cls","js","jsAttr","bem","mix","content","replace","extend","oninit","xjstOptions"],f.prototype.build=function(t,e){var i=this.methods("global").concat(e);return i[0]=this.match.bind(this),t.apply({},i),{templates:this.templates.slice().reverse(),oninit:this.initializers}},f.prototype.methods=function(t){for(var e=new Array(f.methods.length),i=0;i<e.length;i++){var n=f.methods[i];e[i]=m(this,t,n)}return e},f.prototype.flush=function(t,e){var i;i=e.conditions?t.concat(e.conditions):e.conditions;for(var s=0;s<e.children.length;s++){var r=e.children[s];if(r instanceof o)this.flush(i,e.children[s]);else{var a=new n(t,r);a.wrap(),this.templates.push(a)}}},f.prototype.body=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new o(this,t);return this.queue[this.queue.length-1].children.push(i),1===this.queue.length&&this.flush([],this.queue.shift()),this.boundBody},f.prototype.match=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var i=arguments[e];"function"==typeof i&&(i=new p(i)),_(i instanceof s,"Wrong .match() argument"),t[e]=i}return this.queue.push(new o(this,t)),this.boundBody},f.prototype.once=function(){return this.match(new r)},f.prototype.wrap=function(){return this.def().match(new a(this.refs))},f.prototype.xjstOptions=function(t){return this.queue.push(new o(this,[new u(t)])),this.boundBody},f.prototype.block=function(t){return this.match(new l("block",t))},f.prototype.elemMatch=function(){return this.match.apply(this,arguments)},f.prototype.elem=function(t){return this.match(new l("elem",t))},f.prototype.mode=function(t){return this.match(new l("_mode",t))},f.prototype.mod=function(t,e){return this.match(new l(["mods",t],e))},f.prototype.elemMod=function(t,e){return this.match(new l(["elemMods",t],e))},f.prototype.def=function(){return this.mode("default")},f.prototype.tag=function(){return this.mode("tag")},f.prototype.attrs=function(){return this.mode("attrs")},f.prototype.cls=function(){return this.mode("cls")},f.prototype.js=function(){return this.mode("js")},f.prototype.jsAttr=function(){return this.mode("jsAttr")},f.prototype.bem=function(){return this.mode("bem")},f.prototype.mix=function(){return this.mode("mix")},f.prototype.content=function(){return this.mode("content")},f.prototype.replace=function(){return this.def().match(new c(this.refs))},f.prototype.extend=function(){return this.def().match(new h(this.refs))},f.prototype.oninit=function(t){this.initializers.push(t)}},{inherits:8,"minimalistic-assert":9}],7:[function(t,e,i){function n(){return h+ ++r}var s=Object.prototype.toString;i.isArray=Array.isArray,i.isArray||(i.isArray=function(t){return"[object Array]"===s.call(t)}),i.xmlEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i.attrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")},i.jsAttrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/'/g,"&#39;")},i.extend=function(t,e){if(!t||!e)return t||e;var i,n={};for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n};var o={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};i.isShortTag=function(t){return o.hasOwnProperty(t)},i.isSimple=function(t){return t&&t!==!0?"string"==typeof t||"number"==typeof t:!0};var r=0,a=+new Date,c="__"+a,h="uniq"+a;i.getUniq=n,i.identify=function(t,e){if(!t)return n();if(e||t[c])return t[c];var i=n();return t[c]=i,i}},{}],8:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],9:[function(t,e){function i(t,e){if(!t)throw new Error(e||"Assertion failed")}e.exports=i,i.equal=function(t,e,i){if(t!=e)throw new Error(i||"Assertion failed: "+t+" != "+e)}},{}]},{},[4])(4)}),e.exports||i.BEMHTML}({},{}),s=new n({wrap:!1});return s.compile(function(t,e,n,s,o,r,a,c,h,u,l,d,p,f,m,_,g,b,v,y,k,M,w,E,B,x){k(function(){!function(t,e){if(!e.I18N){t.BEM=e;var i=e.I18N=function(t,e){return e};i.keyset=function(){return i},i.key=function(t){return t},i.lang=function(){}}}(this,"undefined"==typeof BEM?{}:BEM)}),o("domik")(u().match(function(){return!Object(this.ctx.mods).logo})(function(){var t;return this.ctx.lang?t=this.ctx.lang:BEM.blocks&&BEM.blocks["i-global"]?t=BEM.blocks["i-global"].param("lang"):this["i-global"]&&(t=this["i-global"].lang),B({"ctx.mods":this.extend(this.ctx.mods||{},{logo:-1!==["en","tr"].indexOf(t)?"en":"ru"})})}),b()(function(){return[{elem:"roof",content:[{elem:"roof-border"},{elem:"roof-body"},{elem:"logo"}]},{elem:"content",content:this.ctx.content}]}),r("roof-border").tag()("i"),r("roof-body").tag()("i"),r("logo").tag()("i")),k(function(t){var e=t.BEMContext.prototype,i=t["i-global"]=e["i-global"]=e.extend({lang:"ru",tld:"ru","content-region":"ru","click-host":"//clck.yandex.ru","passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","export-host":"https://export.yandex.ru",login:"","lego-static-host":"https://yastatic.net/lego/2.10-142"},e["i-global"]);i._public={id:!0,lang:!0,tld:!0,"content-region":!0,"user-region":!0,login:!0,displayName:!0,index:!0,yandexuid:!0,"passport-host":!0,"pass-host":!0,"passport-msg":!0,"static-host":!0,"lego-static-host":!0,"social-host":!0,clck:!0,"click-host":!0,"export-host":!0,"i-host":!0,"social-retpath":!0,"lego-path":!0,sid:!0,retpath:!0,uid:!0},i.makePublic=function(t,n){return"object"==typeof t?void(i._public=e.extend(i._public,t)):("undefined"==typeof n&&(n=!0),void(i._public[t]=n))},i.isPublic=function(t){return Boolean(i._public[t])},i.setTld=function(t){var e="tr"===t?"yandex.com.tr":"yandex."+t,n=-1!==["ua","by","kz"].indexOf(t)?"yandex.ru":e;i.tld=t,i["content-region"]=t,i["click-host"]="//clck."+n,i["passport-host"]="https://passport."+n,i["pass-host"]="https://pass."+e,i["social-host"]="https://social."+e,i["export-host"]="https://export."+e},e._iGlobalBackup={_backup:null,exists:function(){return Boolean(this._backup)},save:function(){this._backup=e.extend({},i)},restore:function(){var t;for(t in i)delete i[t];for(t in this._backup)i[t]=this._backup[t]}}}),o("i-global")(l()(""),u()(function(){var t=this.ctx.params||{},e=this["i-global"];this._iGlobalBackup.exists()?this.ctx.reset!==!1&&this._iGlobalBackup.restore():this._iGlobalBackup.save(),t.tld&&t.tld!==e.tld&&e.setTld(t.tld);for(var i in t)e[i]=t[i];return""})),k(function(t){var e=t["i-global"];["serpid","query","searchInputText","project","page","mobile","isYandexApp","tablet","counterDebug","seo","router","isOldBrowser","showRelevance","uid","ncrnd","isYandexNet","isPumpkin","isSpok","serviceName","expFlags","abuseLink","is500pxAvailable","lags","isPornoQuery","incutPosition"].forEach(function(t){e.makePublic(t)})}),o("utils").js()(!0),o("i-ua")(_()(!1),l()("script"),d()(function(){return{nonce:this.ctx.nonce||this["i-global"].nonce}}),b()(function(){return[";(function(d,e,c,r){","e=d.documentElement;",'c="className";','r="replace";','e[c]=e[c][r]("i-ua_js_no","i-ua_js_yes");','if(d.compatMode!="CSS1Compat")','e[c]=e[c][r]("i-ua_css_standart","i-ua_css_quirks")',"})(document);"].join("")})),o("i-ua").content()(function(){var t=B();return t+=[";(function(d,e,c,n,w,v,f){","e=d.documentElement;",'c="className";','n="createElementNS";','f="firstChild";','w="http://www.w3.org/2000/svg";','e[c]+=" i-ua_svg_"+(!!d[n]&&!!d[n](w,"svg").createSVGRect?"yes":"no");','v=d.createElement("div");','v.innerHTML="<svg/>";','e[c]+=" i-ua_inlinesvg_"+((v[f]&&v[f].namespaceURI)==w?"yes":"no");',"})(document);"].join("")}),o("i-ua").content()(function(){var t=B();return t+=[";(function(w,e,s,c,x,l,p,d){",'c="className";','x="deviceXDPI";','l="logicalXDPI";','p="devicePixelRatio";',"d=x in s&&l in s&&s[x]/s[l]||p in w&&w[p];",'d>1&&(e[c]+=" i-ua_retina_yes")',"})(window,document.documentElement,screen);"].join("")}),o("domik").mod("type","popup").attrs()(function(){var t=B()||{};return t.role="dialog",t}),o("popup")(u().match(function(){return!this._popupDefaults})(function(){var t=this.ctx;if(t.mods=this.mods=this.extend({theme:"ffffff",autoclosable:"yes",adaptive:"yes",animate:"yes"},this.mods),t.zIndex){var e=t.attrs||(t.attrs={});e.style=(e.style||"")+";z-index:"+t.zIndex+";"}return x("default",{_popupDefaults:!0})}),b()(function(){return delete this._popupDefaults,[{elem:"under",mods:this.ctx.underMods},this.ctx.content]})),o("i-bem").elem("i18n").def()(function(){if(!this.ctx)return"";var t=this.ctx,e=t.keyset,i=t.key,n=t.params||{};return e||i?(t.content&&(n.content=this.reapply(t.content)),E(BEM.I18N(e,i,n))):""}),o("auth")(u()(function(){var t=this.ctx,e=function(t,e){return t?BEM.blocks["i-global"].param(e):this["i-global"][e]}.bind(this,BEM&&BEM.blocks);return void 0===t.retpath&&(t.retpath=e("retpath")),void 0===t.from&&(t.from=e("passport-msg")),B({_passportHost:e("passport-host")})}),l()("form"),f()(!0),d()(function(){return{method:"post",action:this.ctx.url||this._passportHost+"/auth",role:"form","aria-label":BEM.I18N("auth","auth")}}),a("auto-content")([]),b()(function(){var t=this.ctx;return[t.content||x("auto-content"),["retpath","from","origin","timestamp"].map(function(e){return{elem:"hidden",mix:{elem:e},name:e,val:t[e]}})]})),o("auth").elem("hidden")(l()("input"),d()(function(){return{type:"hidden",name:this.ctx.name,value:this.ctx.val}})),o("popup").elem("tail").tag()("i"),o("auth").mod("content","auto")(a("auto-content")([{elem:"username"},{elem:"password"},{elem:"row",mods:{button:"yes"},content:[{elem:"haunter"},{elem:"button"}]},{elem:"social"},{elem:"row",content:[{elem:"remember"},{elem:"register"}]}]),r("username").content()(function(){return{block:"input",mods:{theme:"normal",size:"m"},name:"login",placeholder:BEM.I18N("auth","login"),content:[{elem:"control",attrs:{"aria-required":!0}}]}}),r("password").content()(function(){return{block:"input",mods:{theme:"normal",size:"m"},name:"passwd",placeholder:BEM.I18N("auth","password"),content:[{elem:"control",attrs:{type:"password",maxlength:256,"aria-required":!0}}]}}),r("haunter").content()(function(){return{block:"checkbox",mods:{theme:"normal",size:"m"},checkboxAttrs:{id:"auth-haunter",autocomplete:"off",name:"twoweeks",value:"no"},text:BEM.I18N("auth","temporary")}}),r("button").content()(function(){return{block:"button2",mods:{theme:"action",size:"m",type:"submit"},text:BEM.I18N("auth","logon")}}),r("remember").content()(function(){return{block:"button2",mods:{theme:"pseudo",size:"s",type:"link"},url:this.ctx.url||this._passportHost+"/restoration",text:BEM.I18N("auth","remember")}}),r("register").content()(function(){return{block:"button2",mods:{theme:"pseudo",size:"s",type:"link"},url:this.ctx.url||this._passportHost+"/registration",text:BEM.I18N("auth","register")}})),o("auth").elem("social").attrs()(function(){return{role:"group","aria-label":BEM.I18N("auth","social-log-in")}}),o("auth").elem("social-icon")(l()("i"),b()("&nbsp;")),k(function(t){t.BEMContext.prototype.util||(t.BEMContext.prototype.util={})}),k(function(t){function e(t){return"[object Object]"===s.call(t)}function i(t,n,s){var o,r;t=Object(t),n=Object(n);for(o in n)r=s&&s(t[o],n[o],o),t[o]=void 0!==r?r:e(t[o])&&e(n[o])?i(t[o],n[o],s):n[o];return t}function n(t,e){return i(t,e,function(t,e,i){return"mix"===i?[].concat(t,e):void 0})}var s=Object.prototype.toString;t.BEMContext.prototype.util.merge=i,t.BEMContext.prototype.util.mergeBemjson=n}),o("link")(u()(function(){var t=this.mods;return t.theme||(t.theme=t.outer&&"outer"||t.pseudo&&"pseudo"||"normal"),void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),B()}),l()(function(){return void 0!==this.ctx.url?"a":"span"}),f()(function(){return{_tabindex:this.ctx.tabindex,origTabindex:this.ctx.tabindex}}),d()(function(){var t=this.ctx,e=t.url,i=void 0!==e,n=Boolean(this.mods.disabled);return{id:t.id,name:t.name,title:t.title,target:t.target,tabindex:n?void 0:t.tabindex,href:i?this.isSimple(e)?e:this.reapply(e):void 0,role:i?void 0:"button","aria-disabled":n?"true":void 0}}),t(function(){return void 0===this.ctx.content}).content()(function(){var t=this.ctx,e=Boolean(t.text),i=Boolean(t.icon);return[i&&this.util.mergeBemjson({block:"icon",mix:{block:"link",elem:"icon"}},t.icon),e&&(this.isSimple(t.text)?i?{elem:"inner",content:this.xmlEscape(t.text)}:this.xmlEscape(t.text):t.text.block?this.util.mergeBemjson({mix:{block:"link",elem:"inner"}},t.text):this.extend({block:"link",elem:"inner"},t.text))]}),r("inner").tag()("span")),o("link")(f()(!0),d()(function(){for(var t,e=this.ctx,i={href:e.url},n=["title","target"];t=n.pop();)e[t]&&(i[t]=e[t]);return e.counter&&(i.onmousedown=e.counter),i})),o("dropdown")(f()(!0),g()(function(){return[{mods:{action:"closed"}}]}),r("popup").def()(function(){var t=this.ctx,e=[{block:"dropdown",elem:"popup"}];return t.mix&&(e=e.concat(t.mix)),E({block:"popup",mix:e,mods:t.mods,underMods:t.underMods,attrs:t.attrs,js:t.js,content:[{elem:"tail"},{elem:"content",content:t.content}]})})),o("dropdown")(r("text").tag()("span"),r("switcher-text").tag()("span")),o("button")(l()("button"),t(function(){return this.ctx.url}).tag()("a"),f()(!0),u()(function(){return this.ctx.mods=this.extend({theme:"normal"},this.ctx.mods),B()}),d()(t(function(){return!0})(function(){var t=this.ctx,e={};return e.tabindex=t.tabindex,e}),t(function(){return this.ctx.url})(function(){var t=this.ctx,e=B(),i={href:t.url,target:t.target};return this.extend(e,i)}),t(function(){return!this.ctx.url})(function(){var t=this.ctx,e=B(),i={type:t.type||"button",autocomplete:"off",name:t.name,value:t.value};return this.extend(e,i)})),b()(function(){return{elem:"text",tag:"span",content:this.ctx.content}})),o("button").mod("disabled","yes").attrs()(function(){var t=this.ctx,e={};return t.url?e["aria-disabled"]=!0:e.disabled="disabled",this.extend(B(),e)}),k(function(t){t.BEMContext.prototype.cleverSubstring=function(t,e,i){return t.length>e+i?t.substring(0,e-1)+"…":t}}),o("i-ua").content()(function(){var t=B();return t+=[";(function(d,e,p){","e=d.documentElement;",'p="placeholder";','e.className+=" i-ua_"+p+(p in d.createElement("input")?"_yes":"_no")',"})(document);"].join("")}),o("input")(l()("span"),a("live")(!1),a("getLive")(function(){var t=x("live"),e=this.ctx.js,i=this.ctx.mods,n={autofocus:"yes",width:"content","tap-ahead":"yes"};if(e){if(e.autoFocus&&e.live)throw new Error('input block can\'t have both "live" and "autoFocus" enabled');void 0!==e.live&&(t=e.live);var s=Object.keys(n).some(function(t){return i[t]===n[t]});(s||e.autoFocus)&&(t=!1)}return t}),f()(function(){return{live:this._live}}),u()(function(){var t,e=x("value",{ctx:this.ctx.value}),i=this.ctx.id||this.generateId(),n=this.ctx.mods||{},s=x("getLive",{}),o=this.ctx.placeholder;return n.theme=n.theme||"normal",this.ctx.hasOwnProperty("placeholder")&&(t=this.isSimple(o)?o:this.reapply(o)),B({_inputId:i,_labelId:"label"+i,_hintId:"hint"+i,_name:this.ctx.name||"",_value:e,_inputLink:!0,_iconLeft:this.ctx.icon||this.ctx.iconLeft,_iconRight:this.ctx.iconRight,_disabled:this.mods&&this.mods.disabled,_live:s,_placeholder:t,"ctx.mods":n})}),a("value")("",t(function(){return this.ctx})(function(){return this.reapply(this.ctx)}),t(function(){return this.isSimple(this.ctx)})(function(){return this.ctx}))),o("input").elem("box")(l()("span"),b()(function(){return[this._iconLeft&&{elem:"icon",icon:this._iconLeft,elemMods:{side:"left"}},this._iconRight&&{elem:"icon",icon:this._iconRight,elemMods:{side:"right"}},!this.mods.clear&&{elem:"clear",elemMods:this._value?{visibility:"visible"}:void 0,content:"&nbsp;"},this.ctx.content].filter(Boolean)})),o("input").elem("control")(l()("input"),d()(function(){var t=this.extend({id:this._inputId,name:this._name,placeholder:this._placeholder},this.ctx.controlAttrs);return(this._value||0===this._value)&&(t.value=this._value),this.mods.disabled&&(t.disabled="disabled"),this._live&&(t.autocomplete="off"),t["aria-labelledby"]=this._labelId+" "+this._hintId,t}),n()(function(){return[this._placeholder?{elem:"hint",elemMods:{fallback:"yes"},content:this._placeholder}:"",{elem:"box",content:this.ctx}]})),o("input").elem("clear")(l()("span"),d()(function(){return{unselectable:"on"}}),b().match(function(){return!this.ctx.content})("")),o("input").match(function(){return this._service})(r("box").content()(function(){return[{elem:"box-layout",content:{tag:"tr",content:[{elem:"box-layout-cell",elemMods:{pos:"first"},content:this.extend({block:"service",urlAttrs:{tabindex:-1,"aria-hidden":!0},mix:[{block:"input",elem:"service-label"}],icon:!1},"string"==typeof this._service?{service:this._service}:this._service)},{elem:"box-layout-cell",elemMods:{pos:"last"},content:B()}]}}]}),r("box-layout").tag()("table"),r("box-layout-cell").tag()("td")),o("input").match(function(){return this._service})(r("box-layout-cell").elemMod("pos","first").content()(function(){var t=B();return t.mods||(t.mods={}),t.mods["input-label"]="yes",t})),o("input").match(function(){return this._service})(u()(function(){return B({cbirImage:this.ctx.cbirImage,hideServiceLabel:this.ctx.hideServiceLabel,isAnyCbirPage:this.ctx.isAnyCbirPage})}),r("box-layout").content()(function(){var t,e=B();return this.mods&&"yes"===this.mods.cbir&&(t=e.content,t.splice(1,0,{elem:"box-layout-cell",content:{block:"cbir-intent",src:this.cbirImage,mods:{visibility:this.cbirImage&&this.isAnyCbirPage?"visible":""}}})),this.hideServiceLabel&&(t[0].content=""),e})),o("service")(u()(function(){var t=this.ctx;return B({_url:t.url!==!1&&(t.url||this["i-services"].serviceUrl(t.service)),_icon:t.icon!==!1,_name:t.name!==!1})}),b().match(function(){return this._url})(function(){return{elem:"url",url:this._url,urlParams:this.ctx.urlParams||"",urlAttrs:this.ctx.urlAttrs,counter:this.ctx.counter,content:B({_url:!1})}}),b().match(function(){return!this._url})(function(){var t=[];return this._icon&&t.push({elem:"icon",service:this.ctx.service,elemMods:this.ctx.iconMods,serviceIconMods:this.ctx.serviceIconMods}),this._name&&t.push({elem:"name",service:this.ctx.service,name:this.ctx.name}),t})),k(function(t){var e=t["i-services"]=t.BEMContext.prototype["i-services"]={},i=t["i-global"];e.serviceName=function(t){return BEM.I18N("i-services",t||i.id)
},e.serviceUrl=function(t,n){var s=i;return t||(t=s.id),n||(n=s["content-region"]),e._data[t](n)}}),o("i-services").def()(s(function(){return this.elem})(""),r("name")(function(){return E(this["i-services"].serviceName(this.ctx.id))}),r("url")(function(){return E(this["i-services"].serviceUrl(this.ctx.id,this.ctx.region))})),k(function(t){t["i-services"]._data={404:function(t){switch(t){case"ua":return"http://404.yandex.ua";case"by":return"http://404.yandex.by";case"kz":return"http://404.yandex.kz";case"com":return"http://404.yandex.com";case"tr":return"http://404.yandex.com.tr";default:return"http://404.yandex.ru"}},adresa:function(){return"http://adresa.yandex.ru"},advertising:function(t){switch(t){case"ua":return"https://advertising.yandex.ua";case"by":return"https://advertising.yandex.by";case"kz":return"https://advertising.yandex.kz";case"com":return"https://advertising.yandex.com";default:return"https://advertising.yandex.ru"}},afisha:function(t){switch(t){case"ua":return"https://afisha.yandex.ua";case"by":return"https://afisha.yandex.by";case"kz":return"https://afisha.yandex.kz";default:return"https://afisha.yandex.ru"}},all:function(t){switch(t){case"ua":return"//www.yandex.ua/all";case"by":return"//www.yandex.by/all";case"kz":return"//www.yandex.kz/all";case"com":return"//www.yandex.com/all";case"tr":return"//www.yandex.com.tr/all";default:return"//www.yandex.ru/all"}},api:function(t){switch(t){case"com":return"http://api.yandex.com";default:return"http://api.yandex.ru"}},appsearch:function(){return"//appsearch.yandex.ru"},auto:function(t){switch(t){case"ua":return"https://auto.yandex.ua";default:return"https://auto.yandex.ru"}},avia:function(t){switch(t){case"ua":return"https://avia.yandex.ua";default:return"https://avia.yandex.ru"}},aziada:function(){return"http://aziada2011.yandex.kz"},ba:function(t){switch(t){case"ua":return"https://ba.yandex.ua";case"by":return"https://ba.yandex.by";case"kz":return"https://ba.yandex.kz";case"com":return"https://ba.yandex.com";default:return"https://ba.yandex.ru"}},backapv:function(){return"http://backapv.yandex.ru"},balance:function(){return"https://balance.yandex.ru"},bar:function(t){switch(t){case"ua":return"http://bar.yandex.ua";case"by":return"http://bar.yandex.by";case"kz":return"http://bar.yandex.kz";case"tr":return"http://bar.yandex.com.tr";default:return"http://bar.yandex.ru"}},"bar-ie":function(t){switch(t){case"ua":return"http://bar.yandex.ua/ie";case"by":return"http://bar.yandex.by/ie";case"kz":return"http://bar.yandex.kz/ie";case"com":return"http://bar.yandex.com/ie";case"tr":return"http://bar.yandex.com.tr/ie";default:return"http://bar.yandex.ru/ie"}},"bar-ie9":function(t){switch(t){case"ua":return"http://bar.yandex.ua/ie";case"by":return"http://bar.yandex.by/ie";case"kz":return"http://bar.yandex.kz/ie";case"com":return"http://bar.yandex.com/ie";case"tr":return"http://bar.yandex.com.tr/ie";default:return"http://bar.yandex.ru/ie"}},bayan:function(){return"http://bayan.yandex.ru"},blogs:function(t){switch(t){case"ua":return"https://blogs.yandex.ua";case"by":return"https://blogs.yandex.by";case"kz":return"https://blogs.yandex.kz";default:return"https://blogs.yandex.ru"}},books:function(){return"http://books.yandex.ru"},browser:function(t){switch(t){case"ua":return"https://browser.yandex.ua";case"by":return"https://browser.yandex.by";case"kz":return"https://browser.yandex.kz";case"com":return"https://browser.yandex.com";case"tr":return"https://browser.yandex.com.tr";default:return"https://browser.yandex.ru"}},calendar:function(){return"https://calendar.yandex.ru"},catalogwdgt:function(){return"https://www.yandex.ru/catalog"},chrome:function(){return"http://chrome.yandex.ru"},city:function(t){switch(t){case"ua":return"https://gorod.yandex.ua";case"by":return"https://gorod.yandex.by";case"kz":return"https://gorod.yandex.kz";case"com":return"https://city.yandex.com";case"tr":return"https://city.yandex.com.tr";default:return"https://gorod.yandex.ru"}},cityday:function(){return"http://cityday.yandex.ru"},collection:function(){return"https://collection.yandex.ru"},company:function(t){switch(t){case"com":return"https://company.yandex.com";case"tr":return"https://company.yandex.com.tr";default:return"https://company.yandex.ru"}},contest:function(t){switch(t){case"com":return"https://contest.yandex.com";default:return"https://contest.yandex.ru"}},desktop:function(){return"http://desktop.yandex.ru"},direct:function(t){switch(t){case"ua":return"https://direct.yandex.ua";case"by":return"https://direct.yandex.by";case"kz":return"https://direct.yandex.kz";case"com":return"https://direct.yandex.com";default:return"https://direct.yandex.ru"}},"direct.market":function(){return"https://partner.market.yandex.ru/yandex.market/"},disk:function(t){switch(t){case"ua":return"https://disk.yandex.ua";case"by":return"https://disk.yandex.by";case"kz":return"https://disk.yandex.kz";case"com":return"https://disk.yandex.com";case"tr":return"https://disk.yandex.com.tr";default:return"https://disk.yandex.ru"}},display:function(t){switch(t){case"tr":return"https://display.yandex.com.tr";default:return"https://display.yandex.ru"}},ege:function(t){switch(t){case"ua":return"https://zno.yandex.ua";default:return"https://ege.yandex.ru"}},expert:function(){return"http://expert.yandex.ru"},feedback:function(t){switch(t){case"ua":return"http://feedback.yandex.ua";case"by":return"http://feedback.yandex.by";case"kz":return"http://feedback.yandex.kz";case"com":return"http://feedback.yandex.com";case"tr":return"http://contact.yandex.com.tr";default:return"http://feedback.yandex.ru"}},feedback2:function(t){switch(t){case"ua":return"//feedback2.yandex.ua";case"by":return"//feedback2.yandex.by";case"kz":return"//feedback2.yandex.kz";case"com":return"//feedback2.yandex.com";case"tr":return"//contact2.yandex.com.tr";default:return"//feedback2.yandex.ru"}},ff:function(){return"http://ff.yandex.ru"},fotki:function(){return"https://fotki.yandex.ru"},fresh:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://www.yandex.com";case"tr":return"https://www.yandex.com.tr";default:return"https://yandex.ru"}},fx:function(t){switch(t){case"ua":return"https://fx.yandex.ua";case"tr":return"https://fx.yandex.com.tr";default:return"https://fx.yandex.ru"}},games:function(){return"http://games.yandex.ru"},geocontext:function(){return"https://geocontext.yandex.ru"},goroda:function(){return"http://goroda.yandex.ru"},help:function(t){switch(t){case"ua":return"https://help.yandex.ua";case"com":return"https://help.yandex.com";case"tr":return"https://yardim.yandex.com.tr";default:return"https://help.yandex.ru"}},i:function(){return"http://i.yandex.ru"},ie:function(t){switch(t){case"ua":return"https://ie.yandex.ua";case"tr":return"https://ie.yandex.com.tr";default:return"https://ie.yandex.ru"}},images:function(t){switch(t){case"ua":return"https://yandex.ua/images/";case"by":return"https://yandex.by/images/";case"kz":return"https://yandex.kz/images/";case"com":return"https://yandex.com/images/";case"tr":return"https://yandex.com.tr/gorsel/";default:return"https://yandex.ru/images/"}},"images-com":function(){return"https://yandex.com/images/"},interests:function(){return"http://interests.yandex.ru"},internet:function(t){switch(t){case"com":return"//internet.yandex.com";case"tr":return"//internet.yandex.com.tr";default:return"//internet.yandex.ru"}},kassa:function(){return"https://kassa.yandex.ru"},keyboard:function(){return"http://www.yandex.ru/index_engl_qwerty.html"},kraski:function(){return"http://kraski.yandex.ru"},kuda:function(){return"http://kuda.yandex.ru"},large:function(){return"http://large.yandex.ru"},legal:function(t){switch(t){case"ua":return"https://yandex.ua/legal";case"com":return"https://yandex.com/legal";case"tr":return"https://yandex.com.tr/legal";default:return"https://yandex.ru/legal"}},lenta:function(){return"http://lenta.yandex.ru"},literacy:function(){return"https://literacy.yandex.ru"},local:function(){return"http://local.yandex.ru"},lost:function(){return"http://lost.yandex.ru"},love:function(){return"http://love.yandex.ru"},mail:function(t){switch(t){case"ua":return"https://mail.yandex.ua";case"by":return"https://mail.yandex.by";case"kz":return"https://mail.yandex.kz";case"com":return"https://mail.yandex.com";case"tr":return"https://mail.yandex.com.tr";default:return"https://mail.yandex.ru"}},maps:function(t){switch(t){case"ua":return"https://maps.yandex.ua";case"com":return"https://maps.yandex.com";case"tr":return"https://harita.yandex.com.tr";default:return"https://maps.yandex.ru"}},"maps-com":function(){return"https://maps.yandex.com"},"maps-wiki":function(){return"http://nk.yandex.ru"},market:function(t){switch(t){case"ua":return"https://market.yandex.ua";case"by":return"https://market.yandex.by";case"kz":return"https://market.yandex.kz";case"tr":return"https://market.yandex.com.tr";default:return"https://market.yandex.ru"}},"market.advertising":function(){return"https://welcome.advertising.yandex.ru/market/"},master:function(){return"https://master.yandex.ru"},metrika:function(t){switch(t){case"ua":return"https://metrika.yandex.ua";case"by":return"https://metrika.yandex.by";case"kz":return"https://metrika.yandex.kz";case"com":return"https://metrica.yandex.com";case"tr":return"https://metrica.yandex.com.tr";default:return"https://metrika.yandex.ru"}},metro:function(){return"https://metro.yandex.ru"},mobile:function(t){switch(t){case"ua":return"https://mobile.yandex.ua";case"tr":return"https://mobil.yandex.com.tr";default:return"https://mobile.yandex.ru"}},moikrug:function(){return"http://moikrug.ru"},money:function(){return"https://money.yandex.ru"},museums:function(){return"http://18.yandex.ru"},music:function(t){switch(t){case"ua":return"https://music.yandex.ua";case"by":return"https://music.yandex.by";case"kz":return"https://music.yandex.kz";default:return"https://music.yandex.ru"}},"music-partner":function(){return"http://music-partner.yandex.ru"},nahodki:function(t){switch(t){case"ua":return"https://nahodki.yandex.ua";case"kz":return"https://nahodki.yandex.kz";default:return"https://nahodki.yandex.ru"}},nano:function(){return"http://nano.yandex.ru"},news:function(t){switch(t){case"ua":return"https://news.yandex.ua";case"by":return"https://news.yandex.by";case"kz":return"https://news.yandex.kz";case"tr":return"https://haber.yandex.com.tr";default:return"https://news.yandex.ru"}},"news-com":function(){return"https://news.yandex.com"},notifications:function(t){switch(t){case"ua":return"https://notifications.yandex.ua";case"by":return"https://notifications.yandex.by";case"kz":return"https://notifications.yandex.kz";case"com":return"https://notifications.yandex.com";case"tr":return"https://notifications.yandex.com.tr";default:return"https://notifications.yandex.ru"}},oauth:function(t){switch(t){case"com":return"https://oauth.yandex.com";default:return"https://oauth.yandex.ru"}},online:function(){return"http://online.yandex.ru"},openid:function(){return"http://openid.yandex.ru"},opera:function(t){switch(t){case"tr":return"https://opera.yandex.com.tr";default:return"https://opera.yandex.ru"}},opinion:function(){return"http://opinion.yandex.ru"},partners:function(t){switch(t){case"ua":return"http://partner.yandex.ua";case"by":return"http://partner.yandex.by";case"kz":return"http://partner.yandex.kz";case"com":return"http://partner.yandex.com";default:return"http://partner.yandex.ru"}},partnersearch:function(){return"http://yandex.ru"},passport:function(t){switch(t){case"com":return"https://passport.yandex.com";case"tr":return"https://passport.yandex.com.tr";default:return"https://passport.yandex.ru"}},pdd:function(){return"https://pdd.yandex.ru"},peoplesearch:function(t){switch(t){case"ua":return"http://people.yandex.ua";default:return"http://people.yandex.ru"}},perevod:function(){return"https://perevod.yandex.ru"},probki:function(t){switch(t){case"ua":return"http://probki.yandex.ua";default:return"http://probki.yandex.ru"}},pulse:function(t){switch(t){case"ua":return"http://blogs.yandex.ua/pulse";case"by":return"http://blogs.yandex.by/pulse";case"kz":return"http://blogs.yandex.kz/pulse";default:return"http://blogs.yandex.ru/pulse"}},punto:function(){return"https://punto.yandex.ru"},pvo:function(){return"http://ask.yandex.ru"},rabota:function(t){switch(t){case"ua":return"https://rabota.yandex.ua";case"by":return"https://rabota.yandex.by";case"kz":return"https://rabota.yandex.kz";default:return"https://rabota.yandex.ru"}},rasp:function(t){switch(t){case"ua":return"https://rasp.yandex.ua";case"by":return"https://rasp.yandex.by";case"kz":return"https://rasp.yandex.kz";case"tr":return"https://seferler.yandex.com.tr";default:return"https://rasp.yandex.ru"}},realty:function(t){switch(t){case"ua":return"https://realty.yandex.ua";case"by":return"https://realty.yandex.by";case"kz":return"https://realty.yandex.kz";default:return"https://realty.yandex.ru"}},referats:function(){return"https://referats.yandex.ru"},review:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://www.yandex.com";case"tr":return"https://www.yandex.com.tr";default:return"https://yandex.ru"}},rk:function(){return"http://rk.yandex.ru"},root:function(){return"https://root.yandex.ru"},school:function(){return"http://school.yandex.ru"},search:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";default:return"https://yandex.ru"}},serp:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://www.yandex.com";case"tr":return"https://www.yandex.com.tr";default:return"https://yandex.ru"}},server:function(){return"http://company.yandex.ru/technology/server/"},shtrafi:function(){return"https://money.yandex.net/debts"},site:function(t){switch(t){case"ua":return"https://site.yandex.ua";case"tr":return"https://ozel.yandex.com.tr";default:return"https://site.yandex.ru"}},slovari:function(t){switch(t){case"ua":return"https://slovari.yandex.ua";case"by":return"https://slovari.yandex.by";case"kz":return"https://slovari.yandex.kz";default:return"https://slovari.yandex.ru"}},so:function(){return"http://so.yandex.ru"},social:function(t){switch(t){case"ua":return"https://social.yandex.ua";case"by":return"https://social.yandex.by";case"kz":return"https://social.yandex.kz";case"com":return"https://social.yandex.ru";case"tr":return"https://social.yandex.com.tr";default:return"https://social.yandex.ru"}},soft:function(t){switch(t){case"ua":return"https://soft.yandex.ua";case"tr":return"https://soft.yandex.com.tr";default:return"https://soft.yandex.ru"}},sport:function(t){switch(t){case"ua":return"http://sport.yandex.ua";case"by":return"http://sport.yandex.by";case"kz":return"http://sport.yandex.kz";case"tr":return"http://spor.yandex.com.tr";default:return"http://sport.yandex.ru"}},sprav:function(t){switch(t){case"ua":return"https://sprav.yandex.ua";case"by":return"https://sprav.yandex.by";case"kz":return"https://sprav.yandex.kz";case"tr":return"https://rehber.yandex.com.tr";default:return"https://sprav.yandex.ru"}},start:function(t){switch(t){case"ua":return"https://help.yandex.ua/start/";case"com":return"https://help.yandex.com/start/";case"tr":return"https://yardim.yandex.com.tr/start";default:return"https://help.yandex.ru/start/"}},stat:function(t){switch(t){case"ua":return"https://stat.yandex.ua";case"by":return"https://stat.yandex.by";default:return"https://stat.yandex.ru"}},subs:function(){return"https://subs.yandex.ru"},taxi:function(){return"https://taxi.yandex.ru"},terms:function(){return"http://terms.yandex.ru"},tests:function(){return"http://tests.yandex.ru"},ticket:function(){return"http://ticket.yandex.ru"},time:function(t){switch(t){case"ua":return"https://time.yandex.ua";case"by":return"https://time.yandex.by";case"kz":return"https://time.yandex.kz";case"com":return"https://time.yandex.com";case"tr":return"https://saat.yandex.com.tr";default:return"https://time.yandex.ru"}},toster:function(){return"http://toster.yandex.ru"},translate:function(t){switch(t){case"ua":return"https://translate.yandex.ua";case"by":return"https://translate.yandex.by";case"kz":return"https://translate.yandex.kz";case"com":return"https://translate.yandex.com";case"tr":return"https://ceviri.yandex.com.tr";default:return"https://translate.yandex.ru"}},tune:function(t){switch(t){case"ua":return"https://tune.yandex.ua";case"by":return"https://tune.yandex.by";case"kz":return"https://tune.yandex.kz";case"com":return"https://tune.yandex.com";case"tr":return"https://tune.yandex.com.tr";default:return"https://tune.yandex.ru"}},tv:function(t){switch(t){case"ua":return"https://tv.yandex.ua";case"by":return"https://tv.yandex.by";case"kz":return"https://tv.yandex.kz";default:return"https://tv.yandex.ru"}},uslugi:function(){return"http://uslugi.yandex.ru"},video:function(t){switch(t){case"ua":return"http://yandex.ua/video/";case"by":return"http://yandex.by/video/";case"kz":return"http://yandex.kz/video/";case"com":return"https://yandex.com/video/";case"tr":return"http://yandex.com.tr/video/";default:return"http://yandex.ru/video/"}},"video-com":function(){return"https://yandex.com/video/"},vno:function(){return"https://zno.yandex.ua"},wdgt:function(t){switch(t){case"ua":return"https://wdgt.yandex.ua";case"by":return"https://wdgt.yandex.by";case"kz":return"https://wdgt.yandex.kz";case"tr":return"https://wdgt.yandex.com.tr";default:return"https://wdgt.yandex.ru"}},weather:function(t){switch(t){case"ua":return"https://pogoda.yandex.ua";case"by":return"https://pogoda.yandex.by";case"kz":return"https://pogoda.yandex.kz";case"tr":return"https://hava.yandex.com.tr";default:return"https://pogoda.yandex.ru"}},webmaster:function(t){switch(t){case"ua":return"https://webmaster.yandex.ua";case"com":return"https://webmaster.yandex.com";case"tr":return"https://webmaster.yandex.com.tr";default:return"https://webmaster.yandex.ru"}},widgets:function(t){switch(t){case"ua":return"https://widgets.yandex.ua";case"by":return"https://widgets.yandex.by";case"kz":return"https://widgets.yandex.kz";case"tr":return"https://widgets.yandex.com.tr";default:return"https://widgets.yandex.ru"}},wordstat:function(){return"https://wordstat.yandex.ru"},wow:function(){return"http://my.ya.ru"},www:function(t){switch(t){case"ua":return"https://www.yandex.ua";case"by":return"https://www.yandex.by";case"kz":return"https://www.yandex.kz";case"com":return"https://www.yandex.com";case"tr":return"https://www.yandex.com.tr";default:return"https://www.yandex.ru"}},xmlsearch:function(t){switch(t){case"ua":return"https://xml.yandex.ua";case"by":return"https://xml.yandex.by";case"kz":return"https://xml.yandex.kz";case"com":return"https://xml.yandex.com";case"tr":return"https://xml.yandex.com.tr";default:return"https://xml.yandex.ru"}},yaca:function(t){switch(t){case"ua":return"https://yaca.yandex.ua";case"by":return"https://yaca.yandex.by";default:return"https://yaca.yandex.ru"}},yamb:function(){return"https://yamb.yandex.ru"},zakladki:function(){return"http://zakladki.yandex.ru"}}}),o("input").elem("hint")(l()("label"),d()(function(){return{id:this._hintId,"for":this._inputId,"aria-hidden":!0}}),t(function(){return!this._value&&0!==this._value}).def()(function(){var t=this.ctx,e=t.elemMods||(t.elemMods={});return e.visibility="visible",this._iconLeft&&(e.lpad="yes"),this._iconRight&&(e.rpad="yes"),B()})),o("checkbox")(u()(function(){var t=this.ctx;return this.mods.theme||(this.mods.theme="normal"),t.checkboxAttrs=this.extend({id:this.generateId(),checked:this.mods.checked?"checked":void 0,disabled:this.mods.disabled?"disabled":void 0},t.checkboxAttrs),t.checkboxAttrs["aria-labelledby"]="label"+t.checkboxAttrs.id,B({_labelAttrs:{id:t.checkboxAttrs["aria-labelledby"],"for":t.checkboxAttrs.id}})}),l()("span"),f()(function(){return this.extend({live:!1},this.ctx.js)}),t(function(){return void 0!==this.ctx.content}).content()(function(){return[{elem:"box",tag:"span",elemMods:"yes"===this.mods.checked?{checked:"yes"}:"",content:[{elem:"control",attrs:this.ctx.checkboxAttrs},{elem:"tick",tag:"i"}]},this.ctx.content]}),t(function(){return void 0===this.ctx.content}).content()(function(){return[this.util.merge({elem:"box",tag:"span",elemMods:"yes"===this.mods.checked?{checked:"yes"}:"",content:[this.util.merge({elem:"control",attrs:this.ctx.checkboxAttrs},this.ctx.control),{elem:"tick",tag:"i"}]},this.ctx.box),void 0!==this.ctx.text&&this.util.merge({elem:"label"},this.isSimple(this.ctx.text)?{content:this.xmlEscape(this.ctx.text)}:this.ctx.text)].filter(Boolean)})),o("checkbox").elem("control")(l()("input"),d()(function(){return{type:"checkbox",autocomplete:"off"}})),o("checkbox").elem("label")(l()("label"),d()(function(){return this.extend({"aria-hidden":"true"},this._labelAttrs)})),o("button2")(u()(function(){return void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),B()}),t(function(){return void 0===this.ctx.tag}).tag()("button"),f()(function(){return{_tabindex:this.ctx.tabindex}}),d()(function(){var t=this.ctx,e=Boolean(this.mods.disabled);return{type:"button",autocomplete:"off",id:t.id,title:t.title,name:t.name,value:t.val,tabindex:e?void 0:t.tabindex,disabled:e?"disabled":void 0,"aria-disabled":e?"true":void 0}}),t(function(){return!this.ctx.content}).content()(function(){var t=this.ctx;return[t.icon&&{elem:"icon",icon:t.icon},t.iconLeft&&{elem:"icon",elemMods:{side:"left"},icon:t.iconLeft},t.iconRight&&{elem:"icon",elemMods:{side:"right"},icon:t.iconRight},void 0!==t.text&&(this.isSimple(t.text)?{elem:"text",content:this.xmlEscape(t.text)}:this.extend(t.text,{elem:"text"}))].filter(Boolean)})),o("button2").elem("text").tag()("span"),o("button2").mod("type","submit").attrs()(function(){return this.extend(B(),{type:"submit"})}),o("button2").mod("type","link")(l()("a"),d()(function(){return this.extend(B(),{target:this.ctx.target,href:this.mods.disabled?void 0:this.ctx.url,autocomplete:void 0,type:void 0})}),f()(function(){return this.extend(B(),{_url:this.ctx.url})})),o("dropdown").mod("advanced","yes")(r("hidden-value")(l()("input"),d()(function(){return{type:"hidden",name:this.ctx.name,value:this.ctx.value||""}})),r("title-text")(l()("span"))),o("suggest2")(f()(!0),r("items").tag()("ul"),g()({block:"suggest2-detect",js:!0})),o("suggest2-item")(l()("li"),f()(!0),r("text")(l()(function(){return this.ctx.tag||"span"}),b()(function(){return Array.isArray(this.ctx.content)?this.ctx.content.map(function(t){return"string"==typeof t?this.xmlEscape(t):t},this):this.xmlEscape(this.ctx.content)})),r("fact").tag()("span")),o("suggest2-item").elem("highlight")(l()("b"),_()(!1),b()(function(){return this.xmlEscape(this.ctx.content)})),o("suggest2-item")(r("thumb").match(function(){return!this.ctx.content}).content()(function(){return{elem:"thumb-wrapper",attrs:{style:this.ctx.bgColor?"background-color: "+this.ctx.bgColor+";border: none;":""},content:{elem:"thumb-img",attrs:{src:this.ctx.src,alt:this.ctx.alt}}}}),r("thumb-img").tag()("img")),o("suggest2-item").elem("img").def()(function(){var t=this.ctx.attrs||{};return this.ctx.src&&(t.style="background-image: url('"+this.ctx.src+"');"+(t.style||"")),B({"ctx.attrs":t})}),o("suggest2-item").elem("text").elemMod("type","title-url").tag()("div"),o("suggest2-item").elem("text").elemMod("type","green-url").tag()("div"),o("suggest2-item").elem("fact")(t(function(){return this.ctx.color}).def()(function(){return this.ctx.attrs=this.extend(Object(this.ctx.attrs),{style:";color:"+this.ctx.color+";"+(Object(this.ctx.attrs).style||"")}),B()}),b()(function(){return[{block:"suggest2",elem:"a11y",content:BEM.I18N("suggest2-item","quick-answer")+": "},this.escapeContent===!1?this.ctx.content:this.xmlEscape(this.ctx.content)]})),o("suggest2").elem("a11y").tag()("span"),o("suggest2-item").elem("bullet")(l()("span"),d()({"aria-hidden":!0})),o("suggest2-item").mod("type","nav").elem("fact").content()(function(){return this.xmlEscape(this.ctx.content)}),o("suggest2-item").mod("interact","link")(b()(function(){return{elem:"link",url:this.ctx.url,target:this.ctx.target||"_blank",content:this.ctx.content}}),t(function(){return"nav"===this.mods.type||"icon"===this.mods.type}).elem("text").mix()({mods:{type:"url"}})),o("suggest2-item").elem("link")(l()("a"),d()(function(){return{href:this.ctx.url,target:this.ctx.target}})),o("suggest2-item").elem("icon")(u()(function(){var t=this.ctx.png&&this.ctx.svg?this.ctx[BEM.blocks["i-ua"]&&BEM.blocks["suggest2-detect"].isSupportInlineSVG()?"svg":"png"]:this.ctx.svg||this.ctx.png;return t&&(this.ctx.attrs=this.extend(Object(this.ctx.attrs),{style:';background-image:url("'+t+'");'+(Object(this.ctx.attrs).style||"")})),B()}),l()("span")),o("suggest2-item").elem("icon").match(function(){return this.elemMods.weather}).def()(function(){return B({"elemMods.weather":this.elemMods.weather.replace("-","minus-").replace("+","plus-").replace(/_/g,"-")})}),o("dropdown-menu")(f()(!0),u()(function(){var t=this.ctx,e=t.mods||(t.mods={});return e.size||(e.size="m"),e.theme||(e.theme="ffffff"),this.dropdownMenuSize=e.size,this._inDropdownMenu=!0,B()})),o("dropdown-menu").elem("menu").def()(function(){var t=this.ctx,e=t.type||"vert",i=t.mods||{};return i.theme||(i.theme="ffffff"),E({block:"b-menu-"+e,mix:(t.mix||[]).concat({block:"dropdown-menu",elem:"menu",mods:i}),title:t.title,content:t.content})}),o("b-menu-vert").match(function(){return this._inDropdownMenu})(d()(function(){return{role:"menu"}}),r("item").attrs()(function(){return{role:"menuitem"}})),o("b-menu-horiz").match(function(){return this._inDropdownMenu})(d()(function(){return{role:"menu"}}),r("item").attrs()(function(){return{role:"menuitem"}})),o("b-menu-vert")(b()(function(){return[this.ctx.title,{elem:"layout",content:this.ctx.content}]}),r("layout").tag()("ul"),r("item").match(function(){return!this._inItemContent}).wrap()(function(){return this.position--,{elem:"layout-unit",content:[this.ctx,this.ctx["item-content"]]}}),r("item-content").def()(function(){return B({_inItemContent:!0})}),r("layout-unit")(l()("li"),g()(function(){var t=[];return this.isFirst()&&t.push({elemMods:{position:"first"}}),this.isLast()&&t.push({elemMods:{position:"last"}}),t})),r("item-selector").tag()("span"),r("submenu").tag()("ul")),o("b-menu-horiz")(f()(!0),r("item").wrap()(function(){return this.position--,{elem:"layout-unit",content:this.ctx}}),r("layout-unit").mix()(function(){var t=[];return this.isFirst()&&t.push({elemMods:{position:"first"}}),this.isLast()&&t.push({elemMods:{position:"last"}}),t}),r("item-selector").tag()("span")),o("disk-button").content()(function(){return{block:"button2",mix:[{block:"disk-button",elem:"button"}],mods:{theme:"normal",pin:"brick-brick",side:"left",size:"m"},content:[{block:"disk-button",elem:"icon",mix:[{block:"button",elem:"icon"}],tag:"span"},{block:"disk-button",elem:"text",elemMods:{saved:"no"},tag:"span",content:BEM.I18N("disk-button","Сохранить",{context:"Надпись на кнопке для сохранения картинки на Диск https://yadi.sk/i/pzsKjVQIkZj7Q"})},{block:"disk-button",elem:"text",elemMods:{saved:"yes"},tag:"span",content:BEM.I18N("disk-button","Сохранено",{context:"Надпись на кнопке после сохранения картинки на Диск https://yadi.sk/i/KSqGeu55kZjDy"})}]}}),o("disk-button").elem("popup").replace()(function(){return{block:"popup",mods:{hoverable:"yes",position:"fixed","has-close":"yes"},underMods:{type:this.ctx.paranja?"paranja":""},js:{directions:{to:"bottom",offset:{top:-14}}},mix:[{block:"disk-button",elem:"popup"}],content:[{elem:"tail"},{elem:"content",content:this.ctx.content}]}}),o("navigation")(f()(!0),u().match(function(){return!this.mods["more-type"]})(function(){return this.ctx.mods=this.extend(this.ctx.mods||{},{"more-type":"popup"}),E(this.ctx)}),b()(function(){return{elem:"region",content:this.ctx.content.map(function(t){return t.block="navigation",this.extend(this.extend({},t),{elemMods:{service:"yes"}})},this)}}),d()(function(){var t,e=B()||{},i=this.ctx.query;return e.role="navigation",t=i?BEM.I18N("navigation","search-on",{query:i}):BEM.I18N("navigation","search-also"),e["aria-label"]=t,e}),r("item")(g()(function(){return[{elemMods:{name:this.ctx.service,state:this.ctx.selected?"selected":null}}]}),b()(function(){return{block:"service",service:this.ctx.service,iconMods:{self:"40"},name:this.ctx.name,mods:this.ctx.selected?!1:{hoverable:"yes"},lang:this.ctx.lang,url:this.ctx.selected?!1:this.ctx.url,urlParams:(this.ctx.search||"")+(this.ctx.params||""),urlAttrs:{target:this.ctx.target||"_blank",tabindex:0},counter:this.ctx.counter}})),r("region").attrs()({role:"list"}),r("more")(g()([{elem:"item"}]),b()([{elem:"more-label",mix:[{block:"service",mods:{hoverable:"yes"}}],content:{block:"service",elem:"icon"}}])),r("more-label").attrs()(function(){var t=B()||{},e=BEM.I18N("navigation","more");return this.extend(t,{tabindex:0,role:"button",title:e,"aria-label":e,"aria-haspopup":!0,"aria-expanded":!1})})),o("navigation").def()(function(){return B({_moreCounter:this.ctx.moreCounter})}),o("navigation").elem("item").match(function(){return this.ctx.clickable===!0}).content()(function(){var t=B();return t.mods||(t.mods={}),t.mods["selected-clickable"]="yes",t.url=this.ctx.url,t}),o("navigation").elem("item").match(function(){return this.ctx.__kostyl===!1}).def()(function(){var t=this.ctx.serpsearch,e=this.ctx.query,i=this.ctx.tld,n=this.ctx.hostname,s=this.ctx.prefsTarget,o=this.ctx.urlSuffix,r=this.ctx.isAnyCbirPage,a={afisha:{target:s,search:o},appsearch:{url:"//yandex."+(i||"com.tr"),search:"/yandsearch?text="+e,target:s,params:"&filter=mobile_apps"},auto:{search:"/search?text="+e,target:s},blogs:{search:"/search.xml?text="+e,target:s,params:this.ctx.family&&"&family=yes"},encyc:{service:"slovari",search:"/"+e+"/значение/",target:s},fresh:{service:"fresh",url:"//"+n,search:t+"?text="+e,params:"&time_from=-3dE"+(this.ctx.family?"&family=yes":""),ajax:!0},images:{service:"images",search:"/search?text="+e,params:this.ctx.family&&"&family=yes",url:"//"+n+("com.tr"===i?"/gorsel":"/images")},mail:{service:"mail",search:"/",target:s},maps:{service:"maps",search:r&&!e?"/":"/?text="+e,target:s},market:{service:"market",search:"com.tr"===i?r&&!e?"/":"/search?text="+e:r&&!e?"/":"/search.xml?text="+e,target:s,url:"//market.yandex."+(i||"ru")},music:{search:"/search?text="+e,target:s},news:{service:"news",search:"/yandsearch?text="+e,params:"&rpt=nnews2&grhow=clutop",target:s},peoplesearch:{url:"//yandex."+(i||"ru"),search:t+"?text="+e,params:"&filter=people",target:s},rabota:{search:"/search.xml?text="+e,target:s},rasp:{search:o,target:s},realty:{search:o,target:s},review:{},serp:{service:"www",url:"//"+n,search:r&&!e?"/":t+"?text="+e,ajax:!0},sloavri:{service:"slovari",search:"/"+e+"/значение/",target:s},slovari:{service:"slovari",search:"/"+e+"/значение/",target:s},ticket:{service:"avia",target:s},translate:{service:"translate",search:r&&!e?"/":"/?text="+e,target:s},tv:{target:s},video:{service:"video",search:r&&!e?"/":"/search?text="+e,params:this.ctx.family&&"&family=yes",url:"//"+n+"/video"},weather:{service:"weather",search:o,target:s},web:{service:"www",url:"//"+n,search:r&&!e?"/":"/search?text="+e},www:{service:"www",url:"//"+n,search:t+"?text="+e}},c=a[this.ctx.service];return c&&this.ctx.ncrnd&&(c.params=(c.params||"")+("/"===c.search?"?":"&")+"ncrnd="+this.ctx.ncrnd),(this.ctx.isContextVerticalsEnable||this.ctx.clickable)&&(c.url=this.ctx.url||c.url,c.search=null,c.params=null),this.ctx.newTab&&(c.target="_blank"),c.__kostyl=!0,E(this.extend(this.ctx,c))}),o("navigation").elem("more").attrs()(function(){return{role:"listitem",onmousedown:this._moreCounter}}),o("service").elem("icon")(l()("span"),g()(function(){return[{block:"service-icon",elem:this.ctx.service,elemMods:this.ctx.serviceIconMods||this.ctx.elemMods}]
})),o("navigation").mod("more-type","tablo").elem("region").content()(function(){return[B(),{elem:"more"}]}),o("navigation").mod("text-nav","yes").elem("more-label").content()(function(){return BEM.I18N("navigation","more")}),o("service").mod("selected-clickable","yes").elem("url").mix()([{block:"link",mods:{ajax:"yes"}}]),o("select")(u()(function(){var t=this.ctx,e=t.id||this.generateId();return B({_controlAttrs:{id:e,name:t.name||e},_formSelect:{block:this.block,mods:this.mods,tabindex:t.tabindex}})}),f()(function(){return this.extend({live:!1},this.ctx.js)}),l()("span"),r("option").tag()("option"),r("option-group").tag()("optgroup"),r("text").tag()("span")),o("select").def()(function(){var t=this.ctx,e=(x("js")||{}).live;if(e){var i=t.content.filter(function(t){return"control"===t.elem})[0].content;if(i.length){var n=function(t){for(var e,i,s=0;s<t.length&&(e=t[s],"option"===e.elem&&Object(e.attrs).selected?i=e:"option-group"===e.elem&&(i=n(e.content)),!i);s++);return i},s=n(i);return s||(s=i[0],"option-group"===s.elem&&(s=s.content[0])),B({_initValue:s.attrs.value,_initText:s.content})}}return B()}),o("select").elem("item").attrs()(function(){return{id:this.generateId()}}),o("select").elem("item").attrs()(function(){var t=B()||{};return"yes"===(this.ctx.elemMods||{}).label&&(this._labelId&&(t.id=this._labelId),t["aria-hidden"]=!0),t}),o("button").match(function(){return this._formSelect})(d()(function(){var t=B()||{};t.role="listbox",t.type="button",t["aria-haspopup"]=!0,t["aria-expanded"]=!1;var e=this._formSelect.tabindex;return"undefined"!=typeof e&&(t.tabindex=e),t}),u()(function(){var t=this.ctx,e=this._formSelect.mods,i=t.mods||{};return i.arrow="down",e.theme&&(i.theme=e.theme),e.size&&(i.size=e.size),"yes"===e.disabled&&(i.disabled="yes"),t.mods=i,this._initText&&(t.content=this._initText),B({"ctx._theme":!0})}),g()(function(){return[{block:this._formSelect.block,elem:"button"}]})),o("select").elem("control")(t(function(){return this._initValue}).def()(function(){var t=this.ctx;return t.attrs=this.extend(t.attrs,{value:this._initValue}),B()}),l()("select"),d()(function(){for(var t,e=["id","name","tabindex"],i={};t=e.pop();)this._controlAttrs[t]&&(i[t]=this._controlAttrs[t]);return"yes"===this.mods.disabled&&(i.disabled="disabled"),i.tabindex=-1,i["aria-hidden"]=!0,this.ctx.controlAttrs||i})),o("select").elem("group")(d()(function(){return{role:"group","aria-labelledby":this._labelId}}),g()(function(){var t=this.isFirst()?this.isLast()?"both":"first":this.isLast()?"last":"middle";return{mods:{position:t}}}),u()(function(){return B({_labelId:this.generateId()})})),o("incut").wrap()(function(){return{block:"incut",elem:"wrapper",mods:{footer:"bottom"===this.ctx.js.positionType?"yes":""},content:this.ctx}}),o("incut").elem("advertising")(l()("span"),b()("Реклама")),o("incut").mod("type","market")(r("title")(l()("span"),b()(function(){var t=[{elem:"title-text",content:this.ctx.text}," — предложения из Яндекс.Маркета"];return this.ctx.isClickable?{block:"link",target:"_blank",url:this.ctx.url,attrs:{onmousedown:this.ctx.counter},content:t}:t})),r("description")(l()("span"),b()("Товары на этих картинках можно купить"))),o("incut")(r("item").mod("type","direct-like").content()(function(){var t=120,e=Math.round(t*this.ctx.size.width/this.ctx.size.height);return{elem:"link",tag:"a",attrs:{href:this.ctx.url,target:"_blank"},content:[{elem:"thumb",attrs:{style:"background-image: url("+this.ctx.img_href.replace("y150","orig")+");width:"+e+"px"}},{elem:"title",content:this.ctx.title},{elem:"domain",tag:"span",content:this.ctx.domain},this.ctx.warning&&{elem:"warning",mods:{type:"direct-like"}}]}}),r("warning").mod("type","direct-like")(l()("span"),b()("Есть&nbsp;противопоказания. Посоветуйтесь&nbsp;с&nbsp;врачом."))),o("serp-url")(b()(function(){return{elem:"item",content:{elem:"link",mix:this.ctx.linkMix,url:this.ctx.url,counter:this.ctx.counter,content:this.ctx.content}}}),r("item").tag()("span"),r("link")(l()("a"),d()(function(){var t={target:"_blank",href:this.ctx.url};return this.ctx.counter&&(t.onmousedown=this.ctx.counter),t}))),k(function(t,e){var n=t.BEMContext||e.BEMContext;n.prototype.require=function(t){return i[t]}})}),s.exportApply(e),e},i=!0;"object"==typeof module&&"object"==typeof module.exports&&(exports.BEMHTML=e({},{}),i=!1),"object"==typeof modules&&(modules.define("BEMHTML",[],function(t){t(e({},{}))}),i=!1),i&&(BEMHTML=e({},{}),t.BEMHTML=BEMHTML)}(this),function(t,e){function i(){p&&f&&console.log.apply(console,arguments)}function n(t){return"string"==typeof t&&(t={block:t}),t.block+(t.elem?h+t.elem:"")+(t.modName?c+t.modName+c+t.modVal:"")}function s(t){var e={};return t.split(h).forEach(function(t,i){var n=[i?"elem":"block","mod","val"];t.split(c).forEach(function(t,i){e[n[i]]=t})}),e}function o(t){return t?d.push(t):!1}function r(){return d.length&&d.pop()}function a(){this._lang="",this._prj="lego",this._keyset="",this._key=""}if("function"==typeof e.I18N&&e.I18N._proto)return e.I18N;"undefined"==typeof i18n&&(i18n={}),BEM=e;var c="_",h="__",u="ru",l={},d=[],p=!1,f="undefined"!=typeof console&&"function"==typeof console.log;a.prototype={lang:function(t){return this._lang=t,this},project:function(t){return this._prj=t,this},keyset:function(t,e){return e&&o(this._keyset),this._keyset=n(t),this},key:function(t){return this._key=t,this},decl:function(t){var e=s(this._keyset),i="i-tanker"===e.block?"tanker":this._prj,n=e.elem||this._keyset,o=this._key;i=i18n[i]||(i18n[i]={}),n=i[n]||(i[n]={}),n[o]="function"==typeof t?t:function(){return t};var r=l[this._lang]||(l[this._lang]={}),a=r[this._keyset]||(r[this._keyset]={});a[o]=t},val:function(t,e){var n=l[this._lang]&&l[this._lang][this._keyset],s="keyset: "+this._keyset+" key: "+this._key+" (lang: "+this._lang+")";if(!n)return i("[I18N_NO_KEYSET] %s",s),"";n=n[this._key];var o=typeof n;return"undefined"===o?(i("[I18N_NO_VALUE] %s",s),""):"string"===o?n:(e||(e=this),n.call(e,t))},_cache:function(){return l}},e.I18N=function(t){var e=function(t,i,n){return e.keyset(t).key(i,n)};return e._proto=t,e.project=function(t){return this._proto.project(t),this},e.keyset=function(t){return this._proto.keyset(t,!0),this},e.key=function(t,i){var n,s,o=this._proto;return o.lang(this._lang).key(t),n=o.val.call(o,i,e),s=r(),s&&o.keyset(s,!1),n},e.decl=function(t,e,i){var n,s=this._proto;i||(i={}),i.lang&&s.lang(i.lang),s.keyset(t);for(n in e)e.hasOwnProperty(n)&&s.key(n).decl(e[n]);return this},e.lang=function(t){return"undefined"!=typeof t&&(this._lang=t),this._lang},e.debug=function(t){p=!!t},e.lang(u),e}(new a)}(this,"undefined"==typeof BEM?{}:BEM),"undefined"!=typeof BEM&&BEM.I18N&&(BEM.I18N.decl("advanced-search_spok_yes",{"Сбросить":"Сбросить","Белые":"Белые","Большие":"Большие","Вертикальные":"Вертикальные","Голубые":"Голубые","Горизонтальные":"Горизонтальные","Демотиваторы":"Демотиваторы","Жёлтые":"Жёлтые","Зелёные":"Зелёные","Квадратные":"Квадратные","Красные":"Красные","Лица":"Лица","Любая ориентация":"Любая ориентация","Любой размер":"Любой размер","Любой тип":"Любой тип","Любой файл":"Любой файл","Любой цвет":"Любой цвет","Маленькие":"Маленькие","Назад в поиск":"Назад в поиск","Обои":"Обои","Оранжевые":"Оранжевые","Рисунки и чертежи":"Рисунки и чертежи","С белым фоном":"С белым фоном","Свежие":"Свежие","Синие":"Синие","Средние":"Средние","Только цветные":"Только цветные","Фиолетовые":"Фиолетовые","Фото":"Фото","Чёрно-белые":"Чёрно-белые","Чёрные":"Чёрные"},{lang:"ru"}),BEM.I18N.decl("advertising-label",{"Реклама":"Реклама","Яндекс.Маркет":"Яндекс.Маркет"},{lang:"ru"}),BEM.I18N.decl("auth",{auth:"Авторизация","fill-input":"Заполните это поле",login:"Логин",logon:"Войти",more:"Ещё",password:"Пароль",register:"Регистрация",remember:"Вспомнить пароль","social-log-in":"Войти при помощи социальной сети",temporary:"Чужой компьютер","wrong-characters":"Недопустимый ввод","wrong-keyboard-layout":"Смените раскладку","wrong-password":"Пароль не может совпадать с логином"},{lang:"ru"}),BEM.I18N.decl("b-501px",{"Картинка дня":"Картинка дня","Популярные запросы":"Популярные запросы"},{lang:"ru"}),BEM.I18N.decl("b-501px-info_spok_yes",{"В{nbsp}течение суток картинку дня можно скачать для{nbsp}заставки на{nbsp}рабочий стол.":function(t){return"В"+t.nbsp+"течение суток картинку дня можно скачать для"+t.nbsp+"заставки на"+t.nbsp+"рабочий стол."},"Все картинки подходят под{nbsp}экраны любого размера.":function(t){return"Все картинки подходят под"+t.nbsp+"экраны любого размера."},"Наши партнёры":"Наши партнёры","Партнёрская программа":"Партнёрская программа","Специальный алгоритм выбирает фотографии, у{nbsp}которых больше шансов понравиться пользователям.":function(t){return"Специальный алгоритм выбирает фотографии, у"+t.nbsp+"которых больше шансов понравиться пользователям."},"Узнать больше":"Узнать больше"},{lang:"ru"}),BEM.I18N.decl("b-501px-slider",{"Картинка предыдущего дня":"Картинка предыдущего дня","Картинка следующего дня":"Картинка следующего дня"},{lang:"ru"}),BEM.I18N.decl("b-501px__adv",{"Гифки<br> Кока-колы":"Гифки<br> Кока-колы"},{lang:"ru"}),BEM.I18N.decl("b-501px__caption",{"Картинка дня":"Картинка дня","Подробнее о проекте":"Подробнее о проекте"},{lang:"ru"}),BEM.I18N.decl("b-501px__download",{"Скачать обои<br> для моего экрана":"Скачать обои<br> для моего экрана"},{lang:"ru"}),BEM.I18N.decl("b-501px__search",{"Ещё картинки<br> по этой теме":"Ещё картинки<br> по этой теме"},{lang:"ru"}),BEM.I18N.decl("b-501px_spok_yes",{"{author} на {site}":function(t){return t.author+" на "+t.site},"Вернуться к картинке дня":"Вернуться к картинке дня","Вернуться<br> к картинке дня":"Вернуться<br> к картинке дня","Новая картинка каждый день":"Новая картинка каждый день","Эту картинку можно было скачать {date}":function(t){return"Эту картинку можно было скачать "+t.date},"Эту картинку можно было скачать вчера":"Эту картинку можно было скачать вчера","Яндекс.Фотках":"Яндекс.Фотках"},{lang:"ru"}),BEM.I18N.decl("b-mooa",{brak_ticket_added:"Добавлен тикет",brak_ticket_updated:"Обновлён тикет",close:"Закрыть",error:"Ошибка",idea:"Идея",message_error:"Сообщение отправить не удалось, попробуйте еще раз",message_sending:"Сообщение отправляется",message_success:"Ваше сообщение отправлено"},{lang:"ru"}),BEM.I18N.decl("b-page_spok_yes",{"Видео":"Видео","Картинки":"Картинки","{query}: {count} изображение найдено в Яндекс.Картинках":function(t){return this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.query+": "+t.count+" изображение найдено в Яндекс.Картинках",some:t.query+": "+t.count+" изображения найдено в Яндекс.Картинках",many:t.query+": "+t.count+" изображений найдено в Яндекс.Картинках",none:t.query+": "+t.count+" изображений найдено в Яндекс.Картинках"})},"{query}: {count} млн изображений найдено в Яндекс.Картинках":function(t){return t.query+": "+t.count+" млн изображений найдено в Яндекс.Картинках"},"{query}: {count} тыс изображений найдено в Яндекс.Картинках":function(t){return t.query+": "+t.count+" тыс изображений найдено в Яндекс.Картинках"},"Картинок по вашему запросу не найдено":"Картинок по вашему запросу не найдено","Яндекс.Картинки: поиск изображений в интернете, поиск по картинке":"Яндекс.Картинки: поиск изображений в интернете, поиск по картинке","Яндекс.Картинки: поиск по картинке":"Яндекс.Картинки: поиск по картинке","Яндекс.Картинки: поиск похожих картинок":"Яндекс.Картинки: поиск похожих картинок","Заставки для рабочего стола, забавные картинки, схемы и иллюстрированные инструкции - ответы на ваши вопросы в виде изображений":"Заставки для рабочего стола, забавные картинки, схемы и иллюстрированные инструкции - ответы на ваши вопросы в виде изображений",'Результаты поиска по запросу "{query}" в Яндекс.Картинках':function(t){return'Результаты поиска по запросу "'+t.query+'" в Яндекс.Картинках'}},{lang:"ru"}),BEM.I18N.decl("b-statcounter__metrika",{JSERR_incorrectID:"Incorrect ID has been passed."},{lang:"ru"}),BEM.I18N.decl("back_spok_yes",{"Вернуться назад":"Вернуться назад"},{lang:"ru"}),BEM.I18N.decl("categories-index",{"Популярные запросы":"Популярные запросы"},{lang:"ru"}),BEM.I18N.decl("cbir-error_spok_yes",{"Закрыть":"Закрыть","Картинка не загрузилась, попробуйте загрузить другую.":"Картинка не загрузилась, попробуйте загрузить другую.","Неправильный формат загружаемого файла. Попробуйте загрузить файл изображения.":"Неправильный формат загружаемого файла. Попробуйте загрузить файл изображения.","Ошибка":"Ошибка","По указанному адресу не смогли найти картинку, попробуйте ввести другой адрес.":"По указанному адресу не смогли найти картинку, попробуйте ввести другой адрес.","Слишком большой файл, попробуйте загрузить другую картинку.":"Слишком большой файл, попробуйте загрузить другую картинку."},{lang:"ru"}),BEM.I18N.decl("cbir-intent_spok_yes",{"Загружаем картинку":"Загружаем картинку","Загруженная картинка":"Загруженная картинка","Закрыть":"Закрыть"},{lang:"ru"}),BEM.I18N.decl("cbir-logo_spok_yes",{"Поиск по картинке":"Поиск по картинке"},{lang:"ru"}),BEM.I18N.decl("cbir-no-results_spok_yes",{"Таких же картинок не найдено":"Таких же картинок не найдено"},{lang:"ru"}),BEM.I18N.decl("cbir-panel_spok_yes",{"Введите адрес картинки":"Введите адрес картинки","Найти":"Найти","Перетащите картинку сюда или":"Перетащите картинку сюда или","Поиск по картинке":"Поиск по картинке","выберите файл":"выберите файл","или":"или"},{lang:"ru"}),BEM.I18N.decl("competitors",{"Посмотреть «{query}» в других поисковых системах:":function(t){return"Посмотреть «"+t.query+"» в других поисковых системах:"},"Ссылки на поисковые системы скрыты, так как включен семейный фильтр":"Ссылки на поисковые системы скрыты, так как включен семейный фильтр"},{lang:"ru"}),BEM.I18N.decl("complain",{"Пожаловаться":"Пожаловаться"},{lang:"ru"}),BEM.I18N.decl("content_spok_yes",{"Эта картинка в других размерах:":"Эта картинка в других размерах:"},{lang:"ru"}),BEM.I18N.decl("copyright",{link:function(t){return"ООО «"+t.content+"»"},yandex:"Яндекс"},{lang:"ru"}),BEM.I18N.decl("custom-site_spok_yes",{"Адрес сайта указан неправильно.":"Адрес сайта указан неправильно.","На сайте":"На сайте"},{lang:"ru"}),BEM.I18N.decl("custom-size_spok_yes",{"Размер картинок указан неправильно.":"Размер картинок указан неправильно."},{lang:"ru"}),BEM.I18N.decl("date",{"{day} августа":function(t){return t.day+" августа"},"{day} августа {year} г.":function(t){return t.day+" августа "+t.year+" г."},"{day} апреля":function(t){return t.day+" апреля"},"{day} апреля {year} г.":function(t){return t.day+" апреля "+t.year+" г."},"{day} декабря":function(t){return t.day+" декабря"},"{day} декабря {year} г.":function(t){return t.day+" декабря "+t.year+" г."},"{day} июля":function(t){return t.day+" июля"},"{day} июля {year} г.":function(t){return t.day+" июля "+t.year+" г."},"{day} июня":function(t){return t.day+" июня"},"{day} июня {year} г.":function(t){return t.day+" июня "+t.year+" г."},"{day} марта":function(t){return t.day+" марта"},"{day} марта {year} г.":function(t){return t.day+" марта "+t.year+" г."},"{day} мая":function(t){return t.day+" мая"},"{day} мая {year} г.":function(t){return t.day+" мая "+t.year+" г."},"{day} ноября":function(t){return t.day+" ноября"},"{day} ноября {year} г.":function(t){return t.day+" ноября "+t.year+" г."},"{day} октября":function(t){return t.day+" октября"},"{day} октября {year} г.":function(t){return t.day+" октября "+t.year+" г."},"{day} сентября":function(t){return t.day+" сентября"},"{day} сентября {year} г.":function(t){return t.day+" сентября "+t.year+" г."},"{day} февраля":function(t){return t.day+" февраля"},"{day} февраля {year} г.":function(t){return t.day+" февраля "+t.year+" г."},"{day} января":function(t){return t.day+" января"},"{day} января {year} г.":function(t){return t.day+" января "+t.year+" г."},"Вчера":"Вчера","Сегодня":"Сегодня"},{lang:"ru"}),BEM.I18N.decl("direct",{"Реклама":"Реклама"},{lang:"ru"}),BEM.I18N.decl("disk",{"Мои Яндекс.Картинки":"Мои Яндекс.Картинки"},{lang:"ru"}),BEM.I18N.decl("disk-button",{"{authorize} с помощью аккаунта{br}Яндекса, чтобы сохранять{br}картинки на Диск.":function(t){return t.authorize+" с помощью аккаунта"+t.br+"Яндекса, чтобы сохранять"+t.br+"картинки на Диск."},"Войдите":"Войдите","На Диске недостаточно места{br}для сохранения картинки.{br}":function(t){return"На Диске недостаточно места"+t.br+"для сохранения картинки."+t.br},"Не теряйте свои находки.{br}Нажмите, чтобы сохранить{br}картинку на Диске.":function(t){return"Не теряйте свои находки."+t.br+"Нажмите, чтобы сохранить"+t.br+"картинку на Диске."},"Ой! Что-то пошло не так.{br}Попробуйте повторить еще{br}раз немного позже.":function(t){return"Ой! Что-то пошло не так."+t.br+"Попробуйте повторить еще"+t.br+"раз немного позже."},"Сохранено":"Сохранено","Сохранить":"Сохранить","Увеличить место на диске":"Увеличить место на диске"},{lang:"ru"}),BEM.I18N.decl("disk-domik",{"Сохраняйте изображения на Яндекс.Диске. Вы можете получить к ним доступ с любого устройства, организовывать в коллекции и делиться.":"Сохраняйте изображения на Яндекс.Диске. Вы можете получить к ним доступ с любого устройства, организовывать в коллекции и делиться."},{lang:"ru"}),BEM.I18N.decl("disk-logo",{"Картинки сохраняются<br> в специальной папке<br> на Яндекс.Диске.":"Картинки сохраняются<br> в специальной папке<br> на Яндекс.Диске.","Мои картинки":"Мои картинки"},{lang:"ru"}),BEM.I18N.decl("distro",{"Всё ваше в сети<br>Диск сохранит":"Всё ваше в сети<br>Диск сохранит","Любимую музыку<br>угадает и дополнит Радио":"Любимую музыку<br>угадает и дополнит Радио","Мобильный Яндекс<br>в телефоне и планшете":"Мобильный Яндекс<br>в телефоне и планшете","Сделать Яндекс<br>любимым поиском":"Сделать Яндекс<br>любимым поиском","Скачать в {platform}":function(t){return"Скачать в "+t.platform},"Установить<br>Визуальные закладки":"Установить<br>Визуальные закладки","Установить<br>Яндекс.Браузер":"Установить<br>Яндекс.Браузер","Установить<br>расширения Яндекса":"Установить<br>расширения Яндекса"},{lang:"ru"}),BEM.I18N.decl("feedback",{"Ваш отзыв будет использован алгоритмами Поиска.":"Ваш отзыв будет использован алгоритмами Поиска.","Вернуться на Яндекс":"Вернуться на Яндекс","На всю страницу":"На всю страницу","На этот результат":"На этот результат","Несоответствие запросу":"Несоответствие запросу","Пожаловаться":"Пожаловаться","Порнография":"Порнография","Причина жалобы":"Причина жалобы","Спасибо, что помогаете делать Яндекс лучше!":"Спасибо, что помогаете делать Яндекс лучше!","Шокирующая или неприятная информация":"Шокирующая или неприятная информация"},{lang:"ru"}),BEM.I18N.decl("footer",{about:"О компании","about-url":"//company.yandex.ru",advert:"Реклама","advert-url":"//advertising.yandex.ru/kupislova.xml?advertising",apps:"Мобильные приложения","apps-url":"//mobile.yandex.ru",stat:"Статистика",termsofuse:"Лицензия на поиск","termsofuse-url":"//legal.yandex.ru/termsofuse/"},{lang:"ru"}),BEM.I18N.decl("footer_spok_yes",{"Лицензия на поиск":"Лицензия на поиск","Мобильная версия":"Мобильная версия","Обратная связь":"Обратная связь","Политика конфиденциальности":"Политика конфиденциальности","Помощь":"Помощь","Уведомление об авторских правах":"Уведомление об авторских правах"},{lang:"ru"}),BEM.I18N.decl("gallery",{"Ещё {more}":function(t){return"Ещё "+t.more}},{lang:"ru"}),BEM.I18N.decl("head-filter_spok_yes",{"Без защиты":"Без защиты","Поиск без защиты":"Поиск без защиты","Семейный":"Семейный","Семейный поиск":"Семейный поиск","Тип безопасного поиска":"Тип безопасного поиска","Умеренный":"Умеренный","Умеренный поиск":"Умеренный поиск","Фильтрация выключена.<br />Умеренный фильтр включится<br />автоматически через 2 часа.":"Фильтрация выключена.<br />Умеренный фильтр включится<br />автоматически через 2 часа."},{lang:"ru"}),BEM.I18N.decl("header__action_type_srv",{"services-table":"Табло сервисов"},{lang:"ru"}),BEM.I18N.decl("header_spok_yes",{"Расширенный поиск":"Расширенный поиск"},{lang:"ru"}),BEM.I18N.decl("i-global",{"Яндекс.Картинки":"Яндекс.Картинки"},{lang:"ru"}),BEM.I18N.decl("i-global_spok_yes",{"Видео":"Видео","Картинки":"Картинки","Яндекс.Картинки":"Яндекс.Картинки"},{lang:"ru"}),BEM.I18N.decl("i-seo_spok_yes",{"Забавные картинки, заставки для рабочего стола, схемы и иллюстрированные инструкции - ответы на ваши вопросы в виде изображений, Поиск по картинке и фото":"Забавные картинки, заставки для рабочего стола, схемы и иллюстрированные инструкции - ответы на ваши вопросы в виде изображений, Поиск по картинке и фото",'Результаты поиска по запросу "{query}" в Яндекс.Картинках':function(t){return'Результаты поиска по запросу "'+t.query+'" в Яндекс.Картинках'},"Результаты поиска по пустому запросу в Яндекс.Картинках":"Результаты поиска по пустому запросу в Яндекс.Картинках","изображения, фото, яндекс картинки, поиск":"изображения, фото, яндекс картинки, поиск","яндекс картинки, поиск изображений, фото, фотографии, поиск по картинке и фото":"яндекс картинки, поиск изображений, фото, фотографии, поиск по картинке и фото"},{lang:"ru"}),BEM.I18N.decl("i-services",{404:"404",adresa:"Адреса",advertising:"Реклама",afisha:"Афиша",all:"Все сервисы",api:"API",appsearch:"Приложения",auto:"Авто",avia:"Авиабилеты",aziada:"Азиада",ba:"Баян",backapv:"Партнер Я.Карт",balance:"Баланс",bar:"Бар","bar-ie":"Бар для ИЕ","bar-ie9":"Бар для ИЕ9",bayan:"Баннеры Яндекса",blogs:"Блоги",books:"Книги",browser:"Браузер",calendar:"Календарь",captcha:"ой...",catalogwdgt:"Каталог виджетов",chrome:"Хром с поиском Яндекса",city:"Города",cityday:"День города",collection:"Коллекция",company:"Компания",contest:"Contest",desktop:"Персональный поиск",direct:"Директ","direct.market":"Маркет",disk:"Диск",display:"Дисплей",ege:"ЕГЭ",expert:"Эксперт",feedback:"Обратная связь",feedback2:"Обратная связь",ff:"ФФ с поиском Яндекса",fotki:"Фотки",fresh:"Свежее",games:"Игрушки",geocontext:"Геоконтекст",goroda:"Города",help:"Помощь",i:"Мои сервисы",ie:"ИЕ с поиском Яндекса",images:"Картинки","images-com":"Картинки",interests:"Интересы",internet:"Интернет",kassa:"Касса",keyboard:"Клавиатура",kraski:"Краски",kuda:"Куда все идут",large:"Яндекс для слабовидящих",legal:"Правовые документы",lenta:"Лента",libra:"Библиотека",literacy:"Неделя борьбы за грамотность",local:"Локальная сеть",lost:"Незабудки",love:"День взаимного тяготения — 13 августа",mail:"Почта",maps:"Карты","maps-wiki":"Народная карта",market:"Маркет","market.advertising":"Маркет",master:"Мастер",metrika:"Метрика",metro:"Метро",mobile:"Мобильный",moikrug:"Мой Круг",money:"Деньги",museums:"Дни исторического и культурного наследия",music:"Музыка","music-partner":"Музыка: статистика",nahodki:"Мои находки",nano:"Нано",newhire:"Наниматор",news:"Новости",notifications:"Нотификационная панель",oauth:"Авторизация",online:"Онлайн",openid:"OpenID",opera:"Opera Software",opinion:"Цитаты",partners:"Рекламная сеть",partnersearch:"Поиск для партнеров",passport:"Паспорт",pdd:"Почта для домена",peoplesearch:"Люди",perevod:"Переводчик",probki:"Пробки",pulse:"блоги: пульс",punto:"Punto switcher",pvo:"Ответы",rabota:"Работа",ramazan:"",rasp:"Расписания",realty:"Недвижимость",referats:"Рефераты",rk:"Есть вопросы?",root:"Яндекс.Олимпиада для Unix администраторов",school:"Школа",search:"Поиск",server:"Сервер",shtrafi:"Штрафы",site:"Поиск для сайта",slovari:"Словари",so:"Самооборона",social:"Социализм",soft:"Программы",sport:"Спорт",sprav:"Справочник",start:"Стартовая страница",stat:"Статистика",subs:"Подписки",taxi:"Такси",terms:"Разговорник",tests:"Тесты и опросы",tickets:"Билеты",time:"Яндекс.Время",toster:"Тосты",translate:"Переводчик",tune:"Настройки",tv:"ТВ",uslugi:"Услуги",video:"Видео","video-com":"Видео",vno:"ВНО",wdgt:"Виджеты",weather:"Погода",webmaster:"Вебмастер",widgets:"Виджеты",wordstat:"Статистика",wow:"Я.ру",www:"Поиск",xmlsearch:"XML",yaca:"Каталог",yamb:"Медийные баннеры",zakladki:"Закладки"},{lang:"ru"}),BEM.I18N.decl("i-tanker__dynamic",{gender:function(t){return function(t){return t[t.gender]}.call(this,t)},plural:function(t){return function(t){var e=isNaN(parseInt(t.count))?0:t.count,i=e%10,n=e%100;return 1==i&&11!=n?t.one:i>1&&5>i&&(10>n||n>20)?t.some:t.many}.call(this,t)},plural_adv:function(t){return function(t){var e=isNaN(parseInt(t.count))?0:t.count;return 0===e?t.none:this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.one,some:t.some,many:t.many})}.call(this,t)},toggle:function(t){return function(t){return Boolean(t.condition)?t["true"]:t["false"]}.call(this,t)}},{lang:"ru"}),BEM.I18N.decl("lang-switcher",{all:"Ещё"},{lang:"ru"}),BEM.I18N.decl("lang-switcher_spok_yes",{"Ещё":"Ещё"},{lang:"ru"}),BEM.I18N.decl("logo",{yandex:"Яндекс"},{lang:"ru"}),BEM.I18N.decl("misspell",{"В запросе «{query}» была исправлена опечатка.":function(t){return"В запросе «"+t.query+"» была исправлена опечатка."},"Длина вашего запроса превышает максимально допустимую. Запрос сокращён до первых 400 символов.":"Длина вашего запроса превышает максимально допустимую. Запрос сокращён до первых 400 символов.","Исправлена раскладка клавиатуры в «{query}»":function(t){return"Исправлена раскладка клавиатуры в «"+t.query+"»"},"По запросу «{query}» ничего не нашлось.":function(t){return"По запросу «"+t.query+"» ничего не нашлось."},"Слишком длинный запрос. Поиск ведется по 40 первым словам.":"Слишком длинный запрос. Поиск ведется по 40 первым словам.","Точная цитата {query} в кавычках нигде не встречается. Показаны результаты по запросу без кавычек.":function(t){return"Точная цитата "+t.query+" в кавычках нигде не встречается. Показаны результаты по запросу без кавычек."},"Быть может, вы хотели воспользоваться поиском по {link}.":function(t){return"Быть может, вы хотели воспользоваться поиском по "+t.link+"."},"картинке":"картинке"},{lang:"ru"}),BEM.I18N.decl("misspell_spok_yes",{"Быть может, вы искали: «{query}».":function(t){return"Быть может, вы искали: «"+t.query+"»."},"В выдачу добавлены ответы по запросу «{query}».":function(t){return"В выдачу добавлены ответы по запросу «"+t.query+"»."},"В запросе «{query}» была исправлена опечатка.":function(t){return"В запросе «"+t.query+"» была исправлена опечатка."},"Длина вашего запроса превышает максимально допустимую. Запрос сокращён до первых 400 символов.":"Длина вашего запроса превышает максимально допустимую. Запрос сокращён до первых 400 символов.","Задан пустой поисковый запрос.":"Задан пустой поисковый запрос.","Искать только «{query}».":function(t){return"Искать только «"+t.query+"»."},"Исправлена раскладка клавиатуры в «{query}»":function(t){return"Исправлена раскладка клавиатуры в «"+t.query+"»"},"Неизвестная ошибка.":"Неизвестная ошибка.","По вашему запросу ничего не нашлось.":"По вашему запросу ничего не нашлось.","По запросу «{query}» ничего не нашлось.":function(t){return"По запросу «"+t.query+"» ничего не нашлось."},"Синтаксическая ошибка.":"Синтаксическая ошибка.","Слишком длинный запрос. Поиск ведется по 40 первым словам.":"Слишком длинный запрос. Поиск ведется по 40 первым словам.","Точная цитата {query} в кавычках нигде не встречается. Показаны результаты по запросу без кавычек.":function(t){return"Точная цитата "+t.query+" в кавычках нигде не встречается. Показаны результаты по запросу без кавычек."},"Быть может, вы хотели воспользоваться поиском по {link}.":function(t){return"Быть может, вы хотели воспользоваться поиском по "+t.link+"."},"картинке":"картинке"},{lang:"ru"}),BEM.I18N.decl("mobile-suggest_spok_yes",{"Да":"Да","Нет":"Нет","Показать мобильную версию?":"Показать мобильную версию?"},{lang:"ru"}),BEM.I18N.decl("more_spok_yes",{"Ещё картинки":"Ещё картинки","Ещё сайты, где встречается картинка":"Ещё сайты, где встречается картинка","Предыдущие картинки":"Предыдущие картинки"},{lang:"ru"}),BEM.I18N.decl("navigation",{more:"Ещё","search-also":"Найти также","search-on":function(t){return"Найти "+t.query+" в других сервисах"}},{lang:"ru"}),BEM.I18N.decl("nps",{"Вам сложно было найти то, что нужно?":"Вам сложно было найти то, что нужно?","Вы посоветовали бы друзьям Яндекс для поиска картинок?":"Вы посоветовали бы друзьям Яндекс для поиска картинок?","Ответить":"Ответить","Отправить":"Отправить","Помогите улучшить Яндекс.Картинки, ответив на вопрос":"Помогите улучшить Яндекс.Картинки, ответив на вопрос","Спасибо, что помогли нам улучшить Яндекс.Картинки!":"Спасибо, что помогли нам улучшить Яндекс.Картинки!","да, конечно":"да, конечно","легко":"легко","не удалось найти":"не удалось найти","оцените":"оцените","очень легко":"очень легко","очень сложно":"очень сложно","сложно":"сложно","точно нет":"точно нет"},{lang:"ru"}),BEM.I18N.decl("open-image_spok_yes",{"Открыть":"Открыть"},{lang:"ru"}),BEM.I18N.decl("original-image_spok_yes",{"Исходная картинка":"Исходная картинка"},{lang:"ru"}),BEM.I18N.decl("other-sites_spok_yes",{"Перейти на страницу с картинкой":"Перейти на страницу с картинкой","Сайты, где встречается картинка":"Сайты, где встречается картинка"},{lang:"ru"}),BEM.I18N.decl("other-sizes_spok_yes",{"Большие":"Большие","Маленькие":"Маленькие","Средние":"Средние","Эта картинка в других размерах":"Эта картинка в других размерах"},{lang:"ru"}),BEM.I18N.decl("pane2",{"Не удалось загрузить картинку, возможно, она есть на {site}.":function(t){return"Не удалось загрузить картинку, возможно, она есть на "+t.site+"."},"сайте":"сайте"},{lang:"ru"}),BEM.I18N.decl("pane2_spok_yes",{"Закрыть":"Закрыть"},{lang:"ru"}),BEM.I18N.decl("prevention",{"Некоторые изображения были удалены из результатов поиска. {details}":function(t){return"Некоторые изображения были удалены из результатов поиска. "+t.details},"Подробнее":"Подробнее","Причины удаления: {numbers}":function(t){return"Причины удаления: "+t.numbers},"Часть результатов поиска скрыта в соответствии с Федеральным законом от 13.07.2015 N 264-ФЗ":"Часть результатов поиска скрыта в соответствии с Федеральным законом от 13.07.2015 № 264-ФЗ"},{lang:"ru"}),BEM.I18N.decl("preview2",{"Не удалось загрузить картинку, возможно, она есть на {site}.":function(t){return"Не удалось загрузить картинку, возможно, она есть на "+t.site+"."},"сайте":"сайте"},{lang:"ru"}),BEM.I18N.decl("preview2_spok_yes",{"Не удалось загрузить картинку, возможно, она есть на {site}.":function(t){return"Не удалось загрузить картинку, возможно, она есть на "+t.site+"."},"сайте":"сайте"},{lang:"ru"}),BEM.I18N.decl("related2_spok_yes",{"Похожие запросы":"Похожие запросы"},{lang:"ru"}),BEM.I18N.decl("related_spok_yes",{"Смотрите также":"Смотрите также"},{lang:"ru"}),BEM.I18N.decl("search",{"search-for":"Искать",query:"Запрос"},{lang:"ru"}),BEM.I18N.decl("search-by-image",{"Другие размеры и похожие":"Другие размеры и похожие","Поиск по картинке":"Поиск по картинке"},{lang:"ru"}),BEM.I18N.decl("search-by-image_spok_yes",{"Другие размеры и похожие":"Другие размеры и похожие"},{lang:"ru"}),BEM.I18N.decl("search2",{"search-button-text":"Найти","search-input-label":"Запрос","search-service-label":"Поиск по сервису","search-web-label":"Поиск в интернете"},{lang:"ru"}),BEM.I18N.decl("search_spok_yes",{"Найти":"Найти"},{lang:"ru"}),BEM.I18N.decl("serp-controller_spok_yes",{"Результаты поиска":"Результаты поиска"},{lang:"ru"}),BEM.I18N.decl("serp-item_spok_yes",{"{count} год":function(t){return this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.count+" год",some:t.count+" года",many:t.count+" лет",none:t.count+" лет"})},"{count} день":function(t){return this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.count+" день",some:t.count+" дня",many:t.count+" дней",none:t.count+" дней"})},"{count} месяц":function(t){return this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.count+" месяц",some:t.count+" месяца",many:t.count+" месяцев",none:t.count+" месяцев"})},"{count} час":function(t){return this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.count+" час",some:t.count+" часа",many:t.count+" часов",none:t.count+" часов"})},"Перейти на страницу с картинкой":"Перейти на страницу с картинкой"},{lang:"ru"}),BEM.I18N.decl("serp-mark",{"Просмотрено 2 недели назад":"Просмотрено 2 недели назад","Просмотрено больше 2 недель назад":"Просмотрено больше 2 недель назад","Просмотрено больше 3 недель назад":"Просмотрено больше 3 недель назад","Просмотрено больше недели назад":"Просмотрено больше недели назад","Просмотрено в воскресенье":"Просмотрено в воскресенье","Просмотрено в понедельник":"Просмотрено в понедельник","Просмотрено в пятницу":"Просмотрено в пятницу","Просмотрено в среду":"Просмотрено в среду","Просмотрено в субботу":"Просмотрено в субботу","Просмотрено в четверг":"Просмотрено в четверг","Просмотрено во вторник":"Просмотрено во вторник","Просмотрено вчера":"Просмотрено вчера","Просмотрено давно":"Просмотрено давно","Просмотрено месяц назад":"Просмотрено месяц назад","Просмотрено неделю назад":"Просмотрено неделю назад","Просмотрено позавчера":"Просмотрено позавчера","Просмотрено сегодня":"Просмотрено сегодня","Просмотрено только что":"Просмотрено только что"},{lang:"ru"}),BEM.I18N.decl("share-dropdown",{facebook:"Facebook",gplus:"Google +",moimir:"Мой Мир",odnoklassniki:"Одноклассники",pinterest:"Pinterest",share:"Поделиться",twitter:"Twitter",vkontakte:"ВКонтакте"},{lang:"ru"}),BEM.I18N.decl("similar_spok_yes",{"Ещё {br} похожие":function(t){return"Ещё "+t.br+" похожие"
},"Похожие картинки":"Похожие картинки"},{lang:"ru"}),BEM.I18N.decl("sizes_spok_yes",{"Выбрать размер картинки":"Выбрать размер картинки","Открыть":"Открыть"},{lang:"ru"}),BEM.I18N.decl("slideshow-switcher_spok_yes",{"Слайдшоу":"Слайдшоу"},{lang:"ru"}),BEM.I18N.decl("suggest2",{fact:"Факты",group:"Группа подсказок",nah:"Вы искали",nav:"Сайт",text:"Поиск",traffic:"Пробки",weather:"Погода"},{lang:"ru"}),BEM.I18N.decl("suggest2-item",{"quick-answer":"Быстрый ответ"},{lang:"ru"}),BEM.I18N.decl("ticker__text",{notifications:"Уведомлений"},{lang:"ru"}),BEM.I18N.decl("tumbler",{off:"Откл",on:"Вкл"},{lang:"ru"}),BEM.I18N.decl("user",{enter:"Войти",exit:"Выйти",letter:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"новое письмо",some:"новых письма",many:"новых писем",none:"Нет новых писем"})},letter_compose:"Написать письмо",passport:"Паспорт",tune:"Настройка",upload_files:"Мой Диск"},{lang:"ru"}),BEM.I18N.lang("ru"));